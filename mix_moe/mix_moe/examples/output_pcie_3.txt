cuda:0
cuda:1
cuda:2
cuda:3
[Benchmark] world_size = 4, dtype = float16, model_dim = 1024, hidden_size = 4096, samples = 8192, num_local_experts = 4, topK = 2, a2a_ffn_overlap_degree = 1, device = `cuda:0`
STEP-0: step_time = 43.092896 ms, foward_time = 22.542236, backward_time = 20.199425, perf = 19.14 tflops.
STEP-1: step_time = 26.366977 ms, foward_time = 11.851776, backward_time = 14.393344, perf = 31.28 tflops.
STEP-2: step_time = 25.916416 ms, foward_time = 11.142144, backward_time = 14.673920, perf = 31.82 tflops.
STEP-3: step_time = 25.969664 ms, foward_time = 11.428864, backward_time = 14.443520, perf = 31.75 tflops.
STEP-4: step_time = 25.342976 ms, foward_time = 10.901505, backward_time = 14.336000, perf = 32.54 tflops.
STEP-5: step_time = 23.137280 ms, foward_time = 10.614784, backward_time = 12.423168, perf = 35.64 tflops.
STEP-6: step_time = 22.737921 ms, foward_time = 9.856000, backward_time = 12.781568, perf = 36.27 tflops.
STEP-7: step_time = 22.879232 ms, foward_time = 9.931776, backward_time = 12.848128, perf = 36.04 tflops.
STEP-8: step_time = 21.696512 ms, foward_time = 10.279936, backward_time = 11.315200, perf = 38.01 tflops.
STEP-9: step_time = 19.712736 ms, foward_time = 9.484000, backward_time = 10.068992, perf = 41.83 tflops.
STEP-10: step_time = 18.375679 ms, foward_time = 8.028160, backward_time = 10.249216, perf = 44.88 tflops.
STEP-11: step_time = 19.091456 ms, foward_time = 8.557568, backward_time = 10.435584, perf = 43.19 tflops.
STEP-12: step_time = 19.217408 ms, foward_time = 8.787968, backward_time = 10.332160, perf = 42.91 tflops.
STEP-13: step_time = 18.601985 ms, foward_time = 8.129536, backward_time = 10.374144, perf = 44.33 tflops.
STEP-14: step_time = 19.660801 ms, foward_time = 9.049088, backward_time = 10.515456, perf = 41.94 tflops.
STEP-15: step_time = 19.214336 ms, foward_time = 8.869888, backward_time = 10.232832, perf = 42.92 tflops.
STEP-16: step_time = 18.695103 ms, foward_time = 8.837056, backward_time = 9.761792, perf = 44.11 tflops.
STEP-17: step_time = 18.530304 ms, foward_time = 8.332288, backward_time = 10.100736, perf = 44.50 tflops.
STEP-18: step_time = 18.161665 ms, foward_time = 8.163328, backward_time = 9.902080, perf = 45.41 tflops.
STEP-19: step_time = 18.506752 ms, foward_time = 8.524801, backward_time = 9.850880, perf = 44.56 tflops.
STEP-20: step_time = 18.258945 ms, foward_time = 8.230912, backward_time = 9.928704, perf = 45.16 tflops.
STEP-21: step_time = 18.639840 ms, foward_time = 8.582112, backward_time = 9.960448, perf = 44.24 tflops.
STEP-22: step_time = 18.708479 ms, foward_time = 8.559616, backward_time = 10.021888, perf = 44.08 tflops.
STEP-23: step_time = 18.465792 ms, foward_time = 8.316928, backward_time = 10.051584, perf = 44.66 tflops.
STEP-24: step_time = 18.877440 ms, foward_time = 8.714240, backward_time = 10.066944, perf = 43.68 tflops.
STEP-25: step_time = 18.881536 ms, foward_time = 8.776704, backward_time = 9.975808, perf = 43.67 tflops.
STEP-26: step_time = 18.317311 ms, foward_time = 8.135680, backward_time = 10.085376, perf = 45.02 tflops.
STEP-27: step_time = 18.574336 ms, foward_time = 8.342528, backward_time = 10.133504, perf = 44.40 tflops.
STEP-28: step_time = 19.215232 ms, foward_time = 8.887168, backward_time = 10.206208, perf = 42.92 tflops.
STEP-29: step_time = 19.489984 ms, foward_time = 8.886464, backward_time = 10.506240, perf = 42.31 tflops.
STEP-30: step_time = 18.628608 ms, foward_time = 8.531968, backward_time = 9.999360, perf = 44.27 tflops.
STEP-31: step_time = 18.280448 ms, foward_time = 8.206336, backward_time = 9.975808, perf = 45.11 tflops.
STEP-32: step_time = 18.292737 ms, foward_time = 8.059904, backward_time = 10.100736, perf = 45.08 tflops.
STEP-33: step_time = 18.437119 ms, foward_time = 8.435712, backward_time = 9.903104, perf = 44.73 tflops.
STEP-34: step_time = 18.586625 ms, foward_time = 8.370176, backward_time = 10.118144, perf = 44.37 tflops.
STEP-35: step_time = 20.096001 ms, foward_time = 9.833472, backward_time = 10.165248, perf = 41.03 tflops.
STEP-36: step_time = 19.030016 ms, foward_time = 8.619008, backward_time = 10.311680, perf = 43.33 tflops.
STEP-37: step_time = 19.160064 ms, foward_time = 9.010175, backward_time = 10.033152, perf = 43.04 tflops.
STEP-38: step_time = 18.931712 ms, foward_time = 8.763392, backward_time = 10.034176, perf = 43.56 tflops.
STEP-39: step_time = 19.485696 ms, foward_time = 9.322496, backward_time = 9.974784, perf = 42.32 tflops.
STEP-40: step_time = 18.385920 ms, foward_time = 8.132608, backward_time = 10.155008, perf = 44.85 tflops.
STEP-41: step_time = 18.388992 ms, foward_time = 8.419328, backward_time = 9.870336, perf = 44.84 tflops.
STEP-42: step_time = 18.711553 ms, foward_time = 8.654848, backward_time = 9.960448, perf = 44.07 tflops.
STEP-43: step_time = 18.570240 ms, foward_time = 8.259584, backward_time = 10.213376, perf = 44.41 tflops.
STEP-44: step_time = 19.684352 ms, foward_time = 9.101312, backward_time = 10.417152, perf = 41.89 tflops.
STEP-45: step_time = 17.482752 ms, foward_time = 7.700480, backward_time = 9.686016, perf = 47.17 tflops.
STEP-46: step_time = 18.381824 ms, foward_time = 8.218624, backward_time = 10.063872, perf = 44.86 tflops.
STEP-47: step_time = 19.169377 ms, foward_time = 9.020512, backward_time = 10.013696, perf = 43.02 tflops.
STEP-48: step_time = 18.531329 ms, foward_time = 8.368128, backward_time = 10.065920, perf = 44.50 tflops.
STEP-49: step_time = 20.808704 ms, foward_time = 10.264576, backward_time = 10.445824, perf = 39.63 tflops.
STEP-50: step_time = 18.616320 ms, foward_time = 8.693760, backward_time = 9.824256, perf = 44.30 tflops.
STEP-51: step_time = 18.518016 ms, foward_time = 8.538112, backward_time = 9.882624, perf = 44.53 tflops.
STEP-52: step_time = 19.210592 ms, foward_time = 8.964448, backward_time = 10.147840, perf = 42.93 tflops.
STEP-53: step_time = 18.462721 ms, foward_time = 8.611840, backward_time = 9.711616, perf = 44.66 tflops.
STEP-54: step_time = 18.107391 ms, foward_time = 8.278016, backward_time = 9.731072, perf = 45.54 tflops.
STEP-55: step_time = 18.978817 ms, foward_time = 8.888320, backward_time = 9.993216, perf = 43.45 tflops.
STEP-56: step_time = 18.284544 ms, foward_time = 8.088576, backward_time = 10.099712, perf = 45.10 tflops.
STEP-57: step_time = 17.920001 ms, foward_time = 8.136704, backward_time = 9.652224, perf = 46.02 tflops.
STEP-58: step_time = 18.098176 ms, foward_time = 8.003584, backward_time = 9.997312, perf = 45.56 tflops.
STEP-59: step_time = 18.318337 ms, foward_time = 8.141824, backward_time = 10.079232, perf = 45.02 tflops.
STEP-60: step_time = 18.492415 ms, foward_time = 8.153088, backward_time = 10.243072, perf = 44.59 tflops.
STEP-61: step_time = 19.399615 ms, foward_time = 9.040832, backward_time = 10.223616, perf = 42.51 tflops.
STEP-62: step_time = 18.948800 ms, foward_time = 8.744640, backward_time = 10.106880, perf = 43.52 tflops.
STEP-63: step_time = 18.487296 ms, foward_time = 8.276992, backward_time = 10.077184, perf = 44.61 tflops.
STEP-64: step_time = 18.609152 ms, foward_time = 8.679424, backward_time = 9.831424, perf = 44.31 tflops.
STEP-65: step_time = 18.898943 ms, foward_time = 8.619008, backward_time = 10.182656, perf = 43.63 tflops.
STEP-66: step_time = 18.850816 ms, foward_time = 8.707072, backward_time = 10.010624, perf = 43.75 tflops.
STEP-67: step_time = 18.622465 ms, foward_time = 8.584192, backward_time = 9.942016, perf = 44.28 tflops.
STEP-68: step_time = 18.325505 ms, foward_time = 8.169472, backward_time = 10.058752, perf = 45.00 tflops.
STEP-69: step_time = 17.945599 ms, foward_time = 8.008704, backward_time = 9.839616, perf = 45.95 tflops.
STEP-70: step_time = 18.585344 ms, foward_time = 8.553216, backward_time = 9.934848, perf = 44.37 tflops.
STEP-71: step_time = 18.861056 ms, foward_time = 8.495104, backward_time = 10.267648, perf = 43.72 tflops.
STEP-72: step_time = 18.312640 ms, foward_time = 8.365504, backward_time = 9.806848, perf = 45.03 tflops.
STEP-73: step_time = 18.376705 ms, foward_time = 8.455168, backward_time = 9.823232, perf = 44.87 tflops.
STEP-74: step_time = 19.007488 ms, foward_time = 8.740864, backward_time = 10.170368, perf = 43.38 tflops.
STEP-75: step_time = 18.716383 ms, foward_time = 8.793824, backward_time = 9.825280, perf = 44.06 tflops.
STEP-76: step_time = 18.507712 ms, foward_time = 8.343488, backward_time = 10.041344, perf = 44.56 tflops.
STEP-77: step_time = 18.454528 ms, foward_time = 8.250368, backward_time = 10.106880, perf = 44.68 tflops.
STEP-78: step_time = 18.726911 ms, foward_time = 8.510464, backward_time = 10.118144, perf = 44.03 tflops.
STEP-79: step_time = 18.900993 ms, foward_time = 8.704000, backward_time = 10.066944, perf = 43.63 tflops.
STEP-80: step_time = 18.310144 ms, foward_time = 8.244224, backward_time = 9.968640, perf = 45.04 tflops.
STEP-81: step_time = 18.238464 ms, foward_time = 8.004608, backward_time = 10.137600, perf = 45.21 tflops.
STEP-82: step_time = 18.087937 ms, foward_time = 8.263680, backward_time = 9.690112, perf = 45.59 tflops.
STEP-83: step_time = 18.029568 ms, foward_time = 8.159232, backward_time = 9.774080, perf = 45.74 tflops.
STEP-84: step_time = 18.944351 ms, foward_time = 8.813920, backward_time = 10.033152, perf = 43.53 tflops.
STEP-85: step_time = 18.294784 ms, foward_time = 8.413184, backward_time = 9.784320, perf = 45.07 tflops.
STEP-86: step_time = 18.627712 ms, foward_time = 8.793216, backward_time = 9.736192, perf = 44.27 tflops.
STEP-87: step_time = 19.091456 ms, foward_time = 8.745984, backward_time = 10.247168, perf = 43.19 tflops.
STEP-88: step_time = 18.562688 ms, foward_time = 8.754816, backward_time = 9.710592, perf = 44.42 tflops.
STEP-89: step_time = 18.789280 ms, foward_time = 8.961952, backward_time = 9.731072, perf = 43.89 tflops.
STEP-90: step_time = 19.306497 ms, foward_time = 8.768512, backward_time = 10.439680, perf = 42.71 tflops.
STEP-91: step_time = 19.223232 ms, foward_time = 8.873664, backward_time = 10.214400, perf = 42.90 tflops.
STEP-92: step_time = 18.859009 ms, foward_time = 8.739841, backward_time = 10.021888, perf = 43.73 tflops.
STEP-93: step_time = 18.491392 ms, foward_time = 8.453120, backward_time = 9.940992, perf = 44.60 tflops.
STEP-94: step_time = 17.956864 ms, foward_time = 8.099840, backward_time = 9.730048, perf = 45.92 tflops.
STEP-95: step_time = 18.278399 ms, foward_time = 8.415232, backward_time = 9.764864, perf = 45.12 tflops.
STEP-96: step_time = 18.929664 ms, foward_time = 8.622080, backward_time = 10.211328, perf = 43.56 tflops.
STEP-97: step_time = 18.600961 ms, foward_time = 8.702976, backward_time = 9.771008, perf = 44.33 tflops.
STEP-98: step_time = 18.340865 ms, foward_time = 8.422400, backward_time = 9.821184, perf = 44.96 tflops.
STEP-99: step_time = 18.325504 ms, foward_time = 8.160256, backward_time = 10.067968, perf = 45.00 tflops.

 mix_moe 4 [Summary] Average synchronized step_time = 18.631238555908205 ms, forward = 8.525791931152344 , backward = 9.998336029052734 .
cuda:3
cuda:0
cuda:1
cuda:2
[Benchmark] world_size = 4, dtype = float16, model_dim = 1024, hidden_size = 4096, samples = 8192, num_local_experts = 8, topK = 2, a2a_ffn_overlap_degree = 1, device = `cuda:0`
STEP-0: step_time = 50.846680 ms, foward_time = 21.924805, backward_time = 28.619776, perf = 16.22 tflops.
STEP-1: step_time = 26.995711 ms, foward_time = 12.264448, backward_time = 14.613504, perf = 30.55 tflops.
STEP-2: step_time = 27.241471 ms, foward_time = 12.273664, backward_time = 14.867456, perf = 30.27 tflops.
STEP-3: step_time = 25.800095 ms, foward_time = 12.621216, backward_time = 13.082624, perf = 31.96 tflops.
STEP-4: step_time = 22.985729 ms, foward_time = 10.599424, backward_time = 12.290048, perf = 35.88 tflops.
STEP-5: step_time = 23.751136 ms, foward_time = 11.083231, backward_time = 12.566528, perf = 34.72 tflops.
STEP-6: step_time = 22.992895 ms, foward_time = 10.642432, backward_time = 12.255232, perf = 35.86 tflops.
STEP-7: step_time = 23.062528 ms, foward_time = 10.668032, backward_time = 12.298240, perf = 35.76 tflops.
STEP-8: step_time = 22.863201 ms, foward_time = 10.422624, backward_time = 12.343296, perf = 36.07 tflops.
STEP-9: step_time = 23.163008 ms, foward_time = 10.688640, backward_time = 12.378112, perf = 35.60 tflops.
STEP-10: step_time = 23.325695 ms, foward_time = 10.284032, backward_time = 12.945408, perf = 35.35 tflops.
STEP-11: step_time = 23.667712 ms, foward_time = 11.013120, backward_time = 12.572672, perf = 34.84 tflops.
STEP-12: step_time = 23.555073 ms, foward_time = 10.928128, backward_time = 12.539904, perf = 35.01 tflops.
STEP-13: step_time = 22.903808 ms, foward_time = 10.374144, backward_time = 12.432384, perf = 36.00 tflops.
STEP-14: step_time = 21.186559 ms, foward_time = 11.060224, backward_time = 10.030080, perf = 38.92 tflops.
STEP-15: step_time = 19.775200 ms, foward_time = 9.476832, backward_time = 10.159104, perf = 41.70 tflops.
STEP-16: step_time = 19.361791 ms, foward_time = 9.178112, backward_time = 10.088448, perf = 42.59 tflops.
STEP-17: step_time = 19.441665 ms, foward_time = 9.463808, backward_time = 9.882624, perf = 42.42 tflops.
STEP-18: step_time = 19.903489 ms, foward_time = 9.810944, backward_time = 9.995264, perf = 41.43 tflops.
STEP-19: step_time = 19.105792 ms, foward_time = 9.438208, backward_time = 9.534464, perf = 43.16 tflops.
STEP-20: step_time = 18.611200 ms, foward_time = 8.745984, backward_time = 9.769984, perf = 44.31 tflops.
STEP-21: step_time = 19.650560 ms, foward_time = 9.313280, backward_time = 10.230784, perf = 41.96 tflops.
STEP-22: step_time = 20.124672 ms, foward_time = 9.757696, backward_time = 10.238976, perf = 40.98 tflops.
STEP-23: step_time = 19.473409 ms, foward_time = 9.262080, backward_time = 10.114048, perf = 42.35 tflops.
STEP-24: step_time = 19.087360 ms, foward_time = 9.155584, backward_time = 9.834496, perf = 43.20 tflops.
STEP-25: step_time = 19.545087 ms, foward_time = 9.380864, backward_time = 10.066944, perf = 42.19 tflops.
STEP-26: step_time = 19.745791 ms, foward_time = 9.241600, backward_time = 10.406912, perf = 41.76 tflops.
STEP-27: step_time = 19.924991 ms, foward_time = 9.396224, backward_time = 10.433536, perf = 41.39 tflops.
STEP-28: step_time = 19.464192 ms, foward_time = 9.211904, backward_time = 10.157056, perf = 42.37 tflops.
STEP-29: step_time = 18.671617 ms, foward_time = 8.441856, backward_time = 10.133504, perf = 44.17 tflops.
STEP-30: step_time = 19.086337 ms, foward_time = 8.839168, backward_time = 10.123264, perf = 43.21 tflops.
STEP-31: step_time = 18.883584 ms, foward_time = 8.438784, backward_time = 10.349568, perf = 43.67 tflops.
STEP-32: step_time = 18.798593 ms, foward_time = 8.509440, backward_time = 10.127360, perf = 43.87 tflops.
STEP-33: step_time = 18.454528 ms, foward_time = 8.254464, backward_time = 10.102784, perf = 44.68 tflops.
STEP-34: step_time = 18.538496 ms, foward_time = 8.694784, backward_time = 9.746432, perf = 44.48 tflops.
STEP-35: step_time = 18.407424 ms, foward_time = 8.273920, backward_time = 10.038272, perf = 44.80 tflops.
STEP-36: step_time = 19.723263 ms, foward_time = 9.376768, backward_time = 10.243072, perf = 41.81 tflops.
STEP-37: step_time = 18.458625 ms, foward_time = 8.102912, backward_time = 10.258432, perf = 44.67 tflops.
STEP-38: step_time = 18.969600 ms, foward_time = 8.928257, backward_time = 9.944064, perf = 43.47 tflops.
STEP-39: step_time = 18.989055 ms, foward_time = 8.829952, backward_time = 10.061824, perf = 43.43 tflops.
STEP-40: step_time = 19.102721 ms, foward_time = 8.939520, backward_time = 10.065920, perf = 43.17 tflops.
STEP-41: step_time = 18.921471 ms, foward_time = 8.807424, backward_time = 10.018816, perf = 43.58 tflops.
STEP-42: step_time = 18.956289 ms, foward_time = 8.686592, backward_time = 10.173440, perf = 43.50 tflops.
STEP-43: step_time = 19.380223 ms, foward_time = 9.109504, backward_time = 10.137600, perf = 42.55 tflops.
STEP-44: step_time = 17.996800 ms, foward_time = 7.764992, backward_time = 10.136576, perf = 45.82 tflops.
STEP-45: step_time = 18.129921 ms, foward_time = 8.070144, backward_time = 9.963520, perf = 45.48 tflops.
STEP-46: step_time = 19.086337 ms, foward_time = 8.800256, backward_time = 10.188800, perf = 43.21 tflops.
STEP-47: step_time = 18.682879 ms, foward_time = 8.420352, backward_time = 10.168320, perf = 44.14 tflops.
STEP-48: step_time = 18.814976 ms, foward_time = 8.635392, backward_time = 10.052608, perf = 43.83 tflops.
STEP-49: step_time = 19.254272 ms, foward_time = 8.862720, backward_time = 10.295296, perf = 42.83 tflops.
STEP-50: step_time = 19.109889 ms, foward_time = 8.919040, backward_time = 10.094592, perf = 43.15 tflops.
STEP-51: step_time = 18.562049 ms, foward_time = 8.201216, backward_time = 10.264576, perf = 44.43 tflops.
STEP-52: step_time = 18.692095 ms, foward_time = 8.571904, backward_time = 9.989120, perf = 44.12 tflops.
STEP-53: step_time = 17.989632 ms, foward_time = 7.973888, backward_time = 9.920512, perf = 45.84 tflops.
STEP-54: step_time = 18.925569 ms, foward_time = 8.841216, backward_time = 9.990144, perf = 43.57 tflops.
STEP-55: step_time = 18.841600 ms, foward_time = 8.497152, backward_time = 10.249216, perf = 43.77 tflops.
STEP-56: step_time = 19.126272 ms, foward_time = 8.827904, backward_time = 10.200064, perf = 43.12 tflops.
STEP-57: step_time = 19.127295 ms, foward_time = 8.966144, backward_time = 10.063872, perf = 43.11 tflops.
STEP-58: step_time = 19.279233 ms, foward_time = 9.191808, backward_time = 9.990144, perf = 42.77 tflops.
STEP-59: step_time = 19.006464 ms, foward_time = 8.842240, backward_time = 10.038272, perf = 43.39 tflops.
STEP-60: step_time = 19.082241 ms, foward_time = 8.861696, backward_time = 10.124288, perf = 43.21 tflops.
STEP-61: step_time = 19.652192 ms, foward_time = 9.144928, backward_time = 10.369024, perf = 41.96 tflops.
STEP-62: step_time = 19.314625 ms, foward_time = 9.213888, backward_time = 10.006528, perf = 42.69 tflops.
STEP-63: step_time = 19.599360 ms, foward_time = 9.169920, backward_time = 10.267648, perf = 42.07 tflops.
STEP-64: step_time = 18.779135 ms, foward_time = 8.556544, backward_time = 10.127360, perf = 43.91 tflops.
STEP-65: step_time = 20.035200 ms, foward_time = 9.350784, backward_time = 10.587136, perf = 41.16 tflops.
STEP-66: step_time = 19.432032 ms, foward_time = 8.936032, backward_time = 10.399744, perf = 42.44 tflops.
STEP-67: step_time = 19.432447 ms, foward_time = 8.822783, backward_time = 10.465280, perf = 42.44 tflops.
STEP-68: step_time = 19.144703 ms, foward_time = 8.813568, backward_time = 10.234880, perf = 43.07 tflops.
STEP-69: step_time = 19.538496 ms, foward_time = 9.281088, backward_time = 10.160128, perf = 42.21 tflops.
STEP-70: step_time = 19.084287 ms, foward_time = 8.700927, backward_time = 10.288128, perf = 43.21 tflops.
STEP-71: step_time = 19.112961 ms, foward_time = 8.902656, backward_time = 10.076160, perf = 43.15 tflops.
STEP-72: step_time = 19.603233 ms, foward_time = 9.151264, backward_time = 10.354688, perf = 42.07 tflops.
STEP-73: step_time = 19.355648 ms, foward_time = 9.160704, backward_time = 10.043392, perf = 42.60 tflops.
STEP-74: step_time = 18.821119 ms, foward_time = 8.513536, backward_time = 10.211328, perf = 43.81 tflops.
STEP-75: step_time = 18.881536 ms, foward_time = 8.835072, backward_time = 9.949184, perf = 43.67 tflops.
STEP-76: step_time = 19.304449 ms, foward_time = 9.180160, backward_time = 10.029056, perf = 42.72 tflops.
STEP-77: step_time = 19.191808 ms, foward_time = 8.860672, backward_time = 10.233856, perf = 42.97 tflops.
STEP-78: step_time = 19.488961 ms, foward_time = 9.306304, backward_time = 10.084352, perf = 42.31 tflops.
STEP-79: step_time = 19.106817 ms, foward_time = 8.588288, backward_time = 10.422272, perf = 43.16 tflops.
STEP-80: step_time = 18.670591 ms, foward_time = 8.920064, backward_time = 9.609216, perf = 44.17 tflops.
STEP-81: step_time = 18.697217 ms, foward_time = 9.011200, backward_time = 9.590784, perf = 44.10 tflops.
STEP-82: step_time = 19.401119 ms, foward_time = 9.280928, backward_time = 10.021888, perf = 42.50 tflops.
STEP-83: step_time = 18.548160 ms, foward_time = 8.718784, backward_time = 9.697280, perf = 44.46 tflops.
STEP-84: step_time = 19.145728 ms, foward_time = 9.333760, backward_time = 9.715712, perf = 43.07 tflops.
STEP-85: step_time = 18.611200 ms, foward_time = 8.429568, backward_time = 10.086400, perf = 44.31 tflops.
STEP-86: step_time = 19.334816 ms, foward_time = 9.309856, backward_time = 9.927680, perf = 42.65 tflops.
STEP-87: step_time = 19.411967 ms, foward_time = 9.156608, backward_time = 10.159104, perf = 42.48 tflops.
STEP-88: step_time = 19.307935 ms, foward_time = 9.178528, backward_time = 10.033152, perf = 42.71 tflops.
STEP-89: step_time = 18.927616 ms, foward_time = 8.603648, backward_time = 10.227712, perf = 43.57 tflops.
STEP-90: step_time = 19.161311 ms, foward_time = 8.816864, backward_time = 10.212352, perf = 43.04 tflops.
STEP-91: step_time = 19.352576 ms, foward_time = 8.929280, backward_time = 10.327040, perf = 42.61 tflops.
STEP-92: step_time = 19.869697 ms, foward_time = 9.437184, backward_time = 10.337280, perf = 41.50 tflops.
STEP-93: step_time = 19.439616 ms, foward_time = 9.159680, backward_time = 10.184704, perf = 42.42 tflops.
STEP-94: step_time = 18.772991 ms, foward_time = 8.679424, backward_time = 9.959424, perf = 43.93 tflops.
STEP-95: step_time = 19.736577 ms, foward_time = 9.491456, backward_time = 10.148864, perf = 41.78 tflops.
STEP-96: step_time = 19.400704 ms, foward_time = 9.094144, backward_time = 10.210304, perf = 42.51 tflops.
STEP-97: step_time = 19.483553 ms, foward_time = 9.126816, backward_time = 10.259456, perf = 42.32 tflops.
STEP-98: step_time = 19.190304 ms, foward_time = 8.904224, backward_time = 10.149888, perf = 42.97 tflops.
STEP-99: step_time = 19.628032 ms, foward_time = 9.134080, backward_time = 10.398720, perf = 42.01 tflops.

 mix_moe 8 [Summary] Average synchronized step_time = 19.403536105155943 ms, forward = 9.077315211296082 , backward = 10.218803119659423 .
cuda:3
cuda:1
cuda:2
cuda:0
[Benchmark] world_size = 4, dtype = float16, model_dim = 1024, hidden_size = 4096, samples = 8192, num_local_experts = 16, topK = 2, a2a_ffn_overlap_degree = 1, device = `cuda:0`
STEP-0: step_time = 42.588135 ms, foward_time = 22.559692, backward_time = 19.572737, perf = 19.36 tflops.
STEP-1: step_time = 28.231679 ms, foward_time = 13.463552, backward_time = 14.647296, perf = 29.21 tflops.
STEP-2: step_time = 27.838464 ms, foward_time = 13.112319, backward_time = 14.625792, perf = 29.62 tflops.
STEP-3: step_time = 26.753023 ms, foward_time = 13.400064, backward_time = 13.256704, perf = 30.82 tflops.
STEP-4: step_time = 25.972737 ms, foward_time = 13.120512, backward_time = 12.674048, perf = 31.75 tflops.
STEP-5: step_time = 26.156032 ms, foward_time = 12.887040, backward_time = 13.173760, perf = 31.53 tflops.
STEP-6: step_time = 25.376768 ms, foward_time = 12.257280, backward_time = 13.023232, perf = 32.50 tflops.
STEP-7: step_time = 25.224192 ms, foward_time = 11.821056, backward_time = 13.305856, perf = 32.69 tflops.
STEP-8: step_time = 26.039969 ms, foward_time = 12.563104, backward_time = 13.379584, perf = 31.67 tflops.
STEP-9: step_time = 25.742335 ms, foward_time = 12.732416, backward_time = 12.913664, perf = 32.03 tflops.
STEP-10: step_time = 22.104064 ms, foward_time = 10.901504, backward_time = 11.105280, perf = 37.31 tflops.
STEP-11: step_time = 22.530655 ms, foward_time = 11.269728, backward_time = 11.164672, perf = 36.60 tflops.
STEP-12: step_time = 22.523968 ms, foward_time = 11.023424, backward_time = 11.374592, perf = 36.61 tflops.
STEP-13: step_time = 22.551552 ms, foward_time = 10.682368, backward_time = 11.773952, perf = 36.57 tflops.
STEP-14: step_time = 22.306817 ms, foward_time = 10.925056, backward_time = 11.275264, perf = 36.97 tflops.
STEP-15: step_time = 21.469183 ms, foward_time = 10.290176, backward_time = 11.080704, perf = 38.41 tflops.
STEP-16: step_time = 22.209536 ms, foward_time = 10.719232, backward_time = 11.392000, perf = 37.13 tflops.
STEP-17: step_time = 22.482944 ms, foward_time = 10.894336, backward_time = 11.492352, perf = 36.68 tflops.
STEP-18: step_time = 21.513216 ms, foward_time = 9.808896, backward_time = 11.606016, perf = 38.33 tflops.
STEP-19: step_time = 22.014592 ms, foward_time = 10.604160, backward_time = 11.279360, perf = 37.46 tflops.
STEP-20: step_time = 22.131711 ms, foward_time = 10.827776, backward_time = 11.208704, perf = 37.26 tflops.
STEP-21: step_time = 23.741504 ms, foward_time = 12.074048, backward_time = 11.569152, perf = 34.73 tflops.
STEP-22: step_time = 22.020097 ms, foward_time = 10.659840, backward_time = 11.265024, perf = 37.45 tflops.
STEP-23: step_time = 23.313408 ms, foward_time = 11.336704, backward_time = 11.879424, perf = 35.37 tflops.
STEP-24: step_time = 23.104223 ms, foward_time = 11.828960, backward_time = 11.153408, perf = 35.69 tflops.
STEP-25: step_time = 22.648832 ms, foward_time = 11.235328, backward_time = 11.317248, perf = 36.41 tflops.
STEP-26: step_time = 23.432735 ms, foward_time = 12.091936, backward_time = 11.244544, perf = 35.19 tflops.
STEP-27: step_time = 22.758400 ms, foward_time = 11.430912, backward_time = 11.232256, perf = 36.23 tflops.
STEP-28: step_time = 22.896063 ms, foward_time = 11.278784, backward_time = 11.521024, perf = 36.02 tflops.
STEP-29: step_time = 22.061056 ms, foward_time = 10.696704, backward_time = 11.268096, perf = 37.38 tflops.
STEP-30: step_time = 22.748159 ms, foward_time = 11.517952, backward_time = 11.131904, perf = 36.25 tflops.
STEP-31: step_time = 22.425889 ms, foward_time = 10.744096, backward_time = 11.581440, perf = 36.77 tflops.
STEP-32: step_time = 23.239520 ms, foward_time = 11.534176, backward_time = 11.598848, perf = 35.48 tflops.
STEP-33: step_time = 22.832128 ms, foward_time = 11.312128, backward_time = 11.423744, perf = 36.12 tflops.
STEP-34: step_time = 22.749536 ms, foward_time = 11.325792, backward_time = 11.324416, perf = 36.25 tflops.
STEP-35: step_time = 22.518784 ms, foward_time = 11.001856, backward_time = 11.419648, perf = 36.62 tflops.
STEP-36: step_time = 21.656832 ms, foward_time = 10.507520, backward_time = 11.047936, perf = 38.08 tflops.
STEP-37: step_time = 22.250401 ms, foward_time = 10.847136, backward_time = 11.278336, perf = 37.06 tflops.
STEP-38: step_time = 22.258689 ms, foward_time = 10.760192, backward_time = 11.393024, perf = 37.05 tflops.
STEP-39: step_time = 22.287360 ms, foward_time = 10.518528, backward_time = 11.670528, perf = 37.00 tflops.
STEP-40: step_time = 21.898239 ms, foward_time = 10.315776, backward_time = 11.485184, perf = 37.66 tflops.
STEP-41: step_time = 22.019072 ms, foward_time = 10.578944, backward_time = 11.342848, perf = 37.45 tflops.
STEP-42: step_time = 22.366785 ms, foward_time = 10.882624, backward_time = 11.387904, perf = 36.87 tflops.
STEP-43: step_time = 22.491201 ms, foward_time = 10.945600, backward_time = 11.447296, perf = 36.66 tflops.
STEP-44: step_time = 22.354943 ms, foward_time = 10.715136, backward_time = 11.541504, perf = 36.89 tflops.
STEP-45: step_time = 22.388737 ms, foward_time = 10.903552, backward_time = 11.386880, perf = 36.83 tflops.
STEP-46: step_time = 21.910528 ms, foward_time = 10.622976, backward_time = 11.191296, perf = 37.64 tflops.
STEP-47: step_time = 21.760576 ms, foward_time = 10.472000, backward_time = 11.191296, perf = 37.90 tflops.
STEP-48: step_time = 21.732095 ms, foward_time = 10.320640, backward_time = 11.314176, perf = 37.95 tflops.
STEP-49: step_time = 22.699007 ms, foward_time = 10.935296, backward_time = 11.666432, perf = 36.33 tflops.
STEP-50: step_time = 22.237184 ms, foward_time = 10.520576, backward_time = 11.613184, perf = 37.08 tflops.
STEP-51: step_time = 22.623231 ms, foward_time = 10.987520, backward_time = 11.538432, perf = 36.45 tflops.
STEP-52: step_time = 22.071296 ms, foward_time = 10.756096, backward_time = 11.194368, perf = 37.36 tflops.
STEP-53: step_time = 22.522879 ms, foward_time = 11.074560, backward_time = 11.353088, perf = 36.61 tflops.
STEP-54: step_time = 22.475329 ms, foward_time = 10.746432, backward_time = 11.632640, perf = 36.69 tflops.
STEP-55: step_time = 22.230015 ms, foward_time = 10.934272, backward_time = 11.199488, perf = 37.10 tflops.
STEP-56: step_time = 21.904641 ms, foward_time = 10.396928, backward_time = 11.413504, perf = 37.65 tflops.
STEP-57: step_time = 22.178816 ms, foward_time = 10.758144, backward_time = 11.322368, perf = 37.18 tflops.
STEP-58: step_time = 22.010879 ms, foward_time = 10.468352, backward_time = 11.445248, perf = 37.46 tflops.
STEP-59: step_time = 22.125567 ms, foward_time = 10.695680, backward_time = 11.333632, perf = 37.27 tflops.
STEP-60: step_time = 22.532097 ms, foward_time = 11.148288, backward_time = 11.289600, perf = 36.60 tflops.
STEP-61: step_time = 22.223201 ms, foward_time = 10.799456, backward_time = 11.325440, perf = 37.11 tflops.
STEP-62: step_time = 22.181887 ms, foward_time = 10.386432, backward_time = 11.697152, perf = 37.18 tflops.
STEP-63: step_time = 22.493313 ms, foward_time = 11.020416, backward_time = 11.377664, perf = 36.66 tflops.
STEP-64: step_time = 22.006688 ms, foward_time = 10.621856, backward_time = 11.262976, perf = 37.47 tflops.
STEP-65: step_time = 22.142367 ms, foward_time = 10.610080, backward_time = 11.433984, perf = 37.24 tflops.
STEP-66: step_time = 22.345952 ms, foward_time = 10.702048, backward_time = 11.547648, perf = 36.90 tflops.
STEP-67: step_time = 22.403168 ms, foward_time = 10.627168, backward_time = 11.678720, perf = 36.81 tflops.
STEP-68: step_time = 21.953151 ms, foward_time = 10.392192, backward_time = 11.463680, perf = 37.56 tflops.
STEP-69: step_time = 21.978112 ms, foward_time = 10.730496, backward_time = 11.149312, perf = 37.52 tflops.
STEP-70: step_time = 22.285953 ms, foward_time = 10.865280, backward_time = 11.320320, perf = 37.00 tflops.
STEP-71: step_time = 21.749761 ms, foward_time = 10.304512, backward_time = 11.340800, perf = 37.91 tflops.
STEP-72: step_time = 21.528577 ms, foward_time = 10.167296, backward_time = 11.257856, perf = 38.30 tflops.
STEP-73: step_time = 23.260160 ms, foward_time = 11.598848, backward_time = 11.553792, perf = 35.45 tflops.
STEP-74: step_time = 23.558143 ms, foward_time = 12.128256, backward_time = 11.305984, perf = 35.00 tflops.
STEP-75: step_time = 23.950337 ms, foward_time = 12.321792, backward_time = 11.531264, perf = 34.43 tflops.
STEP-76: step_time = 22.098943 ms, foward_time = 10.721280, backward_time = 11.281408, perf = 37.32 tflops.
STEP-77: step_time = 23.072192 ms, foward_time = 11.700672, backward_time = 11.268096, perf = 35.74 tflops.
STEP-78: step_time = 22.769664 ms, foward_time = 11.328512, backward_time = 11.341824, perf = 36.22 tflops.
STEP-79: step_time = 21.948416 ms, foward_time = 10.238976, backward_time = 11.612160, perf = 37.57 tflops.
STEP-80: step_time = 23.490560 ms, foward_time = 11.659264, backward_time = 11.734016, perf = 35.10 tflops.
STEP-81: step_time = 23.129088 ms, foward_time = 11.693056, backward_time = 11.338752, perf = 35.65 tflops.
STEP-82: step_time = 22.679552 ms, foward_time = 11.420672, backward_time = 11.162624, perf = 36.36 tflops.
STEP-83: step_time = 22.821889 ms, foward_time = 11.162624, backward_time = 11.563008, perf = 36.13 tflops.
STEP-84: step_time = 23.344128 ms, foward_time = 11.828224, backward_time = 11.416576, perf = 35.33 tflops.
STEP-85: step_time = 23.431903 ms, foward_time = 11.849440, backward_time = 11.485184, perf = 35.19 tflops.
STEP-86: step_time = 21.073920 ms, foward_time = 9.678848, backward_time = 11.262976, perf = 39.13 tflops.
STEP-87: step_time = 22.233088 ms, foward_time = 10.762240, backward_time = 11.374592, perf = 37.09 tflops.
STEP-88: step_time = 22.719488 ms, foward_time = 10.067968, backward_time = 12.556288, perf = 36.30 tflops.
STEP-89: step_time = 21.941247 ms, foward_time = 10.377216, backward_time = 11.467776, perf = 37.58 tflops.
STEP-90: step_time = 22.231040 ms, foward_time = 10.849280, backward_time = 11.286528, perf = 37.09 tflops.
STEP-91: step_time = 21.627904 ms, foward_time = 10.250240, backward_time = 11.282432, perf = 38.13 tflops.
STEP-92: step_time = 22.209536 ms, foward_time = 10.728448, backward_time = 11.383808, perf = 37.13 tflops.
STEP-93: step_time = 22.588416 ms, foward_time = 10.733567, backward_time = 11.759616, perf = 36.51 tflops.
STEP-94: step_time = 21.917633 ms, foward_time = 10.538944, backward_time = 11.283456, perf = 37.62 tflops.
STEP-95: step_time = 22.021119 ms, foward_time = 10.493952, backward_time = 11.429888, perf = 37.45 tflops.
STEP-96: step_time = 24.026656 ms, foward_time = 12.327456, backward_time = 11.603968, perf = 34.32 tflops.
STEP-97: step_time = 22.114304 ms, foward_time = 10.519552, backward_time = 11.500544, perf = 37.29 tflops.
STEP-98: step_time = 22.237761 ms, foward_time = 10.773056, backward_time = 11.367424, perf = 37.08 tflops.
STEP-99: step_time = 21.914368 ms, foward_time = 10.544896, backward_time = 11.275264, perf = 37.63 tflops.

 mix_moe 16 [Summary] Average synchronized step_time = 22.288873815536498 ms, forward = 10.77593903541565 , backward = 11.417292594909668 .
cuda:0
cuda:2
cuda:1
cuda:3
[Benchmark] world_size = 4, dtype = float16, model_dim = 1024, hidden_size = 4096, samples = 8192, num_local_experts = 32, topK = 2, a2a_ffn_overlap_degree = 1, device = `cuda:0`
STEP-0: step_time = 57.114624 ms, foward_time = 29.361084, backward_time = 27.281408, perf = 14.44 tflops.
STEP-1: step_time = 34.077314 ms, foward_time = 17.590911, backward_time = 16.314367, perf = 24.20 tflops.
STEP-2: step_time = 33.393823 ms, foward_time = 17.015968, backward_time = 16.225281, perf = 24.69 tflops.
STEP-3: step_time = 29.681665 ms, foward_time = 15.897600, backward_time = 13.633536, perf = 27.78 tflops.
STEP-4: step_time = 27.614208 ms, foward_time = 14.350336, backward_time = 13.118464, perf = 29.86 tflops.
STEP-5: step_time = 26.242048 ms, foward_time = 13.005823, backward_time = 13.095936, perf = 31.42 tflops.
STEP-6: step_time = 28.038143 ms, foward_time = 14.766079, backward_time = 13.128704, perf = 29.41 tflops.
STEP-7: step_time = 26.266623 ms, foward_time = 14.021632, backward_time = 12.102656, perf = 31.39 tflops.
STEP-8: step_time = 23.669761 ms, foward_time = 12.135425, backward_time = 11.392000, perf = 34.84 tflops.
STEP-9: step_time = 25.163775 ms, foward_time = 12.752896, backward_time = 12.265472, perf = 32.77 tflops.
STEP-10: step_time = 23.126016 ms, foward_time = 12.407808, backward_time = 10.576896, perf = 35.66 tflops.
STEP-11: step_time = 23.465984 ms, foward_time = 12.189696, backward_time = 11.134976, perf = 35.14 tflops.
STEP-12: step_time = 23.333536 ms, foward_time = 11.954848, backward_time = 11.236352, perf = 35.34 tflops.
STEP-13: step_time = 23.561215 ms, foward_time = 12.048384, backward_time = 11.371520, perf = 35.00 tflops.
STEP-14: step_time = 22.946816 ms, foward_time = 11.724800, backward_time = 11.079680, perf = 35.94 tflops.
STEP-15: step_time = 22.386689 ms, foward_time = 11.046912, backward_time = 11.224064, perf = 36.84 tflops.
STEP-16: step_time = 23.201472 ms, foward_time = 12.014272, backward_time = 11.096064, perf = 35.54 tflops.
STEP-17: step_time = 22.810624 ms, foward_time = 11.524096, backward_time = 11.201536, perf = 36.15 tflops.
STEP-18: step_time = 23.228416 ms, foward_time = 12.095488, backward_time = 11.034624, perf = 35.50 tflops.
STEP-19: step_time = 24.144641 ms, foward_time = 12.427008, backward_time = 11.620352, perf = 34.15 tflops.
STEP-20: step_time = 23.572479 ms, foward_time = 12.252160, backward_time = 11.223040, perf = 34.98 tflops.
STEP-21: step_time = 23.378944 ms, foward_time = 12.120064, backward_time = 11.162624, perf = 35.27 tflops.
STEP-22: step_time = 22.783999 ms, foward_time = 11.688960, backward_time = 10.998784, perf = 36.19 tflops.
STEP-23: step_time = 23.541183 ms, foward_time = 12.186048, backward_time = 11.257856, perf = 35.03 tflops.
STEP-24: step_time = 23.101440 ms, foward_time = 11.968512, backward_time = 11.037696, perf = 35.70 tflops.
STEP-25: step_time = 23.541568 ms, foward_time = 12.165952, backward_time = 11.278336, perf = 35.03 tflops.
STEP-26: step_time = 22.839296 ms, foward_time = 11.737088, backward_time = 11.005952, perf = 36.11 tflops.
STEP-27: step_time = 23.507968 ms, foward_time = 12.025856, backward_time = 11.385856, perf = 35.08 tflops.
STEP-28: step_time = 22.935553 ms, foward_time = 11.840513, backward_time = 10.996736, perf = 35.95 tflops.
STEP-29: step_time = 23.249920 ms, foward_time = 11.986944, backward_time = 11.164672, perf = 35.47 tflops.
STEP-30: step_time = 23.033887 ms, foward_time = 11.858976, backward_time = 11.077632, perf = 35.80 tflops.
STEP-31: step_time = 22.839872 ms, foward_time = 11.634240, backward_time = 11.108352, perf = 36.11 tflops.
STEP-32: step_time = 23.173120 ms, foward_time = 11.913216, backward_time = 11.161600, perf = 35.59 tflops.
STEP-33: step_time = 22.792191 ms, foward_time = 11.598848, backward_time = 11.097088, perf = 36.18 tflops.
STEP-34: step_time = 23.598849 ms, foward_time = 12.065536, backward_time = 11.437056, perf = 34.94 tflops.
STEP-35: step_time = 22.632448 ms, foward_time = 11.541503, backward_time = 10.994688, perf = 36.44 tflops.
STEP-36: step_time = 23.369728 ms, foward_time = 12.024832, backward_time = 11.247616, perf = 35.29 tflops.
STEP-37: step_time = 22.889471 ms, foward_time = 11.698176, backward_time = 11.095040, perf = 36.03 tflops.
STEP-38: step_time = 23.236607 ms, foward_time = 11.963392, backward_time = 11.177984, perf = 35.49 tflops.
STEP-39: step_time = 23.063553 ms, foward_time = 11.809792, backward_time = 11.155456, perf = 35.75 tflops.
STEP-40: step_time = 23.499776 ms, foward_time = 12.058624, backward_time = 11.344896, perf = 35.09 tflops.
STEP-41: step_time = 23.496703 ms, foward_time = 12.188672, backward_time = 11.209728, perf = 35.10 tflops.
STEP-42: step_time = 23.263232 ms, foward_time = 12.071936, backward_time = 11.095040, perf = 35.45 tflops.
STEP-43: step_time = 23.018496 ms, foward_time = 11.949056, backward_time = 10.972160, perf = 35.82 tflops.
STEP-44: step_time = 23.574049 ms, foward_time = 12.092960, backward_time = 11.383808, perf = 34.98 tflops.
STEP-45: step_time = 23.518208 ms, foward_time = 12.187648, backward_time = 11.233280, perf = 35.06 tflops.
STEP-46: step_time = 22.970369 ms, foward_time = 11.557888, backward_time = 11.315200, perf = 35.90 tflops.
STEP-47: step_time = 23.201792 ms, foward_time = 11.882496, backward_time = 11.222016, perf = 35.54 tflops.
STEP-48: step_time = 23.317887 ms, foward_time = 12.011904, backward_time = 11.207680, perf = 35.36 tflops.
STEP-49: step_time = 22.356992 ms, foward_time = 11.024384, backward_time = 11.235328, perf = 36.88 tflops.
STEP-50: step_time = 23.723007 ms, foward_time = 12.170240, backward_time = 11.457536, perf = 34.76 tflops.
STEP-51: step_time = 23.024641 ms, foward_time = 11.749376, backward_time = 11.176960, perf = 35.82 tflops.
STEP-52: step_time = 22.619136 ms, foward_time = 11.479040, backward_time = 11.041792, perf = 36.46 tflops.
STEP-53: step_time = 22.935648 ms, foward_time = 11.724895, backward_time = 11.113472, perf = 35.95 tflops.
STEP-54: step_time = 23.357567 ms, foward_time = 12.191872, backward_time = 11.066368, perf = 35.30 tflops.
STEP-55: step_time = 22.910976 ms, foward_time = 11.635712, backward_time = 11.177984, perf = 35.99 tflops.
STEP-56: step_time = 24.314271 ms, foward_time = 13.092256, backward_time = 11.125760, perf = 33.92 tflops.
STEP-57: step_time = 22.516737 ms, foward_time = 11.114496, backward_time = 11.305984, perf = 36.62 tflops.
STEP-58: step_time = 24.659968 ms, foward_time = 13.628417, backward_time = 10.880000, perf = 33.44 tflops.
STEP-59: step_time = 23.767040 ms, foward_time = 12.309504, backward_time = 11.362304, perf = 34.70 tflops.
STEP-60: step_time = 24.461311 ms, foward_time = 13.683712, backward_time = 10.682368, perf = 33.71 tflops.
STEP-61: step_time = 23.363583 ms, foward_time = 12.190720, backward_time = 11.076608, perf = 35.30 tflops.
STEP-62: step_time = 23.743488 ms, foward_time = 12.696576, backward_time = 10.951680, perf = 34.73 tflops.
STEP-63: step_time = 23.419905 ms, foward_time = 11.627520, backward_time = 11.694080, perf = 35.21 tflops.
STEP-64: step_time = 23.415808 ms, foward_time = 12.719104, backward_time = 10.601472, perf = 35.22 tflops.
STEP-65: step_time = 24.335360 ms, foward_time = 13.052927, backward_time = 11.186176, perf = 33.89 tflops.
STEP-66: step_time = 22.801408 ms, foward_time = 11.771904, backward_time = 10.933248, perf = 36.17 tflops.
STEP-67: step_time = 23.452673 ms, foward_time = 12.071936, backward_time = 11.285504, perf = 35.16 tflops.
STEP-68: step_time = 22.808575 ms, foward_time = 11.635711, backward_time = 11.078656, perf = 36.15 tflops.
STEP-69: step_time = 24.158208 ms, foward_time = 12.823552, backward_time = 11.239424, perf = 34.13 tflops.
STEP-70: step_time = 22.691841 ms, foward_time = 11.487232, backward_time = 11.107328, perf = 36.34 tflops.
STEP-71: step_time = 24.228192 ms, foward_time = 12.863841, backward_time = 11.268096, perf = 34.04 tflops.
STEP-72: step_time = 22.945792 ms, foward_time = 11.380736, backward_time = 11.459584, perf = 35.94 tflops.
STEP-73: step_time = 24.446976 ms, foward_time = 13.278208, backward_time = 11.051008, perf = 33.73 tflops.
STEP-74: step_time = 24.023039 ms, foward_time = 12.763136, backward_time = 11.163648, perf = 34.33 tflops.
STEP-75: step_time = 23.004160 ms, foward_time = 11.950080, backward_time = 10.959872, perf = 35.85 tflops.
STEP-76: step_time = 23.750751 ms, foward_time = 11.752544, backward_time = 11.901952, perf = 34.72 tflops.
STEP-77: step_time = 23.545855 ms, foward_time = 11.853824, backward_time = 11.596800, perf = 35.02 tflops.
STEP-78: step_time = 23.187457 ms, foward_time = 11.630592, backward_time = 11.460608, perf = 35.56 tflops.
STEP-79: step_time = 24.417281 ms, foward_time = 11.885568, backward_time = 12.434432, perf = 33.77 tflops.
STEP-80: step_time = 23.231489 ms, foward_time = 11.342849, backward_time = 11.805696, perf = 35.50 tflops.
STEP-81: step_time = 24.008704 ms, foward_time = 12.211200, backward_time = 11.716608, perf = 34.35 tflops.
STEP-82: step_time = 23.731200 ms, foward_time = 12.068864, backward_time = 11.555840, perf = 34.75 tflops.
STEP-83: step_time = 23.446528 ms, foward_time = 11.879424, backward_time = 11.475968, perf = 35.17 tflops.
STEP-84: step_time = 24.296449 ms, foward_time = 12.080128, backward_time = 12.137472, perf = 33.94 tflops.
STEP-85: step_time = 23.116801 ms, foward_time = 11.779072, backward_time = 11.257856, perf = 35.67 tflops.
STEP-86: step_time = 23.621633 ms, foward_time = 12.210176, backward_time = 11.328512, perf = 34.91 tflops.
STEP-87: step_time = 23.363585 ms, foward_time = 12.120064, backward_time = 11.122688, perf = 35.30 tflops.
STEP-88: step_time = 23.552001 ms, foward_time = 11.829248, backward_time = 11.640832, perf = 35.01 tflops.
STEP-89: step_time = 23.033857 ms, foward_time = 11.752448, backward_time = 11.185152, perf = 35.80 tflops.
STEP-90: step_time = 23.376513 ms, foward_time = 12.203648, backward_time = 11.076608, perf = 35.28 tflops.
STEP-91: step_time = 23.010879 ms, foward_time = 11.938368, backward_time = 10.977280, perf = 35.84 tflops.
STEP-92: step_time = 23.208960 ms, foward_time = 11.881472, backward_time = 11.232256, perf = 35.53 tflops.
STEP-93: step_time = 22.959104 ms, foward_time = 11.830272, backward_time = 11.032576, perf = 35.92 tflops.
STEP-94: step_time = 22.752257 ms, foward_time = 11.397120, backward_time = 11.259904, perf = 36.24 tflops.
STEP-95: step_time = 23.093248 ms, foward_time = 11.625472, backward_time = 11.371520, perf = 35.71 tflops.
STEP-96: step_time = 24.076288 ms, foward_time = 11.804672, backward_time = 12.169216, perf = 34.25 tflops.
STEP-97: step_time = 23.551391 ms, foward_time = 12.473760, backward_time = 10.980352, perf = 35.01 tflops.
STEP-98: step_time = 22.941695 ms, foward_time = 11.658240, backward_time = 11.186176, perf = 35.94 tflops.
STEP-99: step_time = 22.507520 ms, foward_time = 11.271168, backward_time = 11.141120, perf = 36.64 tflops.

 mix_moe 32 [Summary] Average synchronized step_time = 23.147785472869874 ms, forward = 11.808419132232666 , backward = 11.24270076751709 .
cuda:0
cuda:2
cuda:1
cuda:3
[Benchmark] world_size = 4, dtype = float16, model_dim = 1024, hidden_size = 4096, samples = 8192, num_local_experts = 64, topK = 2, a2a_ffn_overlap_degree = 1, device = `cuda:0`
STEP-0: step_time = 54.139648 ms, foward_time = 31.204102, backward_time = 22.648832, perf = 15.23 tflops.
STEP-1: step_time = 38.254592 ms, foward_time = 22.351873, backward_time = 15.801344, perf = 21.56 tflops.
STEP-2: step_time = 37.322750 ms, foward_time = 21.150721, backward_time = 16.093184, perf = 22.09 tflops.
STEP-3: step_time = 34.377727 ms, foward_time = 19.799041, backward_time = 14.500864, perf = 23.99 tflops.
STEP-4: step_time = 34.028544 ms, foward_time = 19.412992, backward_time = 14.536704, perf = 24.23 tflops.
STEP-5: step_time = 32.125951 ms, foward_time = 17.624065, backward_time = 14.416896, perf = 25.67 tflops.
STEP-6: step_time = 32.986113 ms, foward_time = 18.574335, backward_time = 14.334976, perf = 25.00 tflops.
STEP-7: step_time = 33.860128 ms, foward_time = 19.511841, backward_time = 14.261248, perf = 24.35 tflops.
STEP-8: step_time = 32.084128 ms, foward_time = 17.765536, backward_time = 14.233600, perf = 25.70 tflops.
STEP-9: step_time = 32.437442 ms, foward_time = 18.182336, backward_time = 14.170112, perf = 25.42 tflops.
STEP-10: step_time = 32.245760 ms, foward_time = 17.942528, backward_time = 14.222336, perf = 25.57 tflops.
STEP-11: step_time = 32.895998 ms, foward_time = 17.930241, backward_time = 14.881792, perf = 25.07 tflops.
STEP-12: step_time = 32.756736 ms, foward_time = 18.613248, backward_time = 14.064640, perf = 25.17 tflops.
STEP-13: step_time = 31.680290 ms, foward_time = 17.567520, backward_time = 14.031872, perf = 26.03 tflops.
STEP-14: step_time = 32.754017 ms, foward_time = 18.653536, backward_time = 14.017536, perf = 25.18 tflops.
STEP-15: step_time = 31.672319 ms, foward_time = 17.517568, backward_time = 14.068736, perf = 26.04 tflops.
STEP-16: step_time = 32.738306 ms, foward_time = 18.617344, backward_time = 14.036992, perf = 25.19 tflops.
STEP-17: step_time = 31.139841 ms, foward_time = 16.967680, backward_time = 14.090240, perf = 26.48 tflops.
STEP-18: step_time = 32.111615 ms, foward_time = 17.897471, backward_time = 14.120960, perf = 25.68 tflops.
STEP-19: step_time = 31.800321 ms, foward_time = 17.488897, backward_time = 14.228480, perf = 25.93 tflops.
STEP-20: step_time = 32.267264 ms, foward_time = 17.968127, backward_time = 14.211072, perf = 25.56 tflops.
STEP-21: step_time = 32.171007 ms, foward_time = 17.803264, backward_time = 14.284800, perf = 25.63 tflops.
STEP-22: step_time = 31.850497 ms, foward_time = 17.563647, backward_time = 14.200832, perf = 25.89 tflops.
STEP-23: step_time = 31.835137 ms, foward_time = 17.453057, backward_time = 14.304256, perf = 25.90 tflops.
STEP-24: step_time = 31.593471 ms, foward_time = 17.254400, backward_time = 14.254080, perf = 26.10 tflops.
STEP-25: step_time = 31.303679 ms, foward_time = 17.251328, backward_time = 13.970432, perf = 26.34 tflops.
STEP-26: step_time = 31.257599 ms, foward_time = 17.181696, backward_time = 13.976576, perf = 26.38 tflops.
STEP-27: step_time = 30.985216 ms, foward_time = 16.928768, backward_time = 13.955072, perf = 26.61 tflops.
STEP-28: step_time = 31.471616 ms, foward_time = 16.823296, backward_time = 14.548992, perf = 26.20 tflops.
STEP-29: step_time = 31.447039 ms, foward_time = 17.315840, backward_time = 14.030848, perf = 26.22 tflops.
STEP-30: step_time = 31.290366 ms, foward_time = 17.167359, backward_time = 14.022656, perf = 26.35 tflops.
STEP-31: step_time = 32.209919 ms, foward_time = 17.922048, backward_time = 14.187520, perf = 25.60 tflops.
STEP-32: step_time = 31.428610 ms, foward_time = 17.058817, backward_time = 14.270464, perf = 26.24 tflops.
STEP-33: step_time = 31.307776 ms, foward_time = 16.820225, backward_time = 14.388224, perf = 26.34 tflops.
STEP-34: step_time = 31.204352 ms, foward_time = 16.932863, backward_time = 14.173184, perf = 26.43 tflops.
STEP-35: step_time = 31.647745 ms, foward_time = 17.501184, backward_time = 14.047232, perf = 26.06 tflops.
STEP-36: step_time = 31.476734 ms, foward_time = 17.480704, backward_time = 13.895680, perf = 26.20 tflops.
STEP-37: step_time = 31.985535 ms, foward_time = 17.571712, backward_time = 14.312448, perf = 25.78 tflops.
STEP-38: step_time = 32.105601 ms, foward_time = 17.749119, backward_time = 14.257152, perf = 25.69 tflops.
STEP-39: step_time = 32.122879 ms, foward_time = 17.878016, backward_time = 14.144512, perf = 25.67 tflops.
STEP-40: step_time = 31.369217 ms, foward_time = 17.060863, backward_time = 14.209024, perf = 26.29 tflops.
STEP-41: step_time = 31.336446 ms, foward_time = 17.232896, backward_time = 14.003200, perf = 26.32 tflops.
STEP-42: step_time = 32.049151 ms, foward_time = 18.000897, backward_time = 13.948928, perf = 25.73 tflops.
STEP-43: step_time = 32.095233 ms, foward_time = 17.734656, backward_time = 14.260224, perf = 25.69 tflops.
STEP-44: step_time = 31.202302 ms, foward_time = 17.077249, backward_time = 14.025728, perf = 26.43 tflops.
STEP-45: step_time = 31.114242 ms, foward_time = 16.945152, backward_time = 14.069760, perf = 26.50 tflops.
STEP-46: step_time = 31.366143 ms, foward_time = 16.969728, backward_time = 14.298112, perf = 26.29 tflops.
STEP-47: step_time = 31.880192 ms, foward_time = 17.550335, backward_time = 14.231552, perf = 25.87 tflops.
STEP-48: step_time = 31.288322 ms, foward_time = 16.984063, backward_time = 14.203904, perf = 26.36 tflops.
STEP-49: step_time = 31.567871 ms, foward_time = 17.127424, backward_time = 14.342144, perf = 26.12 tflops.
STEP-50: step_time = 31.303679 ms, foward_time = 16.826369, backward_time = 14.377984, perf = 26.34 tflops.
STEP-51: step_time = 32.747519 ms, foward_time = 18.554880, backward_time = 14.067712, perf = 25.18 tflops.
STEP-52: step_time = 31.332352 ms, foward_time = 17.267712, backward_time = 13.965312, perf = 26.32 tflops.
STEP-53: step_time = 31.484927 ms, foward_time = 17.413120, backward_time = 13.970432, perf = 26.19 tflops.
STEP-54: step_time = 31.063042 ms, foward_time = 17.052672, backward_time = 13.911040, perf = 26.55 tflops.
STEP-55: step_time = 31.083519 ms, foward_time = 16.838656, backward_time = 14.144512, perf = 26.53 tflops.
STEP-56: step_time = 31.621153 ms, foward_time = 17.521696, backward_time = 13.998080, perf = 26.08 tflops.
STEP-57: step_time = 31.333377 ms, foward_time = 17.206271, backward_time = 14.025728, perf = 26.32 tflops.
STEP-58: step_time = 32.172034 ms, foward_time = 18.093056, backward_time = 13.979648, perf = 25.63 tflops.
STEP-59: step_time = 32.120831 ms, foward_time = 17.748991, backward_time = 14.271488, perf = 25.67 tflops.
STEP-60: step_time = 31.174658 ms, foward_time = 17.020927, backward_time = 14.054400, perf = 26.45 tflops.
STEP-61: step_time = 31.880223 ms, foward_time = 17.756192, backward_time = 14.021632, perf = 25.87 tflops.
STEP-62: step_time = 32.095168 ms, foward_time = 17.799104, backward_time = 14.193664, perf = 25.69 tflops.
STEP-63: step_time = 31.970303 ms, foward_time = 17.455105, backward_time = 14.414848, perf = 25.79 tflops.
STEP-64: step_time = 32.662174 ms, foward_time = 18.484896, backward_time = 14.076928, perf = 25.25 tflops.
STEP-65: step_time = 32.242784 ms, foward_time = 18.080863, backward_time = 14.060544, perf = 25.58 tflops.
STEP-66: step_time = 32.371713 ms, foward_time = 18.016256, backward_time = 14.256128, perf = 25.47 tflops.
STEP-67: step_time = 31.376384 ms, foward_time = 16.933887, backward_time = 14.342144, perf = 26.28 tflops.
STEP-68: step_time = 31.035391 ms, foward_time = 16.840704, backward_time = 14.094336, perf = 26.57 tflops.
STEP-69: step_time = 32.719873 ms, foward_time = 18.129921, backward_time = 14.489600, perf = 25.20 tflops.
STEP-70: step_time = 31.815329 ms, foward_time = 17.653409, backward_time = 14.061568, perf = 25.92 tflops.
STEP-71: step_time = 31.639554 ms, foward_time = 17.366015, backward_time = 14.174208, perf = 26.06 tflops.
STEP-72: step_time = 31.691775 ms, foward_time = 17.370112, backward_time = 14.223360, perf = 26.02 tflops.
STEP-73: step_time = 30.767104 ms, foward_time = 16.712704, backward_time = 13.956096, perf = 26.80 tflops.
STEP-74: step_time = 31.478783 ms, foward_time = 17.377280, backward_time = 14.002176, perf = 26.20 tflops.
STEP-75: step_time = 31.435775 ms, foward_time = 17.266689, backward_time = 14.071808, perf = 26.23 tflops.
STEP-76: step_time = 31.684608 ms, foward_time = 17.526784, backward_time = 14.055424, perf = 26.03 tflops.
STEP-77: step_time = 32.530817 ms, foward_time = 18.255232, backward_time = 14.178304, perf = 25.35 tflops.
STEP-78: step_time = 31.215617 ms, foward_time = 17.042431, backward_time = 14.076928, perf = 26.42 tflops.
STEP-79: step_time = 31.365120 ms, foward_time = 16.969729, backward_time = 14.277632, perf = 26.29 tflops.
STEP-80: step_time = 32.158718 ms, foward_time = 17.716225, backward_time = 14.346240, perf = 25.64 tflops.
STEP-81: step_time = 31.188991 ms, foward_time = 17.087487, backward_time = 14.004224, perf = 26.44 tflops.
STEP-82: step_time = 32.014337 ms, foward_time = 17.804288, backward_time = 14.111744, perf = 25.76 tflops.
STEP-83: step_time = 31.155199 ms, foward_time = 16.977921, backward_time = 14.058496, perf = 26.47 tflops.
STEP-84: step_time = 32.185983 ms, foward_time = 17.987199, backward_time = 14.100480, perf = 25.62 tflops.
STEP-85: step_time = 32.009214 ms, foward_time = 17.805311, backward_time = 14.107648, perf = 25.76 tflops.
STEP-86: step_time = 32.508929 ms, foward_time = 18.122752, backward_time = 14.289920, perf = 25.37 tflops.
STEP-87: step_time = 31.067137 ms, foward_time = 17.009663, backward_time = 13.957120, perf = 26.54 tflops.
STEP-88: step_time = 31.400321 ms, foward_time = 17.412480, backward_time = 13.889536, perf = 26.26 tflops.
STEP-89: step_time = 31.539521 ms, foward_time = 17.409345, backward_time = 14.033920, perf = 26.15 tflops.
STEP-90: step_time = 31.714303 ms, foward_time = 17.550336, backward_time = 14.069760, perf = 26.00 tflops.
STEP-91: step_time = 32.071680 ms, foward_time = 17.660928, backward_time = 14.314496, perf = 25.71 tflops.
STEP-92: step_time = 31.831041 ms, foward_time = 17.411072, backward_time = 14.323712, perf = 25.91 tflops.
STEP-93: step_time = 32.163039 ms, foward_time = 17.681632, backward_time = 14.384128, perf = 25.64 tflops.
STEP-94: step_time = 32.157695 ms, foward_time = 17.823743, backward_time = 14.234624, perf = 25.64 tflops.
STEP-95: step_time = 31.200258 ms, foward_time = 17.077249, backward_time = 14.027776, perf = 26.43 tflops.
STEP-96: step_time = 31.006722 ms, foward_time = 16.915455, backward_time = 13.995008, perf = 26.60 tflops.
STEP-97: step_time = 32.009217 ms, foward_time = 17.642495, backward_time = 14.268416, perf = 25.76 tflops.
STEP-98: step_time = 30.657536 ms, foward_time = 16.500736, backward_time = 14.061568, perf = 26.90 tflops.
STEP-99: step_time = 31.332352 ms, foward_time = 17.248255, backward_time = 13.988864, perf = 26.32 tflops.

 mix_moe 64 [Summary] Average synchronized step_time = 31.61438431739807 ms, forward = 17.35119023323059 , backward = 14.166835308074951 .
[Benchmark] world_size = 4, dtype = float16, model_dim = 1024, hidden_size = 4096, samples = 8192, num_local_experts = 4, topK = 2, a2a_ffn_overlap_degree = 1, device = `cuda:0`
STEP-0: step_time = 1654.807495 ms, foward_time = 1620.535278, backward_time = 33.305599, perf = 0.50 tflops.
STEP-1: step_time = 52.769791 ms, foward_time = 26.178560, backward_time = 26.463232, perf = 15.63 tflops.
STEP-2: step_time = 50.767872 ms, foward_time = 24.130560, backward_time = 26.514433, perf = 16.24 tflops.
STEP-3: step_time = 53.850113 ms, foward_time = 27.049984, backward_time = 26.682367, perf = 15.31 tflops.
STEP-4: step_time = 53.065727 ms, foward_time = 26.382336, backward_time = 26.570751, perf = 15.54 tflops.
STEP-5: step_time = 43.226112 ms, foward_time = 21.221376, backward_time = 21.895168, perf = 19.08 tflops.
STEP-6: step_time = 42.073090 ms, foward_time = 20.070400, backward_time = 21.896193, perf = 19.60 tflops.
STEP-7: step_time = 42.304512 ms, foward_time = 20.525057, backward_time = 21.669888, perf = 19.49 tflops.
STEP-8: step_time = 40.268799 ms, foward_time = 19.442688, backward_time = 20.721664, perf = 20.48 tflops.
STEP-9: step_time = 43.081730 ms, foward_time = 22.479872, backward_time = 20.495359, perf = 19.14 tflops.
STEP-10: step_time = 39.437313 ms, foward_time = 18.883583, backward_time = 20.449280, perf = 20.91 tflops.
STEP-11: step_time = 40.559616 ms, foward_time = 18.863104, backward_time = 21.594112, perf = 20.33 tflops.
STEP-12: step_time = 41.653248 ms, foward_time = 20.444160, backward_time = 21.096449, perf = 19.80 tflops.
STEP-13: step_time = 39.661568 ms, foward_time = 18.924543, backward_time = 20.631552, perf = 20.79 tflops.
STEP-14: step_time = 40.876034 ms, foward_time = 20.279297, backward_time = 20.505600, perf = 20.17 tflops.
STEP-15: step_time = 39.822334 ms, foward_time = 19.010559, backward_time = 20.721664, perf = 20.71 tflops.
STEP-16: step_time = 39.409664 ms, foward_time = 18.836479, backward_time = 20.487167, perf = 20.92 tflops.
STEP-17: step_time = 39.553024 ms, foward_time = 18.833408, backward_time = 20.632576, perf = 20.85 tflops.
STEP-18: step_time = 39.481342 ms, foward_time = 18.801664, backward_time = 20.577280, perf = 20.89 tflops.
STEP-19: step_time = 39.548927 ms, foward_time = 18.728960, backward_time = 20.733952, perf = 20.85 tflops.
STEP-20: step_time = 40.521729 ms, foward_time = 19.615744, backward_time = 20.822016, perf = 20.35 tflops.
STEP-21: step_time = 40.320000 ms, foward_time = 19.560448, backward_time = 20.674561, perf = 20.45 tflops.
STEP-22: step_time = 39.905281 ms, foward_time = 19.182592, backward_time = 20.638720, perf = 20.66 tflops.
STEP-23: step_time = 39.583744 ms, foward_time = 18.835457, backward_time = 20.662271, perf = 20.83 tflops.
STEP-24: step_time = 40.033279 ms, foward_time = 19.388416, backward_time = 20.561920, perf = 20.60 tflops.
STEP-25: step_time = 41.426945 ms, foward_time = 20.498432, backward_time = 20.842497, perf = 19.91 tflops.
STEP-26: step_time = 39.611393 ms, foward_time = 19.009537, backward_time = 20.515841, perf = 20.82 tflops.
STEP-27: step_time = 39.232513 ms, foward_time = 18.981888, backward_time = 20.163584, perf = 21.02 tflops.
STEP-28: step_time = 38.908928 ms, foward_time = 18.794497, backward_time = 20.028416, perf = 21.19 tflops.
STEP-29: step_time = 40.290302 ms, foward_time = 19.890177, backward_time = 20.315136, perf = 20.47 tflops.
STEP-30: step_time = 40.544254 ms, foward_time = 20.107264, backward_time = 20.354048, perf = 20.34 tflops.
STEP-31: step_time = 39.138306 ms, foward_time = 18.895872, backward_time = 20.156416, perf = 21.07 tflops.
STEP-32: step_time = 39.139328 ms, foward_time = 18.706432, backward_time = 20.349953, perf = 21.07 tflops.
STEP-33: step_time = 39.023617 ms, foward_time = 18.760704, backward_time = 20.179968, perf = 21.13 tflops.
STEP-34: step_time = 40.397823 ms, foward_time = 20.177919, backward_time = 20.134912, perf = 20.41 tflops.
STEP-35: step_time = 39.485439 ms, foward_time = 18.906113, backward_time = 20.493313, perf = 20.88 tflops.
STEP-36: step_time = 42.211327 ms, foward_time = 21.098495, backward_time = 21.014528, perf = 19.54 tflops.
STEP-37: step_time = 39.639042 ms, foward_time = 19.352575, backward_time = 20.179968, perf = 20.80 tflops.
STEP-38: step_time = 39.326721 ms, foward_time = 19.039232, backward_time = 20.183041, perf = 20.97 tflops.
STEP-39: step_time = 39.310337 ms, foward_time = 18.989056, backward_time = 20.218880, perf = 20.98 tflops.
STEP-40: step_time = 40.240128 ms, foward_time = 19.950592, backward_time = 20.195328, perf = 20.49 tflops.
STEP-41: step_time = 39.828480 ms, foward_time = 19.466240, backward_time = 20.276224, perf = 20.70 tflops.
STEP-42: step_time = 40.588287 ms, foward_time = 19.992577, backward_time = 20.509695, perf = 20.32 tflops.
STEP-43: step_time = 40.400894 ms, foward_time = 19.164160, backward_time = 21.148672, perf = 20.41 tflops.
STEP-44: step_time = 38.992897 ms, foward_time = 18.740225, backward_time = 20.167681, perf = 21.15 tflops.
STEP-45: step_time = 38.976513 ms, foward_time = 18.789375, backward_time = 20.104193, perf = 21.16 tflops.
STEP-46: step_time = 39.023617 ms, foward_time = 18.793472, backward_time = 20.146175, perf = 21.13 tflops.
STEP-47: step_time = 40.339455 ms, foward_time = 18.945024, backward_time = 21.309441, perf = 20.44 tflops.
STEP-48: step_time = 40.039425 ms, foward_time = 18.855936, backward_time = 21.100544, perf = 20.60 tflops.
STEP-49: step_time = 40.964096 ms, foward_time = 20.613119, backward_time = 20.165632, perf = 20.13 tflops.
STEP-50: step_time = 39.597057 ms, foward_time = 19.105791, backward_time = 20.384768, perf = 20.83 tflops.
STEP-51: step_time = 39.196671 ms, foward_time = 18.802689, backward_time = 20.286465, perf = 21.04 tflops.
STEP-52: step_time = 38.848511 ms, foward_time = 18.751488, backward_time = 19.999744, perf = 21.23 tflops.
STEP-53: step_time = 39.136257 ms, foward_time = 18.916351, backward_time = 20.115456, perf = 21.07 tflops.
STEP-54: step_time = 38.919167 ms, foward_time = 18.742271, backward_time = 20.073471, perf = 21.19 tflops.
STEP-55: step_time = 38.885376 ms, foward_time = 18.753536, backward_time = 20.042751, perf = 21.21 tflops.
STEP-56: step_time = 40.653824 ms, foward_time = 20.616192, backward_time = 19.898369, perf = 20.28 tflops.
STEP-57: step_time = 38.827007 ms, foward_time = 18.700289, backward_time = 20.039680, perf = 21.24 tflops.
STEP-58: step_time = 38.901760 ms, foward_time = 18.559999, backward_time = 20.256767, perf = 21.20 tflops.
STEP-59: step_time = 39.613441 ms, foward_time = 19.318785, backward_time = 20.208639, perf = 20.82 tflops.
STEP-60: step_time = 39.158783 ms, foward_time = 18.940928, backward_time = 20.134912, perf = 21.06 tflops.
STEP-61: step_time = 38.906879 ms, foward_time = 18.684929, backward_time = 20.133888, perf = 21.20 tflops.
STEP-62: step_time = 38.763519 ms, foward_time = 18.524160, backward_time = 20.155392, perf = 21.27 tflops.
STEP-63: step_time = 39.041023 ms, foward_time = 18.607103, backward_time = 20.350977, perf = 21.12 tflops.
STEP-64: step_time = 38.779903 ms, foward_time = 18.542591, backward_time = 20.154367, perf = 21.26 tflops.
STEP-65: step_time = 38.901760 ms, foward_time = 18.661377, backward_time = 20.158464, perf = 21.20 tflops.
STEP-66: step_time = 39.440384 ms, foward_time = 18.878464, backward_time = 20.466688, perf = 20.91 tflops.
STEP-67: step_time = 38.728703 ms, foward_time = 18.542591, backward_time = 20.097025, perf = 21.29 tflops.
STEP-68: step_time = 38.791168 ms, foward_time = 18.614271, backward_time = 20.094976, perf = 21.26 tflops.
STEP-69: step_time = 38.835201 ms, foward_time = 18.562048, backward_time = 20.185087, perf = 21.23 tflops.
STEP-70: step_time = 38.873089 ms, foward_time = 18.635777, backward_time = 20.153343, perf = 21.21 tflops.
STEP-71: step_time = 38.779903 ms, foward_time = 18.579456, backward_time = 20.112385, perf = 21.26 tflops.
STEP-72: step_time = 39.646210 ms, foward_time = 18.641920, backward_time = 20.922367, perf = 20.80 tflops.
STEP-73: step_time = 38.889473 ms, foward_time = 18.654207, backward_time = 20.152321, perf = 21.20 tflops.
STEP-74: step_time = 38.819839 ms, foward_time = 18.609152, backward_time = 20.128769, perf = 21.24 tflops.
STEP-75: step_time = 38.922241 ms, foward_time = 18.586624, backward_time = 20.239361, perf = 21.19 tflops.
STEP-76: step_time = 38.591488 ms, foward_time = 18.512896, backward_time = 19.994623, perf = 21.37 tflops.
STEP-77: step_time = 39.991295 ms, foward_time = 19.013632, backward_time = 20.897793, perf = 20.62 tflops.
STEP-78: step_time = 38.900738 ms, foward_time = 18.676737, backward_time = 20.141056, perf = 21.20 tflops.
STEP-79: step_time = 38.933502 ms, foward_time = 18.610176, backward_time = 20.236288, perf = 21.18 tflops.
STEP-80: step_time = 39.032833 ms, foward_time = 18.781183, backward_time = 20.168703, perf = 21.13 tflops.
STEP-81: step_time = 38.763519 ms, foward_time = 18.438145, backward_time = 20.238337, perf = 21.27 tflops.
STEP-82: step_time = 38.636543 ms, foward_time = 18.546688, backward_time = 20.007936, perf = 21.34 tflops.
STEP-83: step_time = 39.071743 ms, foward_time = 18.703360, backward_time = 20.286465, perf = 21.11 tflops.
STEP-84: step_time = 38.910976 ms, foward_time = 18.663424, backward_time = 20.163584, perf = 21.19 tflops.
STEP-85: step_time = 39.216129 ms, foward_time = 18.749439, backward_time = 20.379648, perf = 21.03 tflops.
STEP-86: step_time = 39.401470 ms, foward_time = 18.969601, backward_time = 20.347904, perf = 20.93 tflops.
STEP-87: step_time = 39.418880 ms, foward_time = 19.186687, backward_time = 20.149248, perf = 20.92 tflops.
STEP-88: step_time = 39.301121 ms, foward_time = 18.846720, backward_time = 20.366337, perf = 20.98 tflops.
STEP-89: step_time = 39.079937 ms, foward_time = 18.653185, backward_time = 20.342785, perf = 21.10 tflops.
STEP-90: step_time = 39.501823 ms, foward_time = 18.996223, backward_time = 20.423679, perf = 20.88 tflops.
STEP-91: step_time = 38.867970 ms, foward_time = 18.601984, backward_time = 20.183041, perf = 21.22 tflops.
STEP-92: step_time = 38.831104 ms, foward_time = 18.655231, backward_time = 20.090879, perf = 21.24 tflops.
STEP-93: step_time = 39.087105 ms, foward_time = 18.661377, backward_time = 20.343807, perf = 21.10 tflops.
STEP-94: step_time = 39.045120 ms, foward_time = 18.805759, backward_time = 20.156416, perf = 21.12 tflops.
STEP-95: step_time = 38.948864 ms, foward_time = 18.675713, backward_time = 20.191233, perf = 21.17 tflops.
STEP-96: step_time = 38.963200 ms, foward_time = 18.639872, backward_time = 20.239361, perf = 21.16 tflops.
STEP-97: step_time = 39.005184 ms, foward_time = 18.637823, backward_time = 20.283392, perf = 21.14 tflops.
STEP-98: step_time = 39.000065 ms, foward_time = 18.606079, backward_time = 20.311041, perf = 21.14 tflops.
STEP-99: step_time = 40.296448 ms, foward_time = 20.075520, backward_time = 20.132864, perf = 20.46 tflops.

 fast_moe 4 [Summary] Average synchronized step_time = 39.234133338928224 ms, forward = 18.875852711995442 , backward = 20.269107309977212 .
[Benchmark] world_size = 4, dtype = float16, model_dim = 1024, hidden_size = 4096, samples = 8192, num_local_experts = 8, topK = 2, a2a_ffn_overlap_degree = 1, device = `cuda:0`
STEP-0: step_time = 1606.585327 ms, foward_time = 1569.084473, backward_time = 37.150719, perf = 0.51 tflops.
STEP-1: step_time = 61.623295 ms, foward_time = 30.096384, backward_time = 31.382528, perf = 13.38 tflops.
STEP-2: step_time = 57.094143 ms, foward_time = 28.255232, backward_time = 28.688383, perf = 14.44 tflops.
STEP-3: step_time = 54.712318 ms, foward_time = 26.314753, backward_time = 28.269567, perf = 15.07 tflops.
STEP-4: step_time = 56.080383 ms, foward_time = 28.666880, backward_time = 27.295744, perf = 14.70 tflops.
STEP-5: step_time = 56.336384 ms, foward_time = 28.938240, backward_time = 27.269119, perf = 14.64 tflops.
STEP-6: step_time = 53.890049 ms, foward_time = 26.679296, backward_time = 27.085823, perf = 15.30 tflops.
STEP-7: step_time = 53.710850 ms, foward_time = 26.505217, backward_time = 27.073536, perf = 15.35 tflops.
STEP-8: step_time = 55.058434 ms, foward_time = 27.959295, backward_time = 26.979328, perf = 14.98 tflops.
STEP-9: step_time = 54.899712 ms, foward_time = 27.563007, backward_time = 27.203585, perf = 15.02 tflops.
STEP-10: step_time = 52.529152 ms, foward_time = 25.519104, backward_time = 26.887169, perf = 15.70 tflops.
STEP-11: step_time = 52.637695 ms, foward_time = 25.334784, backward_time = 27.181055, perf = 15.67 tflops.
STEP-12: step_time = 53.204990 ms, foward_time = 26.122240, backward_time = 26.962944, perf = 15.50 tflops.
STEP-13: step_time = 54.075394 ms, foward_time = 26.636288, backward_time = 27.249664, perf = 15.25 tflops.
STEP-14: step_time = 52.400127 ms, foward_time = 25.349119, backward_time = 26.927105, perf = 15.74 tflops.
STEP-15: step_time = 52.413441 ms, foward_time = 25.327616, backward_time = 26.962944, perf = 15.73 tflops.
STEP-16: step_time = 53.058559 ms, foward_time = 26.127359, backward_time = 26.814465, perf = 15.54 tflops.
STEP-17: step_time = 53.844994 ms, foward_time = 26.834944, backward_time = 26.868736, perf = 15.31 tflops.
STEP-18: step_time = 52.413441 ms, foward_time = 25.191423, backward_time = 27.104256, perf = 15.73 tflops.
STEP-19: step_time = 52.446209 ms, foward_time = 25.196545, backward_time = 27.127808, perf = 15.72 tflops.
STEP-20: step_time = 53.835777 ms, foward_time = 25.878529, backward_time = 27.839487, perf = 15.32 tflops.
STEP-21: step_time = 52.672512 ms, foward_time = 25.397247, backward_time = 27.142143, perf = 15.66 tflops.
STEP-22: step_time = 55.482368 ms, foward_time = 27.971584, backward_time = 27.414528, perf = 14.86 tflops.
STEP-23: step_time = 52.511745 ms, foward_time = 25.200640, backward_time = 27.210752, perf = 15.70 tflops.
STEP-24: step_time = 53.991425 ms, foward_time = 25.489408, backward_time = 28.400640, perf = 15.27 tflops.
STEP-25: step_time = 52.147202 ms, foward_time = 24.755199, backward_time = 27.289600, perf = 15.81 tflops.
STEP-26: step_time = 52.225025 ms, foward_time = 24.705025, backward_time = 27.408384, perf = 15.79 tflops.
STEP-27: step_time = 53.474304 ms, foward_time = 26.059776, backward_time = 27.312128, perf = 15.42 tflops.
STEP-28: step_time = 54.750210 ms, foward_time = 27.505665, backward_time = 27.128832, perf = 15.06 tflops.
STEP-29: step_time = 52.564991 ms, foward_time = 25.230335, backward_time = 27.227137, perf = 15.69 tflops.
STEP-30: step_time = 52.197376 ms, foward_time = 25.082880, backward_time = 27.006975, perf = 15.80 tflops.
STEP-31: step_time = 53.204990 ms, foward_time = 25.261057, backward_time = 27.824127, perf = 15.50 tflops.
STEP-32: step_time = 52.944897 ms, foward_time = 25.507839, backward_time = 27.314177, perf = 15.58 tflops.
STEP-33: step_time = 53.048321 ms, foward_time = 25.652224, backward_time = 27.270144, perf = 15.54 tflops.
STEP-34: step_time = 55.413761 ms, foward_time = 28.209152, backward_time = 27.080704, perf = 14.88 tflops.
STEP-35: step_time = 52.481026 ms, foward_time = 25.394176, backward_time = 26.968063, perf = 15.71 tflops.
STEP-36: step_time = 52.325375 ms, foward_time = 25.339905, backward_time = 26.862593, perf = 15.76 tflops.
STEP-37: step_time = 54.754303 ms, foward_time = 25.335808, backward_time = 29.296640, perf = 15.06 tflops.
STEP-38: step_time = 55.188480 ms, foward_time = 27.819008, backward_time = 27.213823, perf = 14.94 tflops.
STEP-39: step_time = 52.384769 ms, foward_time = 25.277439, backward_time = 26.984447, perf = 15.74 tflops.
STEP-40: step_time = 52.405247 ms, foward_time = 25.439232, backward_time = 26.843136, perf = 15.74 tflops.
STEP-41: step_time = 52.489216 ms, foward_time = 25.297920, backward_time = 27.066368, perf = 15.71 tflops.
STEP-42: step_time = 52.518913 ms, foward_time = 25.425920, backward_time = 26.972160, perf = 15.70 tflops.
STEP-43: step_time = 53.065727 ms, foward_time = 25.748480, backward_time = 27.194368, perf = 15.54 tflops.
STEP-44: step_time = 52.606976 ms, foward_time = 25.428991, backward_time = 27.057152, perf = 15.68 tflops.
STEP-45: step_time = 52.481026 ms, foward_time = 25.333759, backward_time = 27.025408, perf = 15.71 tflops.
STEP-46: step_time = 52.295681 ms, foward_time = 25.275393, backward_time = 26.900480, perf = 15.77 tflops.
STEP-47: step_time = 52.450302 ms, foward_time = 25.401344, backward_time = 26.926081, perf = 15.72 tflops.
STEP-48: step_time = 52.371456 ms, foward_time = 25.366528, backward_time = 26.887169, perf = 15.75 tflops.
STEP-49: step_time = 52.435966 ms, foward_time = 25.327616, backward_time = 26.986496, perf = 15.73 tflops.
STEP-50: step_time = 52.426750 ms, foward_time = 25.296896, backward_time = 27.011072, perf = 15.73 tflops.
STEP-51: step_time = 52.245502 ms, foward_time = 25.227264, backward_time = 26.896383, perf = 15.78 tflops.
STEP-52: step_time = 52.495361 ms, foward_time = 25.326591, backward_time = 27.049984, perf = 15.71 tflops.
STEP-53: step_time = 52.714497 ms, foward_time = 25.608192, backward_time = 26.984447, perf = 15.64 tflops.
STEP-54: step_time = 52.866047 ms, foward_time = 25.425920, backward_time = 27.321344, perf = 15.60 tflops.
STEP-55: step_time = 52.336639 ms, foward_time = 25.175039, backward_time = 27.039743, perf = 15.76 tflops.
STEP-56: step_time = 52.456448 ms, foward_time = 25.325567, backward_time = 27.012096, perf = 15.72 tflops.
STEP-57: step_time = 52.992001 ms, foward_time = 25.654272, backward_time = 27.172865, perf = 15.56 tflops.
STEP-58: step_time = 52.824062 ms, foward_time = 25.515009, backward_time = 27.184128, perf = 15.61 tflops.
STEP-59: step_time = 52.668415 ms, foward_time = 25.327616, backward_time = 27.215872, perf = 15.66 tflops.
STEP-60: step_time = 52.201473 ms, foward_time = 25.217024, backward_time = 26.861568, perf = 15.80 tflops.
STEP-61: step_time = 52.593662 ms, foward_time = 25.446400, backward_time = 27.018240, perf = 15.68 tflops.
STEP-62: step_time = 52.909058 ms, foward_time = 25.443329, backward_time = 27.334656, perf = 15.59 tflops.
STEP-63: step_time = 52.891647 ms, foward_time = 25.383936, backward_time = 27.368448, perf = 15.59 tflops.
STEP-64: step_time = 52.521984 ms, foward_time = 25.401344, backward_time = 26.995712, perf = 15.70 tflops.
STEP-65: step_time = 52.807678 ms, foward_time = 25.519104, backward_time = 27.166719, perf = 15.62 tflops.
STEP-66: step_time = 52.415489 ms, foward_time = 25.368576, backward_time = 26.925056, perf = 15.73 tflops.
STEP-67: step_time = 53.826561 ms, foward_time = 26.803200, backward_time = 26.899456, perf = 15.32 tflops.
STEP-68: step_time = 52.412415 ms, foward_time = 25.338881, backward_time = 26.930176, perf = 15.73 tflops.
STEP-69: step_time = 53.177345 ms, foward_time = 25.314304, backward_time = 27.742208, perf = 15.51 tflops.
STEP-70: step_time = 52.645889 ms, foward_time = 25.534464, backward_time = 26.987520, perf = 15.66 tflops.
STEP-71: step_time = 52.643841 ms, foward_time = 25.341951, backward_time = 27.180033, perf = 15.66 tflops.
STEP-72: step_time = 52.561920 ms, foward_time = 25.413631, backward_time = 27.024384, perf = 15.69 tflops.
STEP-73: step_time = 52.240383 ms, foward_time = 25.148417, backward_time = 26.970112, perf = 15.79 tflops.
STEP-74: step_time = 52.361217 ms, foward_time = 25.392128, backward_time = 26.848255, perf = 15.75 tflops.
STEP-75: step_time = 52.354050 ms, foward_time = 25.359360, backward_time = 26.869761, perf = 15.75 tflops.
STEP-76: step_time = 52.084736 ms, foward_time = 24.975361, backward_time = 26.979328, perf = 15.83 tflops.
STEP-77: step_time = 52.767742 ms, foward_time = 25.413631, backward_time = 27.233280, perf = 15.63 tflops.
STEP-78: step_time = 52.436993 ms, foward_time = 25.336832, backward_time = 26.981377, perf = 15.73 tflops.
STEP-79: step_time = 52.671490 ms, foward_time = 25.436159, backward_time = 27.112448, perf = 15.66 tflops.
STEP-80: step_time = 52.752384 ms, foward_time = 25.424896, backward_time = 27.199488, perf = 15.63 tflops.
STEP-81: step_time = 52.594688 ms, foward_time = 25.361408, backward_time = 27.109377, perf = 15.68 tflops.
STEP-82: step_time = 52.682751 ms, foward_time = 25.350143, backward_time = 27.192320, perf = 15.65 tflops.
STEP-83: step_time = 52.965378 ms, foward_time = 25.605120, backward_time = 27.237375, perf = 15.57 tflops.
STEP-84: step_time = 52.718594 ms, foward_time = 25.419777, backward_time = 27.180033, perf = 15.64 tflops.
STEP-85: step_time = 52.574207 ms, foward_time = 25.221121, backward_time = 27.232256, perf = 15.69 tflops.
STEP-86: step_time = 52.418560 ms, foward_time = 25.252865, backward_time = 27.043840, perf = 15.73 tflops.
STEP-87: step_time = 52.302849 ms, foward_time = 25.293823, backward_time = 26.887169, perf = 15.77 tflops.
STEP-88: step_time = 52.450302 ms, foward_time = 25.390079, backward_time = 26.939392, perf = 15.72 tflops.
STEP-89: step_time = 52.699135 ms, foward_time = 25.356289, backward_time = 27.222015, perf = 15.65 tflops.
STEP-90: step_time = 52.467712 ms, foward_time = 25.390079, backward_time = 26.958849, perf = 15.72 tflops.
STEP-91: step_time = 52.452351 ms, foward_time = 25.207808, backward_time = 27.122688, perf = 15.72 tflops.
STEP-92: step_time = 52.903934 ms, foward_time = 25.979904, backward_time = 26.801151, perf = 15.59 tflops.
STEP-93: step_time = 51.807232 ms, foward_time = 24.839169, backward_time = 26.849279, perf = 15.92 tflops.
STEP-94: step_time = 52.425728 ms, foward_time = 25.353216, backward_time = 26.954752, perf = 15.73 tflops.
STEP-95: step_time = 52.302849 ms, foward_time = 25.262079, backward_time = 26.921984, perf = 15.77 tflops.
STEP-96: step_time = 52.380672 ms, foward_time = 25.379841, backward_time = 26.882048, perf = 15.74 tflops.
STEP-97: step_time = 52.156418 ms, foward_time = 25.299969, backward_time = 26.737663, perf = 15.81 tflops.
STEP-98: step_time = 52.048897 ms, foward_time = 24.854528, backward_time = 27.076609, perf = 15.84 tflops.
STEP-99: step_time = 52.413441 ms, foward_time = 25.307137, backward_time = 26.982401, perf = 15.73 tflops.

 fast_moe 8 [Summary] Average synchronized step_time = 52.55316480000814 ms, forward = 25.38441390991211 , backward = 27.04510300954183 .
[Benchmark] world_size = 4, dtype = float16, model_dim = 1024, hidden_size = 4096, samples = 8192, num_local_experts = 16, topK = 2, a2a_ffn_overlap_degree = 1, device = `cuda:0`
STEP-0: step_time = 1545.116699 ms, foward_time = 1507.777588, backward_time = 37.039104, perf = 0.53 tflops.
STEP-1: step_time = 64.093185 ms, foward_time = 33.928192, backward_time = 30.026752, perf = 12.87 tflops.
STEP-2: step_time = 60.519424 ms, foward_time = 32.448513, backward_time = 27.926529, perf = 13.63 tflops.
STEP-3: step_time = 57.624577 ms, foward_time = 30.616575, backward_time = 26.878977, perf = 14.31 tflops.
STEP-4: step_time = 59.849728 ms, foward_time = 31.226879, backward_time = 28.463104, perf = 13.78 tflops.
STEP-5: step_time = 56.856575 ms, foward_time = 30.500864, backward_time = 26.212353, perf = 14.50 tflops.
STEP-6: step_time = 56.757248 ms, foward_time = 30.270464, backward_time = 26.347521, perf = 14.53 tflops.
STEP-7: step_time = 57.865215 ms, foward_time = 30.925823, backward_time = 26.779648, perf = 14.25 tflops.
STEP-8: step_time = 57.753601 ms, foward_time = 31.023104, backward_time = 26.603519, perf = 14.28 tflops.
STEP-9: step_time = 55.372799 ms, foward_time = 29.206528, backward_time = 26.042368, perf = 14.89 tflops.
STEP-10: step_time = 54.610943 ms, foward_time = 28.446720, backward_time = 26.033152, perf = 15.10 tflops.
STEP-11: step_time = 55.525375 ms, foward_time = 29.162497, backward_time = 26.221567, perf = 14.85 tflops.
STEP-12: step_time = 59.085823 ms, foward_time = 31.542273, backward_time = 27.418625, perf = 13.96 tflops.
STEP-13: step_time = 54.703102 ms, foward_time = 28.392448, backward_time = 26.179585, perf = 15.07 tflops.
STEP-14: step_time = 56.778751 ms, foward_time = 30.438400, backward_time = 26.195969, perf = 14.52 tflops.
STEP-15: step_time = 57.289726 ms, foward_time = 31.165440, backward_time = 25.997313, perf = 14.39 tflops.
STEP-16: step_time = 53.834751 ms, foward_time = 27.516928, backward_time = 26.192896, perf = 15.32 tflops.
STEP-17: step_time = 53.481472 ms, foward_time = 27.384832, backward_time = 25.970688, perf = 15.42 tflops.
STEP-18: step_time = 53.806080 ms, foward_time = 27.471872, backward_time = 26.215424, perf = 15.33 tflops.
STEP-19: step_time = 55.945217 ms, foward_time = 29.668352, backward_time = 26.156033, perf = 14.74 tflops.
STEP-20: step_time = 55.068672 ms, foward_time = 28.936192, backward_time = 26.006529, perf = 14.97 tflops.
STEP-21: step_time = 53.314560 ms, foward_time = 27.305984, backward_time = 25.886721, perf = 15.47 tflops.
STEP-22: step_time = 54.614017 ms, foward_time = 27.938816, backward_time = 26.548223, perf = 15.10 tflops.
STEP-23: step_time = 54.453247 ms, foward_time = 28.359680, backward_time = 25.966593, perf = 15.14 tflops.
STEP-24: step_time = 53.527554 ms, foward_time = 27.386881, backward_time = 26.015743, perf = 15.41 tflops.
STEP-25: step_time = 54.578175 ms, foward_time = 28.239872, backward_time = 26.149887, perf = 15.11 tflops.
STEP-26: step_time = 58.117119 ms, foward_time = 28.631041, backward_time = 29.352961, perf = 14.19 tflops.
STEP-27: step_time = 55.661568 ms, foward_time = 29.544449, backward_time = 25.998337, perf = 14.82 tflops.
STEP-28: step_time = 53.104641 ms, foward_time = 27.123713, backward_time = 25.866240, perf = 15.53 tflops.
STEP-29: step_time = 55.665665 ms, foward_time = 28.438528, backward_time = 27.106304, perf = 14.81 tflops.
STEP-30: step_time = 53.420033 ms, foward_time = 27.249664, backward_time = 26.053633, perf = 15.44 tflops.
STEP-31: step_time = 54.425598 ms, foward_time = 27.878401, backward_time = 26.427391, perf = 15.15 tflops.
STEP-32: step_time = 53.097473 ms, foward_time = 27.137024, backward_time = 25.834496, perf = 15.53 tflops.
STEP-33: step_time = 55.926785 ms, foward_time = 29.603840, backward_time = 26.102783, perf = 14.74 tflops.
STEP-34: step_time = 54.075394 ms, foward_time = 27.451391, backward_time = 26.492928, perf = 15.25 tflops.
STEP-35: step_time = 55.973888 ms, foward_time = 29.978624, backward_time = 25.868288, perf = 14.73 tflops.
STEP-36: step_time = 54.396927 ms, foward_time = 27.903999, backward_time = 26.357759, perf = 15.16 tflops.
STEP-37: step_time = 53.270527 ms, foward_time = 27.186176, backward_time = 25.959423, perf = 15.48 tflops.
STEP-38: step_time = 53.353474 ms, foward_time = 27.075584, backward_time = 26.150911, perf = 15.46 tflops.
STEP-39: step_time = 53.199871 ms, foward_time = 26.992640, backward_time = 26.087423, perf = 15.50 tflops.
STEP-40: step_time = 53.017601 ms, foward_time = 26.966017, backward_time = 25.916416, perf = 15.55 tflops.
STEP-41: step_time = 53.448704 ms, foward_time = 26.934273, backward_time = 26.377216, perf = 15.43 tflops.
STEP-42: step_time = 52.593662 ms, foward_time = 26.752001, backward_time = 25.724928, perf = 15.68 tflops.
STEP-43: step_time = 53.053440 ms, foward_time = 27.077633, backward_time = 25.836544, perf = 15.54 tflops.
STEP-44: step_time = 53.011456 ms, foward_time = 26.906624, backward_time = 25.986048, perf = 15.56 tflops.
STEP-45: step_time = 53.004288 ms, foward_time = 26.918913, backward_time = 25.962496, perf = 15.56 tflops.
STEP-46: step_time = 54.177792 ms, foward_time = 27.964417, backward_time = 26.091520, perf = 15.22 tflops.
STEP-47: step_time = 52.976639 ms, foward_time = 27.033600, backward_time = 25.825279, perf = 15.57 tflops.
STEP-48: step_time = 52.942848 ms, foward_time = 26.981377, backward_time = 25.845760, perf = 15.58 tflops.
STEP-49: step_time = 54.797314 ms, foward_time = 27.299841, backward_time = 27.369473, perf = 15.05 tflops.
STEP-50: step_time = 54.080513 ms, foward_time = 28.032000, backward_time = 25.928703, perf = 15.25 tflops.
STEP-51: step_time = 53.888000 ms, foward_time = 27.710464, backward_time = 26.056704, perf = 15.30 tflops.
STEP-52: step_time = 54.847488 ms, foward_time = 27.706367, backward_time = 27.021313, perf = 15.04 tflops.
STEP-53: step_time = 53.238785 ms, foward_time = 26.977280, backward_time = 26.140673, perf = 15.49 tflops.
STEP-54: step_time = 53.289986 ms, foward_time = 27.058176, backward_time = 26.112000, perf = 15.47 tflops.
STEP-55: step_time = 53.106689 ms, foward_time = 26.816511, backward_time = 26.152960, perf = 15.53 tflops.
STEP-56: step_time = 53.878784 ms, foward_time = 27.837440, backward_time = 25.926657, perf = 15.31 tflops.
STEP-57: step_time = 54.585342 ms, foward_time = 28.129280, backward_time = 26.337280, perf = 15.11 tflops.
STEP-58: step_time = 53.731327 ms, foward_time = 27.779072, backward_time = 25.834496, perf = 15.35 tflops.
STEP-59: step_time = 53.303295 ms, foward_time = 27.451391, backward_time = 25.733120, perf = 15.47 tflops.
STEP-60: step_time = 52.834305 ms, foward_time = 26.782721, backward_time = 25.917440, perf = 15.61 tflops.
STEP-61: step_time = 54.839294 ms, foward_time = 26.972160, backward_time = 27.735041, perf = 15.04 tflops.
STEP-62: step_time = 53.850113 ms, foward_time = 26.983423, backward_time = 26.747904, perf = 15.31 tflops.
STEP-63: step_time = 53.920769 ms, foward_time = 26.948608, backward_time = 26.843136, perf = 15.29 tflops.
STEP-64: step_time = 54.195202 ms, foward_time = 27.067392, backward_time = 27.013121, perf = 15.22 tflops.
STEP-65: step_time = 53.861378 ms, foward_time = 26.957825, backward_time = 26.781696, perf = 15.31 tflops.
STEP-66: step_time = 53.530624 ms, foward_time = 27.674623, backward_time = 25.743361, perf = 15.40 tflops.
STEP-67: step_time = 53.075970 ms, foward_time = 27.090944, backward_time = 25.865215, perf = 15.54 tflops.
STEP-68: step_time = 53.065727 ms, foward_time = 27.268097, backward_time = 25.678848, perf = 15.54 tflops.
STEP-69: step_time = 54.121471 ms, foward_time = 27.142143, backward_time = 26.839041, perf = 15.24 tflops.
STEP-70: step_time = 54.310913 ms, foward_time = 28.573696, backward_time = 25.613312, perf = 15.18 tflops.
STEP-71: step_time = 53.531647 ms, foward_time = 27.416576, backward_time = 25.987072, perf = 15.40 tflops.
STEP-72: step_time = 53.242882 ms, foward_time = 26.896383, backward_time = 26.230783, perf = 15.49 tflops.
STEP-73: step_time = 55.640064 ms, foward_time = 29.452288, backward_time = 26.073088, perf = 14.82 tflops.
STEP-74: step_time = 54.013950 ms, foward_time = 28.054527, backward_time = 25.829376, perf = 15.27 tflops.
STEP-75: step_time = 52.957184 ms, foward_time = 27.024384, backward_time = 25.818111, perf = 15.57 tflops.
STEP-76: step_time = 53.005314 ms, foward_time = 26.884096, backward_time = 26.008575, perf = 15.56 tflops.
STEP-77: step_time = 52.844543 ms, foward_time = 26.863617, backward_time = 25.845760, perf = 15.60 tflops.
STEP-78: step_time = 53.792767 ms, foward_time = 27.716608, backward_time = 25.955328, perf = 15.33 tflops.
STEP-79: step_time = 53.215233 ms, foward_time = 27.147264, backward_time = 25.920511, perf = 15.50 tflops.
STEP-80: step_time = 54.653954 ms, foward_time = 28.475391, backward_time = 26.029057, perf = 15.09 tflops.
STEP-81: step_time = 53.438465 ms, foward_time = 27.422720, backward_time = 25.892864, perf = 15.43 tflops.
STEP-82: step_time = 54.611969 ms, foward_time = 27.720703, backward_time = 26.760193, perf = 15.10 tflops.
STEP-83: step_time = 53.803009 ms, foward_time = 27.751425, backward_time = 25.935871, perf = 15.33 tflops.
STEP-84: step_time = 52.905983 ms, foward_time = 26.984447, backward_time = 25.797632, perf = 15.59 tflops.
STEP-85: step_time = 53.073921 ms, foward_time = 27.216896, backward_time = 25.723904, perf = 15.54 tflops.
STEP-86: step_time = 52.667393 ms, foward_time = 26.828800, backward_time = 25.725952, perf = 15.66 tflops.
STEP-87: step_time = 52.913151 ms, foward_time = 26.862593, backward_time = 25.930752, perf = 15.58 tflops.
STEP-88: step_time = 52.948994 ms, foward_time = 27.092993, backward_time = 25.739264, perf = 15.57 tflops.
STEP-89: step_time = 52.829185 ms, foward_time = 26.845184, backward_time = 25.833471, perf = 15.61 tflops.
STEP-90: step_time = 53.065727 ms, foward_time = 27.108353, backward_time = 25.826303, perf = 15.54 tflops.
STEP-91: step_time = 52.679680 ms, foward_time = 26.854401, backward_time = 25.708544, perf = 15.65 tflops.
STEP-92: step_time = 52.673534 ms, foward_time = 26.711040, backward_time = 25.846785, perf = 15.66 tflops.
STEP-93: step_time = 53.128193 ms, foward_time = 27.276287, backward_time = 25.737217, perf = 15.52 tflops.
STEP-94: step_time = 53.344257 ms, foward_time = 27.171841, backward_time = 26.057728, perf = 15.46 tflops.
STEP-95: step_time = 52.924416 ms, foward_time = 27.003904, backward_time = 25.799681, perf = 15.58 tflops.
STEP-96: step_time = 52.429825 ms, foward_time = 26.772480, backward_time = 25.540607, perf = 15.73 tflops.
STEP-97: step_time = 52.911102 ms, foward_time = 27.278336, backward_time = 25.504768, perf = 15.59 tflops.
STEP-98: step_time = 53.389313 ms, foward_time = 27.251713, backward_time = 26.005505, perf = 15.45 tflops.
STEP-99: step_time = 52.694016 ms, foward_time = 26.974209, backward_time = 25.596928, perf = 15.65 tflops.

 fast_moe 16 [Summary] Average synchronized step_time = 53.46515649159749 ms, forward = 27.280896155039468 , backward = 26.06032215754191 .
[Benchmark] world_size = 4, dtype = float16, model_dim = 1024, hidden_size = 4096, samples = 8192, num_local_experts = 32, topK = 2, a2a_ffn_overlap_degree = 1, device = `cuda:0`
STEP-0: step_time = 1488.463867 ms, foward_time = 1439.448120, backward_time = 48.094208, perf = 0.55 tflops.
STEP-1: step_time = 81.868797 ms, foward_time = 43.323391, backward_time = 38.336514, perf = 10.07 tflops.
STEP-2: step_time = 75.798531 ms, foward_time = 39.135231, backward_time = 36.452351, perf = 10.88 tflops.
STEP-3: step_time = 74.682365 ms, foward_time = 38.937599, backward_time = 35.535873, perf = 11.04 tflops.
STEP-4: step_time = 75.302910 ms, foward_time = 39.424000, backward_time = 35.667969, perf = 10.95 tflops.
STEP-5: step_time = 73.827332 ms, foward_time = 38.264832, backward_time = 35.353600, perf = 11.17 tflops.
STEP-6: step_time = 74.025986 ms, foward_time = 38.176769, backward_time = 35.638271, perf = 11.14 tflops.
STEP-7: step_time = 74.773506 ms, foward_time = 39.356415, backward_time = 35.205120, perf = 11.03 tflops.
STEP-8: step_time = 73.475075 ms, foward_time = 38.060032, backward_time = 35.206142, perf = 11.22 tflops.
STEP-9: step_time = 73.767937 ms, foward_time = 38.291454, backward_time = 35.263489, perf = 11.18 tflops.
STEP-10: step_time = 73.031677 ms, foward_time = 37.903358, backward_time = 34.957314, perf = 11.29 tflops.
STEP-11: step_time = 72.032257 ms, foward_time = 36.777985, backward_time = 35.078144, perf = 11.45 tflops.
STEP-12: step_time = 71.583740 ms, foward_time = 36.382721, backward_time = 35.032063, perf = 11.52 tflops.
STEP-13: step_time = 71.957504 ms, foward_time = 36.714497, backward_time = 35.028992, perf = 11.46 tflops.
STEP-14: step_time = 73.075714 ms, foward_time = 36.614143, backward_time = 36.288513, perf = 11.28 tflops.
STEP-15: step_time = 71.918594 ms, foward_time = 36.772865, backward_time = 34.974720, perf = 11.47 tflops.
STEP-16: step_time = 71.364609 ms, foward_time = 36.288513, backward_time = 34.905087, perf = 11.56 tflops.
STEP-17: step_time = 71.842819 ms, foward_time = 36.218880, backward_time = 35.454975, perf = 11.48 tflops.
STEP-18: step_time = 71.362556 ms, foward_time = 36.279297, backward_time = 34.914303, perf = 11.56 tflops.
STEP-19: step_time = 72.650749 ms, foward_time = 36.664322, backward_time = 35.816448, perf = 11.35 tflops.
STEP-20: step_time = 71.320580 ms, foward_time = 36.048897, backward_time = 35.103745, perf = 11.56 tflops.
STEP-21: step_time = 72.488960 ms, foward_time = 37.125118, backward_time = 35.193855, perf = 11.38 tflops.
STEP-22: step_time = 71.356415 ms, foward_time = 36.023296, backward_time = 35.164162, perf = 11.56 tflops.
STEP-23: step_time = 73.807869 ms, foward_time = 36.874241, backward_time = 36.739071, perf = 11.17 tflops.
STEP-24: step_time = 72.988670 ms, foward_time = 37.881855, backward_time = 34.934784, perf = 11.30 tflops.
STEP-25: step_time = 73.205757 ms, foward_time = 36.538368, backward_time = 36.471809, perf = 11.26 tflops.
STEP-26: step_time = 72.978432 ms, foward_time = 37.582848, backward_time = 35.190784, perf = 11.30 tflops.
STEP-27: step_time = 72.006653 ms, foward_time = 36.896767, backward_time = 34.923519, perf = 11.45 tflops.
STEP-28: step_time = 73.820160 ms, foward_time = 36.772865, backward_time = 36.842495, perf = 11.17 tflops.
STEP-29: step_time = 71.629822 ms, foward_time = 36.408321, backward_time = 35.047424, perf = 11.51 tflops.
STEP-30: step_time = 72.337410 ms, foward_time = 36.033535, backward_time = 36.131840, perf = 11.40 tflops.
STEP-31: step_time = 71.333885 ms, foward_time = 36.093952, backward_time = 35.065857, perf = 11.56 tflops.
STEP-32: step_time = 72.506371 ms, foward_time = 36.482048, backward_time = 35.850239, perf = 11.37 tflops.
STEP-33: step_time = 71.767036 ms, foward_time = 36.715519, backward_time = 34.867199, perf = 11.49 tflops.
STEP-34: step_time = 71.545853 ms, foward_time = 36.054016, backward_time = 35.319809, perf = 11.53 tflops.
STEP-35: step_time = 72.135681 ms, foward_time = 35.905537, backward_time = 36.060162, perf = 11.43 tflops.
STEP-36: step_time = 74.740738 ms, foward_time = 36.636673, backward_time = 37.896191, perf = 11.03 tflops.
STEP-37: step_time = 72.496124 ms, foward_time = 36.817921, backward_time = 35.509247, perf = 11.37 tflops.
STEP-38: step_time = 72.494080 ms, foward_time = 36.240383, backward_time = 36.079617, perf = 11.38 tflops.
STEP-39: step_time = 72.083458 ms, foward_time = 36.828159, backward_time = 35.078144, perf = 11.44 tflops.
STEP-40: step_time = 72.369148 ms, foward_time = 36.837376, backward_time = 35.354626, perf = 11.39 tflops.
STEP-41: step_time = 72.257538 ms, foward_time = 36.537346, backward_time = 35.549183, perf = 11.41 tflops.
STEP-42: step_time = 71.533569 ms, foward_time = 36.134911, backward_time = 35.226624, perf = 11.53 tflops.
STEP-43: step_time = 75.906052 ms, foward_time = 39.123966, backward_time = 36.608002, perf = 10.86 tflops.
STEP-44: step_time = 71.669762 ms, foward_time = 36.546558, backward_time = 34.949120, perf = 11.51 tflops.
STEP-45: step_time = 72.965118 ms, foward_time = 36.978687, backward_time = 35.807232, perf = 11.30 tflops.
STEP-46: step_time = 73.198593 ms, foward_time = 36.700161, backward_time = 36.316158, perf = 11.27 tflops.
STEP-47: step_time = 71.636993 ms, foward_time = 36.538368, backward_time = 34.918400, perf = 11.51 tflops.
STEP-48: step_time = 75.170815 ms, foward_time = 38.152191, backward_time = 36.838402, perf = 10.97 tflops.
STEP-49: step_time = 72.253441 ms, foward_time = 36.360191, backward_time = 35.714046, perf = 11.41 tflops.
STEP-50: step_time = 72.592384 ms, foward_time = 36.788223, backward_time = 35.634174, perf = 11.36 tflops.
STEP-51: step_time = 78.371841 ms, foward_time = 40.844288, backward_time = 37.317631, perf = 10.52 tflops.
STEP-52: step_time = 75.531265 ms, foward_time = 40.163326, backward_time = 35.197952, perf = 10.92 tflops.
STEP-53: step_time = 76.144638 ms, foward_time = 40.799232, backward_time = 35.083263, perf = 10.83 tflops.
STEP-54: step_time = 77.316093 ms, foward_time = 41.673729, backward_time = 35.457024, perf = 10.67 tflops.
STEP-55: step_time = 75.984894 ms, foward_time = 40.330238, backward_time = 35.482624, perf = 10.85 tflops.
STEP-56: step_time = 81.269760 ms, foward_time = 43.847679, backward_time = 37.102592, perf = 10.15 tflops.
STEP-57: step_time = 75.321342 ms, foward_time = 39.660545, backward_time = 35.394562, perf = 10.95 tflops.
STEP-58: step_time = 75.072510 ms, foward_time = 39.331841, backward_time = 35.480576, perf = 10.98 tflops.
STEP-59: step_time = 76.323837 ms, foward_time = 39.361534, backward_time = 36.731903, perf = 10.80 tflops.
STEP-60: step_time = 75.164673 ms, foward_time = 39.111679, backward_time = 35.837952, perf = 10.97 tflops.
STEP-61: step_time = 74.473473 ms, foward_time = 38.600704, backward_time = 35.651585, perf = 11.07 tflops.
STEP-62: step_time = 74.601471 ms, foward_time = 38.915073, backward_time = 35.464191, perf = 11.05 tflops.
STEP-63: step_time = 74.719231 ms, foward_time = 39.113728, backward_time = 35.383297, perf = 11.04 tflops.
STEP-64: step_time = 75.207680 ms, foward_time = 38.615040, backward_time = 36.370434, perf = 10.96 tflops.
STEP-65: step_time = 74.810371 ms, foward_time = 38.790146, backward_time = 35.800064, perf = 11.02 tflops.
STEP-66: step_time = 74.426369 ms, foward_time = 38.667263, backward_time = 35.537922, perf = 11.08 tflops.
STEP-67: step_time = 74.927101 ms, foward_time = 38.820866, backward_time = 35.884033, perf = 11.01 tflops.
STEP-68: step_time = 74.761215 ms, foward_time = 38.722561, backward_time = 35.824638, perf = 11.03 tflops.
STEP-69: step_time = 74.573822 ms, foward_time = 38.523903, backward_time = 35.834881, perf = 11.06 tflops.
STEP-70: step_time = 74.479614 ms, foward_time = 38.391808, backward_time = 35.873791, perf = 11.07 tflops.
STEP-71: step_time = 76.297218 ms, foward_time = 38.824959, backward_time = 37.253120, perf = 10.81 tflops.
STEP-72: step_time = 77.981697 ms, foward_time = 39.361534, backward_time = 38.400002, perf = 10.57 tflops.
STEP-73: step_time = 77.723648 ms, foward_time = 39.149567, backward_time = 38.353920, perf = 10.61 tflops.
STEP-74: step_time = 76.401665 ms, foward_time = 38.651905, backward_time = 37.536770, perf = 10.79 tflops.
STEP-75: step_time = 76.615677 ms, foward_time = 38.813698, backward_time = 37.583874, perf = 10.76 tflops.
STEP-76: step_time = 78.397438 ms, foward_time = 40.160255, backward_time = 38.017025, perf = 10.52 tflops.
STEP-77: step_time = 76.895233 ms, foward_time = 38.628353, backward_time = 38.051842, perf = 10.72 tflops.
STEP-78: step_time = 75.856895 ms, foward_time = 38.468609, backward_time = 37.166080, perf = 10.87 tflops.
STEP-79: step_time = 77.492226 ms, foward_time = 38.774784, backward_time = 38.496258, perf = 10.64 tflops.
STEP-80: step_time = 76.615677 ms, foward_time = 38.579201, backward_time = 37.829632, perf = 10.76 tflops.
STEP-81: step_time = 76.573692 ms, foward_time = 38.728703, backward_time = 37.628929, perf = 10.77 tflops.
STEP-82: step_time = 76.121086 ms, foward_time = 38.628353, backward_time = 37.267456, perf = 10.83 tflops.
STEP-83: step_time = 76.275711 ms, foward_time = 38.831104, backward_time = 37.154816, perf = 10.81 tflops.
STEP-84: step_time = 77.302788 ms, foward_time = 39.022591, backward_time = 38.052864, perf = 10.67 tflops.
STEP-85: step_time = 76.717056 ms, foward_time = 38.989822, backward_time = 37.501953, perf = 10.75 tflops.
STEP-86: step_time = 76.807167 ms, foward_time = 38.415359, backward_time = 38.158337, perf = 10.74 tflops.
STEP-87: step_time = 77.250557 ms, foward_time = 38.882305, backward_time = 38.135807, perf = 10.67 tflops.
STEP-88: step_time = 76.365822 ms, foward_time = 38.675457, backward_time = 37.473282, perf = 10.80 tflops.
STEP-89: step_time = 77.331459 ms, foward_time = 38.690815, backward_time = 38.408192, perf = 10.66 tflops.
STEP-90: step_time = 75.938812 ms, foward_time = 38.209538, backward_time = 37.508095, perf = 10.86 tflops.
STEP-91: step_time = 75.448318 ms, foward_time = 38.166527, backward_time = 37.061630, perf = 10.93 tflops.
STEP-92: step_time = 74.354691 ms, foward_time = 38.233089, backward_time = 35.896320, perf = 11.09 tflops.
STEP-93: step_time = 75.746307 ms, foward_time = 39.684097, backward_time = 35.832832, perf = 10.89 tflops.
STEP-94: step_time = 75.533310 ms, foward_time = 39.430145, backward_time = 35.883007, perf = 10.92 tflops.
STEP-95: step_time = 75.819008 ms, foward_time = 39.326721, backward_time = 36.273151, perf = 10.88 tflops.
STEP-96: step_time = 75.032578 ms, foward_time = 38.872063, backward_time = 35.916801, perf = 10.99 tflops.
STEP-97: step_time = 73.707520 ms, foward_time = 37.998592, backward_time = 35.478527, perf = 11.19 tflops.
STEP-98: step_time = 78.227455 ms, foward_time = 41.487358, backward_time = 36.534271, perf = 10.54 tflops.
STEP-99: step_time = 73.910271 ms, foward_time = 37.822464, backward_time = 35.872768, perf = 11.16 tflops.

 fast_moe 32 [Summary] Average synchronized step_time = 75.4962599436442 ms, forward = 38.774852180480956 , backward = 36.50590737660726 .
[Benchmark] world_size = 4, dtype = float16, model_dim = 1024, hidden_size = 4096, samples = 8192, num_local_experts = 64, topK = 2, a2a_ffn_overlap_degree = 1, device = `cuda:0`
STEP-0: step_time = 1454.885864 ms, foward_time = 1385.815063, backward_time = 68.016129, perf = 0.57 tflops.
STEP-1: step_time = 128.801788 ms, foward_time = 69.324799, backward_time = 59.108353, perf = 6.40 tflops.
STEP-2: step_time = 126.082047 ms, foward_time = 67.044350, backward_time = 58.713089, perf = 6.54 tflops.
STEP-3: step_time = 120.307709 ms, foward_time = 64.321533, backward_time = 55.655422, perf = 6.85 tflops.
STEP-4: step_time = 114.625534 ms, foward_time = 60.106750, backward_time = 54.180862, perf = 7.19 tflops.
STEP-5: step_time = 118.103043 ms, foward_time = 62.491650, backward_time = 55.088127, perf = 6.98 tflops.
STEP-6: step_time = 113.928192 ms, foward_time = 59.038719, backward_time = 54.532097, perf = 7.24 tflops.
STEP-7: step_time = 116.282372 ms, foward_time = 60.580864, backward_time = 55.262207, perf = 7.09 tflops.
STEP-8: step_time = 115.379204 ms, foward_time = 60.712959, backward_time = 54.323200, perf = 7.15 tflops.
STEP-9: step_time = 112.551933 ms, foward_time = 59.746304, backward_time = 52.447231, perf = 7.33 tflops.
STEP-10: step_time = 110.931969 ms, foward_time = 59.288574, backward_time = 51.312641, perf = 7.43 tflops.
STEP-11: step_time = 114.304001 ms, foward_time = 59.328510, backward_time = 54.574081, perf = 7.21 tflops.
STEP-12: step_time = 114.056190 ms, foward_time = 59.430912, backward_time = 54.238209, perf = 7.23 tflops.
STEP-13: step_time = 110.872574 ms, foward_time = 59.457535, backward_time = 51.056641, perf = 7.44 tflops.
STEP-14: step_time = 110.782463 ms, foward_time = 59.646976, backward_time = 50.776066, perf = 7.44 tflops.
STEP-15: step_time = 110.738434 ms, foward_time = 59.281406, backward_time = 51.084290, perf = 7.45 tflops.
STEP-16: step_time = 110.491646 ms, foward_time = 59.749374, backward_time = 50.406399, perf = 7.46 tflops.
STEP-17: step_time = 111.195137 ms, foward_time = 58.925056, backward_time = 51.885056, perf = 7.42 tflops.
STEP-18: step_time = 111.620094 ms, foward_time = 59.357185, backward_time = 51.885056, perf = 7.39 tflops.
STEP-19: step_time = 109.668350 ms, foward_time = 59.066368, backward_time = 50.247681, perf = 7.52 tflops.
STEP-20: step_time = 110.027779 ms, foward_time = 59.410431, backward_time = 50.232319, perf = 7.49 tflops.
STEP-21: step_time = 110.676994 ms, foward_time = 58.873856, backward_time = 51.419136, perf = 7.45 tflops.
STEP-22: step_time = 110.942207 ms, foward_time = 59.669502, backward_time = 50.873344, perf = 7.43 tflops.
STEP-23: step_time = 111.778816 ms, foward_time = 60.057598, backward_time = 51.342335, perf = 7.38 tflops.
STEP-24: step_time = 110.154755 ms, foward_time = 59.364353, backward_time = 50.411518, perf = 7.49 tflops.
STEP-25: step_time = 109.712387 ms, foward_time = 58.786816, backward_time = 50.557953, perf = 7.52 tflops.
STEP-26: step_time = 110.573570 ms, foward_time = 59.339775, backward_time = 50.882561, perf = 7.46 tflops.
STEP-27: step_time = 110.624771 ms, foward_time = 59.448318, backward_time = 50.810879, perf = 7.45 tflops.
STEP-28: step_time = 108.860413 ms, foward_time = 58.054657, backward_time = 50.419712, perf = 7.58 tflops.
STEP-29: step_time = 110.032898 ms, foward_time = 59.398144, backward_time = 50.253822, perf = 7.49 tflops.
STEP-30: step_time = 111.132675 ms, foward_time = 60.178432, backward_time = 50.576385, perf = 7.42 tflops.
STEP-31: step_time = 110.743553 ms, foward_time = 59.534336, backward_time = 50.784256, perf = 7.45 tflops.
STEP-32: step_time = 111.918083 ms, foward_time = 59.564034, backward_time = 51.992577, perf = 7.37 tflops.
STEP-33: step_time = 109.914108 ms, foward_time = 58.935295, backward_time = 50.595840, perf = 7.50 tflops.
STEP-34: step_time = 110.270462 ms, foward_time = 59.388927, backward_time = 50.477055, perf = 7.48 tflops.
STEP-35: step_time = 112.301056 ms, foward_time = 60.086273, backward_time = 51.794945, perf = 7.34 tflops.
STEP-36: step_time = 111.748093 ms, foward_time = 59.294720, backward_time = 52.021248, perf = 7.38 tflops.
STEP-37: step_time = 110.107651 ms, foward_time = 59.067390, backward_time = 50.706432, perf = 7.49 tflops.
STEP-38: step_time = 109.880318 ms, foward_time = 59.236351, backward_time = 50.260990, perf = 7.50 tflops.
STEP-39: step_time = 111.013885 ms, foward_time = 59.751423, backward_time = 50.889729, perf = 7.43 tflops.
STEP-40: step_time = 110.502914 ms, foward_time = 59.233280, backward_time = 50.896896, perf = 7.46 tflops.
STEP-41: step_time = 112.212990 ms, foward_time = 60.678143, backward_time = 51.097599, perf = 7.35 tflops.
STEP-42: step_time = 109.786110 ms, foward_time = 58.729473, backward_time = 50.667519, perf = 7.51 tflops.
STEP-43: step_time = 113.767426 ms, foward_time = 62.418945, backward_time = 50.890751, perf = 7.25 tflops.
STEP-44: step_time = 110.153725 ms, foward_time = 58.974209, backward_time = 50.816002, perf = 7.49 tflops.
STEP-45: step_time = 111.594498 ms, foward_time = 60.334080, backward_time = 50.891777, perf = 7.39 tflops.
STEP-46: step_time = 110.314499 ms, foward_time = 59.484161, backward_time = 50.456577, perf = 7.48 tflops.
STEP-47: step_time = 111.828995 ms, foward_time = 61.092865, backward_time = 50.345985, perf = 7.37 tflops.
STEP-48: step_time = 110.224380 ms, foward_time = 59.210751, backward_time = 50.619392, perf = 7.48 tflops.
STEP-49: step_time = 110.101501 ms, foward_time = 59.287552, backward_time = 50.415615, perf = 7.49 tflops.
STEP-50: step_time = 110.893059 ms, foward_time = 60.316673, backward_time = 50.202625, perf = 7.44 tflops.
STEP-51: step_time = 110.524414 ms, foward_time = 59.359234, backward_time = 50.796543, perf = 7.46 tflops.
STEP-52: step_time = 111.242241 ms, foward_time = 59.972607, backward_time = 50.892799, perf = 7.41 tflops.
STEP-53: step_time = 110.886909 ms, foward_time = 59.174911, backward_time = 51.323902, perf = 7.44 tflops.
STEP-54: step_time = 111.665154 ms, foward_time = 60.375038, backward_time = 50.929665, perf = 7.38 tflops.
STEP-55: step_time = 110.560257 ms, foward_time = 59.515903, backward_time = 50.659328, perf = 7.46 tflops.
STEP-56: step_time = 109.196289 ms, foward_time = 58.418175, backward_time = 50.394112, perf = 7.55 tflops.
STEP-57: step_time = 110.448639 ms, foward_time = 59.332607, backward_time = 50.728958, perf = 7.47 tflops.
STEP-58: step_time = 110.286850 ms, foward_time = 59.376640, backward_time = 50.546688, perf = 7.48 tflops.
STEP-59: step_time = 110.926849 ms, foward_time = 58.129410, backward_time = 52.410370, perf = 7.43 tflops.
STEP-60: step_time = 110.579712 ms, foward_time = 59.565056, backward_time = 50.657280, perf = 7.46 tflops.
STEP-61: step_time = 110.059517 ms, foward_time = 58.891266, backward_time = 50.832382, perf = 7.49 tflops.
STEP-62: step_time = 110.938110 ms, foward_time = 59.511806, backward_time = 51.067905, perf = 7.43 tflops.
STEP-63: step_time = 111.141891 ms, foward_time = 59.788288, backward_time = 50.995201, perf = 7.42 tflops.
STEP-64: step_time = 113.346558 ms, foward_time = 61.733887, backward_time = 51.238911, perf = 7.28 tflops.
STEP-65: step_time = 111.329277 ms, foward_time = 60.240894, backward_time = 50.702335, perf = 7.41 tflops.
STEP-66: step_time = 110.349312 ms, foward_time = 59.128834, backward_time = 50.855934, perf = 7.47 tflops.
STEP-67: step_time = 110.614525 ms, foward_time = 59.452415, backward_time = 50.769920, perf = 7.46 tflops.
STEP-68: step_time = 110.710785 ms, foward_time = 60.015617, backward_time = 50.330624, perf = 7.45 tflops.
STEP-69: step_time = 110.095360 ms, foward_time = 59.455486, backward_time = 50.251778, perf = 7.49 tflops.
STEP-70: step_time = 111.650818 ms, foward_time = 59.502590, backward_time = 51.811329, perf = 7.39 tflops.
STEP-71: step_time = 111.265793 ms, foward_time = 59.710464, backward_time = 51.172352, perf = 7.41 tflops.
STEP-72: step_time = 109.925377 ms, foward_time = 59.011070, backward_time = 50.539520, perf = 7.50 tflops.
STEP-73: step_time = 110.324738 ms, foward_time = 59.237377, backward_time = 50.693119, perf = 7.47 tflops.
STEP-74: step_time = 110.402557 ms, foward_time = 59.522049, backward_time = 50.494465, perf = 7.47 tflops.
STEP-75: step_time = 109.962242 ms, foward_time = 59.164673, backward_time = 50.430977, perf = 7.50 tflops.
STEP-76: step_time = 110.218239 ms, foward_time = 59.185150, backward_time = 50.607105, perf = 7.48 tflops.
STEP-77: step_time = 109.615105 ms, foward_time = 59.185150, backward_time = 50.035713, perf = 7.52 tflops.
STEP-78: step_time = 109.965309 ms, foward_time = 59.176960, backward_time = 50.378754, perf = 7.50 tflops.
STEP-79: step_time = 110.797821 ms, foward_time = 59.747330, backward_time = 50.710529, perf = 7.44 tflops.
STEP-80: step_time = 110.029823 ms, foward_time = 59.277313, backward_time = 50.385921, perf = 7.49 tflops.
STEP-81: step_time = 110.860291 ms, foward_time = 59.572224, backward_time = 50.897919, perf = 7.44 tflops.
STEP-82: step_time = 110.717949 ms, foward_time = 59.270145, backward_time = 51.080193, perf = 7.45 tflops.
STEP-83: step_time = 110.316544 ms, foward_time = 59.566078, backward_time = 50.377728, perf = 7.48 tflops.
STEP-84: step_time = 109.987839 ms, foward_time = 58.893311, backward_time = 50.700287, perf = 7.50 tflops.
STEP-85: step_time = 110.002174 ms, foward_time = 58.924030, backward_time = 50.703362, perf = 7.50 tflops.
STEP-86: step_time = 110.952446 ms, foward_time = 59.804672, backward_time = 50.625538, perf = 7.43 tflops.
STEP-87: step_time = 109.907967 ms, foward_time = 59.328510, backward_time = 50.056190, perf = 7.50 tflops.
STEP-88: step_time = 110.389252 ms, foward_time = 59.357185, backward_time = 50.625538, perf = 7.47 tflops.
STEP-89: step_time = 110.208000 ms, foward_time = 59.387905, backward_time = 50.342911, perf = 7.48 tflops.
STEP-90: step_time = 110.846977 ms, foward_time = 59.478016, backward_time = 50.909184, perf = 7.44 tflops.
STEP-91: step_time = 110.387199 ms, foward_time = 59.206657, backward_time = 50.781185, perf = 7.47 tflops.
STEP-92: step_time = 110.167038 ms, foward_time = 59.308033, backward_time = 50.440193, perf = 7.49 tflops.
STEP-93: step_time = 111.320061 ms, foward_time = 59.973633, backward_time = 50.909184, perf = 7.41 tflops.
STEP-94: step_time = 110.398460 ms, foward_time = 59.133953, backward_time = 50.847744, perf = 7.47 tflops.
STEP-95: step_time = 110.576637 ms, foward_time = 59.360256, backward_time = 50.822144, perf = 7.46 tflops.
STEP-96: step_time = 110.184448 ms, foward_time = 58.875904, backward_time = 50.923519, perf = 7.48 tflops.
STEP-97: step_time = 110.696449 ms, foward_time = 59.644928, backward_time = 50.678783, perf = 7.45 tflops.
STEP-98: step_time = 113.017853 ms, foward_time = 61.749249, backward_time = 50.772991, perf = 7.30 tflops.
STEP-99: step_time = 112.327682 ms, foward_time = 60.264446, backward_time = 51.653633, perf = 7.34 tflops.

 fast_moe 64 [Summary] Average synchronized step_time = 110.72843055725097 ms, forward = 59.583624521891274 , backward = 50.751556396484375 .
[Benchmark] world_size = 4, dtype = float16, model_dim = 1024, hidden_size = 4096, samples = 8192, num_local_experts = 4, topK = 2, a2a_ffn_overlap_degree = 1, device = `cuda:0`
STEP-0: step_time = 1666.763794 ms, foward_time = 1628.049438, backward_time = 37.415936, perf = 0.49 tflops.
STEP-1: step_time = 65.996803 ms, foward_time = 33.761280, backward_time = 31.997952, perf = 12.50 tflops.
STEP-2: step_time = 59.777023 ms, foward_time = 28.774401, backward_time = 30.817280, perf = 13.80 tflops.
STEP-3: step_time = 60.765182 ms, foward_time = 29.763584, backward_time = 30.825472, perf = 13.57 tflops.
STEP-4: step_time = 51.203072 ms, foward_time = 27.281408, backward_time = 23.749632, perf = 16.11 tflops.
STEP-5: step_time = 48.118786 ms, foward_time = 25.096191, backward_time = 22.870016, perf = 17.14 tflops.
STEP-6: step_time = 44.401665 ms, foward_time = 21.679104, backward_time = 22.579201, perf = 18.57 tflops.
STEP-7: step_time = 44.356609 ms, foward_time = 21.650433, backward_time = 22.566912, perf = 18.59 tflops.
STEP-8: step_time = 44.153854 ms, foward_time = 21.524481, backward_time = 22.489088, perf = 18.68 tflops.
STEP-9: step_time = 44.358658 ms, foward_time = 21.665792, backward_time = 22.555649, perf = 18.59 tflops.
STEP-10: step_time = 46.440449 ms, foward_time = 23.430143, backward_time = 22.880257, perf = 17.76 tflops.
STEP-11: step_time = 44.013569 ms, foward_time = 21.475328, backward_time = 22.407167, perf = 18.74 tflops.
STEP-12: step_time = 44.125183 ms, foward_time = 21.423103, backward_time = 22.561792, perf = 18.69 tflops.
STEP-13: step_time = 43.992065 ms, foward_time = 21.386240, backward_time = 22.475777, perf = 18.75 tflops.
STEP-14: step_time = 44.179455 ms, foward_time = 21.353472, backward_time = 22.695936, perf = 18.67 tflops.
STEP-15: step_time = 46.888962 ms, foward_time = 23.724031, backward_time = 23.016447, perf = 17.59 tflops.
STEP-16: step_time = 44.295170 ms, foward_time = 21.642241, backward_time = 22.512640, perf = 18.62 tflops.
STEP-17: step_time = 44.187649 ms, foward_time = 21.463039, backward_time = 22.591488, perf = 18.66 tflops.
STEP-18: step_time = 44.838913 ms, foward_time = 22.124544, backward_time = 22.579201, perf = 18.39 tflops.
STEP-19: step_time = 45.584385 ms, foward_time = 22.519808, backward_time = 22.890495, perf = 18.09 tflops.
STEP-20: step_time = 44.527615 ms, foward_time = 21.475328, backward_time = 22.908928, perf = 18.52 tflops.
STEP-21: step_time = 45.064194 ms, foward_time = 22.281216, backward_time = 22.637568, perf = 18.30 tflops.
STEP-22: step_time = 44.752895 ms, foward_time = 21.798912, backward_time = 22.822912, perf = 18.43 tflops.
STEP-23: step_time = 44.748798 ms, foward_time = 21.913601, backward_time = 22.695936, perf = 18.43 tflops.
STEP-24: step_time = 47.231998 ms, foward_time = 24.491009, backward_time = 22.610945, perf = 17.46 tflops.
STEP-25: step_time = 44.849152 ms, foward_time = 21.915648, backward_time = 22.838272, perf = 18.39 tflops.
STEP-26: step_time = 43.828224 ms, foward_time = 21.035007, backward_time = 22.702080, perf = 18.82 tflops.
STEP-27: step_time = 43.402241 ms, foward_time = 20.666368, backward_time = 22.639616, perf = 19.00 tflops.
STEP-28: step_time = 44.070911 ms, foward_time = 21.319679, backward_time = 22.656000, perf = 18.71 tflops.
STEP-29: step_time = 47.396866 ms, foward_time = 24.239103, backward_time = 22.967297, perf = 17.40 tflops.
STEP-30: step_time = 43.894783 ms, foward_time = 21.078016, backward_time = 22.709248, perf = 18.79 tflops.
STEP-31: step_time = 44.362751 ms, foward_time = 21.359615, backward_time = 22.905855, perf = 18.59 tflops.
STEP-32: step_time = 44.017666 ms, foward_time = 21.389313, backward_time = 22.536192, perf = 18.73 tflops.
STEP-33: step_time = 43.567104 ms, foward_time = 20.816896, backward_time = 22.657024, perf = 18.93 tflops.
STEP-34: step_time = 43.218945 ms, foward_time = 20.562944, backward_time = 22.562817, perf = 19.08 tflops.
STEP-35: step_time = 43.521023 ms, foward_time = 20.595713, backward_time = 22.833153, perf = 18.95 tflops.
STEP-36: step_time = 43.264000 ms, foward_time = 20.543488, backward_time = 22.629375, perf = 19.06 tflops.
STEP-37: step_time = 43.607040 ms, foward_time = 20.904961, backward_time = 22.607872, perf = 18.91 tflops.
STEP-38: step_time = 43.289600 ms, foward_time = 20.682753, backward_time = 22.516735, perf = 19.05 tflops.
STEP-39: step_time = 43.071487 ms, foward_time = 20.297728, backward_time = 22.677504, perf = 19.15 tflops.
STEP-40: step_time = 42.973183 ms, foward_time = 20.436993, backward_time = 22.446079, perf = 19.19 tflops.
STEP-41: step_time = 43.351040 ms, foward_time = 20.676607, backward_time = 22.584320, perf = 19.02 tflops.
STEP-42: step_time = 44.253185 ms, foward_time = 21.345280, backward_time = 22.792192, perf = 18.63 tflops.
STEP-43: step_time = 43.193344 ms, foward_time = 20.376575, backward_time = 22.725632, perf = 19.09 tflops.
STEP-44: step_time = 43.061249 ms, foward_time = 20.391935, backward_time = 22.582272, perf = 19.15 tflops.
STEP-45: step_time = 43.116543 ms, foward_time = 20.464640, backward_time = 22.555649, perf = 19.13 tflops.
STEP-46: step_time = 42.896385 ms, foward_time = 20.442112, backward_time = 22.363136, perf = 19.22 tflops.
STEP-47: step_time = 43.227135 ms, foward_time = 20.493313, backward_time = 22.639616, perf = 19.08 tflops.
STEP-48: step_time = 43.429890 ms, foward_time = 20.575232, backward_time = 22.762497, perf = 18.99 tflops.
STEP-49: step_time = 43.181057 ms, foward_time = 20.385792, backward_time = 22.702080, perf = 19.10 tflops.
STEP-50: step_time = 42.948608 ms, foward_time = 20.423679, backward_time = 22.430719, perf = 19.20 tflops.
STEP-51: step_time = 42.886143 ms, foward_time = 20.408319, backward_time = 22.388737, perf = 19.23 tflops.
STEP-52: step_time = 43.168770 ms, foward_time = 20.517887, backward_time = 22.559744, perf = 19.10 tflops.
STEP-53: step_time = 43.650047 ms, foward_time = 20.538368, backward_time = 23.016447, perf = 18.89 tflops.
STEP-54: step_time = 43.115520 ms, foward_time = 20.512768, backward_time = 22.512640, perf = 19.13 tflops.
STEP-55: step_time = 42.949631 ms, foward_time = 20.390911, backward_time = 22.469631, perf = 19.20 tflops.
STEP-56: step_time = 42.913792 ms, foward_time = 20.407295, backward_time = 22.418432, perf = 19.22 tflops.
STEP-57: step_time = 43.028481 ms, foward_time = 20.370432, backward_time = 22.566912, perf = 19.16 tflops.
STEP-58: step_time = 43.200512 ms, foward_time = 20.424704, backward_time = 22.683647, perf = 19.09 tflops.
STEP-59: step_time = 43.212799 ms, foward_time = 20.398081, backward_time = 22.721537, perf = 19.08 tflops.
STEP-60: step_time = 43.823105 ms, foward_time = 21.114880, backward_time = 22.617088, perf = 18.82 tflops.
STEP-61: step_time = 43.261951 ms, foward_time = 20.612097, backward_time = 22.557695, perf = 19.06 tflops.
STEP-62: step_time = 43.126785 ms, foward_time = 20.474880, backward_time = 22.562817, perf = 19.12 tflops.
STEP-63: step_time = 42.841087 ms, foward_time = 20.260864, backward_time = 22.490112, perf = 19.25 tflops.
STEP-64: step_time = 42.993664 ms, foward_time = 20.371456, backward_time = 22.534143, perf = 19.18 tflops.
STEP-65: step_time = 43.756542 ms, foward_time = 20.541439, backward_time = 23.105536, perf = 18.85 tflops.
STEP-66: step_time = 44.071938 ms, foward_time = 21.409792, backward_time = 22.575104, perf = 18.71 tflops.
STEP-67: step_time = 43.269119 ms, foward_time = 20.583424, backward_time = 22.595585, perf = 19.06 tflops.
STEP-68: step_time = 43.031551 ms, foward_time = 20.447231, backward_time = 22.491137, perf = 19.16 tflops.
STEP-69: step_time = 43.352062 ms, foward_time = 20.663296, backward_time = 22.562817, perf = 19.02 tflops.
STEP-70: step_time = 43.007999 ms, foward_time = 20.416512, backward_time = 22.501375, perf = 19.17 tflops.
STEP-71: step_time = 42.738689 ms, foward_time = 20.339712, backward_time = 22.307840, perf = 19.29 tflops.
STEP-72: step_time = 42.957825 ms, foward_time = 20.576256, backward_time = 22.290432, perf = 19.20 tflops.
STEP-73: step_time = 43.544575 ms, foward_time = 20.927488, backward_time = 22.524927, perf = 18.94 tflops.
STEP-74: step_time = 43.167744 ms, foward_time = 20.580353, backward_time = 22.493183, perf = 19.10 tflops.
STEP-75: step_time = 42.918911 ms, foward_time = 20.362240, backward_time = 22.463488, perf = 19.21 tflops.
STEP-76: step_time = 42.908672 ms, foward_time = 20.418560, backward_time = 22.403072, perf = 19.22 tflops.
STEP-77: step_time = 42.925056 ms, foward_time = 20.384768, backward_time = 22.450176, perf = 19.21 tflops.
STEP-78: step_time = 43.250687 ms, foward_time = 20.610048, backward_time = 22.548479, perf = 19.07 tflops.
STEP-79: step_time = 43.908096 ms, foward_time = 20.471807, backward_time = 23.342079, perf = 18.78 tflops.
STEP-80: step_time = 43.984898 ms, foward_time = 20.868095, backward_time = 23.011328, perf = 18.75 tflops.
STEP-81: step_time = 43.457535 ms, foward_time = 20.800512, backward_time = 22.562817, perf = 18.98 tflops.
STEP-82: step_time = 43.744255 ms, foward_time = 21.187584, backward_time = 22.466560, perf = 18.85 tflops.
STEP-83: step_time = 43.340801 ms, foward_time = 20.519936, backward_time = 22.730753, perf = 19.03 tflops.
STEP-84: step_time = 43.185150 ms, foward_time = 20.377600, backward_time = 22.712320, perf = 19.10 tflops.
STEP-85: step_time = 43.694080 ms, foward_time = 20.988928, backward_time = 22.610945, perf = 18.87 tflops.
STEP-86: step_time = 43.315201 ms, foward_time = 20.558847, backward_time = 22.664192, perf = 19.04 tflops.
STEP-87: step_time = 43.080704 ms, foward_time = 20.401152, backward_time = 22.585344, perf = 19.14 tflops.
STEP-88: step_time = 42.985474 ms, foward_time = 20.433920, backward_time = 22.462463, perf = 19.18 tflops.
STEP-89: step_time = 42.915840 ms, foward_time = 20.323328, backward_time = 22.503424, perf = 19.22 tflops.
STEP-90: step_time = 42.852352 ms, foward_time = 20.345856, backward_time = 22.413313, perf = 19.24 tflops.
STEP-91: step_time = 43.003902 ms, foward_time = 20.378624, backward_time = 22.533119, perf = 19.18 tflops.
STEP-92: step_time = 43.094017 ms, foward_time = 20.444160, backward_time = 22.562817, perf = 19.14 tflops.
STEP-93: step_time = 42.968063 ms, foward_time = 20.421633, backward_time = 22.457344, perf = 19.19 tflops.
STEP-94: step_time = 43.071487 ms, foward_time = 20.468737, backward_time = 22.515713, perf = 19.15 tflops.
STEP-95: step_time = 42.998783 ms, foward_time = 20.376575, backward_time = 22.526976, perf = 19.18 tflops.
STEP-96: step_time = 42.864639 ms, foward_time = 20.340736, backward_time = 22.434816, perf = 19.24 tflops.
STEP-97: step_time = 42.897408 ms, foward_time = 20.325377, backward_time = 22.482944, perf = 19.22 tflops.
STEP-98: step_time = 43.274239 ms, foward_time = 20.632576, backward_time = 22.555649, perf = 19.06 tflops.
STEP-99: step_time = 42.893311 ms, foward_time = 20.417536, backward_time = 22.383615, perf = 19.23 tflops.

 faster_moe 4 [Summary] Average synchronized step_time = 43.203925196329756 ms, forward = 20.535995610555013 , backward = 22.575257619222004 .
[Benchmark] world_size = 4, dtype = float16, model_dim = 1024, hidden_size = 4096, samples = 8192, num_local_experts = 8, topK = 2, a2a_ffn_overlap_degree = 1, device = `cuda:0`
STEP-0: step_time = 1491.450928 ms, foward_time = 1457.411133, backward_time = 33.682430, perf = 0.55 tflops.
STEP-1: step_time = 56.578049 ms, foward_time = 31.172607, backward_time = 25.231359, perf = 14.58 tflops.
STEP-2: step_time = 52.015102 ms, foward_time = 27.161600, backward_time = 24.697857, perf = 15.85 tflops.
STEP-3: step_time = 53.228542 ms, foward_time = 28.134399, backward_time = 24.942593, perf = 15.49 tflops.
STEP-4: step_time = 50.563072 ms, foward_time = 26.654720, backward_time = 23.786495, perf = 16.31 tflops.
STEP-5: step_time = 51.028992 ms, foward_time = 27.164673, backward_time = 23.740416, perf = 16.16 tflops.
STEP-6: step_time = 50.438145 ms, foward_time = 26.701824, backward_time = 23.595009, perf = 16.35 tflops.
STEP-7: step_time = 49.182720 ms, foward_time = 25.482241, backward_time = 23.579647, perf = 16.77 tflops.
STEP-8: step_time = 46.446590 ms, foward_time = 23.673857, backward_time = 22.656000, perf = 17.75 tflops.
STEP-9: step_time = 48.491520 ms, foward_time = 24.583168, backward_time = 23.785473, perf = 17.01 tflops.
STEP-10: step_time = 45.362175 ms, foward_time = 22.723583, backward_time = 22.519808, perf = 18.18 tflops.
STEP-11: step_time = 47.602688 ms, foward_time = 24.660992, backward_time = 22.803455, perf = 17.32 tflops.
STEP-12: step_time = 45.608959 ms, foward_time = 22.986752, backward_time = 22.503424, perf = 18.08 tflops.
STEP-13: step_time = 46.623745 ms, foward_time = 22.749184, backward_time = 23.757824, perf = 17.69 tflops.
STEP-14: step_time = 48.121857 ms, foward_time = 24.817663, backward_time = 23.185408, perf = 17.14 tflops.
STEP-15: step_time = 46.312447 ms, foward_time = 23.645184, backward_time = 22.534143, perf = 17.81 tflops.
STEP-16: step_time = 49.080318 ms, foward_time = 25.293823, backward_time = 23.667711, perf = 16.80 tflops.
STEP-17: step_time = 45.326336 ms, foward_time = 22.759424, backward_time = 22.446079, perf = 18.19 tflops.
STEP-18: step_time = 49.695744 ms, foward_time = 26.888191, backward_time = 22.682625, perf = 16.59 tflops.
STEP-19: step_time = 47.564800 ms, foward_time = 24.631296, backward_time = 22.786049, perf = 17.34 tflops.
STEP-20: step_time = 45.924351 ms, foward_time = 23.300097, backward_time = 22.503424, perf = 17.96 tflops.
STEP-21: step_time = 46.008320 ms, foward_time = 23.324673, backward_time = 22.563841, perf = 17.92 tflops.
STEP-22: step_time = 46.163967 ms, foward_time = 23.368704, backward_time = 22.683647, perf = 17.86 tflops.
STEP-23: step_time = 46.288895 ms, foward_time = 23.596031, backward_time = 22.575104, perf = 17.81 tflops.
STEP-24: step_time = 44.746754 ms, foward_time = 22.140928, backward_time = 22.495232, perf = 18.43 tflops.
STEP-25: step_time = 45.834240 ms, foward_time = 22.609921, backward_time = 23.110657, perf = 17.99 tflops.
STEP-26: step_time = 44.783615 ms, foward_time = 22.196224, backward_time = 22.470655, perf = 18.41 tflops.
STEP-27: step_time = 44.957695 ms, foward_time = 22.331392, backward_time = 22.497280, perf = 18.34 tflops.
STEP-28: step_time = 44.758015 ms, foward_time = 21.971968, backward_time = 22.676479, perf = 18.42 tflops.
STEP-29: step_time = 47.336449 ms, foward_time = 23.868416, backward_time = 23.355392, perf = 17.42 tflops.
STEP-30: step_time = 44.945408 ms, foward_time = 22.202368, backward_time = 22.610945, perf = 18.35 tflops.
STEP-31: step_time = 44.731392 ms, foward_time = 22.246401, backward_time = 22.359039, perf = 18.44 tflops.
STEP-32: step_time = 46.272511 ms, foward_time = 23.556095, backward_time = 22.598656, perf = 17.82 tflops.
STEP-33: step_time = 44.755966 ms, foward_time = 22.102016, backward_time = 22.529024, perf = 18.43 tflops.
STEP-34: step_time = 46.024704 ms, foward_time = 22.113279, backward_time = 23.797760, perf = 17.92 tflops.
STEP-35: step_time = 45.737984 ms, foward_time = 22.859776, backward_time = 22.767616, perf = 18.03 tflops.
STEP-36: step_time = 44.940289 ms, foward_time = 22.396929, backward_time = 22.432768, perf = 18.35 tflops.
STEP-37: step_time = 44.702721 ms, foward_time = 22.145023, backward_time = 22.447104, perf = 18.45 tflops.
STEP-38: step_time = 47.578114 ms, foward_time = 24.863745, backward_time = 22.594561, perf = 17.33 tflops.
STEP-39: step_time = 44.924927 ms, foward_time = 22.159361, backward_time = 22.658049, perf = 18.36 tflops.
STEP-40: step_time = 44.859390 ms, foward_time = 22.270975, backward_time = 22.477823, perf = 18.38 tflops.
STEP-41: step_time = 44.812286 ms, foward_time = 22.179840, backward_time = 22.523905, perf = 18.40 tflops.
STEP-42: step_time = 44.707840 ms, foward_time = 22.091776, backward_time = 22.511616, perf = 18.44 tflops.
STEP-43: step_time = 45.000706 ms, foward_time = 22.432768, backward_time = 22.386688, perf = 18.32 tflops.
STEP-44: step_time = 44.734463 ms, foward_time = 22.136831, backward_time = 22.482944, perf = 18.43 tflops.
STEP-45: step_time = 44.823551 ms, foward_time = 22.096895, backward_time = 22.615040, perf = 18.40 tflops.
STEP-46: step_time = 44.733440 ms, foward_time = 22.108160, backward_time = 22.515713, perf = 18.43 tflops.
STEP-47: step_time = 45.836288 ms, foward_time = 23.205889, backward_time = 22.361088, perf = 17.99 tflops.
STEP-48: step_time = 45.359104 ms, foward_time = 22.584320, backward_time = 22.633472, perf = 18.18 tflops.
STEP-49: step_time = 44.907520 ms, foward_time = 22.168575, backward_time = 22.601728, perf = 18.36 tflops.
STEP-50: step_time = 44.893185 ms, foward_time = 22.064129, backward_time = 22.696960, perf = 18.37 tflops.
STEP-51: step_time = 45.415424 ms, foward_time = 22.754305, backward_time = 22.525951, perf = 18.16 tflops.
STEP-52: step_time = 45.412354 ms, foward_time = 22.600704, backward_time = 22.675455, perf = 18.16 tflops.
STEP-53: step_time = 44.776447 ms, foward_time = 22.180864, backward_time = 22.460417, perf = 18.42 tflops.
STEP-54: step_time = 44.652542 ms, foward_time = 22.026239, backward_time = 22.497280, perf = 18.47 tflops.
STEP-55: step_time = 44.808193 ms, foward_time = 22.131712, backward_time = 22.543360, perf = 18.40 tflops.
STEP-56: step_time = 44.653568 ms, foward_time = 22.014977, backward_time = 22.505472, perf = 18.47 tflops.
STEP-57: step_time = 44.669952 ms, foward_time = 21.954559, backward_time = 22.584320, perf = 18.46 tflops.
STEP-58: step_time = 46.295040 ms, foward_time = 22.078465, backward_time = 24.097792, perf = 17.81 tflops.
STEP-59: step_time = 46.093311 ms, foward_time = 22.060032, backward_time = 23.882751, perf = 17.89 tflops.
STEP-60: step_time = 44.620800 ms, foward_time = 22.089727, backward_time = 22.405121, perf = 18.48 tflops.
STEP-61: step_time = 44.670975 ms, foward_time = 22.095873, backward_time = 22.450176, perf = 18.46 tflops.
STEP-62: step_time = 44.749825 ms, foward_time = 22.161407, backward_time = 22.459393, perf = 18.43 tflops.
STEP-63: step_time = 44.610561 ms, foward_time = 22.054913, backward_time = 22.423552, perf = 18.49 tflops.
STEP-64: step_time = 44.717056 ms, foward_time = 21.931007, backward_time = 22.656000, perf = 18.44 tflops.
STEP-65: step_time = 46.208000 ms, foward_time = 22.976513, backward_time = 23.100416, perf = 17.85 tflops.
STEP-66: step_time = 45.332481 ms, foward_time = 22.371328, backward_time = 22.829056, perf = 18.19 tflops.
STEP-67: step_time = 44.878849 ms, foward_time = 21.991425, backward_time = 22.757376, perf = 18.37 tflops.
STEP-68: step_time = 44.932095 ms, foward_time = 21.994495, backward_time = 22.809601, perf = 18.35 tflops.
STEP-69: step_time = 46.671871 ms, foward_time = 22.268929, backward_time = 24.268801, perf = 17.67 tflops.
STEP-70: step_time = 44.791809 ms, foward_time = 22.103041, backward_time = 22.559744, perf = 18.41 tflops.
STEP-71: step_time = 44.957695 ms, foward_time = 22.220800, backward_time = 22.607872, perf = 18.34 tflops.
STEP-72: step_time = 44.836864 ms, foward_time = 22.079489, backward_time = 22.630400, perf = 18.39 tflops.
STEP-73: step_time = 44.942337 ms, foward_time = 22.134785, backward_time = 22.673409, perf = 18.35 tflops.
STEP-74: step_time = 45.035519 ms, foward_time = 22.248447, backward_time = 22.657024, perf = 18.31 tflops.
STEP-75: step_time = 44.756992 ms, foward_time = 22.165504, backward_time = 22.462463, perf = 18.42 tflops.
STEP-76: step_time = 45.516800 ms, foward_time = 22.980608, backward_time = 22.405121, perf = 18.12 tflops.
STEP-77: step_time = 44.598270 ms, foward_time = 21.968897, backward_time = 22.483969, perf = 18.49 tflops.
STEP-78: step_time = 44.803074 ms, foward_time = 22.164480, backward_time = 22.507521, perf = 18.41 tflops.
STEP-79: step_time = 44.817410 ms, foward_time = 22.149120, backward_time = 22.534143, perf = 18.40 tflops.
STEP-80: step_time = 46.322689 ms, foward_time = 22.841345, backward_time = 23.349249, perf = 17.80 tflops.
STEP-81: step_time = 44.688385 ms, foward_time = 22.123520, backward_time = 22.436865, perf = 18.45 tflops.
STEP-82: step_time = 47.569920 ms, foward_time = 25.029633, backward_time = 22.411264, perf = 17.34 tflops.
STEP-83: step_time = 44.739586 ms, foward_time = 22.078465, backward_time = 22.545408, perf = 18.43 tflops.
STEP-84: step_time = 44.645374 ms, foward_time = 22.029312, backward_time = 22.490112, perf = 18.47 tflops.
STEP-85: step_time = 45.558784 ms, foward_time = 22.914047, backward_time = 22.516735, perf = 18.10 tflops.
STEP-86: step_time = 45.202431 ms, foward_time = 22.683647, backward_time = 22.390783, perf = 18.24 tflops.
STEP-87: step_time = 45.199360 ms, foward_time = 22.336512, backward_time = 22.744064, perf = 18.24 tflops.
STEP-88: step_time = 44.796928 ms, foward_time = 22.094849, backward_time = 22.573055, perf = 18.41 tflops.
STEP-89: step_time = 44.938240 ms, foward_time = 22.193151, backward_time = 22.610945, perf = 18.35 tflops.
STEP-90: step_time = 44.723202 ms, foward_time = 22.029312, backward_time = 22.562817, perf = 18.44 tflops.
STEP-91: step_time = 45.535233 ms, foward_time = 21.962751, backward_time = 23.446527, perf = 18.11 tflops.
STEP-92: step_time = 44.771328 ms, foward_time = 22.073343, backward_time = 22.572033, perf = 18.42 tflops.
STEP-93: step_time = 44.821503 ms, foward_time = 22.022144, backward_time = 22.670336, perf = 18.40 tflops.
STEP-94: step_time = 44.822529 ms, foward_time = 22.048767, backward_time = 22.644735, perf = 18.40 tflops.
STEP-95: step_time = 44.928001 ms, foward_time = 22.083584, backward_time = 22.712320, perf = 18.35 tflops.
STEP-96: step_time = 44.529663 ms, foward_time = 22.018047, backward_time = 22.383615, perf = 18.52 tflops.
STEP-97: step_time = 44.710911 ms, foward_time = 22.078465, backward_time = 22.500353, perf = 18.44 tflops.
STEP-98: step_time = 45.773823 ms, foward_time = 23.223295, backward_time = 22.419456, perf = 18.02 tflops.
STEP-99: step_time = 45.758465 ms, foward_time = 23.030785, backward_time = 22.596607, perf = 18.02 tflops.

 faster_moe 8 [Summary] Average synchronized step_time = 45.09883740743001 ms, forward = 22.303129641215005 , backward = 22.66397024790446 .
[Benchmark] world_size = 4, dtype = float16, model_dim = 1024, hidden_size = 4096, samples = 8192, num_local_experts = 16, topK = 2, a2a_ffn_overlap_degree = 1, device = `cuda:0`
STEP-0: step_time = 1577.130981 ms, foward_time = 1536.323608, backward_time = 39.907330, perf = 0.52 tflops.
STEP-1: step_time = 69.072899 ms, foward_time = 36.044800, backward_time = 32.859135, perf = 11.94 tflops.
STEP-2: step_time = 59.147263 ms, foward_time = 30.545919, backward_time = 28.437504, perf = 13.94 tflops.
STEP-3: step_time = 57.782272 ms, foward_time = 29.657087, backward_time = 27.986944, perf = 14.27 tflops.
STEP-4: step_time = 56.486912 ms, foward_time = 28.498943, backward_time = 27.849728, perf = 14.60 tflops.
STEP-5: step_time = 59.340801 ms, foward_time = 31.370239, backward_time = 27.842560, perf = 13.90 tflops.
STEP-6: step_time = 54.707199 ms, foward_time = 28.129280, backward_time = 26.465281, perf = 15.07 tflops.
STEP-7: step_time = 56.651775 ms, foward_time = 29.910015, backward_time = 26.608641, perf = 14.56 tflops.
STEP-8: step_time = 55.347198 ms, foward_time = 28.139521, backward_time = 27.094015, perf = 14.90 tflops.
STEP-9: step_time = 58.177536 ms, foward_time = 31.158272, backward_time = 26.883072, perf = 14.17 tflops.
STEP-10: step_time = 55.112705 ms, foward_time = 28.433409, backward_time = 26.566656, perf = 14.96 tflops.
STEP-11: step_time = 56.157185 ms, foward_time = 29.398016, backward_time = 26.641409, perf = 14.68 tflops.
STEP-12: step_time = 61.408257 ms, foward_time = 33.370113, backward_time = 27.898880, perf = 13.43 tflops.
STEP-13: step_time = 56.611839 ms, foward_time = 29.703169, backward_time = 26.782721, perf = 14.57 tflops.
STEP-14: step_time = 55.063553 ms, foward_time = 28.062719, backward_time = 26.890240, perf = 14.98 tflops.
STEP-15: step_time = 56.128513 ms, foward_time = 28.717056, backward_time = 27.299841, perf = 14.69 tflops.
STEP-16: step_time = 57.121792 ms, foward_time = 30.287872, backward_time = 26.692608, perf = 14.44 tflops.
STEP-17: step_time = 54.562817 ms, foward_time = 28.160000, backward_time = 26.292225, perf = 15.11 tflops.
STEP-18: step_time = 54.746113 ms, foward_time = 27.981825, backward_time = 26.652672, perf = 15.06 tflops.
STEP-19: step_time = 55.272449 ms, foward_time = 28.384256, backward_time = 26.763264, perf = 14.92 tflops.
STEP-20: step_time = 61.047810 ms, foward_time = 33.214462, backward_time = 27.724800, perf = 13.51 tflops.
STEP-21: step_time = 55.110657 ms, foward_time = 28.158976, backward_time = 26.827776, perf = 14.96 tflops.
STEP-22: step_time = 58.552319 ms, foward_time = 29.515776, backward_time = 28.922880, perf = 14.08 tflops.
STEP-23: step_time = 59.716606 ms, foward_time = 32.666622, backward_time = 26.923008, perf = 13.81 tflops.
STEP-24: step_time = 55.001087 ms, foward_time = 27.950081, backward_time = 26.940416, perf = 14.99 tflops.
STEP-25: step_time = 54.747135 ms, foward_time = 28.097536, backward_time = 26.539007, perf = 15.06 tflops.
STEP-26: step_time = 55.284737 ms, foward_time = 28.480513, backward_time = 26.679296, perf = 14.92 tflops.
STEP-27: step_time = 62.740479 ms, foward_time = 34.611198, backward_time = 28.005377, perf = 13.14 tflops.
STEP-28: step_time = 59.870209 ms, foward_time = 31.759359, backward_time = 27.991039, perf = 13.77 tflops.
STEP-29: step_time = 58.086399 ms, foward_time = 31.115265, backward_time = 26.860544, perf = 14.20 tflops.
STEP-30: step_time = 59.619328 ms, foward_time = 32.611328, backward_time = 26.810368, perf = 13.83 tflops.
STEP-31: step_time = 56.370174 ms, foward_time = 29.571072, backward_time = 26.671104, perf = 14.63 tflops.
STEP-32: step_time = 56.572929 ms, foward_time = 29.680639, backward_time = 26.778624, perf = 14.58 tflops.
STEP-33: step_time = 55.199745 ms, foward_time = 28.721151, backward_time = 26.363905, perf = 14.94 tflops.
STEP-34: step_time = 55.866367 ms, foward_time = 28.943359, backward_time = 26.734592, perf = 14.76 tflops.
STEP-35: step_time = 57.605122 ms, foward_time = 30.714880, backward_time = 26.743809, perf = 14.32 tflops.
STEP-36: step_time = 55.890945 ms, foward_time = 29.155329, backward_time = 26.587135, perf = 14.75 tflops.
STEP-37: step_time = 55.431168 ms, foward_time = 28.388351, backward_time = 26.872831, perf = 14.88 tflops.
STEP-38: step_time = 55.561214 ms, foward_time = 28.268543, backward_time = 27.174911, perf = 14.84 tflops.
STEP-39: step_time = 57.114624 ms, foward_time = 30.032896, backward_time = 26.959871, perf = 14.44 tflops.
STEP-40: step_time = 56.420353 ms, foward_time = 29.241344, backward_time = 27.061249, perf = 14.62 tflops.
STEP-41: step_time = 55.280640 ms, foward_time = 28.298241, backward_time = 26.859520, perf = 14.92 tflops.
STEP-42: step_time = 55.865345 ms, foward_time = 29.134848, backward_time = 26.612736, perf = 14.76 tflops.
STEP-43: step_time = 56.359936 ms, foward_time = 28.188671, backward_time = 28.050432, perf = 14.63 tflops.
STEP-44: step_time = 54.963200 ms, foward_time = 28.230656, backward_time = 26.612736, perf = 15.00 tflops.
STEP-45: step_time = 56.399872 ms, foward_time = 29.210625, backward_time = 27.060225, perf = 14.62 tflops.
STEP-46: step_time = 55.444481 ms, foward_time = 28.733440, backward_time = 26.600449, perf = 14.87 tflops.
STEP-47: step_time = 55.323647 ms, foward_time = 28.552193, backward_time = 26.652672, perf = 14.91 tflops.
STEP-48: step_time = 55.332863 ms, foward_time = 28.234753, backward_time = 26.978304, perf = 14.90 tflops.
STEP-49: step_time = 56.248322 ms, foward_time = 29.310976, backward_time = 26.812416, perf = 14.66 tflops.
STEP-50: step_time = 56.538113 ms, foward_time = 29.218817, backward_time = 27.200512, perf = 14.59 tflops.
STEP-51: step_time = 55.717888 ms, foward_time = 28.557312, backward_time = 27.038719, perf = 14.80 tflops.
STEP-52: step_time = 55.455746 ms, foward_time = 28.528641, backward_time = 26.803200, perf = 14.87 tflops.
STEP-53: step_time = 54.890495 ms, foward_time = 28.142591, backward_time = 26.626047, perf = 15.02 tflops.
STEP-54: step_time = 55.929855 ms, foward_time = 29.005823, backward_time = 26.805248, perf = 14.74 tflops.
STEP-55: step_time = 56.437759 ms, foward_time = 28.180479, backward_time = 28.136448, perf = 14.61 tflops.
STEP-56: step_time = 55.991295 ms, foward_time = 28.891136, backward_time = 26.981377, perf = 14.73 tflops.
STEP-57: step_time = 55.023617 ms, foward_time = 28.309504, backward_time = 26.594303, perf = 14.99 tflops.
STEP-58: step_time = 55.420929 ms, foward_time = 28.504065, backward_time = 26.796032, perf = 14.88 tflops.
STEP-59: step_time = 55.152641 ms, foward_time = 28.267521, backward_time = 26.769407, perf = 14.95 tflops.
STEP-60: step_time = 55.677952 ms, foward_time = 28.865536, backward_time = 26.691584, perf = 14.81 tflops.
STEP-61: step_time = 55.333889 ms, foward_time = 28.292095, backward_time = 26.924032, perf = 14.90 tflops.
STEP-62: step_time = 55.042049 ms, foward_time = 28.188671, backward_time = 26.736641, perf = 14.98 tflops.
STEP-63: step_time = 55.265282 ms, foward_time = 28.491776, backward_time = 26.650623, perf = 14.92 tflops.
STEP-64: step_time = 55.516159 ms, foward_time = 28.711937, backward_time = 26.683392, perf = 14.85 tflops.
STEP-65: step_time = 56.253441 ms, foward_time = 28.322817, backward_time = 27.811840, perf = 14.66 tflops.
STEP-66: step_time = 56.095745 ms, foward_time = 29.277184, backward_time = 26.699776, perf = 14.70 tflops.
STEP-67: step_time = 55.304192 ms, foward_time = 28.430336, backward_time = 26.752001, perf = 14.91 tflops.
STEP-68: step_time = 56.092670 ms, foward_time = 28.268543, backward_time = 27.686913, perf = 14.70 tflops.
STEP-69: step_time = 55.830528 ms, foward_time = 28.957697, backward_time = 26.726400, perf = 14.77 tflops.
STEP-70: step_time = 55.258114 ms, foward_time = 28.292095, backward_time = 26.849279, perf = 14.92 tflops.
STEP-71: step_time = 56.975361 ms, foward_time = 30.050304, backward_time = 26.808319, perf = 14.47 tflops.
STEP-72: step_time = 56.813568 ms, foward_time = 28.732416, backward_time = 27.963392, perf = 14.51 tflops.
STEP-73: step_time = 55.711742 ms, foward_time = 28.432384, backward_time = 27.158527, perf = 14.80 tflops.
STEP-74: step_time = 56.565762 ms, foward_time = 28.369921, backward_time = 28.081152, perf = 14.58 tflops.
STEP-75: step_time = 57.290752 ms, foward_time = 30.470144, backward_time = 26.700800, perf = 14.39 tflops.
STEP-76: step_time = 56.762367 ms, foward_time = 29.609983, backward_time = 27.032576, perf = 14.53 tflops.
STEP-77: step_time = 55.410686 ms, foward_time = 28.648449, backward_time = 26.639360, perf = 14.88 tflops.
STEP-78: step_time = 55.022591 ms, foward_time = 28.164097, backward_time = 26.750977, perf = 14.99 tflops.
STEP-79: step_time = 55.946239 ms, foward_time = 28.772352, backward_time = 27.001856, perf = 14.74 tflops.
STEP-80: step_time = 55.769089 ms, foward_time = 28.858368, backward_time = 26.787840, perf = 14.79 tflops.
STEP-81: step_time = 56.826881 ms, foward_time = 28.474367, backward_time = 28.221439, perf = 14.51 tflops.
STEP-82: step_time = 55.249920 ms, foward_time = 28.211201, backward_time = 26.918913, perf = 14.93 tflops.
STEP-83: step_time = 55.544830 ms, foward_time = 28.440577, backward_time = 26.984447, perf = 14.85 tflops.
STEP-84: step_time = 55.350273 ms, foward_time = 28.368896, backward_time = 26.860544, perf = 14.90 tflops.
STEP-85: step_time = 55.211006 ms, foward_time = 28.393473, backward_time = 26.692608, perf = 14.94 tflops.
STEP-86: step_time = 56.641537 ms, foward_time = 29.060097, backward_time = 27.460608, perf = 14.56 tflops.
STEP-87: step_time = 55.501823 ms, foward_time = 28.500992, backward_time = 26.875904, perf = 14.86 tflops.
STEP-88: step_time = 55.325695 ms, foward_time = 28.386305, backward_time = 26.790913, perf = 14.91 tflops.
STEP-89: step_time = 55.966721 ms, foward_time = 29.011969, backward_time = 26.827776, perf = 14.73 tflops.
STEP-90: step_time = 55.415810 ms, foward_time = 28.465153, backward_time = 26.827776, perf = 14.88 tflops.
STEP-91: step_time = 55.283710 ms, foward_time = 28.344320, backward_time = 26.772480, perf = 14.92 tflops.
STEP-92: step_time = 55.477249 ms, foward_time = 28.339199, backward_time = 27.009024, perf = 14.86 tflops.
STEP-93: step_time = 57.976833 ms, foward_time = 30.624767, backward_time = 27.226112, perf = 14.22 tflops.
STEP-94: step_time = 55.746559 ms, foward_time = 28.893185, backward_time = 26.730495, perf = 14.79 tflops.
STEP-95: step_time = 56.254463 ms, foward_time = 28.184576, backward_time = 27.949057, perf = 14.66 tflops.
STEP-96: step_time = 55.255039 ms, foward_time = 28.006399, backward_time = 27.127808, perf = 14.92 tflops.
STEP-97: step_time = 56.222721 ms, foward_time = 28.874752, backward_time = 27.210752, perf = 14.67 tflops.
STEP-98: step_time = 55.970818 ms, foward_time = 28.141567, backward_time = 27.705343, perf = 14.73 tflops.
STEP-99: step_time = 55.230465 ms, foward_time = 28.328960, backward_time = 26.778624, perf = 14.93 tflops.

 faster_moe 16 [Summary] Average synchronized step_time = 55.809792137146 ms, forward = 28.666658242543537 , backward = 27.019332218170167 .
[Benchmark] world_size = 4, dtype = float16, model_dim = 1024, hidden_size = 4096, samples = 8192, num_local_experts = 32, topK = 2, a2a_ffn_overlap_degree = 1, device = `cuda:0`
STEP-0: step_time = 1486.786499 ms, foward_time = 1443.195923, backward_time = 42.697727, perf = 0.55 tflops.
STEP-1: step_time = 76.422142 ms, foward_time = 40.166401, backward_time = 36.009983, perf = 10.79 tflops.
STEP-2: step_time = 72.297470 ms, foward_time = 37.156864, backward_time = 34.874367, perf = 11.41 tflops.
STEP-3: step_time = 68.019203 ms, foward_time = 37.381119, backward_time = 30.385153, perf = 12.12 tflops.
STEP-4: step_time = 65.741821 ms, foward_time = 34.442242, backward_time = 31.053823, perf = 12.54 tflops.
STEP-5: step_time = 66.226173 ms, foward_time = 34.247681, backward_time = 31.743999, perf = 12.45 tflops.
STEP-6: step_time = 64.792580 ms, foward_time = 34.582527, backward_time = 29.946880, perf = 12.73 tflops.
STEP-7: step_time = 64.705536 ms, foward_time = 34.571262, backward_time = 29.886463, perf = 12.74 tflops.
STEP-8: step_time = 64.916481 ms, foward_time = 34.377728, backward_time = 30.301184, perf = 12.70 tflops.
STEP-9: step_time = 64.582657 ms, foward_time = 34.084866, backward_time = 30.257153, perf = 12.77 tflops.
STEP-10: step_time = 64.190460 ms, foward_time = 34.013184, backward_time = 29.939713, perf = 12.85 tflops.
STEP-11: step_time = 61.703167 ms, foward_time = 31.301632, backward_time = 30.240768, perf = 13.36 tflops.
STEP-12: step_time = 62.489601 ms, foward_time = 32.045055, backward_time = 30.281729, perf = 13.20 tflops.
STEP-13: step_time = 61.333504 ms, foward_time = 31.178753, backward_time = 29.989887, perf = 13.45 tflops.
STEP-14: step_time = 61.159424 ms, foward_time = 31.213568, backward_time = 29.790209, perf = 13.48 tflops.
STEP-15: step_time = 61.213696 ms, foward_time = 31.197184, backward_time = 29.856768, perf = 13.47 tflops.
STEP-16: step_time = 63.130623 ms, foward_time = 32.829441, backward_time = 30.130177, perf = 13.06 tflops.
STEP-17: step_time = 62.462975 ms, foward_time = 31.815680, backward_time = 30.488577, perf = 13.20 tflops.
STEP-18: step_time = 62.451714 ms, foward_time = 32.207870, backward_time = 30.086143, perf = 13.20 tflops.
STEP-19: step_time = 62.356480 ms, foward_time = 31.787008, backward_time = 30.408705, perf = 13.22 tflops.
STEP-20: step_time = 62.672897 ms, foward_time = 32.453632, backward_time = 30.063616, perf = 13.16 tflops.
STEP-21: step_time = 64.596992 ms, foward_time = 33.993729, backward_time = 30.411776, perf = 12.77 tflops.
STEP-22: step_time = 63.647743 ms, foward_time = 33.351681, backward_time = 30.094336, perf = 12.96 tflops.
STEP-23: step_time = 63.726593 ms, foward_time = 33.359871, backward_time = 30.155775, perf = 12.94 tflops.
STEP-24: step_time = 62.053375 ms, foward_time = 31.672319, backward_time = 30.228479, perf = 13.29 tflops.
STEP-25: step_time = 61.917183 ms, foward_time = 31.634432, backward_time = 30.121984, perf = 13.32 tflops.
STEP-26: step_time = 61.931519 ms, foward_time = 31.672319, backward_time = 30.100479, perf = 13.32 tflops.
STEP-27: step_time = 62.469120 ms, foward_time = 31.767551, backward_time = 30.542849, perf = 13.20 tflops.
STEP-28: step_time = 62.210049 ms, foward_time = 31.713280, backward_time = 30.336000, perf = 13.26 tflops.
STEP-29: step_time = 62.479359 ms, foward_time = 32.015362, backward_time = 30.294016, perf = 13.20 tflops.
STEP-30: step_time = 64.456703 ms, foward_time = 34.059265, backward_time = 30.238720, perf = 12.79 tflops.
STEP-31: step_time = 65.620995 ms, foward_time = 33.982464, backward_time = 31.444992, perf = 12.57 tflops.
STEP-32: step_time = 64.604156 ms, foward_time = 32.689152, backward_time = 31.762432, perf = 12.76 tflops.
STEP-33: step_time = 64.050179 ms, foward_time = 33.229824, backward_time = 30.640127, perf = 12.87 tflops.
STEP-34: step_time = 63.195137 ms, foward_time = 32.178177, backward_time = 30.861313, perf = 13.05 tflops.
STEP-35: step_time = 64.447487 ms, foward_time = 33.419266, backward_time = 30.857216, perf = 12.80 tflops.
STEP-36: step_time = 62.589951 ms, foward_time = 31.974400, backward_time = 30.452736, perf = 13.18 tflops.
STEP-37: step_time = 61.942783 ms, foward_time = 31.538176, backward_time = 30.240768, perf = 13.31 tflops.
STEP-38: step_time = 62.226433 ms, foward_time = 31.772673, backward_time = 30.292992, perf = 13.25 tflops.
STEP-39: step_time = 64.249855 ms, foward_time = 33.901569, backward_time = 30.192640, perf = 12.83 tflops.
STEP-40: step_time = 62.315521 ms, foward_time = 31.907841, backward_time = 30.255104, perf = 13.23 tflops.
STEP-41: step_time = 61.746178 ms, foward_time = 31.458303, backward_time = 30.120960, perf = 13.36 tflops.
STEP-42: step_time = 63.613953 ms, foward_time = 31.443968, backward_time = 32.020481, perf = 12.96 tflops.
STEP-43: step_time = 61.824001 ms, foward_time = 31.534081, backward_time = 30.136320, perf = 13.34 tflops.
STEP-44: step_time = 62.618626 ms, foward_time = 30.919680, backward_time = 31.544319, perf = 13.17 tflops.
STEP-45: step_time = 63.175678 ms, foward_time = 31.643648, backward_time = 31.356928, perf = 13.05 tflops.
STEP-46: step_time = 61.518848 ms, foward_time = 31.260672, backward_time = 30.097408, perf = 13.40 tflops.
STEP-47: step_time = 62.938110 ms, foward_time = 31.900673, backward_time = 30.856192, perf = 13.10 tflops.
STEP-48: step_time = 62.614529 ms, foward_time = 31.949823, backward_time = 30.495745, perf = 13.17 tflops.
STEP-49: step_time = 63.380482 ms, foward_time = 33.074177, backward_time = 30.124031, perf = 13.01 tflops.
STEP-50: step_time = 64.310272 ms, foward_time = 33.587200, backward_time = 30.536703, perf = 12.82 tflops.
STEP-51: step_time = 62.658562 ms, foward_time = 31.975424, backward_time = 30.515200, perf = 13.16 tflops.
STEP-52: step_time = 64.485374 ms, foward_time = 33.769470, backward_time = 30.538752, perf = 12.79 tflops.
STEP-53: step_time = 64.146431 ms, foward_time = 33.388542, backward_time = 30.602240, perf = 12.86 tflops.
STEP-54: step_time = 61.954048 ms, foward_time = 31.789057, backward_time = 29.991936, perf = 13.31 tflops.
STEP-55: step_time = 63.587330 ms, foward_time = 31.027201, backward_time = 32.405502, perf = 12.97 tflops.
STEP-56: step_time = 63.419392 ms, foward_time = 33.053696, backward_time = 30.076927, perf = 13.00 tflops.
STEP-57: step_time = 60.962814 ms, foward_time = 30.751743, backward_time = 30.054399, perf = 13.53 tflops.
STEP-58: step_time = 63.576065 ms, foward_time = 33.113087, backward_time = 30.266369, perf = 12.97 tflops.
STEP-59: step_time = 64.075775 ms, foward_time = 33.366016, backward_time = 30.511105, perf = 12.87 tflops.
STEP-60: step_time = 65.152000 ms, foward_time = 34.997250, backward_time = 29.943808, perf = 12.66 tflops.
STEP-61: step_time = 62.835712 ms, foward_time = 32.684032, backward_time = 29.960192, perf = 13.12 tflops.
STEP-62: step_time = 62.633984 ms, foward_time = 32.621567, backward_time = 29.852673, perf = 13.17 tflops.
STEP-63: step_time = 64.555008 ms, foward_time = 34.168831, backward_time = 30.136320, perf = 12.77 tflops.
STEP-64: step_time = 64.082947 ms, foward_time = 33.772545, backward_time = 30.127104, perf = 12.87 tflops.
STEP-65: step_time = 61.877247 ms, foward_time = 31.070208, backward_time = 30.643200, perf = 13.33 tflops.
STEP-66: step_time = 61.404160 ms, foward_time = 30.675968, backward_time = 30.570496, perf = 13.43 tflops.
STEP-67: step_time = 62.253056 ms, foward_time = 32.173058, backward_time = 29.889536, perf = 13.25 tflops.
STEP-68: step_time = 61.349888 ms, foward_time = 31.008768, backward_time = 30.192640, perf = 13.44 tflops.
STEP-69: step_time = 61.167618 ms, foward_time = 30.963713, backward_time = 30.050304, perf = 13.48 tflops.
STEP-70: step_time = 62.793728 ms, foward_time = 32.753662, backward_time = 29.879295, perf = 13.13 tflops.
STEP-71: step_time = 62.009342 ms, foward_time = 31.810560, backward_time = 30.046207, perf = 13.30 tflops.
STEP-72: step_time = 62.076927 ms, foward_time = 32.101376, backward_time = 29.820929, perf = 13.28 tflops.
STEP-73: step_time = 60.929024 ms, foward_time = 30.896128, backward_time = 29.862911, perf = 13.53 tflops.
STEP-74: step_time = 62.354431 ms, foward_time = 32.260098, backward_time = 29.944832, perf = 13.22 tflops.
STEP-75: step_time = 61.817856 ms, foward_time = 31.613953, backward_time = 30.048256, perf = 13.34 tflops.
STEP-76: step_time = 62.078976 ms, foward_time = 31.830015, backward_time = 30.082048, perf = 13.28 tflops.
STEP-77: step_time = 61.089790 ms, foward_time = 30.992384, backward_time = 29.921280, perf = 13.50 tflops.
STEP-78: step_time = 61.143040 ms, foward_time = 31.233025, backward_time = 29.754368, perf = 13.49 tflops.
STEP-79: step_time = 61.206528 ms, foward_time = 30.613504, backward_time = 30.416897, perf = 13.47 tflops.
STEP-80: step_time = 60.751873 ms, foward_time = 30.726145, backward_time = 29.868032, perf = 13.57 tflops.
STEP-81: step_time = 61.018112 ms, foward_time = 30.670849, backward_time = 30.178305, perf = 13.51 tflops.
STEP-82: step_time = 61.270016 ms, foward_time = 31.222784, backward_time = 29.889536, perf = 13.46 tflops.
STEP-83: step_time = 61.860863 ms, foward_time = 31.191040, backward_time = 30.516224, perf = 13.33 tflops.
STEP-84: step_time = 62.451714 ms, foward_time = 32.043007, backward_time = 30.242817, perf = 13.20 tflops.
STEP-85: step_time = 62.285824 ms, foward_time = 32.003071, backward_time = 30.134272, perf = 13.24 tflops.
STEP-86: step_time = 62.486526 ms, foward_time = 32.151550, backward_time = 30.185472, perf = 13.20 tflops.
STEP-87: step_time = 61.554688 ms, foward_time = 31.286272, backward_time = 30.119936, perf = 13.40 tflops.
STEP-88: step_time = 62.724094 ms, foward_time = 31.319040, backward_time = 31.240192, perf = 13.15 tflops.
STEP-89: step_time = 63.174656 ms, foward_time = 32.673794, backward_time = 30.346239, perf = 13.05 tflops.
STEP-90: step_time = 62.870529 ms, foward_time = 32.436226, backward_time = 30.266369, perf = 13.12 tflops.
STEP-91: step_time = 61.957119 ms, foward_time = 31.415297, backward_time = 30.371840, perf = 13.31 tflops.
STEP-92: step_time = 61.916161 ms, foward_time = 31.453184, backward_time = 30.271488, perf = 13.32 tflops.
STEP-93: step_time = 62.776321 ms, foward_time = 32.662529, backward_time = 29.940737, perf = 13.14 tflops.
STEP-94: step_time = 61.252609 ms, foward_time = 31.007744, backward_time = 30.071808, perf = 13.46 tflops.
STEP-95: step_time = 63.065086 ms, foward_time = 32.857086, backward_time = 30.043137, perf = 13.08 tflops.
STEP-96: step_time = 61.203457 ms, foward_time = 30.962688, backward_time = 30.075905, perf = 13.47 tflops.
STEP-97: step_time = 61.357056 ms, foward_time = 31.090689, backward_time = 30.104576, perf = 13.44 tflops.
STEP-98: step_time = 61.760513 ms, foward_time = 31.543297, backward_time = 30.055424, perf = 13.35 tflops.
STEP-99: step_time = 61.561855 ms, foward_time = 31.108095, backward_time = 30.292992, perf = 13.40 tflops.

 faster_moe 32 [Summary] Average synchronized step_time = 62.38387203216553 ms, forward = 31.916322167714437 , backward = 30.29775358835856 .
[Benchmark] world_size = 4, dtype = float16, model_dim = 1024, hidden_size = 4096, samples = 8192, num_local_experts = 64, topK = 2, a2a_ffn_overlap_degree = 1, device = `cuda:0`
STEP-0: step_time = 1381.830688 ms, foward_time = 1330.209839, backward_time = 50.722816, perf = 0.60 tflops.
STEP-1: step_time = 100.866051 ms, foward_time = 57.272320, backward_time = 43.253761, perf = 8.18 tflops.
STEP-2: step_time = 94.843903 ms, foward_time = 51.086334, backward_time = 43.469826, perf = 8.69 tflops.
STEP-3: step_time = 84.596733 ms, foward_time = 45.680641, backward_time = 38.633472, perf = 9.75 tflops.
STEP-4: step_time = 85.163010 ms, foward_time = 47.168510, backward_time = 37.711872, perf = 9.68 tflops.
STEP-5: step_time = 82.757629 ms, foward_time = 45.755390, backward_time = 36.712448, perf = 9.96 tflops.
STEP-6: step_time = 86.417412 ms, foward_time = 48.706558, backward_time = 36.743168, perf = 9.54 tflops.
STEP-7: step_time = 86.023170 ms, foward_time = 48.986111, backward_time = 36.612095, perf = 9.59 tflops.
STEP-8: step_time = 84.674561 ms, foward_time = 47.594498, backward_time = 36.681728, perf = 9.74 tflops.
STEP-9: step_time = 86.454269 ms, foward_time = 48.473087, backward_time = 37.584896, perf = 9.54 tflops.
STEP-10: step_time = 81.731583 ms, foward_time = 44.396545, backward_time = 36.999168, perf = 10.09 tflops.
STEP-11: step_time = 81.129471 ms, foward_time = 44.385281, backward_time = 36.387840, perf = 10.16 tflops.
STEP-12: step_time = 79.514626 ms, foward_time = 42.654720, backward_time = 36.528130, perf = 10.37 tflops.
STEP-13: step_time = 81.240067 ms, foward_time = 44.370945, backward_time = 36.586494, perf = 10.15 tflops.
STEP-14: step_time = 79.169533 ms, foward_time = 42.220543, backward_time = 36.619263, perf = 10.42 tflops.
STEP-15: step_time = 80.395264 ms, foward_time = 43.169792, backward_time = 36.881409, perf = 10.26 tflops.
STEP-16: step_time = 78.864388 ms, foward_time = 42.121216, backward_time = 36.401154, perf = 10.46 tflops.
STEP-17: step_time = 79.724541 ms, foward_time = 42.890240, backward_time = 36.498432, perf = 10.34 tflops.
STEP-18: step_time = 79.594498 ms, foward_time = 42.116096, backward_time = 37.127167, perf = 10.36 tflops.
STEP-19: step_time = 82.367485 ms, foward_time = 43.464703, backward_time = 38.589439, perf = 10.01 tflops.
STEP-20: step_time = 80.769028 ms, foward_time = 44.220417, backward_time = 36.176895, perf = 10.21 tflops.
STEP-21: step_time = 82.000893 ms, foward_time = 45.688831, backward_time = 35.842049, perf = 10.06 tflops.
STEP-22: step_time = 81.240067 ms, foward_time = 45.247486, backward_time = 35.627007, perf = 10.15 tflops.
STEP-23: step_time = 79.342590 ms, foward_time = 43.327488, backward_time = 35.689472, perf = 10.39 tflops.
STEP-24: step_time = 78.297089 ms, foward_time = 42.613762, backward_time = 35.359745, perf = 10.53 tflops.
STEP-25: step_time = 80.922623 ms, foward_time = 45.363201, backward_time = 35.252224, perf = 10.19 tflops.
STEP-26: step_time = 78.659584 ms, foward_time = 43.251713, backward_time = 35.053570, perf = 10.48 tflops.
STEP-27: step_time = 77.852669 ms, foward_time = 42.417152, backward_time = 35.135487, perf = 10.59 tflops.
STEP-28: step_time = 77.900803 ms, foward_time = 42.357761, backward_time = 35.245056, perf = 10.59 tflops.
STEP-29: step_time = 79.330307 ms, foward_time = 43.817986, backward_time = 35.188736, perf = 10.39 tflops.
STEP-30: step_time = 77.875198 ms, foward_time = 42.717182, backward_time = 34.876415, perf = 10.59 tflops.
STEP-31: step_time = 78.238724 ms, foward_time = 42.545151, backward_time = 35.361794, perf = 10.54 tflops.
STEP-32: step_time = 79.619072 ms, foward_time = 43.232258, backward_time = 36.061184, perf = 10.36 tflops.
STEP-33: step_time = 77.968384 ms, foward_time = 42.037247, backward_time = 35.643391, perf = 10.58 tflops.
STEP-34: step_time = 77.699074 ms, foward_time = 42.329086, backward_time = 35.068928, perf = 10.61 tflops.
STEP-35: step_time = 79.432701 ms, foward_time = 43.658241, backward_time = 35.463169, perf = 10.38 tflops.
STEP-36: step_time = 78.541824 ms, foward_time = 42.651649, backward_time = 35.582977, perf = 10.50 tflops.
STEP-37: step_time = 77.962242 ms, foward_time = 42.275841, backward_time = 35.378178, perf = 10.58 tflops.
STEP-38: step_time = 78.712830 ms, foward_time = 42.854401, backward_time = 35.575809, perf = 10.48 tflops.
STEP-39: step_time = 77.418495 ms, foward_time = 42.232834, backward_time = 34.866177, perf = 10.65 tflops.
STEP-40: step_time = 79.027199 ms, foward_time = 43.728897, backward_time = 34.996223, perf = 10.43 tflops.
STEP-41: step_time = 77.622269 ms, foward_time = 42.275841, backward_time = 35.059711, perf = 10.62 tflops.
STEP-42: step_time = 78.617599 ms, foward_time = 43.090942, backward_time = 35.213310, perf = 10.49 tflops.
STEP-43: step_time = 77.993980 ms, foward_time = 42.562561, backward_time = 35.159039, perf = 10.57 tflops.
STEP-44: step_time = 77.878273 ms, foward_time = 42.659840, backward_time = 34.929665, perf = 10.59 tflops.
STEP-45: step_time = 77.984772 ms, foward_time = 42.523647, backward_time = 35.187714, perf = 10.57 tflops.
STEP-46: step_time = 77.240318 ms, foward_time = 42.050560, backward_time = 34.905087, perf = 10.68 tflops.
STEP-47: step_time = 78.489601 ms, foward_time = 42.364929, backward_time = 35.835903, perf = 10.51 tflops.
STEP-48: step_time = 78.354431 ms, foward_time = 42.878975, backward_time = 35.202049, perf = 10.52 tflops.
STEP-49: step_time = 78.257149 ms, foward_time = 42.775551, backward_time = 35.184639, perf = 10.54 tflops.
STEP-50: step_time = 78.846977 ms, foward_time = 43.033600, backward_time = 35.542015, perf = 10.46 tflops.
STEP-51: step_time = 77.749245 ms, foward_time = 42.528767, backward_time = 34.915329, perf = 10.61 tflops.
STEP-52: step_time = 77.091843 ms, foward_time = 41.876480, backward_time = 34.918400, perf = 10.70 tflops.
STEP-53: step_time = 78.815231 ms, foward_time = 43.264000, backward_time = 35.271679, perf = 10.46 tflops.
STEP-54: step_time = 78.700546 ms, foward_time = 43.174911, backward_time = 35.222527, perf = 10.48 tflops.
STEP-55: step_time = 77.924355 ms, foward_time = 42.312702, backward_time = 35.319809, perf = 10.58 tflops.
STEP-56: step_time = 77.723648 ms, foward_time = 42.231808, backward_time = 35.192833, perf = 10.61 tflops.
STEP-57: step_time = 78.595070 ms, foward_time = 42.874882, backward_time = 35.416065, perf = 10.49 tflops.
STEP-58: step_time = 78.693375 ms, foward_time = 43.328510, backward_time = 35.089409, perf = 10.48 tflops.
STEP-59: step_time = 80.201729 ms, foward_time = 44.545025, backward_time = 35.310593, perf = 10.28 tflops.
STEP-60: step_time = 79.203331 ms, foward_time = 42.520576, backward_time = 36.406273, perf = 10.41 tflops.
STEP-61: step_time = 81.355774 ms, foward_time = 45.075455, backward_time = 35.840000, perf = 10.14 tflops.
STEP-62: step_time = 78.679039 ms, foward_time = 42.652672, backward_time = 35.733505, perf = 10.48 tflops.
STEP-63: step_time = 80.003075 ms, foward_time = 43.522049, backward_time = 36.178944, perf = 10.31 tflops.
STEP-64: step_time = 79.491074 ms, foward_time = 43.443199, backward_time = 35.748863, perf = 10.37 tflops.
STEP-65: step_time = 78.081024 ms, foward_time = 42.312702, backward_time = 35.439617, perf = 10.56 tflops.
STEP-66: step_time = 78.795776 ms, foward_time = 42.699776, backward_time = 35.814400, perf = 10.47 tflops.
STEP-67: step_time = 78.457855 ms, foward_time = 42.785793, backward_time = 35.391487, perf = 10.51 tflops.
STEP-68: step_time = 83.728386 ms, foward_time = 47.021057, backward_time = 36.337666, perf = 9.85 tflops.
STEP-69: step_time = 84.020226 ms, foward_time = 48.134144, backward_time = 35.496960, perf = 9.81 tflops.
STEP-70: step_time = 84.556801 ms, foward_time = 47.737858, backward_time = 36.447231, perf = 9.75 tflops.
STEP-71: step_time = 89.574402 ms, foward_time = 52.414463, backward_time = 36.365311, perf = 9.21 tflops.
STEP-72: step_time = 86.635521 ms, foward_time = 48.774143, backward_time = 37.481472, perf = 9.52 tflops.
STEP-73: step_time = 85.289986 ms, foward_time = 48.136192, backward_time = 36.784126, perf = 9.67 tflops.
STEP-74: step_time = 83.964928 ms, foward_time = 47.960064, backward_time = 35.633152, perf = 9.82 tflops.
STEP-75: step_time = 83.597313 ms, foward_time = 47.684608, backward_time = 35.552258, perf = 9.86 tflops.
STEP-76: step_time = 84.416512 ms, foward_time = 47.902721, backward_time = 36.127743, perf = 9.77 tflops.
STEP-77: step_time = 83.672066 ms, foward_time = 47.746048, backward_time = 35.568642, perf = 9.86 tflops.
STEP-78: step_time = 84.376579 ms, foward_time = 47.769600, backward_time = 36.200447, perf = 9.77 tflops.
STEP-79: step_time = 84.346878 ms, foward_time = 48.118786, backward_time = 35.864574, perf = 9.78 tflops.
STEP-80: step_time = 84.011009 ms, foward_time = 47.714306, backward_time = 35.948544, perf = 9.82 tflops.
STEP-81: step_time = 83.618813 ms, foward_time = 47.762432, backward_time = 35.507198, perf = 9.86 tflops.
STEP-82: step_time = 83.833855 ms, foward_time = 47.558655, backward_time = 35.931137, perf = 9.84 tflops.
STEP-83: step_time = 83.569664 ms, foward_time = 47.779839, backward_time = 35.439617, perf = 9.87 tflops.
STEP-84: step_time = 83.982338 ms, foward_time = 47.878143, backward_time = 35.764225, perf = 9.82 tflops.
STEP-85: step_time = 84.713470 ms, foward_time = 47.960064, backward_time = 36.407295, perf = 9.73 tflops.
STEP-86: step_time = 83.955711 ms, foward_time = 47.747070, backward_time = 35.863552, perf = 9.82 tflops.
STEP-87: step_time = 83.913727 ms, foward_time = 47.882240, backward_time = 35.670017, perf = 9.83 tflops.
STEP-88: step_time = 86.834175 ms, foward_time = 50.744320, backward_time = 35.679234, perf = 9.50 tflops.
STEP-89: step_time = 83.988480 ms, foward_time = 47.928322, backward_time = 35.709953, perf = 9.82 tflops.
STEP-90: step_time = 84.013054 ms, foward_time = 47.762432, backward_time = 35.896320, perf = 9.82 tflops.
STEP-91: step_time = 84.924416 ms, foward_time = 48.454655, backward_time = 36.089855, perf = 9.71 tflops.
STEP-92: step_time = 84.060158 ms, foward_time = 47.932415, backward_time = 35.789825, perf = 9.81 tflops.
STEP-93: step_time = 84.196350 ms, foward_time = 48.095230, backward_time = 35.739647, perf = 9.79 tflops.
STEP-94: step_time = 84.186111 ms, foward_time = 47.980545, backward_time = 35.832832, perf = 9.80 tflops.
STEP-95: step_time = 84.219902 ms, foward_time = 47.978497, backward_time = 35.897343, perf = 9.79 tflops.
STEP-96: step_time = 84.130814 ms, foward_time = 47.934464, backward_time = 35.849216, perf = 9.80 tflops.
STEP-97: step_time = 84.478973 ms, foward_time = 47.723518, backward_time = 36.414463, perf = 9.76 tflops.
STEP-98: step_time = 85.172226 ms, foward_time = 48.606209, backward_time = 36.226048, perf = 9.68 tflops.
STEP-99: step_time = 84.036606 ms, foward_time = 47.972351, backward_time = 35.695618, perf = 9.81 tflops.

 faster_moe 64 [Summary] Average synchronized step_time = 81.73156674702962 ms, forward = 45.698167355855304 , backward = 35.69394346872966 .
