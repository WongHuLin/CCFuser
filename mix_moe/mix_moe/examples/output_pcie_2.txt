cuda:2
cuda:3
cuda:1
cuda:0
[Benchmark] world_size = 4, dtype = float16, model_dim = 1024, hidden_size = 4096, samples = 8192, num_local_experts = 4, topK = 2, a2a_ffn_overlap_degree = 1, device = `cuda:0`
STEP-0: step_time = 43.287476 ms, foward_time = 22.006714, backward_time = 20.857857, perf = 19.05 tflops.
STEP-1: step_time = 26.360831 ms, foward_time = 12.488704, backward_time = 13.753344, perf = 31.28 tflops.
STEP-2: step_time = 26.117696 ms, foward_time = 11.892288, backward_time = 14.127104, perf = 31.57 tflops.
STEP-3: step_time = 25.073665 ms, foward_time = 11.184128, backward_time = 13.791232, perf = 32.89 tflops.
STEP-4: step_time = 25.383937 ms, foward_time = 11.531264, backward_time = 13.753344, perf = 32.49 tflops.
STEP-5: step_time = 25.470977 ms, foward_time = 11.686912, backward_time = 13.685760, perf = 32.38 tflops.
STEP-6: step_time = 24.795137 ms, foward_time = 10.886144, backward_time = 13.810688, perf = 33.26 tflops.
STEP-7: step_time = 24.935424 ms, foward_time = 11.228160, backward_time = 13.605888, perf = 33.07 tflops.
STEP-8: step_time = 24.768512 ms, foward_time = 11.198464, backward_time = 13.470720, perf = 33.29 tflops.
STEP-9: step_time = 25.007551 ms, foward_time = 11.494848, backward_time = 13.413376, perf = 32.98 tflops.
STEP-10: step_time = 20.732929 ms, foward_time = 10.588160, backward_time = 10.047488, perf = 39.77 tflops.
STEP-11: step_time = 19.111265 ms, foward_time = 8.865120, backward_time = 10.148864, perf = 43.15 tflops.
STEP-12: step_time = 19.204095 ms, foward_time = 8.804352, backward_time = 10.270720, perf = 42.94 tflops.
STEP-13: step_time = 19.222528 ms, foward_time = 8.808448, backward_time = 10.316800, perf = 42.90 tflops.
STEP-14: step_time = 19.386368 ms, foward_time = 9.053184, backward_time = 10.235904, perf = 42.54 tflops.
STEP-15: step_time = 19.246079 ms, foward_time = 8.879104, backward_time = 10.270720, perf = 42.85 tflops.
STEP-16: step_time = 19.013984 ms, foward_time = 8.677728, backward_time = 10.203136, perf = 43.37 tflops.
STEP-17: step_time = 18.877440 ms, foward_time = 8.522752, backward_time = 10.258432, perf = 43.68 tflops.
STEP-18: step_time = 19.131680 ms, foward_time = 9.119008, backward_time = 9.915392, perf = 43.10 tflops.
STEP-19: step_time = 19.268896 ms, foward_time = 9.059616, backward_time = 10.112000, perf = 42.80 tflops.
STEP-20: step_time = 19.092481 ms, foward_time = 9.051136, backward_time = 9.942016, perf = 43.19 tflops.
STEP-21: step_time = 19.588544 ms, foward_time = 9.182656, backward_time = 10.270720, perf = 42.10 tflops.
STEP-22: step_time = 19.187711 ms, foward_time = 8.930304, backward_time = 10.163200, perf = 42.98 tflops.
STEP-23: step_time = 19.381248 ms, foward_time = 8.927232, backward_time = 10.322944, perf = 42.55 tflops.
STEP-24: step_time = 19.599360 ms, foward_time = 9.227264, backward_time = 10.275840, perf = 42.07 tflops.
STEP-25: step_time = 19.627904 ms, foward_time = 9.198464, backward_time = 10.309632, perf = 42.01 tflops.
STEP-26: step_time = 19.479231 ms, foward_time = 9.010880, backward_time = 10.330112, perf = 42.33 tflops.
STEP-27: step_time = 19.587745 ms, foward_time = 9.453216, backward_time = 10.001408, perf = 42.10 tflops.
STEP-28: step_time = 18.975744 ms, foward_time = 8.520704, backward_time = 10.358784, perf = 43.46 tflops.
STEP-29: step_time = 19.934561 ms, foward_time = 9.438560, backward_time = 10.369024, perf = 41.37 tflops.
STEP-30: step_time = 19.284992 ms, foward_time = 8.811521, backward_time = 10.377216, perf = 42.76 tflops.
STEP-31: step_time = 19.367936 ms, foward_time = 9.023488, backward_time = 10.208256, perf = 42.58 tflops.
STEP-32: step_time = 19.192833 ms, foward_time = 8.869888, backward_time = 10.225664, perf = 42.97 tflops.
STEP-33: step_time = 19.700735 ms, foward_time = 9.298944, backward_time = 10.268672, perf = 41.86 tflops.
STEP-34: step_time = 19.183616 ms, foward_time = 8.856576, backward_time = 10.229760, perf = 42.99 tflops.
STEP-35: step_time = 19.483168 ms, foward_time = 9.374240, backward_time = 10.012672, perf = 42.33 tflops.
STEP-36: step_time = 18.994176 ms, foward_time = 8.704000, backward_time = 10.194944, perf = 43.42 tflops.
STEP-37: step_time = 18.655233 ms, foward_time = 8.609792, backward_time = 9.949184, perf = 44.20 tflops.
STEP-38: step_time = 18.859744 ms, foward_time = 8.836832, backward_time = 9.927680, perf = 43.72 tflops.
STEP-39: step_time = 19.076097 ms, foward_time = 8.970240, backward_time = 10.010624, perf = 43.23 tflops.
STEP-40: step_time = 19.270657 ms, foward_time = 9.063424, backward_time = 10.075136, perf = 42.79 tflops.
STEP-41: step_time = 19.255871 ms, foward_time = 8.984128, backward_time = 10.173440, perf = 42.83 tflops.
STEP-42: step_time = 18.351104 ms, foward_time = 8.424448, backward_time = 9.794560, perf = 44.94 tflops.
STEP-43: step_time = 19.714047 ms, foward_time = 9.438208, backward_time = 10.179584, perf = 41.83 tflops.
STEP-44: step_time = 18.773663 ms, foward_time = 8.667808, backward_time = 10.009600, perf = 43.93 tflops.
STEP-45: step_time = 19.288736 ms, foward_time = 9.000608, backward_time = 10.190848, perf = 42.75 tflops.
STEP-46: step_time = 19.508224 ms, foward_time = 9.177088, backward_time = 10.234880, perf = 42.27 tflops.
STEP-47: step_time = 19.632193 ms, foward_time = 9.261120, backward_time = 10.275840, perf = 42.00 tflops.
STEP-48: step_time = 19.230784 ms, foward_time = 8.863808, backward_time = 10.270720, perf = 42.88 tflops.
STEP-49: step_time = 19.508544 ms, foward_time = 9.349440, backward_time = 10.007552, perf = 42.27 tflops.
STEP-50: step_time = 19.609601 ms, foward_time = 9.011200, backward_time = 10.502144, perf = 42.05 tflops.
STEP-51: step_time = 19.287263 ms, foward_time = 9.188576, backward_time = 9.966592, perf = 42.76 tflops.
STEP-52: step_time = 19.183615 ms, foward_time = 8.906752, backward_time = 10.180608, perf = 42.99 tflops.
STEP-53: step_time = 19.219904 ms, foward_time = 8.827327, backward_time = 10.266624, perf = 42.91 tflops.
STEP-54: step_time = 19.054593 ms, foward_time = 8.911872, backward_time = 10.047488, perf = 43.28 tflops.
STEP-55: step_time = 18.772992 ms, foward_time = 8.598528, backward_time = 10.076160, perf = 43.93 tflops.
STEP-56: step_time = 19.202049 ms, foward_time = 8.861696, backward_time = 10.216448, perf = 42.95 tflops.
STEP-57: step_time = 19.443392 ms, foward_time = 9.029312, backward_time = 10.317824, perf = 42.41 tflops.
STEP-58: step_time = 19.225599 ms, foward_time = 8.998912, backward_time = 10.085376, perf = 42.89 tflops.
STEP-59: step_time = 19.487457 ms, foward_time = 9.076448, backward_time = 10.314752, perf = 42.32 tflops.
STEP-60: step_time = 19.735231 ms, foward_time = 9.585344, backward_time = 10.031104, perf = 41.78 tflops.
STEP-61: step_time = 19.620000 ms, foward_time = 9.275552, backward_time = 10.205184, perf = 42.03 tflops.
STEP-62: step_time = 20.550657 ms, foward_time = 9.239552, backward_time = 11.214848, perf = 40.13 tflops.
STEP-63: step_time = 18.764960 ms, foward_time = 8.962208, backward_time = 9.691136, perf = 43.95 tflops.
STEP-64: step_time = 19.166240 ms, foward_time = 9.133088, backward_time = 9.936896, perf = 43.03 tflops.
STEP-65: step_time = 19.361791 ms, foward_time = 9.064448, backward_time = 10.163200, perf = 42.59 tflops.
STEP-66: step_time = 19.347615 ms, foward_time = 9.215136, backward_time = 10.037248, perf = 42.62 tflops.
STEP-67: step_time = 18.771969 ms, foward_time = 8.382464, backward_time = 10.294272, perf = 43.93 tflops.
STEP-68: step_time = 19.151873 ms, foward_time = 8.845312, backward_time = 10.168320, perf = 43.06 tflops.
STEP-69: step_time = 19.119104 ms, foward_time = 9.076736, backward_time = 9.948160, perf = 43.13 tflops.
STEP-70: step_time = 18.920993 ms, foward_time = 8.846880, backward_time = 9.978880, perf = 43.58 tflops.
STEP-71: step_time = 18.614272 ms, foward_time = 8.658944, backward_time = 9.860096, perf = 44.30 tflops.
STEP-72: step_time = 19.214849 ms, foward_time = 8.933888, backward_time = 10.185728, perf = 42.92 tflops.
STEP-73: step_time = 19.986464 ms, foward_time = 9.177120, backward_time = 10.686464, perf = 41.26 tflops.
STEP-74: step_time = 18.902784 ms, foward_time = 8.733440, backward_time = 10.030080, perf = 43.62 tflops.
STEP-75: step_time = 18.631680 ms, foward_time = 8.542208, backward_time = 9.994240, perf = 44.26 tflops.
STEP-76: step_time = 19.126337 ms, foward_time = 9.201728, backward_time = 9.829376, perf = 43.12 tflops.
STEP-77: step_time = 18.696192 ms, foward_time = 8.673280, backward_time = 9.926656, perf = 44.11 tflops.
STEP-78: step_time = 19.605504 ms, foward_time = 8.871936, backward_time = 10.570752, perf = 42.06 tflops.
STEP-79: step_time = 19.098623 ms, foward_time = 8.727552, backward_time = 10.274816, perf = 43.18 tflops.
STEP-80: step_time = 19.513345 ms, foward_time = 9.140224, backward_time = 10.191872, perf = 42.26 tflops.
STEP-81: step_time = 19.341313 ms, foward_time = 8.796160, backward_time = 10.448896, perf = 42.64 tflops.
STEP-82: step_time = 19.743008 ms, foward_time = 9.151776, backward_time = 10.493952, perf = 41.77 tflops.
STEP-83: step_time = 19.123904 ms, foward_time = 8.832704, backward_time = 10.194944, perf = 43.12 tflops.
STEP-84: step_time = 19.213312 ms, foward_time = 8.549376, backward_time = 10.539008, perf = 42.92 tflops.
STEP-85: step_time = 19.221505 ms, foward_time = 9.022464, backward_time = 10.103808, perf = 42.90 tflops.
STEP-86: step_time = 19.514336 ms, foward_time = 8.963040, backward_time = 10.455040, perf = 42.26 tflops.
STEP-87: step_time = 19.812353 ms, foward_time = 9.464832, backward_time = 10.243072, perf = 41.62 tflops.
STEP-88: step_time = 19.473408 ms, foward_time = 8.930304, backward_time = 10.446848, perf = 42.35 tflops.
STEP-89: step_time = 19.415041 ms, foward_time = 8.992768, backward_time = 10.326016, perf = 42.47 tflops.
STEP-90: step_time = 19.141631 ms, foward_time = 8.837120, backward_time = 10.207232, perf = 43.08 tflops.
STEP-91: step_time = 19.032063 ms, foward_time = 8.777728, backward_time = 10.159104, perf = 43.33 tflops.
STEP-92: step_time = 19.219455 ms, foward_time = 8.717312, backward_time = 10.404864, perf = 42.91 tflops.
STEP-93: step_time = 19.417088 ms, foward_time = 9.108479, backward_time = 10.203136, perf = 42.47 tflops.
STEP-94: step_time = 19.633600 ms, foward_time = 9.012672, backward_time = 10.523648, perf = 42.00 tflops.
STEP-95: step_time = 19.641599 ms, foward_time = 9.265408, backward_time = 10.279936, perf = 41.98 tflops.
STEP-96: step_time = 19.369984 ms, foward_time = 8.891392, backward_time = 10.383360, perf = 42.57 tflops.
STEP-97: step_time = 18.930687 ms, foward_time = 8.552448, backward_time = 10.280960, perf = 43.56 tflops.
STEP-98: step_time = 19.576097 ms, foward_time = 9.194784, backward_time = 10.285056, perf = 42.12 tflops.
STEP-99: step_time = 19.271681 ms, foward_time = 8.921088, backward_time = 10.255360, perf = 42.79 tflops.

 mix_moe 4 [Summary] Average synchronized step_time = 19.32338857650757 ms, forward = 8.927843189239502 , backward = 10.298265743255616 .
cuda:0
cuda:3
cuda:2
cuda:1
[Benchmark] world_size = 4, dtype = float16, model_dim = 1024, hidden_size = 4096, samples = 8192, num_local_experts = 8, topK = 2, a2a_ffn_overlap_degree = 1, device = `cuda:0`
STEP-0: step_time = 49.139771 ms, foward_time = 21.384277, backward_time = 27.468800, perf = 16.78 tflops.
STEP-1: step_time = 24.827424 ms, foward_time = 11.413024, backward_time = 13.309952, perf = 33.21 tflops.
STEP-2: step_time = 25.341952 ms, foward_time = 12.063744, backward_time = 13.195264, perf = 32.54 tflops.
STEP-3: step_time = 23.689216 ms, foward_time = 10.387456, backward_time = 13.219840, perf = 34.81 tflops.
STEP-4: step_time = 24.841472 ms, foward_time = 11.642112, backward_time = 13.117440, perf = 33.20 tflops.
STEP-5: step_time = 24.559743 ms, foward_time = 11.393152, backward_time = 13.079552, perf = 33.58 tflops.
STEP-6: step_time = 25.175039 ms, foward_time = 11.909120, backward_time = 13.181952, perf = 32.76 tflops.
STEP-7: step_time = 24.204960 ms, foward_time = 10.899104, backward_time = 13.221888, perf = 34.07 tflops.
STEP-8: step_time = 21.993473 ms, foward_time = 10.675200, backward_time = 11.220992, perf = 37.49 tflops.
STEP-9: step_time = 20.022720 ms, foward_time = 9.339328, backward_time = 10.586112, perf = 41.18 tflops.
STEP-10: step_time = 20.079999 ms, foward_time = 9.101696, backward_time = 10.881024, perf = 41.07 tflops.
STEP-11: step_time = 19.644609 ms, foward_time = 8.963264, backward_time = 10.606592, perf = 41.98 tflops.
STEP-12: step_time = 20.212736 ms, foward_time = 9.288704, backward_time = 10.842112, perf = 40.80 tflops.
STEP-13: step_time = 20.248192 ms, foward_time = 9.219712, backward_time = 10.849280, perf = 40.73 tflops.
STEP-14: step_time = 19.588096 ms, foward_time = 9.073664, backward_time = 10.431488, perf = 42.10 tflops.
STEP-15: step_time = 19.360768 ms, foward_time = 8.771584, backward_time = 10.507264, perf = 42.59 tflops.
STEP-16: step_time = 19.434497 ms, foward_time = 8.944640, backward_time = 10.391552, perf = 42.43 tflops.
STEP-17: step_time = 19.875584 ms, foward_time = 9.406208, backward_time = 10.372096, perf = 41.49 tflops.
STEP-18: step_time = 19.312640 ms, foward_time = 8.932352, backward_time = 10.280960, perf = 42.70 tflops.
STEP-19: step_time = 19.541504 ms, foward_time = 8.917504, backward_time = 10.527744, perf = 42.20 tflops.
STEP-20: step_time = 19.504129 ms, foward_time = 9.090048, backward_time = 10.317824, perf = 42.28 tflops.
STEP-21: step_time = 19.346816 ms, foward_time = 8.885632, backward_time = 10.362880, perf = 42.62 tflops.
STEP-22: step_time = 20.085760 ms, foward_time = 9.417728, backward_time = 10.483712, perf = 41.06 tflops.
STEP-23: step_time = 19.992705 ms, foward_time = 9.568384, backward_time = 10.328064, perf = 41.25 tflops.
STEP-24: step_time = 19.648512 ms, foward_time = 8.935424, backward_time = 10.616832, perf = 41.97 tflops.
STEP-25: step_time = 19.578881 ms, foward_time = 9.014272, backward_time = 10.467328, perf = 42.12 tflops.
STEP-26: step_time = 19.793121 ms, foward_time = 9.267424, backward_time = 10.427392, perf = 41.66 tflops.
STEP-27: step_time = 19.888128 ms, foward_time = 9.333760, backward_time = 10.457088, perf = 41.46 tflops.
STEP-28: step_time = 19.878207 ms, foward_time = 9.420096, backward_time = 10.360832, perf = 41.48 tflops.
STEP-29: step_time = 20.600641 ms, foward_time = 9.676608, backward_time = 10.826752, perf = 40.03 tflops.
STEP-30: step_time = 19.920897 ms, foward_time = 9.437184, backward_time = 10.385408, perf = 41.40 tflops.
STEP-31: step_time = 19.662847 ms, foward_time = 9.229312, backward_time = 10.335232, perf = 41.94 tflops.
STEP-32: step_time = 20.270079 ms, foward_time = 9.520128, backward_time = 10.650624, perf = 40.68 tflops.
STEP-33: step_time = 19.958785 ms, foward_time = 8.973312, backward_time = 10.888192, perf = 41.32 tflops.
STEP-34: step_time = 19.874817 ms, foward_time = 9.402368, backward_time = 10.375168, perf = 41.49 tflops.
STEP-35: step_time = 20.315233 ms, foward_time = 9.556064, backward_time = 10.661888, perf = 40.59 tflops.
STEP-36: step_time = 19.730432 ms, foward_time = 9.396224, backward_time = 10.236928, perf = 41.80 tflops.
STEP-37: step_time = 20.038656 ms, foward_time = 9.216000, backward_time = 10.724352, perf = 41.15 tflops.
STEP-38: step_time = 19.999968 ms, foward_time = 9.312480, backward_time = 10.587136, perf = 41.23 tflops.
STEP-39: step_time = 19.520512 ms, foward_time = 9.075712, backward_time = 10.347520, perf = 42.24 tflops.
STEP-40: step_time = 20.089983 ms, foward_time = 9.058432, backward_time = 10.935296, perf = 41.05 tflops.
STEP-41: step_time = 20.237312 ms, foward_time = 9.401344, backward_time = 10.729472, perf = 40.75 tflops.
STEP-42: step_time = 19.670273 ms, foward_time = 8.848640, backward_time = 10.724352, perf = 41.92 tflops.
STEP-43: step_time = 19.831713 ms, foward_time = 9.241504, backward_time = 10.447872, perf = 41.58 tflops.
STEP-44: step_time = 19.908064 ms, foward_time = 9.220576, backward_time = 10.592256, perf = 41.42 tflops.
STEP-45: step_time = 20.125569 ms, foward_time = 9.433984, backward_time = 10.594304, perf = 40.97 tflops.
STEP-46: step_time = 20.095552 ms, foward_time = 9.342528, backward_time = 10.654720, perf = 41.04 tflops.
STEP-47: step_time = 19.852288 ms, foward_time = 9.341952, backward_time = 10.412032, perf = 41.54 tflops.
STEP-48: step_time = 20.336448 ms, foward_time = 9.404224, backward_time = 10.832896, perf = 40.55 tflops.
STEP-49: step_time = 19.491841 ms, foward_time = 9.066496, backward_time = 10.327040, perf = 42.31 tflops.
STEP-50: step_time = 20.117504 ms, foward_time = 9.601024, backward_time = 10.419200, perf = 40.99 tflops.
STEP-51: step_time = 20.295679 ms, foward_time = 9.327616, backward_time = 10.870784, perf = 40.63 tflops.
STEP-52: step_time = 19.290112 ms, foward_time = 8.884223, backward_time = 10.309632, perf = 42.75 tflops.
STEP-53: step_time = 20.380512 ms, foward_time = 9.502560, backward_time = 10.779648, perf = 40.46 tflops.
STEP-54: step_time = 19.216383 ms, foward_time = 8.939520, backward_time = 10.181632, perf = 42.91 tflops.
STEP-55: step_time = 20.369408 ms, foward_time = 9.688064, backward_time = 10.583040, perf = 40.48 tflops.
STEP-56: step_time = 20.160512 ms, foward_time = 9.382912, backward_time = 10.660864, perf = 40.90 tflops.
STEP-57: step_time = 20.388192 ms, foward_time = 9.718112, backward_time = 10.529792, perf = 40.45 tflops.
STEP-58: step_time = 20.029439 ms, foward_time = 9.211904, backward_time = 10.720256, perf = 41.17 tflops.
STEP-59: step_time = 20.626431 ms, foward_time = 9.673728, backward_time = 10.855424, perf = 39.98 tflops.
STEP-60: step_time = 20.459521 ms, foward_time = 9.534464, backward_time = 10.825728, perf = 40.31 tflops.
STEP-61: step_time = 19.908031 ms, foward_time = 9.265600, backward_time = 10.491904, perf = 41.42 tflops.
STEP-62: step_time = 20.340736 ms, foward_time = 9.543680, backward_time = 10.698752, perf = 40.54 tflops.
STEP-63: step_time = 20.421632 ms, foward_time = 9.509888, backward_time = 10.814464, perf = 40.38 tflops.
STEP-64: step_time = 20.371456 ms, foward_time = 9.523200, backward_time = 10.743808, perf = 40.48 tflops.
STEP-65: step_time = 20.160415 ms, foward_time = 9.622432, backward_time = 10.395648, perf = 40.90 tflops.
STEP-66: step_time = 20.469759 ms, foward_time = 9.791488, backward_time = 10.580992, perf = 40.29 tflops.
STEP-67: step_time = 19.979264 ms, foward_time = 9.350144, backward_time = 10.532864, perf = 41.27 tflops.
STEP-68: step_time = 19.778561 ms, foward_time = 9.225216, backward_time = 10.457088, perf = 41.69 tflops.
STEP-69: step_time = 19.871743 ms, foward_time = 9.206784, backward_time = 10.567680, perf = 41.50 tflops.
STEP-70: step_time = 20.510529 ms, foward_time = 9.796416, backward_time = 10.615808, perf = 40.21 tflops.
STEP-71: step_time = 19.672065 ms, foward_time = 9.374720, backward_time = 10.201088, perf = 41.92 tflops.
STEP-72: step_time = 20.107648 ms, foward_time = 9.440640, backward_time = 10.567680, perf = 41.01 tflops.
STEP-73: step_time = 20.319231 ms, foward_time = 9.388032, backward_time = 10.828800, perf = 40.58 tflops.
STEP-74: step_time = 19.513345 ms, foward_time = 8.980480, backward_time = 10.435584, perf = 42.26 tflops.
STEP-75: step_time = 20.346047 ms, foward_time = 9.759936, backward_time = 10.486784, perf = 40.53 tflops.
STEP-76: step_time = 20.612767 ms, foward_time = 9.751200, backward_time = 10.763264, perf = 40.01 tflops.
STEP-77: step_time = 20.633633 ms, foward_time = 9.728032, backward_time = 10.805248, perf = 39.97 tflops.
STEP-78: step_time = 20.153343 ms, foward_time = 9.295872, backward_time = 10.759168, perf = 40.92 tflops.
STEP-79: step_time = 19.744768 ms, foward_time = 9.251840, backward_time = 10.395648, perf = 41.76 tflops.
STEP-80: step_time = 20.692992 ms, foward_time = 9.629696, backward_time = 10.966016, perf = 39.85 tflops.
STEP-81: step_time = 19.663871 ms, foward_time = 9.111552, backward_time = 10.455040, perf = 41.94 tflops.
STEP-82: step_time = 19.706880 ms, foward_time = 9.153536, backward_time = 10.456064, perf = 41.84 tflops.
STEP-83: step_time = 20.210688 ms, foward_time = 9.337856, backward_time = 10.774528, perf = 40.80 tflops.
STEP-84: step_time = 19.877887 ms, foward_time = 9.303040, backward_time = 10.476544, perf = 41.48 tflops.
STEP-85: step_time = 19.934208 ms, foward_time = 9.339904, backward_time = 10.496000, perf = 41.37 tflops.
STEP-86: step_time = 19.908608 ms, foward_time = 9.055232, backward_time = 10.756096, perf = 41.42 tflops.
STEP-87: step_time = 19.301375 ms, foward_time = 8.913920, backward_time = 10.291200, perf = 42.72 tflops.
STEP-88: step_time = 19.495937 ms, foward_time = 8.820736, backward_time = 10.576896, perf = 42.30 tflops.
STEP-89: step_time = 19.745793 ms, foward_time = 9.032704, backward_time = 10.613760, perf = 41.76 tflops.
STEP-90: step_time = 19.630080 ms, foward_time = 9.290752, backward_time = 10.242048, perf = 42.01 tflops.
STEP-91: step_time = 19.607552 ms, foward_time = 9.069568, backward_time = 10.421248, perf = 42.06 tflops.
STEP-92: step_time = 19.706880 ms, foward_time = 9.462784, backward_time = 10.102784, perf = 41.84 tflops.
STEP-93: step_time = 18.977793 ms, foward_time = 8.368128, backward_time = 10.511360, perf = 43.45 tflops.
STEP-94: step_time = 19.345408 ms, foward_time = 8.824832, backward_time = 10.423296, perf = 42.63 tflops.
STEP-95: step_time = 19.477505 ms, foward_time = 8.985600, backward_time = 10.393600, perf = 42.34 tflops.
STEP-96: step_time = 20.499456 ms, foward_time = 9.720832, backward_time = 10.681344, perf = 40.23 tflops.
STEP-97: step_time = 19.095552 ms, foward_time = 8.873984, backward_time = 10.124288, perf = 43.18 tflops.
STEP-98: step_time = 19.767297 ms, foward_time = 9.165824, backward_time = 10.504192, perf = 41.72 tflops.
STEP-99: step_time = 18.813952 ms, foward_time = 8.308736, backward_time = 10.408960, perf = 43.83 tflops.

 mix_moe 8 [Summary] Average synchronized step_time = 19.492147493362427 ms, forward = 9.007103967666627 , backward = 10.38131217956543 .
cuda:0
cuda:3
cuda:2
cuda:1
[Benchmark] world_size = 4, dtype = float16, model_dim = 1024, hidden_size = 4096, samples = 8192, num_local_experts = 16, topK = 2, a2a_ffn_overlap_degree = 1, device = `cuda:0`
STEP-0: step_time = 46.152710 ms, foward_time = 22.429688, backward_time = 23.367680, perf = 17.87 tflops.
STEP-1: step_time = 31.588353 ms, foward_time = 14.641152, backward_time = 16.832512, perf = 26.11 tflops.
STEP-2: step_time = 30.982143 ms, foward_time = 14.146560, backward_time = 16.735231, perf = 26.62 tflops.
STEP-3: step_time = 29.088767 ms, foward_time = 14.509055, backward_time = 14.477312, perf = 28.35 tflops.
STEP-4: step_time = 26.369024 ms, foward_time = 12.514304, backward_time = 13.756416, perf = 31.27 tflops.
STEP-5: step_time = 26.905695 ms, foward_time = 13.005920, backward_time = 13.801472, perf = 30.65 tflops.
STEP-6: step_time = 26.533889 ms, foward_time = 12.692480, backward_time = 13.744128, perf = 31.08 tflops.
STEP-7: step_time = 26.056703 ms, foward_time = 12.097536, backward_time = 13.860864, perf = 31.65 tflops.
STEP-8: step_time = 26.427392 ms, foward_time = 12.412928, backward_time = 13.917184, perf = 31.20 tflops.
STEP-9: step_time = 26.617857 ms, foward_time = 12.753920, backward_time = 13.764608, perf = 30.98 tflops.
STEP-10: step_time = 23.034880 ms, foward_time = 11.320320, backward_time = 11.616256, perf = 35.80 tflops.
STEP-11: step_time = 22.645760 ms, foward_time = 10.687488, backward_time = 11.860992, perf = 36.41 tflops.
STEP-12: step_time = 22.205439 ms, foward_time = 10.550272, backward_time = 11.558912, perf = 37.14 tflops.
STEP-13: step_time = 21.877441 ms, foward_time = 10.429120, backward_time = 11.351040, perf = 37.69 tflops.
STEP-14: step_time = 21.743840 ms, foward_time = 10.342624, backward_time = 11.303936, perf = 37.92 tflops.
STEP-15: step_time = 21.731328 ms, foward_time = 10.400768, backward_time = 11.231232, perf = 37.95 tflops.
STEP-16: step_time = 21.859392 ms, foward_time = 10.477632, backward_time = 11.285504, perf = 37.72 tflops.
STEP-17: step_time = 21.532672 ms, foward_time = 10.312704, backward_time = 11.121664, perf = 38.30 tflops.
STEP-18: step_time = 22.024160 ms, foward_time = 10.382304, backward_time = 11.543552, perf = 37.44 tflops.
STEP-19: step_time = 21.669888 ms, foward_time = 10.382336, backward_time = 11.190272, perf = 38.05 tflops.
STEP-20: step_time = 22.008384 ms, foward_time = 10.490432, backward_time = 11.413504, perf = 37.47 tflops.
STEP-21: step_time = 22.579873 ms, foward_time = 10.546848, backward_time = 11.935744, perf = 36.52 tflops.
STEP-22: step_time = 22.039552 ms, foward_time = 10.492928, backward_time = 11.449344, perf = 37.42 tflops.
STEP-23: step_time = 22.132288 ms, foward_time = 10.649152, backward_time = 11.384832, perf = 37.26 tflops.
STEP-24: step_time = 21.930624 ms, foward_time = 10.437248, backward_time = 11.395072, perf = 37.60 tflops.
STEP-25: step_time = 21.523616 ms, foward_time = 10.304672, backward_time = 11.120640, perf = 38.31 tflops.
STEP-26: step_time = 21.964607 ms, foward_time = 10.470207, backward_time = 11.397120, perf = 37.54 tflops.
STEP-27: step_time = 22.214271 ms, foward_time = 10.768000, backward_time = 11.347968, perf = 37.12 tflops.
STEP-28: step_time = 22.318080 ms, foward_time = 10.686464, backward_time = 11.534336, perf = 36.95 tflops.
STEP-29: step_time = 22.104704 ms, foward_time = 10.531456, backward_time = 11.475968, perf = 37.31 tflops.
STEP-30: step_time = 22.340832 ms, foward_time = 10.950880, backward_time = 11.291648, perf = 36.91 tflops.
STEP-31: step_time = 21.790593 ms, foward_time = 10.365824, backward_time = 11.327488, perf = 37.84 tflops.
STEP-32: step_time = 21.889599 ms, foward_time = 10.485312, backward_time = 11.307008, perf = 37.67 tflops.
STEP-33: step_time = 22.107649 ms, foward_time = 10.571264, backward_time = 11.440128, perf = 37.30 tflops.
STEP-34: step_time = 21.647360 ms, foward_time = 10.160128, backward_time = 11.388928, perf = 38.09 tflops.
STEP-35: step_time = 22.299999 ms, foward_time = 10.574176, backward_time = 11.628544, perf = 36.98 tflops.
STEP-36: step_time = 22.119424 ms, foward_time = 10.491904, backward_time = 11.530240, perf = 37.28 tflops.
STEP-37: step_time = 21.758752 ms, foward_time = 10.310432, backward_time = 11.351040, perf = 37.90 tflops.
STEP-38: step_time = 22.320512 ms, foward_time = 10.896768, backward_time = 11.327488, perf = 36.95 tflops.
STEP-39: step_time = 22.080512 ms, foward_time = 10.583040, backward_time = 11.400192, perf = 37.35 tflops.
STEP-40: step_time = 21.907041 ms, foward_time = 10.489440, backward_time = 11.320320, perf = 37.64 tflops.
STEP-41: step_time = 21.771904 ms, foward_time = 10.419840, backward_time = 11.241472, perf = 37.88 tflops.
STEP-42: step_time = 21.773600 ms, foward_time = 10.519840, backward_time = 11.155456, perf = 37.87 tflops.
STEP-43: step_time = 21.975039 ms, foward_time = 10.054656, backward_time = 11.823104, perf = 37.53 tflops.
STEP-44: step_time = 22.328415 ms, foward_time = 10.404960, backward_time = 11.825152, perf = 36.93 tflops.
STEP-45: step_time = 22.060032 ms, foward_time = 10.773504, backward_time = 11.188224, perf = 37.38 tflops.
STEP-46: step_time = 21.480287 ms, foward_time = 10.262368, backward_time = 11.118592, perf = 38.39 tflops.
STEP-47: step_time = 21.863391 ms, foward_time = 10.162144, backward_time = 11.602944, perf = 37.72 tflops.
STEP-48: step_time = 21.562815 ms, foward_time = 10.314176, backward_time = 11.151360, perf = 38.24 tflops.
STEP-49: step_time = 21.555168 ms, foward_time = 10.208224, backward_time = 11.247616, perf = 38.26 tflops.
STEP-50: step_time = 21.910816 ms, foward_time = 10.618144, backward_time = 11.195392, perf = 37.64 tflops.
STEP-51: step_time = 22.033409 ms, foward_time = 10.702848, backward_time = 11.232256, perf = 37.43 tflops.
STEP-52: step_time = 21.988481 ms, foward_time = 10.672256, backward_time = 11.217920, perf = 37.50 tflops.
STEP-53: step_time = 22.290432 ms, foward_time = 10.746880, backward_time = 11.447296, perf = 36.99 tflops.
STEP-54: step_time = 22.363135 ms, foward_time = 10.836992, backward_time = 11.428864, perf = 36.87 tflops.
STEP-55: step_time = 21.582848 ms, foward_time = 10.122240, backward_time = 11.361280, perf = 38.21 tflops.
STEP-56: step_time = 22.237185 ms, foward_time = 10.857472, backward_time = 11.281408, perf = 37.08 tflops.
STEP-57: step_time = 21.808512 ms, foward_time = 10.350976, backward_time = 11.360256, perf = 37.81 tflops.
STEP-58: step_time = 21.674623 ms, foward_time = 10.349184, backward_time = 11.228160, perf = 38.05 tflops.
STEP-59: step_time = 22.426656 ms, foward_time = 10.965024, backward_time = 11.364352, perf = 36.77 tflops.
STEP-60: step_time = 22.111232 ms, foward_time = 10.469376, backward_time = 11.543552, perf = 37.29 tflops.
STEP-61: step_time = 22.106112 ms, foward_time = 10.603520, backward_time = 11.403264, perf = 37.30 tflops.
STEP-62: step_time = 21.687296 ms, foward_time = 10.345473, backward_time = 11.245568, perf = 38.02 tflops.
STEP-63: step_time = 22.341631 ms, foward_time = 10.846208, backward_time = 11.398144, perf = 36.91 tflops.
STEP-64: step_time = 22.626144 ms, foward_time = 10.757984, backward_time = 11.769856, perf = 36.45 tflops.
STEP-65: step_time = 22.217729 ms, foward_time = 10.513408, backward_time = 11.608064, perf = 37.12 tflops.
STEP-66: step_time = 22.108160 ms, foward_time = 10.566656, backward_time = 11.444224, perf = 37.30 tflops.
STEP-67: step_time = 22.129888 ms, foward_time = 10.683616, backward_time = 11.350016, perf = 37.26 tflops.
STEP-68: step_time = 22.087329 ms, foward_time = 10.632864, backward_time = 11.358208, perf = 37.34 tflops.
STEP-69: step_time = 22.074655 ms, foward_time = 10.732832, backward_time = 11.244544, perf = 37.36 tflops.
STEP-70: step_time = 22.257247 ms, foward_time = 10.666592, backward_time = 11.494400, perf = 37.05 tflops.
STEP-71: step_time = 21.864447 ms, foward_time = 10.167296, backward_time = 11.598848, perf = 37.72 tflops.
STEP-72: step_time = 22.076416 ms, foward_time = 10.196992, backward_time = 11.781120, perf = 37.35 tflops.
STEP-73: step_time = 22.092705 ms, foward_time = 10.631072, backward_time = 11.364352, perf = 37.33 tflops.
STEP-74: step_time = 22.489664 ms, foward_time = 11.206208, backward_time = 11.157504, perf = 36.67 tflops.
STEP-75: step_time = 22.402047 ms, foward_time = 10.587136, backward_time = 11.716608, perf = 36.81 tflops.
STEP-76: step_time = 22.327295 ms, foward_time = 10.442752, backward_time = 11.787264, perf = 36.93 tflops.
STEP-77: step_time = 22.234944 ms, foward_time = 10.788672, backward_time = 11.348992, perf = 37.09 tflops.
STEP-78: step_time = 22.528001 ms, foward_time = 11.169792, backward_time = 11.260928, perf = 36.60 tflops.
STEP-79: step_time = 22.033407 ms, foward_time = 10.391552, backward_time = 11.543552, perf = 37.43 tflops.
STEP-80: step_time = 22.804545 ms, foward_time = 10.934336, backward_time = 11.771904, perf = 36.16 tflops.
STEP-81: step_time = 22.633473 ms, foward_time = 11.183104, backward_time = 11.354112, perf = 36.43 tflops.
STEP-82: step_time = 21.674144 ms, foward_time = 10.391712, backward_time = 11.185152, perf = 38.05 tflops.
STEP-83: step_time = 21.983232 ms, foward_time = 10.187776, backward_time = 11.698176, perf = 37.51 tflops.
STEP-84: step_time = 21.566463 ms, foward_time = 9.851904, backward_time = 11.617280, perf = 38.24 tflops.
STEP-85: step_time = 22.341601 ms, foward_time = 10.897376, backward_time = 11.347968, perf = 36.91 tflops.
STEP-86: step_time = 21.733377 ms, foward_time = 10.489856, backward_time = 11.145216, perf = 37.94 tflops.
STEP-87: step_time = 22.379520 ms, foward_time = 10.945536, backward_time = 11.336704, perf = 36.85 tflops.
STEP-88: step_time = 22.351871 ms, foward_time = 10.771456, backward_time = 11.482112, perf = 36.89 tflops.
STEP-89: step_time = 21.868544 ms, foward_time = 10.027008, backward_time = 11.743232, perf = 37.71 tflops.
STEP-90: step_time = 21.953535 ms, foward_time = 10.449920, backward_time = 11.406336, perf = 37.56 tflops.
STEP-91: step_time = 22.246400 ms, foward_time = 10.803200, backward_time = 11.345920, perf = 37.07 tflops.
STEP-92: step_time = 22.385664 ms, foward_time = 10.813441, backward_time = 11.471872, perf = 36.84 tflops.
STEP-93: step_time = 22.396927 ms, foward_time = 10.519552, backward_time = 11.780096, perf = 36.82 tflops.
STEP-94: step_time = 22.298623 ms, foward_time = 10.755072, backward_time = 11.445248, perf = 36.98 tflops.
STEP-95: step_time = 22.595360 ms, foward_time = 11.287328, backward_time = 11.209728, perf = 36.50 tflops.
STEP-96: step_time = 22.339648 ms, foward_time = 10.886208, backward_time = 11.355136, perf = 36.91 tflops.
STEP-97: step_time = 22.684768 ms, foward_time = 10.756192, backward_time = 11.830272, perf = 36.35 tflops.
STEP-98: step_time = 22.532096 ms, foward_time = 11.004928, backward_time = 11.429888, perf = 36.60 tflops.
STEP-99: step_time = 22.461697 ms, foward_time = 11.074816, backward_time = 11.290624, perf = 36.71 tflops.

 mix_moe 16 [Summary] Average synchronized step_time = 22.389471888542175 ms, forward = 10.835065627098084 , backward = 11.456511878967286 .
cuda:0
cuda:2
cuda:1
cuda:3
[Benchmark] world_size = 4, dtype = float16, model_dim = 1024, hidden_size = 4096, samples = 8192, num_local_experts = 32, topK = 2, a2a_ffn_overlap_degree = 1, device = `cuda:0`
STEP-0: step_time = 47.023071 ms, foward_time = 25.221069, backward_time = 21.515265, perf = 17.54 tflops.
STEP-1: step_time = 32.020482 ms, foward_time = 16.669695, backward_time = 15.238144, perf = 25.75 tflops.
STEP-2: step_time = 31.541248 ms, foward_time = 16.284672, backward_time = 15.165440, perf = 26.14 tflops.
STEP-3: step_time = 31.024128 ms, foward_time = 16.125952, backward_time = 14.799872, perf = 26.58 tflops.
STEP-4: step_time = 28.096512 ms, foward_time = 14.272513, backward_time = 13.733888, perf = 29.35 tflops.
STEP-5: step_time = 26.558465 ms, foward_time = 13.341696, backward_time = 13.128704, perf = 31.05 tflops.
STEP-6: step_time = 26.951681 ms, foward_time = 13.757440, backward_time = 13.093888, perf = 30.60 tflops.
STEP-7: step_time = 25.654271 ms, foward_time = 14.031873, backward_time = 11.492352, perf = 32.14 tflops.
STEP-8: step_time = 24.237055 ms, foward_time = 12.882945, backward_time = 11.233280, perf = 34.02 tflops.
STEP-9: step_time = 24.128512 ms, foward_time = 12.840960, backward_time = 11.164672, perf = 34.18 tflops.
STEP-10: step_time = 23.075839 ms, foward_time = 12.191744, backward_time = 10.727424, perf = 35.74 tflops.
STEP-11: step_time = 21.758977 ms, foward_time = 10.518528, backward_time = 11.082752, perf = 37.90 tflops.
STEP-12: step_time = 21.903360 ms, foward_time = 11.159552, backward_time = 10.586112, perf = 37.65 tflops.
STEP-13: step_time = 23.099392 ms, foward_time = 12.313600, backward_time = 10.628096, perf = 35.70 tflops.
STEP-14: step_time = 20.670464 ms, foward_time = 10.256384, backward_time = 10.257408, perf = 39.89 tflops.
STEP-15: step_time = 23.617536 ms, foward_time = 13.500415, backward_time = 9.971712, perf = 34.92 tflops.
STEP-16: step_time = 22.068225 ms, foward_time = 11.444224, backward_time = 10.493952, perf = 37.37 tflops.
STEP-17: step_time = 22.472704 ms, foward_time = 11.617280, backward_time = 10.745856, perf = 36.69 tflops.
STEP-18: step_time = 22.703104 ms, foward_time = 12.523520, backward_time = 10.073088, perf = 36.32 tflops.
STEP-19: step_time = 21.601280 ms, foward_time = 11.094016, backward_time = 10.411008, perf = 38.18 tflops.
STEP-20: step_time = 21.762048 ms, foward_time = 11.086848, backward_time = 10.579968, perf = 37.89 tflops.
STEP-21: step_time = 22.044672 ms, foward_time = 11.297792, backward_time = 10.653696, perf = 37.41 tflops.
STEP-22: step_time = 24.072193 ms, foward_time = 14.139392, backward_time = 9.836544, perf = 34.26 tflops.
STEP-23: step_time = 22.732800 ms, foward_time = 12.044288, backward_time = 10.591232, perf = 36.28 tflops.
STEP-24: step_time = 21.891073 ms, foward_time = 11.462656, backward_time = 10.331136, perf = 37.67 tflops.
STEP-25: step_time = 22.411263 ms, foward_time = 11.938816, backward_time = 10.376192, perf = 36.80 tflops.
STEP-26: step_time = 22.965248 ms, foward_time = 12.076032, backward_time = 10.782720, perf = 35.91 tflops.
STEP-27: step_time = 22.938623 ms, foward_time = 12.070912, backward_time = 10.771456, perf = 35.95 tflops.
STEP-28: step_time = 22.020096 ms, foward_time = 11.255808, backward_time = 10.668032, perf = 37.45 tflops.
STEP-29: step_time = 21.714944 ms, foward_time = 11.365376, backward_time = 10.253312, perf = 37.98 tflops.
STEP-30: step_time = 22.091775 ms, foward_time = 11.768832, backward_time = 10.227712, perf = 37.33 tflops.
STEP-31: step_time = 21.964063 ms, foward_time = 11.524384, backward_time = 10.335232, perf = 37.54 tflops.
STEP-32: step_time = 22.322208 ms, foward_time = 11.358240, backward_time = 10.867712, perf = 36.94 tflops.
STEP-33: step_time = 21.833729 ms, foward_time = 11.091968, backward_time = 10.645504, perf = 37.77 tflops.
STEP-34: step_time = 22.232063 ms, foward_time = 11.235328, backward_time = 10.901504, perf = 37.09 tflops.
STEP-35: step_time = 21.836800 ms, foward_time = 11.468800, backward_time = 10.272768, perf = 37.76 tflops.
STEP-36: step_time = 21.565439 ms, foward_time = 11.183104, backward_time = 10.285056, perf = 38.24 tflops.
STEP-37: step_time = 21.573631 ms, foward_time = 11.110400, backward_time = 10.365952, perf = 38.22 tflops.
STEP-38: step_time = 21.831679 ms, foward_time = 11.344896, backward_time = 10.389504, perf = 37.77 tflops.
STEP-39: step_time = 22.391808 ms, foward_time = 11.550720, backward_time = 10.744832, perf = 36.83 tflops.
STEP-40: step_time = 22.515327 ms, foward_time = 11.463295, backward_time = 10.957824, perf = 36.63 tflops.
STEP-41: step_time = 22.233472 ms, foward_time = 11.556224, backward_time = 10.582016, perf = 37.09 tflops.
STEP-42: step_time = 22.129664 ms, foward_time = 11.565056, backward_time = 10.467328, perf = 37.26 tflops.
STEP-43: step_time = 21.956608 ms, foward_time = 11.120640, backward_time = 10.737664, perf = 37.56 tflops.
STEP-44: step_time = 22.360639 ms, foward_time = 11.435584, backward_time = 10.828800, perf = 36.88 tflops.
STEP-45: step_time = 22.183935 ms, foward_time = 11.317248, backward_time = 10.771456, perf = 37.17 tflops.
STEP-46: step_time = 22.060031 ms, foward_time = 11.523072, backward_time = 10.438656, perf = 37.38 tflops.
STEP-47: step_time = 22.373024 ms, foward_time = 11.615904, backward_time = 10.647552, perf = 36.86 tflops.
STEP-48: step_time = 22.923232 ms, foward_time = 11.681760, backward_time = 11.145216, perf = 35.97 tflops.
STEP-49: step_time = 21.597184 ms, foward_time = 10.847232, backward_time = 10.652672, perf = 38.18 tflops.
STEP-50: step_time = 23.073824 ms, foward_time = 12.150816, backward_time = 10.825728, perf = 35.74 tflops.
STEP-51: step_time = 22.325856 ms, foward_time = 11.429472, backward_time = 10.800128, perf = 36.94 tflops.
STEP-52: step_time = 22.715200 ms, foward_time = 11.928385, backward_time = 10.690560, perf = 36.30 tflops.
STEP-53: step_time = 21.649183 ms, foward_time = 11.127584, backward_time = 10.425344, perf = 38.09 tflops.
STEP-54: step_time = 21.828960 ms, foward_time = 11.198816, backward_time = 10.533888, perf = 37.78 tflops.
STEP-55: step_time = 21.581825 ms, foward_time = 11.061248, backward_time = 10.425344, perf = 38.21 tflops.
STEP-56: step_time = 22.307167 ms, foward_time = 11.541856, backward_time = 10.667008, perf = 36.97 tflops.
STEP-57: step_time = 22.507520 ms, foward_time = 11.555840, backward_time = 10.855424, perf = 36.64 tflops.
STEP-58: step_time = 21.830655 ms, foward_time = 11.204608, backward_time = 10.530816, perf = 37.77 tflops.
STEP-59: step_time = 21.410817 ms, foward_time = 10.979328, backward_time = 10.338304, perf = 38.51 tflops.
STEP-60: step_time = 21.592991 ms, foward_time = 10.920864, backward_time = 10.576896, perf = 38.19 tflops.
STEP-61: step_time = 22.311744 ms, foward_time = 11.658048, backward_time = 10.559488, perf = 36.96 tflops.
STEP-62: step_time = 22.981632 ms, foward_time = 11.829248, backward_time = 11.057152, perf = 35.88 tflops.
STEP-63: step_time = 23.351296 ms, foward_time = 12.333056, backward_time = 10.923008, perf = 35.31 tflops.
STEP-64: step_time = 22.020448 ms, foward_time = 11.448672, backward_time = 10.474496, perf = 37.45 tflops.
STEP-65: step_time = 21.931424 ms, foward_time = 11.013536, backward_time = 10.820608, perf = 37.60 tflops.
STEP-66: step_time = 22.270976 ms, foward_time = 11.365376, backward_time = 10.808320, perf = 37.03 tflops.
STEP-67: step_time = 22.089728 ms, foward_time = 11.609088, backward_time = 10.384384, perf = 37.33 tflops.
STEP-68: step_time = 21.839361 ms, foward_time = 11.488768, backward_time = 10.254336, perf = 37.76 tflops.
STEP-69: step_time = 22.263424 ms, foward_time = 11.746944, backward_time = 10.420224, perf = 37.04 tflops.
STEP-70: step_time = 22.222911 ms, foward_time = 11.446336, backward_time = 10.681344, perf = 37.11 tflops.
STEP-71: step_time = 22.182368 ms, foward_time = 11.247072, backward_time = 10.839040, perf = 37.18 tflops.
STEP-72: step_time = 21.822464 ms, foward_time = 11.329536, backward_time = 10.396672, perf = 37.79 tflops.
STEP-73: step_time = 21.667040 ms, foward_time = 11.494624, backward_time = 10.076160, perf = 38.06 tflops.
STEP-74: step_time = 21.453823 ms, foward_time = 11.217921, backward_time = 10.139648, perf = 38.44 tflops.
STEP-75: step_time = 21.536769 ms, foward_time = 10.943488, backward_time = 10.496000, perf = 38.29 tflops.
STEP-76: step_time = 22.174721 ms, foward_time = 11.739136, backward_time = 10.339328, perf = 37.19 tflops.
STEP-77: step_time = 22.296575 ms, foward_time = 11.871232, backward_time = 10.330112, perf = 36.98 tflops.
STEP-78: step_time = 22.179840 ms, foward_time = 11.645952, backward_time = 10.438656, perf = 37.18 tflops.
STEP-79: step_time = 21.394431 ms, foward_time = 10.382336, backward_time = 10.916864, perf = 38.54 tflops.
STEP-80: step_time = 22.406144 ms, foward_time = 11.853824, backward_time = 10.456064, perf = 36.80 tflops.
STEP-81: step_time = 23.091199 ms, foward_time = 11.849728, backward_time = 11.146240, perf = 35.71 tflops.
STEP-82: step_time = 21.924800 ms, foward_time = 11.280320, backward_time = 10.550272, perf = 37.61 tflops.
STEP-83: step_time = 22.394497 ms, foward_time = 11.843200, backward_time = 10.457088, perf = 36.82 tflops.
STEP-84: step_time = 21.984257 ms, foward_time = 11.206656, backward_time = 10.682368, perf = 37.51 tflops.
STEP-85: step_time = 21.785600 ms, foward_time = 11.499520, backward_time = 10.189824, perf = 37.85 tflops.
STEP-86: step_time = 21.833728 ms, foward_time = 10.920960, backward_time = 10.816512, perf = 37.77 tflops.
STEP-87: step_time = 21.831617 ms, foward_time = 11.329472, backward_time = 10.393600, perf = 37.77 tflops.
STEP-88: step_time = 22.667456 ms, foward_time = 11.753664, backward_time = 10.814464, perf = 36.38 tflops.
STEP-89: step_time = 22.016001 ms, foward_time = 11.129856, backward_time = 10.781696, perf = 37.46 tflops.
STEP-90: step_time = 22.298945 ms, foward_time = 11.635008, backward_time = 10.561536, perf = 36.98 tflops.
STEP-91: step_time = 22.493185 ms, foward_time = 11.597824, backward_time = 10.780672, perf = 36.66 tflops.
STEP-92: step_time = 22.494879 ms, foward_time = 11.647648, backward_time = 10.746880, perf = 36.66 tflops.
STEP-93: step_time = 22.215936 ms, foward_time = 11.308288, backward_time = 10.809344, perf = 37.12 tflops.
STEP-94: step_time = 21.569536 ms, foward_time = 10.982400, backward_time = 10.491904, perf = 38.23 tflops.
STEP-95: step_time = 21.796865 ms, foward_time = 11.149312, backward_time = 10.550272, perf = 37.83 tflops.
STEP-96: step_time = 22.063456 ms, foward_time = 11.425120, backward_time = 10.541056, perf = 37.38 tflops.
STEP-97: step_time = 21.721087 ms, foward_time = 11.123712, backward_time = 10.502144, perf = 37.96 tflops.
STEP-98: step_time = 21.775585 ms, foward_time = 11.447520, backward_time = 10.231808, perf = 37.87 tflops.
STEP-99: step_time = 21.991425 ms, foward_time = 11.269120, backward_time = 10.627072, perf = 37.50 tflops.

 mix_moe 32 [Summary] Average synchronized step_time = 22.042089819908142 ms, forward = 11.358595061302186 , backward = 10.584268760681152 .
cuda:0
cuda:2
cuda:1
cuda:3
[Benchmark] world_size = 4, dtype = float16, model_dim = 1024, hidden_size = 4096, samples = 8192, num_local_experts = 64, topK = 2, a2a_ffn_overlap_degree = 1, device = `cuda:0`
STEP-0: step_time = 49.383179 ms, foward_time = 28.411621, backward_time = 20.611073, perf = 16.70 tflops.
STEP-1: step_time = 33.305154 ms, foward_time = 18.994752, backward_time = 14.191616, perf = 24.76 tflops.
STEP-2: step_time = 33.430527 ms, foward_time = 19.186688, backward_time = 14.145536, perf = 24.67 tflops.
STEP-3: step_time = 34.691488 ms, foward_time = 20.146593, backward_time = 14.445568, perf = 23.77 tflops.
STEP-4: step_time = 33.405954 ms, foward_time = 19.268607, backward_time = 14.039040, perf = 24.69 tflops.
STEP-5: step_time = 33.733633 ms, foward_time = 19.075071, backward_time = 14.559232, perf = 24.45 tflops.
STEP-6: step_time = 26.869760 ms, foward_time = 15.373311, backward_time = 11.398144, perf = 30.69 tflops.
STEP-7: step_time = 26.109953 ms, foward_time = 15.120384, backward_time = 10.890240, perf = 31.58 tflops.
STEP-8: step_time = 27.012096 ms, foward_time = 15.421440, backward_time = 11.488256, perf = 30.53 tflops.
STEP-9: step_time = 25.465857 ms, foward_time = 14.683136, backward_time = 10.682368, perf = 32.38 tflops.
STEP-10: step_time = 25.293823 ms, foward_time = 14.690304, backward_time = 10.503168, perf = 32.60 tflops.
STEP-11: step_time = 24.791039 ms, foward_time = 14.223361, backward_time = 10.467328, perf = 33.26 tflops.
STEP-12: step_time = 25.272321 ms, foward_time = 14.423040, backward_time = 10.749952, perf = 32.63 tflops.
STEP-13: step_time = 24.913919 ms, foward_time = 14.346239, backward_time = 10.467328, perf = 33.10 tflops.
STEP-14: step_time = 25.095168 ms, foward_time = 14.566399, backward_time = 10.427392, perf = 32.86 tflops.
STEP-15: step_time = 24.819713 ms, foward_time = 14.205953, backward_time = 10.511360, perf = 33.22 tflops.
STEP-16: step_time = 24.851456 ms, foward_time = 14.327807, backward_time = 10.425344, perf = 33.18 tflops.
STEP-17: step_time = 25.114495 ms, foward_time = 14.553985, backward_time = 10.460160, perf = 32.83 tflops.
STEP-18: step_time = 26.237951 ms, foward_time = 15.554560, backward_time = 10.584064, perf = 31.43 tflops.
STEP-19: step_time = 25.702400 ms, foward_time = 14.560257, backward_time = 11.040768, perf = 32.08 tflops.
STEP-20: step_time = 25.502177 ms, foward_time = 14.930399, backward_time = 10.469376, perf = 32.34 tflops.
STEP-21: step_time = 24.825856 ms, foward_time = 14.211071, backward_time = 10.513408, perf = 33.22 tflops.
STEP-22: step_time = 25.501695 ms, foward_time = 14.222336, backward_time = 11.181056, perf = 32.34 tflops.
STEP-23: step_time = 25.398273 ms, foward_time = 14.856193, backward_time = 10.441728, perf = 32.47 tflops.
STEP-24: step_time = 25.104384 ms, foward_time = 14.422017, backward_time = 10.582016, perf = 32.85 tflops.
STEP-25: step_time = 25.721856 ms, foward_time = 14.701567, backward_time = 10.918912, perf = 32.06 tflops.
STEP-26: step_time = 24.314880 ms, foward_time = 13.799423, backward_time = 10.414080, perf = 33.91 tflops.
STEP-27: step_time = 25.368577 ms, foward_time = 14.453761, backward_time = 10.790912, perf = 32.51 tflops.
STEP-28: step_time = 25.480160 ms, foward_time = 14.618592, backward_time = 10.760192, perf = 32.36 tflops.
STEP-29: step_time = 25.366528 ms, foward_time = 14.783488, backward_time = 10.481664, perf = 32.51 tflops.
STEP-30: step_time = 24.921087 ms, foward_time = 14.276608, backward_time = 10.544128, perf = 33.09 tflops.
STEP-31: step_time = 25.271616 ms, foward_time = 14.885185, backward_time = 10.285056, perf = 32.63 tflops.
STEP-32: step_time = 25.128224 ms, foward_time = 14.495008, backward_time = 10.531840, perf = 32.82 tflops.
STEP-33: step_time = 24.916256 ms, foward_time = 14.443808, backward_time = 10.369024, perf = 33.10 tflops.
STEP-34: step_time = 25.658592 ms, foward_time = 15.050977, backward_time = 10.504192, perf = 32.14 tflops.
STEP-35: step_time = 25.267201 ms, foward_time = 14.736384, backward_time = 10.429440, perf = 32.64 tflops.
STEP-36: step_time = 24.189952 ms, foward_time = 13.433856, backward_time = 10.655744, perf = 34.09 tflops.
STEP-37: step_time = 25.715841 ms, foward_time = 15.189121, backward_time = 10.425344, perf = 32.07 tflops.
STEP-38: step_time = 25.301120 ms, foward_time = 14.647424, backward_time = 10.554368, perf = 32.59 tflops.
STEP-39: step_time = 25.466399 ms, foward_time = 15.001121, backward_time = 10.364928, perf = 32.38 tflops.
STEP-40: step_time = 25.000960 ms, foward_time = 14.181376, backward_time = 10.719232, perf = 32.98 tflops.
STEP-41: step_time = 25.099265 ms, foward_time = 14.622720, backward_time = 10.375168, perf = 32.85 tflops.
STEP-42: step_time = 25.456800 ms, foward_time = 14.839967, backward_time = 10.516480, perf = 32.39 tflops.
STEP-43: step_time = 25.339903 ms, foward_time = 14.757887, backward_time = 10.482688, perf = 32.54 tflops.
STEP-44: step_time = 24.806401 ms, foward_time = 14.241793, backward_time = 10.465280, perf = 33.24 tflops.
STEP-45: step_time = 25.601600 ms, foward_time = 14.850624, backward_time = 10.650624, perf = 32.21 tflops.
STEP-46: step_time = 26.015040 ms, foward_time = 15.269185, backward_time = 10.646528, perf = 31.70 tflops.
STEP-47: step_time = 25.212352 ms, foward_time = 14.685632, backward_time = 10.425344, perf = 32.71 tflops.
STEP-48: step_time = 25.605120 ms, foward_time = 14.834688, backward_time = 10.670080, perf = 32.21 tflops.
STEP-49: step_time = 24.745985 ms, foward_time = 14.133249, backward_time = 10.513408, perf = 33.32 tflops.
STEP-50: step_time = 24.754176 ms, foward_time = 14.216193, backward_time = 10.440704, perf = 33.31 tflops.
STEP-51: step_time = 25.365503 ms, foward_time = 14.418943, backward_time = 10.847232, perf = 32.51 tflops.
STEP-52: step_time = 25.134080 ms, foward_time = 14.714879, backward_time = 10.317824, perf = 32.81 tflops.
STEP-53: step_time = 24.955904 ms, foward_time = 14.570496, backward_time = 10.285056, perf = 33.04 tflops.
STEP-54: step_time = 24.425472 ms, foward_time = 14.001151, backward_time = 10.327040, perf = 33.76 tflops.
STEP-55: step_time = 25.454591 ms, foward_time = 14.943233, backward_time = 10.412032, perf = 32.40 tflops.
STEP-56: step_time = 24.582144 ms, foward_time = 14.166016, backward_time = 10.317824, perf = 33.55 tflops.
STEP-57: step_time = 25.060352 ms, foward_time = 14.564352, backward_time = 10.397696, perf = 32.91 tflops.
STEP-58: step_time = 25.936897 ms, foward_time = 15.424513, backward_time = 10.375168, perf = 31.79 tflops.
STEP-59: step_time = 25.896961 ms, foward_time = 15.122432, backward_time = 10.673152, perf = 31.84 tflops.
STEP-60: step_time = 24.926337 ms, foward_time = 14.539904, backward_time = 10.286080, perf = 33.08 tflops.
STEP-61: step_time = 24.937952 ms, foward_time = 14.337503, backward_time = 10.500096, perf = 33.07 tflops.
STEP-62: step_time = 27.497471 ms, foward_time = 16.165888, backward_time = 11.231232, perf = 29.99 tflops.
STEP-63: step_time = 24.643584 ms, foward_time = 14.141440, backward_time = 10.403840, perf = 33.46 tflops.
STEP-64: step_time = 24.905728 ms, foward_time = 14.452737, backward_time = 10.354688, perf = 33.11 tflops.
STEP-65: step_time = 24.912896 ms, foward_time = 14.403584, backward_time = 10.409984, perf = 33.10 tflops.
STEP-66: step_time = 25.191425 ms, foward_time = 14.769151, backward_time = 10.323968, perf = 32.73 tflops.
STEP-67: step_time = 25.094143 ms, foward_time = 14.579712, backward_time = 10.413056, perf = 32.86 tflops.
STEP-68: step_time = 24.532992 ms, foward_time = 14.101504, backward_time = 10.333184, perf = 33.61 tflops.
STEP-69: step_time = 25.041920 ms, foward_time = 14.550015, backward_time = 10.391552, perf = 32.93 tflops.
STEP-70: step_time = 25.269248 ms, foward_time = 14.487552, backward_time = 10.661888, perf = 32.63 tflops.
STEP-71: step_time = 25.473024 ms, foward_time = 14.769152, backward_time = 10.604544, perf = 32.37 tflops.
STEP-72: step_time = 24.605696 ms, foward_time = 14.153727, backward_time = 10.353664, perf = 33.51 tflops.
STEP-73: step_time = 24.920063 ms, foward_time = 14.235647, backward_time = 10.579968, perf = 33.09 tflops.
STEP-74: step_time = 25.001983 ms, foward_time = 14.539776, backward_time = 10.364928, perf = 32.98 tflops.
STEP-75: step_time = 24.677376 ms, foward_time = 14.243840, backward_time = 10.335232, perf = 33.42 tflops.
STEP-76: step_time = 24.797183 ms, foward_time = 14.334975, backward_time = 10.363904, perf = 33.26 tflops.
STEP-77: step_time = 24.611840 ms, foward_time = 14.136319, backward_time = 10.377216, perf = 33.51 tflops.
STEP-78: step_time = 25.852927 ms, foward_time = 15.027200, backward_time = 10.726400, perf = 31.90 tflops.
STEP-79: step_time = 25.138176 ms, foward_time = 14.502913, backward_time = 10.533888, perf = 32.80 tflops.
STEP-80: step_time = 25.361408 ms, foward_time = 14.675968, backward_time = 10.587136, perf = 32.52 tflops.
STEP-81: step_time = 24.473600 ms, foward_time = 14.150656, backward_time = 10.224640, perf = 33.69 tflops.
STEP-82: step_time = 25.249984 ms, foward_time = 14.535871, backward_time = 10.611712, perf = 32.66 tflops.
STEP-83: step_time = 25.138176 ms, foward_time = 14.657536, backward_time = 10.380288, perf = 32.80 tflops.
STEP-84: step_time = 25.031680 ms, foward_time = 14.515200, backward_time = 10.418176, perf = 32.94 tflops.
STEP-85: step_time = 25.682656 ms, foward_time = 15.162080, backward_time = 10.421248, perf = 32.11 tflops.
STEP-86: step_time = 25.573600 ms, foward_time = 14.910688, backward_time = 10.505216, perf = 32.25 tflops.
STEP-87: step_time = 25.950528 ms, foward_time = 15.271232, backward_time = 10.591232, perf = 31.78 tflops.
STEP-88: step_time = 24.596481 ms, foward_time = 13.973505, backward_time = 10.539008, perf = 33.53 tflops.
STEP-89: step_time = 25.191425 ms, foward_time = 14.390271, backward_time = 10.720256, perf = 32.73 tflops.
STEP-90: step_time = 25.180063 ms, foward_time = 14.484385, backward_time = 10.611712, perf = 32.75 tflops.
STEP-91: step_time = 25.433439 ms, foward_time = 14.793056, backward_time = 10.554368, perf = 32.42 tflops.
STEP-92: step_time = 24.584192 ms, foward_time = 13.872127, backward_time = 10.627072, perf = 33.54 tflops.
STEP-93: step_time = 25.518080 ms, foward_time = 14.530560, backward_time = 10.906624, perf = 32.32 tflops.
STEP-94: step_time = 26.033664 ms, foward_time = 14.634496, backward_time = 11.301888, perf = 31.68 tflops.
STEP-95: step_time = 25.315328 ms, foward_time = 14.256128, backward_time = 10.977280, perf = 32.57 tflops.
STEP-96: step_time = 25.402049 ms, foward_time = 14.898881, backward_time = 10.419200, perf = 32.46 tflops.
STEP-97: step_time = 26.265599 ms, foward_time = 14.888961, backward_time = 11.288576, perf = 31.40 tflops.
STEP-98: step_time = 25.581568 ms, foward_time = 14.601216, backward_time = 10.896384, perf = 32.24 tflops.
STEP-99: step_time = 25.554944 ms, foward_time = 14.639104, backward_time = 10.829824, perf = 32.27 tflops.

 mix_moe 64 [Summary] Average synchronized step_time = 25.48689274787903 ms, forward = 14.559891366958619 , backward = 10.84129295349121 .
[Benchmark] world_size = 4, dtype = float16, model_dim = 1024, hidden_size = 4096, samples = 8192, num_local_experts = 4, topK = 2, a2a_ffn_overlap_degree = 1, device = `cuda:0`
STEP-0: step_time = 1535.796265 ms, foward_time = 1504.937012, backward_time = 30.503937, perf = 0.54 tflops.
STEP-1: step_time = 45.646847 ms, foward_time = 22.855680, backward_time = 22.682625, perf = 18.07 tflops.
STEP-2: step_time = 45.792255 ms, foward_time = 22.690817, backward_time = 22.980608, perf = 18.01 tflops.
STEP-3: step_time = 44.234753 ms, foward_time = 21.672960, backward_time = 22.453247, perf = 18.64 tflops.
STEP-4: step_time = 43.534336 ms, foward_time = 21.140480, backward_time = 22.301697, perf = 18.94 tflops.
STEP-5: step_time = 42.132481 ms, foward_time = 20.198400, backward_time = 21.835775, perf = 19.57 tflops.
STEP-6: step_time = 42.423298 ms, foward_time = 20.269056, backward_time = 22.006784, perf = 19.44 tflops.
STEP-7: step_time = 42.718208 ms, foward_time = 20.877312, backward_time = 21.708799, perf = 19.30 tflops.
STEP-8: step_time = 39.760895 ms, foward_time = 20.259840, backward_time = 19.414017, perf = 20.74 tflops.
STEP-9: step_time = 39.915520 ms, foward_time = 19.888128, backward_time = 19.936256, perf = 20.66 tflops.
STEP-10: step_time = 38.418430 ms, foward_time = 19.090431, backward_time = 19.236864, perf = 21.46 tflops.
STEP-11: step_time = 38.938625 ms, foward_time = 19.685375, backward_time = 19.163136, perf = 21.18 tflops.
STEP-12: step_time = 40.517632 ms, foward_time = 21.216255, backward_time = 19.200001, perf = 20.35 tflops.
STEP-13: step_time = 38.185986 ms, foward_time = 18.931711, backward_time = 19.153919, perf = 21.60 tflops.
STEP-14: step_time = 38.327297 ms, foward_time = 18.963455, backward_time = 19.279873, perf = 21.52 tflops.
STEP-15: step_time = 39.411713 ms, foward_time = 18.891775, backward_time = 20.432896, perf = 20.92 tflops.
STEP-16: step_time = 38.477825 ms, foward_time = 19.196928, backward_time = 19.193855, perf = 21.43 tflops.
STEP-17: step_time = 38.377472 ms, foward_time = 18.864128, backward_time = 19.408895, perf = 21.49 tflops.
STEP-18: step_time = 40.999935 ms, foward_time = 21.624832, backward_time = 19.266560, perf = 20.11 tflops.
STEP-19: step_time = 39.002113 ms, foward_time = 19.686399, backward_time = 19.209215, perf = 21.14 tflops.
STEP-20: step_time = 38.538239 ms, foward_time = 19.280895, backward_time = 19.156992, perf = 21.40 tflops.
STEP-21: step_time = 38.271999 ms, foward_time = 19.228672, backward_time = 18.938881, perf = 21.55 tflops.
STEP-22: step_time = 38.988800 ms, foward_time = 19.309568, backward_time = 19.576832, perf = 21.15 tflops.
STEP-23: step_time = 40.364033 ms, foward_time = 20.871168, backward_time = 19.388416, perf = 20.43 tflops.
STEP-24: step_time = 38.252544 ms, foward_time = 18.948095, backward_time = 19.202047, perf = 21.56 tflops.
STEP-25: step_time = 38.425598 ms, foward_time = 19.160065, backward_time = 19.163136, perf = 21.46 tflops.
STEP-26: step_time = 39.249920 ms, foward_time = 19.944448, backward_time = 19.202047, perf = 21.01 tflops.
STEP-27: step_time = 38.431744 ms, foward_time = 19.227648, backward_time = 19.096577, perf = 21.46 tflops.
STEP-28: step_time = 39.968769 ms, foward_time = 19.597313, backward_time = 20.269056, perf = 20.63 tflops.
STEP-29: step_time = 39.907330 ms, foward_time = 20.618240, backward_time = 19.171328, perf = 20.66 tflops.
STEP-30: step_time = 38.818817 ms, foward_time = 19.229696, backward_time = 19.449856, perf = 21.24 tflops.
STEP-31: step_time = 38.108158 ms, foward_time = 18.636801, backward_time = 19.366913, perf = 21.64 tflops.
STEP-32: step_time = 39.308289 ms, foward_time = 19.442688, backward_time = 19.761152, perf = 20.98 tflops.
STEP-33: step_time = 38.584320 ms, foward_time = 19.057665, backward_time = 19.422209, perf = 21.37 tflops.
STEP-34: step_time = 38.888447 ms, foward_time = 19.613695, backward_time = 19.168257, perf = 21.21 tflops.
STEP-35: step_time = 38.852608 ms, foward_time = 19.665920, backward_time = 19.083263, perf = 21.22 tflops.
STEP-36: step_time = 38.375423 ms, foward_time = 18.741247, backward_time = 19.531776, perf = 21.49 tflops.
STEP-37: step_time = 38.435841 ms, foward_time = 19.067904, backward_time = 19.265535, perf = 21.45 tflops.
STEP-38: step_time = 38.203392 ms, foward_time = 19.026943, backward_time = 19.073025, perf = 21.59 tflops.
STEP-39: step_time = 40.448002 ms, foward_time = 21.312511, backward_time = 19.031040, perf = 20.39 tflops.
STEP-40: step_time = 38.558720 ms, foward_time = 19.207169, backward_time = 19.250175, perf = 21.39 tflops.
STEP-41: step_time = 37.263359 ms, foward_time = 18.158592, backward_time = 19.001345, perf = 22.13 tflops.
STEP-42: step_time = 37.511169 ms, foward_time = 18.401279, backward_time = 19.006464, perf = 21.98 tflops.
STEP-43: step_time = 36.986881 ms, foward_time = 17.906689, backward_time = 18.979839, perf = 22.30 tflops.
STEP-44: step_time = 37.261311 ms, foward_time = 17.860607, backward_time = 19.300352, perf = 22.13 tflops.
STEP-45: step_time = 42.707970 ms, foward_time = 23.017471, backward_time = 19.481600, perf = 19.31 tflops.
STEP-46: step_time = 37.627903 ms, foward_time = 18.157568, backward_time = 19.352575, perf = 21.92 tflops.
STEP-47: step_time = 38.814720 ms, foward_time = 19.434496, backward_time = 19.265535, perf = 21.25 tflops.
STEP-48: step_time = 38.383617 ms, foward_time = 19.048449, backward_time = 19.224577, perf = 21.48 tflops.
STEP-49: step_time = 37.092354 ms, foward_time = 17.655807, backward_time = 19.330048, perf = 22.23 tflops.
STEP-50: step_time = 37.368832 ms, foward_time = 17.848320, backward_time = 19.416063, perf = 22.07 tflops.
STEP-51: step_time = 38.313984 ms, foward_time = 19.024897, backward_time = 19.181568, perf = 21.52 tflops.
STEP-52: step_time = 36.986881 ms, foward_time = 17.637377, backward_time = 19.247105, perf = 22.30 tflops.
STEP-53: step_time = 36.852737 ms, foward_time = 17.659904, backward_time = 19.087360, perf = 22.38 tflops.
STEP-54: step_time = 36.865025 ms, foward_time = 17.519615, backward_time = 19.238913, perf = 22.37 tflops.
STEP-55: step_time = 36.889599 ms, foward_time = 17.643520, backward_time = 19.141632, perf = 22.35 tflops.
STEP-56: step_time = 36.638721 ms, foward_time = 17.465343, backward_time = 19.088385, perf = 22.51 tflops.
STEP-57: step_time = 39.133183 ms, foward_time = 18.990080, backward_time = 20.055040, perf = 21.07 tflops.
STEP-58: step_time = 36.680702 ms, foward_time = 17.408001, backward_time = 19.188736, perf = 22.48 tflops.
STEP-59: step_time = 36.903934 ms, foward_time = 17.616896, backward_time = 19.200001, perf = 22.35 tflops.
STEP-60: step_time = 36.857857 ms, foward_time = 17.517569, backward_time = 19.255297, perf = 22.37 tflops.
STEP-61: step_time = 36.664322 ms, foward_time = 17.403904, backward_time = 19.172352, perf = 22.49 tflops.
STEP-62: step_time = 39.354366 ms, foward_time = 19.257343, backward_time = 20.014080, perf = 20.95 tflops.
STEP-63: step_time = 36.616192 ms, foward_time = 17.488895, backward_time = 19.046400, perf = 22.52 tflops.
STEP-64: step_time = 38.481918 ms, foward_time = 19.224577, backward_time = 19.172352, perf = 21.43 tflops.
STEP-65: step_time = 36.904961 ms, foward_time = 17.661951, backward_time = 19.159040, perf = 22.34 tflops.
STEP-66: step_time = 37.047295 ms, foward_time = 17.588224, backward_time = 19.375105, perf = 22.26 tflops.
STEP-67: step_time = 36.785152 ms, foward_time = 17.515520, backward_time = 19.177471, perf = 22.42 tflops.
STEP-68: step_time = 37.502975 ms, foward_time = 17.385471, backward_time = 20.033537, perf = 21.99 tflops.
STEP-69: step_time = 37.486591 ms, foward_time = 18.285568, backward_time = 19.100672, perf = 22.00 tflops.
STEP-70: step_time = 36.656128 ms, foward_time = 17.430529, backward_time = 19.141632, perf = 22.50 tflops.
STEP-71: step_time = 36.584450 ms, foward_time = 17.393663, backward_time = 19.103745, perf = 22.54 tflops.
STEP-72: step_time = 36.715519 ms, foward_time = 17.543167, backward_time = 19.087360, perf = 22.46 tflops.
STEP-73: step_time = 36.860928 ms, foward_time = 17.519615, backward_time = 19.257343, perf = 22.37 tflops.
STEP-74: step_time = 37.605377 ms, foward_time = 17.474560, backward_time = 20.045824, perf = 21.93 tflops.
STEP-75: step_time = 36.798466 ms, foward_time = 17.603584, backward_time = 19.106815, perf = 22.41 tflops.
STEP-76: step_time = 37.337090 ms, foward_time = 17.508352, backward_time = 19.743744, perf = 22.09 tflops.
STEP-77: step_time = 37.490688 ms, foward_time = 18.167809, backward_time = 19.240959, perf = 22.00 tflops.
STEP-78: step_time = 36.803585 ms, foward_time = 17.658880, backward_time = 19.058687, perf = 22.41 tflops.
STEP-79: step_time = 36.695042 ms, foward_time = 17.510401, backward_time = 19.098623, perf = 22.47 tflops.
STEP-80: step_time = 37.105663 ms, foward_time = 17.561600, backward_time = 19.460096, perf = 22.22 tflops.
STEP-81: step_time = 36.911102 ms, foward_time = 17.490944, backward_time = 19.334145, perf = 22.34 tflops.
STEP-82: step_time = 36.642815 ms, foward_time = 17.398785, backward_time = 19.162111, perf = 22.50 tflops.
STEP-83: step_time = 36.924416 ms, foward_time = 17.603584, backward_time = 19.235840, perf = 22.33 tflops.
STEP-84: step_time = 36.690945 ms, foward_time = 17.461248, backward_time = 19.143681, perf = 22.48 tflops.
STEP-85: step_time = 37.612545 ms, foward_time = 17.532928, backward_time = 19.994623, perf = 21.92 tflops.
STEP-86: step_time = 37.042175 ms, foward_time = 17.406977, backward_time = 19.527679, perf = 22.26 tflops.
STEP-87: step_time = 36.993023 ms, foward_time = 17.743872, backward_time = 19.165184, perf = 22.29 tflops.
STEP-88: step_time = 37.949440 ms, foward_time = 18.728960, backward_time = 19.124224, perf = 21.73 tflops.
STEP-89: step_time = 37.663746 ms, foward_time = 18.427904, backward_time = 19.151873, perf = 21.89 tflops.
STEP-90: step_time = 38.739967 ms, foward_time = 19.479551, backward_time = 19.165184, perf = 21.29 tflops.
STEP-91: step_time = 36.862976 ms, foward_time = 17.488895, backward_time = 19.289087, perf = 22.37 tflops.
STEP-92: step_time = 36.608002 ms, foward_time = 17.374208, backward_time = 19.148800, perf = 22.53 tflops.
STEP-93: step_time = 38.444031 ms, foward_time = 19.189760, backward_time = 19.165184, perf = 21.45 tflops.
STEP-94: step_time = 38.665215 ms, foward_time = 19.369984, backward_time = 19.209215, perf = 21.33 tflops.
STEP-95: step_time = 36.794369 ms, foward_time = 17.518593, backward_time = 19.190784, perf = 22.41 tflops.
STEP-96: step_time = 38.475777 ms, foward_time = 19.284992, backward_time = 19.103745, perf = 21.43 tflops.
STEP-97: step_time = 38.750210 ms, foward_time = 19.386368, backward_time = 19.275776, perf = 21.28 tflops.
STEP-98: step_time = 37.313538 ms, foward_time = 17.326080, backward_time = 19.898369, perf = 22.10 tflops.
STEP-99: step_time = 36.712448 ms, foward_time = 17.499136, backward_time = 19.126272, perf = 22.46 tflops.

 fast_moe 4 [Summary] Average synchronized step_time = 37.44988174438477 ms, forward = 18.067933909098308 , backward = 19.288337071736652 .
[Benchmark] world_size = 4, dtype = float16, model_dim = 1024, hidden_size = 4096, samples = 8192, num_local_experts = 8, topK = 2, a2a_ffn_overlap_degree = 1, device = `cuda:0`
STEP-0: step_time = 1618.945068 ms, foward_time = 1583.157227, backward_time = 34.950146, perf = 0.51 tflops.
STEP-1: step_time = 56.727551 ms, foward_time = 28.258305, backward_time = 28.310528, perf = 14.54 tflops.
STEP-2: step_time = 56.098816 ms, foward_time = 26.944511, backward_time = 29.034496, perf = 14.70 tflops.
STEP-3: step_time = 52.425728 ms, foward_time = 25.776129, backward_time = 26.527744, perf = 15.73 tflops.
STEP-4: step_time = 52.940800 ms, foward_time = 26.001408, backward_time = 26.814465, perf = 15.58 tflops.
STEP-5: step_time = 52.409344 ms, foward_time = 25.415680, backward_time = 26.874880, perf = 15.73 tflops.
STEP-6: step_time = 55.346176 ms, foward_time = 30.964737, backward_time = 24.239103, perf = 14.90 tflops.
STEP-7: step_time = 49.146881 ms, foward_time = 23.103489, backward_time = 25.922560, perf = 16.78 tflops.
STEP-8: step_time = 48.389118 ms, foward_time = 23.976959, backward_time = 24.314880, perf = 17.04 tflops.
STEP-9: step_time = 50.565121 ms, foward_time = 25.947136, backward_time = 24.521729, perf = 16.31 tflops.
STEP-10: step_time = 49.505280 ms, foward_time = 24.996864, backward_time = 24.413183, perf = 16.66 tflops.
STEP-11: step_time = 48.335873 ms, foward_time = 24.016895, backward_time = 24.221697, perf = 17.06 tflops.
STEP-12: step_time = 48.903168 ms, foward_time = 24.321024, backward_time = 24.488960, perf = 16.86 tflops.
STEP-13: step_time = 48.353279 ms, foward_time = 23.836672, backward_time = 24.420353, perf = 17.05 tflops.
STEP-14: step_time = 50.492416 ms, foward_time = 26.093569, backward_time = 24.303616, perf = 16.33 tflops.
STEP-15: step_time = 49.666046 ms, foward_time = 25.746431, backward_time = 23.723007, perf = 16.60 tflops.
STEP-16: step_time = 48.205826 ms, foward_time = 23.520256, backward_time = 24.590336, perf = 17.11 tflops.
STEP-17: step_time = 47.443970 ms, foward_time = 23.317505, backward_time = 24.033279, perf = 17.38 tflops.
STEP-18: step_time = 48.613377 ms, foward_time = 24.548351, backward_time = 23.970816, perf = 16.96 tflops.
STEP-19: step_time = 48.142338 ms, foward_time = 24.296448, backward_time = 23.751680, perf = 17.13 tflops.
STEP-20: step_time = 50.974720 ms, foward_time = 24.424448, backward_time = 26.460159, perf = 16.18 tflops.
STEP-21: step_time = 48.994305 ms, foward_time = 24.871937, backward_time = 24.027136, perf = 16.83 tflops.
STEP-22: step_time = 47.499264 ms, foward_time = 23.523329, backward_time = 23.885824, perf = 17.36 tflops.
STEP-23: step_time = 48.982018 ms, foward_time = 24.957952, backward_time = 23.918592, perf = 16.84 tflops.
STEP-24: step_time = 46.566399 ms, foward_time = 22.426624, backward_time = 24.033279, perf = 17.71 tflops.
STEP-25: step_time = 48.690174 ms, foward_time = 24.166401, backward_time = 24.434689, perf = 16.94 tflops.
STEP-26: step_time = 47.637505 ms, foward_time = 23.636992, backward_time = 23.910400, perf = 17.31 tflops.
STEP-27: step_time = 47.970303 ms, foward_time = 23.853056, backward_time = 24.026112, perf = 17.19 tflops.
STEP-28: step_time = 48.038914 ms, foward_time = 23.711744, backward_time = 24.217600, perf = 17.17 tflops.
STEP-29: step_time = 47.561729 ms, foward_time = 23.532543, backward_time = 23.936001, perf = 17.34 tflops.
STEP-30: step_time = 47.463425 ms, foward_time = 23.485439, backward_time = 23.888897, perf = 17.37 tflops.
STEP-31: step_time = 46.513153 ms, foward_time = 22.554625, backward_time = 23.870464, perf = 17.73 tflops.
STEP-32: step_time = 51.490814 ms, foward_time = 26.896383, backward_time = 24.500223, perf = 16.02 tflops.
STEP-33: step_time = 48.982018 ms, foward_time = 25.003008, backward_time = 23.869440, perf = 16.84 tflops.
STEP-34: step_time = 47.932415 ms, foward_time = 23.731199, backward_time = 24.101889, perf = 17.20 tflops.
STEP-35: step_time = 47.898624 ms, foward_time = 24.060928, backward_time = 23.746559, perf = 17.22 tflops.
STEP-36: step_time = 47.879169 ms, foward_time = 23.933952, backward_time = 23.854080, perf = 17.22 tflops.
STEP-37: step_time = 47.922176 ms, foward_time = 23.838720, backward_time = 23.990273, perf = 17.21 tflops.
STEP-38: step_time = 48.123905 ms, foward_time = 24.317951, backward_time = 23.716864, perf = 17.14 tflops.
STEP-39: step_time = 47.712257 ms, foward_time = 23.931904, backward_time = 23.684095, perf = 17.28 tflops.
STEP-40: step_time = 47.935490 ms, foward_time = 23.943169, backward_time = 23.904257, perf = 17.20 tflops.
STEP-41: step_time = 47.464447 ms, foward_time = 23.589888, backward_time = 23.785473, perf = 17.37 tflops.
STEP-42: step_time = 47.467522 ms, foward_time = 23.733248, backward_time = 23.645184, perf = 17.37 tflops.
STEP-43: step_time = 47.711231 ms, foward_time = 23.892992, backward_time = 23.729153, perf = 17.28 tflops.
STEP-44: step_time = 47.554562 ms, foward_time = 23.680000, backward_time = 23.764992, perf = 17.34 tflops.
STEP-45: step_time = 48.055298 ms, foward_time = 23.829504, backward_time = 24.137728, perf = 17.16 tflops.
STEP-46: step_time = 47.620094 ms, foward_time = 23.488512, backward_time = 24.024063, perf = 17.32 tflops.
STEP-47: step_time = 48.004097 ms, foward_time = 23.749632, backward_time = 24.163328, perf = 17.18 tflops.
STEP-48: step_time = 47.564800 ms, foward_time = 23.578625, backward_time = 23.892992, perf = 17.34 tflops.
STEP-49: step_time = 46.197762 ms, foward_time = 22.394880, backward_time = 23.710720, perf = 17.85 tflops.
STEP-50: step_time = 48.313343 ms, foward_time = 24.500223, backward_time = 23.726080, perf = 17.07 tflops.
STEP-51: step_time = 48.338943 ms, foward_time = 24.434689, backward_time = 23.811071, perf = 17.06 tflops.
STEP-52: step_time = 47.077377 ms, foward_time = 23.083008, backward_time = 23.903233, perf = 17.52 tflops.
STEP-53: step_time = 48.283649 ms, foward_time = 24.509439, backward_time = 23.671808, perf = 17.08 tflops.
STEP-54: step_time = 48.129025 ms, foward_time = 24.341503, backward_time = 23.697409, perf = 17.13 tflops.
STEP-55: step_time = 47.193089 ms, foward_time = 23.312384, backward_time = 23.790592, perf = 17.47 tflops.
STEP-56: step_time = 48.165890 ms, foward_time = 24.236032, backward_time = 23.824385, perf = 17.12 tflops.
STEP-57: step_time = 47.591423 ms, foward_time = 23.743488, backward_time = 23.755775, perf = 17.33 tflops.
STEP-58: step_time = 48.801792 ms, foward_time = 24.730623, backward_time = 23.981056, perf = 16.90 tflops.
STEP-59: step_time = 47.688705 ms, foward_time = 23.761921, backward_time = 23.831553, perf = 17.29 tflops.
STEP-60: step_time = 48.761856 ms, foward_time = 24.803328, backward_time = 23.830528, perf = 16.91 tflops.
STEP-61: step_time = 47.668224 ms, foward_time = 23.612415, backward_time = 23.946239, perf = 17.30 tflops.
STEP-62: step_time = 48.071678 ms, foward_time = 23.760897, backward_time = 24.211456, perf = 17.15 tflops.
STEP-63: step_time = 47.772671 ms, foward_time = 23.707647, backward_time = 23.972864, perf = 17.26 tflops.
STEP-64: step_time = 47.990784 ms, foward_time = 24.160255, backward_time = 23.735296, perf = 17.18 tflops.
STEP-65: step_time = 48.149506 ms, foward_time = 23.826431, backward_time = 24.224768, perf = 17.13 tflops.
STEP-66: step_time = 49.757183 ms, foward_time = 25.076736, backward_time = 24.589312, perf = 16.57 tflops.
STEP-67: step_time = 48.933887 ms, foward_time = 24.389631, backward_time = 24.449024, perf = 16.85 tflops.
STEP-68: step_time = 48.583679 ms, foward_time = 23.912449, backward_time = 24.578049, perf = 16.97 tflops.
STEP-69: step_time = 49.726463 ms, foward_time = 25.064447, backward_time = 24.543232, perf = 16.58 tflops.
STEP-70: step_time = 48.444416 ms, foward_time = 24.005632, backward_time = 24.306688, perf = 17.02 tflops.
STEP-71: step_time = 48.622593 ms, foward_time = 24.195072, backward_time = 24.307713, perf = 16.96 tflops.
STEP-72: step_time = 48.676865 ms, foward_time = 24.449024, backward_time = 24.109056, perf = 16.94 tflops.
STEP-73: step_time = 47.340546 ms, foward_time = 22.627329, backward_time = 24.623104, perf = 17.42 tflops.
STEP-74: step_time = 49.737728 ms, foward_time = 25.121792, backward_time = 24.520704, perf = 16.58 tflops.
STEP-75: step_time = 48.930817 ms, foward_time = 24.384512, backward_time = 24.455168, perf = 16.85 tflops.
STEP-76: step_time = 48.571392 ms, foward_time = 24.003584, backward_time = 24.478720, perf = 16.98 tflops.
STEP-77: step_time = 49.714176 ms, foward_time = 25.145344, backward_time = 24.474625, perf = 16.59 tflops.
STEP-78: step_time = 49.223679 ms, foward_time = 24.612864, backward_time = 24.514561, perf = 16.75 tflops.
STEP-79: step_time = 49.612801 ms, foward_time = 24.643583, backward_time = 24.872959, perf = 16.62 tflops.
STEP-80: step_time = 49.434624 ms, foward_time = 24.926208, backward_time = 24.407040, perf = 16.68 tflops.
STEP-81: step_time = 48.598015 ms, foward_time = 24.084480, backward_time = 24.424448, perf = 16.97 tflops.
STEP-82: step_time = 49.099777 ms, foward_time = 24.009727, backward_time = 24.977407, perf = 16.80 tflops.
STEP-83: step_time = 49.328129 ms, foward_time = 24.876032, backward_time = 24.345600, perf = 16.72 tflops.
STEP-84: step_time = 48.670719 ms, foward_time = 24.283136, backward_time = 24.279039, perf = 16.94 tflops.
STEP-85: step_time = 48.756737 ms, foward_time = 24.256512, backward_time = 24.404991, perf = 16.91 tflops.
STEP-86: step_time = 49.488895 ms, foward_time = 24.895489, backward_time = 24.502272, perf = 16.66 tflops.
STEP-87: step_time = 47.422462 ms, foward_time = 22.803455, backward_time = 24.513536, perf = 17.39 tflops.
STEP-88: step_time = 47.132671 ms, foward_time = 22.545408, backward_time = 24.488960, perf = 17.50 tflops.
STEP-89: step_time = 48.145409 ms, foward_time = 23.558144, backward_time = 24.480768, perf = 17.13 tflops.
STEP-90: step_time = 49.189888 ms, foward_time = 24.577024, backward_time = 24.522753, perf = 16.76 tflops.
STEP-91: step_time = 48.609280 ms, foward_time = 24.245249, backward_time = 24.271872, perf = 16.96 tflops.
STEP-92: step_time = 48.239616 ms, foward_time = 23.691263, backward_time = 24.459265, perf = 17.09 tflops.
STEP-93: step_time = 49.535999 ms, foward_time = 24.989697, backward_time = 24.439808, perf = 16.65 tflops.
STEP-94: step_time = 48.961536 ms, foward_time = 24.444927, backward_time = 24.427521, perf = 16.84 tflops.
STEP-95: step_time = 48.648193 ms, foward_time = 24.174591, backward_time = 24.377344, perf = 16.95 tflops.
STEP-96: step_time = 48.476158 ms, foward_time = 23.890944, backward_time = 24.493055, perf = 17.01 tflops.
STEP-97: step_time = 48.169983 ms, foward_time = 23.651327, backward_time = 24.422400, perf = 17.12 tflops.
STEP-98: step_time = 49.184769 ms, foward_time = 24.598528, backward_time = 24.495104, perf = 16.77 tflops.
STEP-99: step_time = 49.139713 ms, foward_time = 24.022017, backward_time = 25.010176, perf = 16.78 tflops.

 fast_moe 8 [Summary] Average synchronized step_time = 48.39470094045003 ms, forward = 24.076014868418376 , backward = 24.2206379254659 .
[Benchmark] world_size = 4, dtype = float16, model_dim = 1024, hidden_size = 4096, samples = 8192, num_local_experts = 16, topK = 2, a2a_ffn_overlap_degree = 1, device = `cuda:0`
STEP-0: step_time = 1397.823486 ms, foward_time = 1359.173584, backward_time = 37.873665, perf = 0.59 tflops.
STEP-1: step_time = 63.419392 ms, foward_time = 31.972351, backward_time = 31.310848, perf = 13.00 tflops.
STEP-2: step_time = 61.094913 ms, foward_time = 30.534657, backward_time = 30.437376, perf = 13.50 tflops.
STEP-3: step_time = 60.961792 ms, foward_time = 31.306751, backward_time = 29.508608, perf = 13.53 tflops.
STEP-4: step_time = 61.346817 ms, foward_time = 31.712255, backward_time = 29.507584, perf = 13.44 tflops.
STEP-5: step_time = 61.467648 ms, foward_time = 31.645697, backward_time = 29.680639, perf = 13.42 tflops.
STEP-6: step_time = 60.496895 ms, foward_time = 31.223808, backward_time = 29.122561, perf = 13.63 tflops.
STEP-7: step_time = 63.694847 ms, foward_time = 34.339840, backward_time = 29.202433, perf = 12.95 tflops.
STEP-8: step_time = 60.164097 ms, foward_time = 30.812160, backward_time = 29.200384, perf = 13.71 tflops.
STEP-9: step_time = 61.207554 ms, foward_time = 31.780865, backward_time = 29.266945, perf = 13.47 tflops.
STEP-10: step_time = 63.210495 ms, foward_time = 33.776642, backward_time = 29.283327, perf = 13.05 tflops.
STEP-11: step_time = 60.875774 ms, foward_time = 31.271936, backward_time = 29.452288, perf = 13.55 tflops.
STEP-12: step_time = 60.809216 ms, foward_time = 30.454784, backward_time = 30.192640, perf = 13.56 tflops.
STEP-13: step_time = 64.653313 ms, foward_time = 33.715199, backward_time = 30.787584, perf = 12.75 tflops.
STEP-14: step_time = 61.487103 ms, foward_time = 30.860289, backward_time = 30.486528, perf = 13.41 tflops.
STEP-15: step_time = 62.190594 ms, foward_time = 32.136192, backward_time = 29.903872, perf = 13.26 tflops.
STEP-16: step_time = 60.695553 ms, foward_time = 30.459904, backward_time = 30.100479, perf = 13.59 tflops.
STEP-17: step_time = 64.782333 ms, foward_time = 34.185215, backward_time = 30.457855, perf = 12.73 tflops.
STEP-18: step_time = 61.580288 ms, foward_time = 31.401983, backward_time = 30.056448, perf = 13.39 tflops.
STEP-19: step_time = 61.771774 ms, foward_time = 31.135744, backward_time = 30.504959, perf = 13.35 tflops.
STEP-20: step_time = 64.952316 ms, foward_time = 34.251778, backward_time = 30.563328, perf = 12.70 tflops.
STEP-21: step_time = 61.640705 ms, foward_time = 31.335424, backward_time = 30.176256, perf = 13.38 tflops.
STEP-22: step_time = 61.272064 ms, foward_time = 31.412224, backward_time = 29.733889, perf = 13.46 tflops.
STEP-23: step_time = 63.042561 ms, foward_time = 33.589249, backward_time = 29.307903, perf = 13.08 tflops.
STEP-24: step_time = 59.939838 ms, foward_time = 30.669825, backward_time = 29.147137, perf = 13.76 tflops.
STEP-25: step_time = 60.141567 ms, foward_time = 30.788609, backward_time = 29.184000, perf = 13.71 tflops.
STEP-26: step_time = 65.087486 ms, foward_time = 32.221184, backward_time = 32.744450, perf = 12.67 tflops.
STEP-27: step_time = 62.043137 ms, foward_time = 32.794624, backward_time = 29.110271, perf = 13.29 tflops.
STEP-28: step_time = 60.679169 ms, foward_time = 31.342592, backward_time = 29.213696, perf = 13.59 tflops.
STEP-29: step_time = 62.921726 ms, foward_time = 32.968704, backward_time = 29.821953, perf = 13.11 tflops.
STEP-30: step_time = 63.637505 ms, foward_time = 32.720898, backward_time = 30.785536, perf = 12.96 tflops.
STEP-31: step_time = 61.297665 ms, foward_time = 31.928320, backward_time = 29.240320, perf = 13.45 tflops.
STEP-32: step_time = 65.824768 ms, foward_time = 36.028416, backward_time = 29.447168, perf = 12.53 tflops.
STEP-33: step_time = 60.754944 ms, foward_time = 31.270912, backward_time = 29.296640, perf = 13.57 tflops.
STEP-34: step_time = 59.963390 ms, foward_time = 30.662657, backward_time = 29.115393, perf = 13.75 tflops.
STEP-35: step_time = 60.021759 ms, foward_time = 30.730240, backward_time = 29.107201, perf = 13.74 tflops.
STEP-36: step_time = 60.214272 ms, foward_time = 30.987265, backward_time = 29.035521, perf = 13.69 tflops.
STEP-37: step_time = 60.252159 ms, foward_time = 30.937088, backward_time = 29.168640, perf = 13.69 tflops.
STEP-38: step_time = 59.609089 ms, foward_time = 30.189568, backward_time = 29.274113, perf = 13.83 tflops.
STEP-39: step_time = 59.668480 ms, foward_time = 30.373888, backward_time = 29.143040, perf = 13.82 tflops.
STEP-40: step_time = 58.890240 ms, foward_time = 29.737984, backward_time = 29.005823, perf = 14.00 tflops.
STEP-41: step_time = 59.231232 ms, foward_time = 30.150656, backward_time = 28.935167, perf = 13.92 tflops.
STEP-42: step_time = 59.356159 ms, foward_time = 29.860865, backward_time = 29.352961, perf = 13.89 tflops.
STEP-43: step_time = 60.058624 ms, foward_time = 30.718975, backward_time = 29.197311, perf = 13.73 tflops.
STEP-44: step_time = 59.706367 ms, foward_time = 30.407681, backward_time = 29.157375, perf = 13.81 tflops.
STEP-45: step_time = 59.288574 ms, foward_time = 29.934591, backward_time = 29.212671, perf = 13.91 tflops.
STEP-46: step_time = 59.954178 ms, foward_time = 30.630913, backward_time = 29.181952, perf = 13.75 tflops.
STEP-47: step_time = 59.237377 ms, foward_time = 30.106625, backward_time = 28.996609, perf = 13.92 tflops.
STEP-48: step_time = 59.627522 ms, foward_time = 30.445568, backward_time = 29.043713, perf = 13.83 tflops.
STEP-49: step_time = 59.657215 ms, foward_time = 30.448641, backward_time = 29.031424, perf = 13.82 tflops.
STEP-50: step_time = 60.138496 ms, foward_time = 30.578688, backward_time = 29.414400, perf = 13.71 tflops.
STEP-51: step_time = 59.525120 ms, foward_time = 30.260223, backward_time = 29.119488, perf = 13.85 tflops.
STEP-52: step_time = 60.232704 ms, foward_time = 30.710785, backward_time = 29.377537, perf = 13.69 tflops.
STEP-53: step_time = 59.418625 ms, foward_time = 30.254080, backward_time = 29.017088, perf = 13.88 tflops.
STEP-54: step_time = 59.578369 ms, foward_time = 30.231552, backward_time = 29.204479, perf = 13.84 tflops.
STEP-55: step_time = 59.387905 ms, foward_time = 30.247936, backward_time = 28.989441, perf = 13.89 tflops.
STEP-56: step_time = 59.871231 ms, foward_time = 30.594048, backward_time = 29.132799, perf = 13.77 tflops.
STEP-57: step_time = 59.769855 ms, foward_time = 30.500864, backward_time = 29.126656, perf = 13.80 tflops.
STEP-58: step_time = 59.784191 ms, foward_time = 30.211073, backward_time = 29.430784, perf = 13.79 tflops.
STEP-59: step_time = 60.732414 ms, foward_time = 30.771200, backward_time = 29.810688, perf = 13.58 tflops.
STEP-60: step_time = 60.882942 ms, foward_time = 31.544319, backward_time = 29.187073, perf = 13.54 tflops.
STEP-61: step_time = 60.599297 ms, foward_time = 31.316992, backward_time = 29.139969, perf = 13.61 tflops.
STEP-62: step_time = 59.657215 ms, foward_time = 30.498816, backward_time = 29.022207, perf = 13.82 tflops.
STEP-63: step_time = 59.656193 ms, foward_time = 30.183424, backward_time = 29.324287, perf = 13.82 tflops.
STEP-64: step_time = 59.679745 ms, foward_time = 30.590977, backward_time = 28.948481, perf = 13.82 tflops.
STEP-65: step_time = 59.693054 ms, foward_time = 30.522367, backward_time = 29.025280, perf = 13.81 tflops.
STEP-66: step_time = 59.913216 ms, foward_time = 30.387199, backward_time = 29.373440, perf = 13.76 tflops.
STEP-67: step_time = 59.739136 ms, foward_time = 30.534657, backward_time = 29.056000, perf = 13.80 tflops.
STEP-68: step_time = 60.006401 ms, foward_time = 30.595072, backward_time = 29.266945, perf = 13.74 tflops.
STEP-69: step_time = 59.950081 ms, foward_time = 30.410751, backward_time = 29.395967, perf = 13.76 tflops.
STEP-70: step_time = 59.771904 ms, foward_time = 30.424065, backward_time = 29.205503, perf = 13.80 tflops.
STEP-71: step_time = 59.526142 ms, foward_time = 30.274561, backward_time = 29.109247, perf = 13.85 tflops.
STEP-72: step_time = 59.823105 ms, foward_time = 30.495745, backward_time = 29.173759, perf = 13.78 tflops.
STEP-73: step_time = 60.232704 ms, foward_time = 30.714880, backward_time = 29.367296, perf = 13.69 tflops.
STEP-74: step_time = 59.958271 ms, foward_time = 30.778368, backward_time = 29.033472, perf = 13.75 tflops.
STEP-75: step_time = 59.580418 ms, foward_time = 30.255104, backward_time = 29.169664, perf = 13.84 tflops.
STEP-76: step_time = 60.090366 ms, foward_time = 30.320641, backward_time = 29.629440, perf = 13.72 tflops.
STEP-77: step_time = 60.825600 ms, foward_time = 31.166464, backward_time = 29.508608, perf = 13.56 tflops.
STEP-78: step_time = 60.219391 ms, foward_time = 30.694401, backward_time = 29.371391, perf = 13.69 tflops.
STEP-79: step_time = 59.079681 ms, foward_time = 29.711361, backward_time = 29.219839, perf = 13.96 tflops.
STEP-80: step_time = 58.849281 ms, foward_time = 27.870209, backward_time = 30.836737, perf = 14.01 tflops.
STEP-81: step_time = 58.864639 ms, foward_time = 29.506559, backward_time = 29.207552, perf = 14.01 tflops.
STEP-82: step_time = 57.846783 ms, foward_time = 28.168192, backward_time = 29.536257, perf = 14.26 tflops.
STEP-83: step_time = 58.603519 ms, foward_time = 29.087744, backward_time = 29.358080, perf = 14.07 tflops.
STEP-84: step_time = 57.022465 ms, foward_time = 27.887615, backward_time = 28.980225, perf = 14.46 tflops.
STEP-85: step_time = 57.177090 ms, foward_time = 28.050432, backward_time = 28.977152, perf = 14.42 tflops.
STEP-86: step_time = 57.400318 ms, foward_time = 27.878401, backward_time = 29.379583, perf = 14.37 tflops.
STEP-87: step_time = 57.057281 ms, foward_time = 27.998207, backward_time = 28.909569, perf = 14.45 tflops.
STEP-88: step_time = 57.558018 ms, foward_time = 27.885569, backward_time = 29.531136, perf = 14.33 tflops.
STEP-89: step_time = 58.347519 ms, foward_time = 29.227009, backward_time = 28.976128, perf = 14.13 tflops.
STEP-90: step_time = 57.964542 ms, foward_time = 28.549120, backward_time = 29.268991, perf = 14.23 tflops.
STEP-91: step_time = 62.046207 ms, foward_time = 29.630465, backward_time = 32.259071, perf = 13.29 tflops.
STEP-92: step_time = 57.014271 ms, foward_time = 27.844608, backward_time = 29.021185, perf = 14.46 tflops.
STEP-93: step_time = 57.018368 ms, foward_time = 27.926529, backward_time = 28.945408, perf = 14.46 tflops.
STEP-94: step_time = 58.355713 ms, foward_time = 28.741632, backward_time = 29.470720, perf = 14.13 tflops.
STEP-95: step_time = 57.103359 ms, foward_time = 28.001280, backward_time = 28.950527, perf = 14.44 tflops.
STEP-96: step_time = 58.037247 ms, foward_time = 28.787712, backward_time = 29.065216, perf = 14.21 tflops.
STEP-97: step_time = 57.357311 ms, foward_time = 28.140545, backward_time = 29.074432, perf = 14.38 tflops.
STEP-98: step_time = 58.882050 ms, foward_time = 29.073408, backward_time = 29.664255, perf = 14.00 tflops.
STEP-99: step_time = 57.561089 ms, foward_time = 28.480513, backward_time = 28.934143, perf = 14.33 tflops.

 fast_moe 16 [Summary] Average synchronized step_time = 59.20663884480794 ms, forward = 29.782647609710693 , backward = 29.27687670389811 .
[Benchmark] world_size = 4, dtype = float16, model_dim = 1024, hidden_size = 4096, samples = 8192, num_local_experts = 32, topK = 2, a2a_ffn_overlap_degree = 1, device = `cuda:0`
STEP-0: step_time = 1610.411987 ms, foward_time = 1554.745361, backward_time = 55.308289, perf = 0.51 tflops.
STEP-1: step_time = 91.999229 ms, foward_time = 46.467072, backward_time = 45.308929, perf = 8.96 tflops.
STEP-2: step_time = 85.705727 ms, foward_time = 44.826626, backward_time = 40.650753, perf = 9.62 tflops.
STEP-3: step_time = 80.087044 ms, foward_time = 40.420353, backward_time = 39.450623, perf = 10.30 tflops.
STEP-4: step_time = 79.902718 ms, foward_time = 40.283134, backward_time = 39.408642, perf = 10.32 tflops.
STEP-5: step_time = 79.290367 ms, foward_time = 40.419327, backward_time = 38.653954, perf = 10.40 tflops.
STEP-6: step_time = 80.177155 ms, foward_time = 40.561665, backward_time = 39.393280, perf = 10.29 tflops.
STEP-7: step_time = 79.156227 ms, foward_time = 39.607296, backward_time = 39.364609, perf = 10.42 tflops.
STEP-8: step_time = 76.881920 ms, foward_time = 38.119423, backward_time = 38.576126, perf = 10.73 tflops.
STEP-9: step_time = 76.705795 ms, foward_time = 37.505024, backward_time = 38.986752, perf = 10.75 tflops.
STEP-10: step_time = 76.569603 ms, foward_time = 37.924866, backward_time = 38.470657, perf = 10.77 tflops.
STEP-11: step_time = 77.020157 ms, foward_time = 37.922817, backward_time = 38.899712, perf = 10.71 tflops.
STEP-12: step_time = 77.743103 ms, foward_time = 37.990398, backward_time = 39.577599, perf = 10.61 tflops.
STEP-13: step_time = 77.603844 ms, foward_time = 38.460415, backward_time = 38.970367, perf = 10.63 tflops.
STEP-14: step_time = 77.478912 ms, foward_time = 38.401024, backward_time = 38.904831, perf = 10.64 tflops.
STEP-15: step_time = 77.529091 ms, foward_time = 37.870590, backward_time = 39.483391, perf = 10.64 tflops.
STEP-16: step_time = 78.056450 ms, foward_time = 38.096897, backward_time = 39.782398, perf = 10.56 tflops.
STEP-17: step_time = 77.219841 ms, foward_time = 38.004738, backward_time = 39.027714, perf = 10.68 tflops.
STEP-18: step_time = 76.993538 ms, foward_time = 38.235134, backward_time = 38.564865, perf = 10.71 tflops.
STEP-19: step_time = 76.189697 ms, foward_time = 37.528576, backward_time = 38.484993, perf = 10.82 tflops.
STEP-20: step_time = 76.483582 ms, foward_time = 37.032959, backward_time = 39.276543, perf = 10.78 tflops.
STEP-21: step_time = 76.323837 ms, foward_time = 37.635071, backward_time = 38.513664, perf = 10.80 tflops.
STEP-22: step_time = 77.493248 ms, foward_time = 39.004162, backward_time = 38.288383, perf = 10.64 tflops.
STEP-23: step_time = 78.525436 ms, foward_time = 38.939648, backward_time = 39.409664, perf = 10.50 tflops.
STEP-24: step_time = 80.034813 ms, foward_time = 40.626175, backward_time = 39.191551, perf = 10.30 tflops.
STEP-25: step_time = 77.988861 ms, foward_time = 37.447681, backward_time = 40.354816, perf = 10.57 tflops.
STEP-26: step_time = 76.850174 ms, foward_time = 37.427200, backward_time = 39.230465, perf = 10.73 tflops.
STEP-27: step_time = 76.275711 ms, foward_time = 37.310463, backward_time = 38.787071, perf = 10.81 tflops.
STEP-28: step_time = 75.759613 ms, foward_time = 36.846592, backward_time = 38.740993, perf = 10.88 tflops.
STEP-29: step_time = 76.160004 ms, foward_time = 37.577728, backward_time = 38.387711, perf = 10.83 tflops.
STEP-30: step_time = 75.636734 ms, foward_time = 37.124096, backward_time = 38.340607, perf = 10.90 tflops.
STEP-31: step_time = 74.523651 ms, foward_time = 37.598209, backward_time = 36.748287, perf = 11.07 tflops.
STEP-32: step_time = 77.451263 ms, foward_time = 39.622658, backward_time = 37.614594, perf = 10.65 tflops.
STEP-33: step_time = 76.811264 ms, foward_time = 39.431168, backward_time = 37.157887, perf = 10.74 tflops.
STEP-34: step_time = 81.537025 ms, foward_time = 42.995712, backward_time = 38.359039, perf = 10.11 tflops.
STEP-35: step_time = 77.152252 ms, foward_time = 39.486465, backward_time = 37.481472, perf = 10.69 tflops.
STEP-36: step_time = 79.342590 ms, foward_time = 38.985729, backward_time = 40.163326, perf = 10.39 tflops.
STEP-37: step_time = 77.510658 ms, foward_time = 39.043072, backward_time = 38.235134, perf = 10.64 tflops.
STEP-38: step_time = 74.343422 ms, foward_time = 37.638145, backward_time = 36.524033, perf = 11.09 tflops.
STEP-39: step_time = 74.824707 ms, foward_time = 37.400578, backward_time = 37.257217, perf = 11.02 tflops.
STEP-40: step_time = 77.542397 ms, foward_time = 39.058434, backward_time = 38.308865, perf = 10.63 tflops.
STEP-41: step_time = 73.584641 ms, foward_time = 36.256767, backward_time = 37.152767, perf = 11.21 tflops.
STEP-42: step_time = 73.599998 ms, foward_time = 35.680256, backward_time = 37.739521, perf = 11.20 tflops.
STEP-43: step_time = 77.062141 ms, foward_time = 39.446529, backward_time = 37.433346, perf = 10.70 tflops.
STEP-44: step_time = 74.889214 ms, foward_time = 36.303871, backward_time = 38.369282, perf = 11.01 tflops.
STEP-45: step_time = 78.786560 ms, foward_time = 39.643135, backward_time = 38.914047, perf = 10.47 tflops.
STEP-46: step_time = 83.588097 ms, foward_time = 44.265472, backward_time = 39.146496, perf = 9.87 tflops.
STEP-47: step_time = 78.741501 ms, foward_time = 38.972416, backward_time = 39.587841, perf = 10.47 tflops.
STEP-48: step_time = 78.779388 ms, foward_time = 39.070721, backward_time = 39.512066, perf = 10.47 tflops.
STEP-49: step_time = 74.484734 ms, foward_time = 35.634174, backward_time = 38.661121, perf = 11.07 tflops.
STEP-50: step_time = 74.107903 ms, foward_time = 35.332096, backward_time = 38.606850, perf = 11.13 tflops.
STEP-51: step_time = 74.557442 ms, foward_time = 35.566593, backward_time = 38.814720, perf = 11.06 tflops.
STEP-52: step_time = 76.924927 ms, foward_time = 36.194305, backward_time = 40.562687, perf = 10.72 tflops.
STEP-53: step_time = 76.792831 ms, foward_time = 37.658623, backward_time = 38.911999, perf = 10.74 tflops.
STEP-54: step_time = 75.683838 ms, foward_time = 36.144127, backward_time = 39.371777, perf = 10.90 tflops.
STEP-55: step_time = 75.235329 ms, foward_time = 35.318783, backward_time = 39.726082, perf = 10.96 tflops.
STEP-56: step_time = 74.606590 ms, foward_time = 35.887104, backward_time = 38.551552, perf = 11.05 tflops.
STEP-57: step_time = 75.952126 ms, foward_time = 35.746815, backward_time = 40.033279, perf = 10.86 tflops.
STEP-58: step_time = 74.702850 ms, foward_time = 35.883007, backward_time = 38.647808, perf = 11.04 tflops.
STEP-59: step_time = 74.471420 ms, foward_time = 35.393536, backward_time = 38.914047, perf = 11.07 tflops.
STEP-60: step_time = 75.250687 ms, foward_time = 36.158463, backward_time = 38.932480, perf = 10.96 tflops.
STEP-61: step_time = 74.937347 ms, foward_time = 36.228096, backward_time = 38.538239, perf = 11.00 tflops.
STEP-62: step_time = 75.564034 ms, foward_time = 35.917824, backward_time = 39.468033, perf = 10.91 tflops.
STEP-63: step_time = 74.680321 ms, foward_time = 35.977215, backward_time = 38.541313, perf = 11.04 tflops.
STEP-64: step_time = 73.097214 ms, foward_time = 35.951614, backward_time = 36.974590, perf = 11.28 tflops.
STEP-65: step_time = 73.603073 ms, foward_time = 36.246529, backward_time = 37.151745, perf = 11.20 tflops.
STEP-66: step_time = 74.013695 ms, foward_time = 36.633598, backward_time = 37.179394, perf = 11.14 tflops.
STEP-67: step_time = 73.446404 ms, foward_time = 35.908607, backward_time = 37.336063, perf = 11.23 tflops.
STEP-68: step_time = 74.374146 ms, foward_time = 36.169727, backward_time = 38.005760, perf = 11.09 tflops.
STEP-69: step_time = 74.151939 ms, foward_time = 36.834305, backward_time = 37.117950, perf = 11.12 tflops.
STEP-70: step_time = 73.205757 ms, foward_time = 36.013058, backward_time = 36.990974, perf = 11.26 tflops.
STEP-71: step_time = 76.723198 ms, foward_time = 39.583744, backward_time = 36.940800, perf = 10.75 tflops.
STEP-72: step_time = 76.181503 ms, foward_time = 38.909950, backward_time = 37.070847, perf = 10.82 tflops.
STEP-73: step_time = 76.278786 ms, foward_time = 38.848511, backward_time = 37.226498, perf = 10.81 tflops.
STEP-74: step_time = 73.190399 ms, foward_time = 35.773441, backward_time = 37.185535, perf = 11.27 tflops.
STEP-75: step_time = 73.302017 ms, foward_time = 35.920895, backward_time = 37.160961, perf = 11.25 tflops.
STEP-76: step_time = 72.944641 ms, foward_time = 35.589119, backward_time = 37.156864, perf = 11.30 tflops.
STEP-77: step_time = 72.999939 ms, foward_time = 35.562496, backward_time = 37.236736, perf = 11.30 tflops.
STEP-78: step_time = 75.087875 ms, foward_time = 37.373951, backward_time = 37.495808, perf = 10.98 tflops.
STEP-79: step_time = 73.146370 ms, foward_time = 35.630081, backward_time = 37.318657, perf = 11.27 tflops.
STEP-80: step_time = 73.368576 ms, foward_time = 36.061184, backward_time = 37.101566, perf = 11.24 tflops.
STEP-81: step_time = 73.263107 ms, foward_time = 35.831806, backward_time = 37.230591, perf = 11.26 tflops.
STEP-82: step_time = 73.826302 ms, foward_time = 35.835903, backward_time = 37.754879, perf = 11.17 tflops.
STEP-83: step_time = 73.723907 ms, foward_time = 36.777985, backward_time = 36.709377, perf = 11.19 tflops.
STEP-84: step_time = 73.296898 ms, foward_time = 35.834881, backward_time = 37.242882, perf = 11.25 tflops.
STEP-85: step_time = 73.394173 ms, foward_time = 36.009983, backward_time = 37.175297, perf = 11.24 tflops.
STEP-86: step_time = 72.727554 ms, foward_time = 35.518463, backward_time = 36.996098, perf = 11.34 tflops.
STEP-87: step_time = 73.028610 ms, foward_time = 35.713024, backward_time = 37.114880, perf = 11.29 tflops.
STEP-88: step_time = 73.503746 ms, foward_time = 36.289536, backward_time = 36.999168, perf = 11.22 tflops.
STEP-89: step_time = 72.734718 ms, foward_time = 35.552258, backward_time = 36.978687, perf = 11.34 tflops.
STEP-90: step_time = 73.117699 ms, foward_time = 35.773441, backward_time = 37.113857, perf = 11.28 tflops.
STEP-91: step_time = 73.961472 ms, foward_time = 36.144127, backward_time = 37.612545, perf = 11.15 tflops.
STEP-92: step_time = 73.525246 ms, foward_time = 36.175873, backward_time = 37.145599, perf = 11.22 tflops.
STEP-93: step_time = 73.371651 ms, foward_time = 36.143105, backward_time = 37.021694, perf = 11.24 tflops.
STEP-94: step_time = 73.055229 ms, foward_time = 35.684353, backward_time = 37.157887, perf = 11.29 tflops.
STEP-95: step_time = 73.663490 ms, foward_time = 36.315136, backward_time = 37.146626, perf = 11.19 tflops.
STEP-96: step_time = 73.819138 ms, foward_time = 36.294655, backward_time = 37.317631, perf = 11.17 tflops.
STEP-97: step_time = 72.741890 ms, foward_time = 35.625984, backward_time = 36.908031, perf = 11.34 tflops.
STEP-98: step_time = 74.637314 ms, foward_time = 37.119999, backward_time = 37.300224, perf = 11.05 tflops.
STEP-99: step_time = 73.285629 ms, foward_time = 36.074497, backward_time = 37.003265, perf = 11.25 tflops.

 fast_moe 32 [Summary] Average synchronized step_time = 74.63866030375162 ms, forward = 36.5910696665446 , backward = 37.85043640136719 .
[Benchmark] world_size = 4, dtype = float16, model_dim = 1024, hidden_size = 4096, samples = 8192, num_local_experts = 64, topK = 2, a2a_ffn_overlap_degree = 1, device = `cuda:0`
STEP-0: step_time = 1399.537720 ms, foward_time = 1330.334717, backward_time = 68.317184, perf = 0.59 tflops.
STEP-1: step_time = 123.243523 ms, foward_time = 62.541824, backward_time = 60.333057, perf = 6.69 tflops.
STEP-2: step_time = 136.048645 ms, foward_time = 75.439102, backward_time = 60.275711, perf = 6.06 tflops.
STEP-3: step_time = 127.066109 ms, foward_time = 67.680260, backward_time = 59.042816, perf = 6.49 tflops.
STEP-4: step_time = 127.304703 ms, foward_time = 67.785728, backward_time = 59.171841, perf = 6.48 tflops.
STEP-5: step_time = 123.744255 ms, foward_time = 64.535553, backward_time = 58.722305, perf = 6.66 tflops.
STEP-6: step_time = 117.160957 ms, foward_time = 58.970112, backward_time = 57.811970, perf = 7.04 tflops.
STEP-7: step_time = 124.094467 ms, foward_time = 67.448830, backward_time = 56.259583, perf = 6.65 tflops.
STEP-8: step_time = 115.090431 ms, foward_time = 59.365376, backward_time = 55.393280, perf = 7.17 tflops.
STEP-9: step_time = 114.422783 ms, foward_time = 58.929153, backward_time = 55.128063, perf = 7.21 tflops.
STEP-10: step_time = 115.824638 ms, foward_time = 59.325439, backward_time = 56.131584, perf = 7.12 tflops.
STEP-11: step_time = 115.859459 ms, foward_time = 60.165119, backward_time = 55.376896, perf = 7.12 tflops.
STEP-12: step_time = 114.812927 ms, foward_time = 58.403839, backward_time = 56.085503, perf = 7.18 tflops.
STEP-13: step_time = 115.045380 ms, foward_time = 58.815487, backward_time = 55.873535, perf = 7.17 tflops.
STEP-14: step_time = 113.819649 ms, foward_time = 58.259457, backward_time = 55.235584, perf = 7.25 tflops.
STEP-15: step_time = 114.583549 ms, foward_time = 59.598846, backward_time = 54.630402, perf = 7.20 tflops.
STEP-16: step_time = 114.726913 ms, foward_time = 59.129856, backward_time = 55.273472, perf = 7.19 tflops.
STEP-17: step_time = 116.861954 ms, foward_time = 60.069889, backward_time = 56.450047, perf = 7.06 tflops.
STEP-18: step_time = 113.320961 ms, foward_time = 58.183681, backward_time = 54.808575, perf = 7.28 tflops.
STEP-19: step_time = 111.346687 ms, foward_time = 56.524799, backward_time = 54.478848, perf = 7.41 tflops.
STEP-20: step_time = 112.082947 ms, foward_time = 56.557568, backward_time = 55.204865, perf = 7.36 tflops.
STEP-21: step_time = 111.295486 ms, foward_time = 56.598530, backward_time = 54.338558, perf = 7.41 tflops.
STEP-22: step_time = 112.601089 ms, foward_time = 56.383488, backward_time = 55.891968, perf = 7.32 tflops.
STEP-23: step_time = 112.491524 ms, foward_time = 56.951809, backward_time = 55.207935, perf = 7.33 tflops.
STEP-24: step_time = 111.630333 ms, foward_time = 56.457214, backward_time = 54.845440, perf = 7.39 tflops.
STEP-25: step_time = 111.928322 ms, foward_time = 56.561665, backward_time = 55.045120, perf = 7.37 tflops.
STEP-26: step_time = 112.381950 ms, foward_time = 57.034752, backward_time = 55.023617, perf = 7.34 tflops.
STEP-27: step_time = 114.548737 ms, foward_time = 58.856449, backward_time = 55.334911, perf = 7.20 tflops.
STEP-28: step_time = 112.822273 ms, foward_time = 57.093121, backward_time = 55.400448, perf = 7.31 tflops.
STEP-29: step_time = 112.562180 ms, foward_time = 56.843266, backward_time = 55.370750, perf = 7.33 tflops.
STEP-30: step_time = 113.311745 ms, foward_time = 57.509888, backward_time = 55.483391, perf = 7.28 tflops.
STEP-31: step_time = 112.072701 ms, foward_time = 56.764416, backward_time = 54.972416, perf = 7.36 tflops.
STEP-32: step_time = 111.683586 ms, foward_time = 56.970242, backward_time = 54.385666, perf = 7.38 tflops.
STEP-33: step_time = 114.097153 ms, foward_time = 57.369598, backward_time = 56.393726, perf = 7.23 tflops.
STEP-34: step_time = 112.433151 ms, foward_time = 56.629250, backward_time = 55.474174, perf = 7.33 tflops.
STEP-35: step_time = 113.407997 ms, foward_time = 57.348095, backward_time = 55.688190, perf = 7.27 tflops.
STEP-36: step_time = 111.945724 ms, foward_time = 56.366081, backward_time = 55.251968, perf = 7.37 tflops.
STEP-37: step_time = 114.471939 ms, foward_time = 57.889793, backward_time = 56.240128, perf = 7.20 tflops.
STEP-38: step_time = 113.336319 ms, foward_time = 58.033154, backward_time = 54.963200, perf = 7.28 tflops.
STEP-39: step_time = 113.692673 ms, foward_time = 56.449024, backward_time = 56.919041, perf = 7.25 tflops.
STEP-40: step_time = 111.969276 ms, foward_time = 56.345600, backward_time = 55.310337, perf = 7.36 tflops.
STEP-41: step_time = 111.575043 ms, foward_time = 55.958527, backward_time = 55.293953, perf = 7.39 tflops.
STEP-42: step_time = 113.439743 ms, foward_time = 56.957951, backward_time = 56.157185, perf = 7.27 tflops.
STEP-43: step_time = 112.888832 ms, foward_time = 57.404415, backward_time = 55.131138, perf = 7.30 tflops.
STEP-44: step_time = 111.403008 ms, foward_time = 56.304642, backward_time = 54.776833, perf = 7.40 tflops.
STEP-45: step_time = 114.019325 ms, foward_time = 57.372673, backward_time = 56.326145, perf = 7.23 tflops.
STEP-46: step_time = 114.100227 ms, foward_time = 58.699776, backward_time = 55.049217, perf = 7.23 tflops.
STEP-47: step_time = 113.536003 ms, foward_time = 58.139648, backward_time = 55.075840, perf = 7.26 tflops.
STEP-48: step_time = 109.425667 ms, foward_time = 53.504002, backward_time = 55.511040, perf = 7.54 tflops.
STEP-49: step_time = 111.407104 ms, foward_time = 54.948864, backward_time = 56.059902, perf = 7.40 tflops.
STEP-50: step_time = 109.787132 ms, foward_time = 54.594559, backward_time = 54.796288, perf = 7.51 tflops.
STEP-51: step_time = 109.936638 ms, foward_time = 54.386688, backward_time = 55.171070, perf = 7.50 tflops.
STEP-52: step_time = 109.528061 ms, foward_time = 53.783550, backward_time = 55.396351, perf = 7.53 tflops.
STEP-53: step_time = 111.501312 ms, foward_time = 54.802433, backward_time = 56.292351, perf = 7.40 tflops.
STEP-54: step_time = 110.816254 ms, foward_time = 55.207935, backward_time = 55.230465, perf = 7.44 tflops.
STEP-55: step_time = 110.129150 ms, foward_time = 54.539265, backward_time = 55.213055, perf = 7.49 tflops.
STEP-56: step_time = 111.448067 ms, foward_time = 55.745537, backward_time = 55.318527, perf = 7.40 tflops.
STEP-57: step_time = 108.479485 ms, foward_time = 53.176319, backward_time = 54.937599, perf = 7.60 tflops.
STEP-58: step_time = 109.806595 ms, foward_time = 54.322178, backward_time = 55.108608, perf = 7.51 tflops.
STEP-59: step_time = 109.947906 ms, foward_time = 54.299648, backward_time = 55.075840, perf = 7.50 tflops.
STEP-60: step_time = 108.756989 ms, foward_time = 53.303295, backward_time = 55.075840, perf = 7.58 tflops.
STEP-61: step_time = 110.134270 ms, foward_time = 54.840321, backward_time = 54.930431, perf = 7.49 tflops.
STEP-62: step_time = 109.843452 ms, foward_time = 54.715393, backward_time = 54.757378, perf = 7.51 tflops.
STEP-63: step_time = 109.323265 ms, foward_time = 53.749760, backward_time = 55.191551, perf = 7.54 tflops.
STEP-64: step_time = 110.938110 ms, foward_time = 55.056385, backward_time = 55.510017, perf = 7.43 tflops.
STEP-65: step_time = 111.029251 ms, foward_time = 54.887424, backward_time = 55.730175, perf = 7.43 tflops.
STEP-66: step_time = 110.285828 ms, foward_time = 54.992897, backward_time = 54.918144, perf = 7.48 tflops.
STEP-67: step_time = 109.080574 ms, foward_time = 53.165054, backward_time = 55.527424, perf = 7.56 tflops.
STEP-68: step_time = 107.990013 ms, foward_time = 53.044224, backward_time = 54.556671, perf = 7.64 tflops.
STEP-69: step_time = 110.956543 ms, foward_time = 55.282688, backward_time = 55.287807, perf = 7.43 tflops.
STEP-70: step_time = 110.133247 ms, foward_time = 53.308414, backward_time = 56.439808, perf = 7.49 tflops.
STEP-71: step_time = 108.705795 ms, foward_time = 53.584896, backward_time = 54.762497, perf = 7.59 tflops.
STEP-72: step_time = 110.559235 ms, foward_time = 54.718464, backward_time = 55.476223, perf = 7.46 tflops.
STEP-73: step_time = 111.286270 ms, foward_time = 54.786049, backward_time = 56.208385, perf = 7.41 tflops.
STEP-74: step_time = 111.137794 ms, foward_time = 54.761471, backward_time = 55.988224, perf = 7.42 tflops.
STEP-75: step_time = 109.081596 ms, foward_time = 53.677055, backward_time = 55.003136, perf = 7.56 tflops.
STEP-76: step_time = 110.129150 ms, foward_time = 54.007809, backward_time = 55.733250, perf = 7.49 tflops.
STEP-77: step_time = 108.242943 ms, foward_time = 53.110783, backward_time = 54.757378, perf = 7.62 tflops.
STEP-78: step_time = 110.793732 ms, foward_time = 54.684673, backward_time = 55.726082, perf = 7.44 tflops.
STEP-79: step_time = 110.225410 ms, foward_time = 54.544384, backward_time = 55.331841, perf = 7.48 tflops.
STEP-80: step_time = 112.322563 ms, foward_time = 55.755775, backward_time = 56.198143, perf = 7.34 tflops.
STEP-81: step_time = 110.231552 ms, foward_time = 54.862846, backward_time = 54.965248, perf = 7.48 tflops.
STEP-82: step_time = 109.549568 ms, foward_time = 54.494209, backward_time = 54.664192, perf = 7.53 tflops.
STEP-83: step_time = 109.338623 ms, foward_time = 53.974014, backward_time = 54.984703, perf = 7.54 tflops.
STEP-84: step_time = 113.169411 ms, foward_time = 57.224194, backward_time = 55.308289, perf = 7.29 tflops.
STEP-85: step_time = 110.895103 ms, foward_time = 55.148544, backward_time = 55.361534, perf = 7.44 tflops.
STEP-86: step_time = 111.393791 ms, foward_time = 55.617535, backward_time = 55.408642, perf = 7.40 tflops.
STEP-87: step_time = 111.566849 ms, foward_time = 55.239681, backward_time = 55.879681, perf = 7.39 tflops.
STEP-88: step_time = 110.597122 ms, foward_time = 54.790146, backward_time = 55.456768, perf = 7.46 tflops.
STEP-89: step_time = 110.928894 ms, foward_time = 54.493183, backward_time = 56.070145, perf = 7.43 tflops.
STEP-90: step_time = 110.168060 ms, foward_time = 55.206913, backward_time = 54.589439, perf = 7.49 tflops.
STEP-91: step_time = 109.888512 ms, foward_time = 54.593536, backward_time = 54.927361, perf = 7.50 tflops.
STEP-92: step_time = 109.740028 ms, foward_time = 54.358017, backward_time = 55.006207, perf = 7.51 tflops.
STEP-93: step_time = 109.555710 ms, foward_time = 54.312962, backward_time = 54.864895, perf = 7.53 tflops.
STEP-94: step_time = 109.187073 ms, foward_time = 54.047745, backward_time = 54.760448, perf = 7.55 tflops.
STEP-95: step_time = 111.431679 ms, foward_time = 54.978561, backward_time = 56.072193, perf = 7.40 tflops.
STEP-96: step_time = 111.171585 ms, foward_time = 54.792191, backward_time = 55.979008, perf = 7.42 tflops.
STEP-97: step_time = 111.340546 ms, foward_time = 54.760448, backward_time = 56.222721, perf = 7.41 tflops.
STEP-98: step_time = 110.313469 ms, foward_time = 54.831104, backward_time = 55.102463, perf = 7.48 tflops.
STEP-99: step_time = 109.418495 ms, foward_time = 53.354496, backward_time = 55.693314, perf = 7.54 tflops.

 fast_moe 64 [Summary] Average synchronized step_time = 110.59978218078614 ms, forward = 54.85919583638509 , backward = 55.3609899520874 .
[Benchmark] world_size = 4, dtype = float16, model_dim = 1024, hidden_size = 4096, samples = 8192, num_local_experts = 4, topK = 2, a2a_ffn_overlap_degree = 1, device = `cuda:0`
STEP-0: step_time = 1624.139771 ms, foward_time = 1584.423950, backward_time = 39.361534, perf = 0.51 tflops.
STEP-1: step_time = 62.361599 ms, foward_time = 30.936064, backward_time = 31.311872, perf = 13.22 tflops.
STEP-2: step_time = 51.234818 ms, foward_time = 25.249792, backward_time = 25.882624, perf = 16.10 tflops.
STEP-3: step_time = 50.577408 ms, foward_time = 25.329664, backward_time = 25.150463, perf = 16.30 tflops.
STEP-4: step_time = 49.800194 ms, foward_time = 24.518656, backward_time = 25.165825, perf = 16.56 tflops.
STEP-5: step_time = 50.094082 ms, foward_time = 24.553473, backward_time = 25.443329, perf = 16.46 tflops.
STEP-6: step_time = 50.140160 ms, foward_time = 24.676352, backward_time = 25.371649, perf = 16.45 tflops.
STEP-7: step_time = 49.805313 ms, foward_time = 25.327616, backward_time = 24.380417, perf = 16.56 tflops.
STEP-8: step_time = 49.974274 ms, foward_time = 24.927233, backward_time = 24.942593, perf = 16.50 tflops.
STEP-9: step_time = 47.595520 ms, foward_time = 23.030785, backward_time = 24.475649, perf = 17.33 tflops.
STEP-10: step_time = 48.563202 ms, foward_time = 24.085505, backward_time = 24.387585, perf = 16.98 tflops.
STEP-11: step_time = 47.648769 ms, foward_time = 23.304192, backward_time = 24.252417, perf = 17.31 tflops.
STEP-12: step_time = 49.673218 ms, foward_time = 25.294847, backward_time = 24.286207, perf = 16.60 tflops.
STEP-13: step_time = 49.060863 ms, foward_time = 24.799232, backward_time = 24.166401, perf = 16.81 tflops.
STEP-14: step_time = 47.763454 ms, foward_time = 23.428097, backward_time = 24.244225, perf = 17.26 tflops.
STEP-15: step_time = 47.568897 ms, foward_time = 23.233536, backward_time = 24.248320, perf = 17.34 tflops.
STEP-16: step_time = 48.753662 ms, foward_time = 24.551424, backward_time = 24.110081, perf = 16.91 tflops.
STEP-17: step_time = 48.546818 ms, foward_time = 24.255487, backward_time = 24.198145, perf = 16.99 tflops.
STEP-18: step_time = 47.706112 ms, foward_time = 23.502848, backward_time = 24.110081, perf = 17.29 tflops.
STEP-19: step_time = 47.643646 ms, foward_time = 23.621632, backward_time = 23.927809, perf = 17.31 tflops.
STEP-20: step_time = 49.164288 ms, foward_time = 23.445503, backward_time = 25.618431, perf = 16.77 tflops.
STEP-21: step_time = 49.388542 ms, foward_time = 25.388033, backward_time = 23.905279, perf = 16.70 tflops.
STEP-22: step_time = 47.774719 ms, foward_time = 23.597055, backward_time = 24.084480, perf = 17.26 tflops.
STEP-23: step_time = 47.953918 ms, foward_time = 23.951361, backward_time = 23.911425, perf = 17.20 tflops.
STEP-24: step_time = 47.529984 ms, foward_time = 23.242752, backward_time = 24.189953, perf = 17.35 tflops.
STEP-25: step_time = 51.102718 ms, foward_time = 26.779648, backward_time = 24.230911, perf = 16.14 tflops.
STEP-26: step_time = 47.907841 ms, foward_time = 23.766016, backward_time = 24.038401, perf = 17.21 tflops.
STEP-27: step_time = 46.878719 ms, foward_time = 22.828032, backward_time = 23.961599, perf = 17.59 tflops.
STEP-28: step_time = 47.371265 ms, foward_time = 23.386112, backward_time = 23.892992, perf = 17.41 tflops.
STEP-29: step_time = 52.336639 ms, foward_time = 23.367680, backward_time = 28.877825, perf = 15.76 tflops.
STEP-30: step_time = 48.244736 ms, foward_time = 23.934977, backward_time = 24.211456, perf = 17.09 tflops.
STEP-31: step_time = 48.010239 ms, foward_time = 23.382015, backward_time = 24.517632, perf = 17.18 tflops.
STEP-32: step_time = 46.259201 ms, foward_time = 22.375423, backward_time = 23.793665, perf = 17.83 tflops.
STEP-33: step_time = 46.356480 ms, foward_time = 22.437887, backward_time = 23.829504, perf = 17.79 tflops.
STEP-34: step_time = 46.354431 ms, foward_time = 22.424576, backward_time = 23.839745, perf = 17.79 tflops.
STEP-35: step_time = 48.241665 ms, foward_time = 23.686144, backward_time = 24.467457, perf = 17.09 tflops.
STEP-36: step_time = 47.554562 ms, foward_time = 23.623680, backward_time = 23.840769, perf = 17.34 tflops.
STEP-37: step_time = 47.156223 ms, foward_time = 22.514688, backward_time = 24.536064, perf = 17.49 tflops.
STEP-38: step_time = 46.197762 ms, foward_time = 22.297600, backward_time = 23.812096, perf = 17.85 tflops.
STEP-39: step_time = 51.292160 ms, foward_time = 26.964993, backward_time = 24.134657, perf = 16.08 tflops.
STEP-40: step_time = 46.956543 ms, foward_time = 22.976513, backward_time = 23.890944, perf = 17.56 tflops.
STEP-41: step_time = 46.517246 ms, foward_time = 22.428673, backward_time = 23.995392, perf = 17.73 tflops.
STEP-42: step_time = 46.777344 ms, foward_time = 22.851583, backward_time = 23.828480, perf = 17.63 tflops.
STEP-43: step_time = 46.420994 ms, foward_time = 22.385664, backward_time = 23.948288, perf = 17.76 tflops.
STEP-44: step_time = 46.827518 ms, foward_time = 22.835199, backward_time = 23.906303, perf = 17.61 tflops.
STEP-45: step_time = 46.429184 ms, foward_time = 22.334463, backward_time = 24.002560, perf = 17.76 tflops.
STEP-46: step_time = 48.505856 ms, foward_time = 24.403969, backward_time = 24.014849, perf = 17.00 tflops.
STEP-47: step_time = 46.680065 ms, foward_time = 22.549503, backward_time = 24.040447, perf = 17.67 tflops.
STEP-48: step_time = 46.921726 ms, foward_time = 22.943745, backward_time = 23.891968, perf = 17.57 tflops.
STEP-49: step_time = 46.544895 ms, foward_time = 22.429695, backward_time = 24.017920, perf = 17.72 tflops.
STEP-50: step_time = 46.599167 ms, foward_time = 22.337536, backward_time = 24.173569, perf = 17.70 tflops.
STEP-51: step_time = 46.394367 ms, foward_time = 22.247423, backward_time = 24.059904, perf = 17.77 tflops.
STEP-52: step_time = 46.788609 ms, foward_time = 22.371328, backward_time = 24.332289, perf = 17.62 tflops.
STEP-53: step_time = 46.672897 ms, foward_time = 22.308865, backward_time = 24.276993, perf = 17.67 tflops.
STEP-54: step_time = 47.151104 ms, foward_time = 22.267904, backward_time = 24.788992, perf = 17.49 tflops.
STEP-55: step_time = 46.521343 ms, foward_time = 22.334463, backward_time = 24.101889, perf = 17.73 tflops.
STEP-56: step_time = 46.585857 ms, foward_time = 22.371328, backward_time = 24.127487, perf = 17.70 tflops.
STEP-57: step_time = 46.208000 ms, foward_time = 22.159361, backward_time = 23.963648, perf = 17.85 tflops.
STEP-58: step_time = 46.536705 ms, foward_time = 22.415359, backward_time = 24.035328, perf = 17.72 tflops.
STEP-59: step_time = 46.308353 ms, foward_time = 22.221825, backward_time = 24.002560, perf = 17.81 tflops.
STEP-60: step_time = 46.411777 ms, foward_time = 22.261761, backward_time = 24.058880, perf = 17.77 tflops.
STEP-61: step_time = 48.320511 ms, foward_time = 24.198145, backward_time = 24.035328, perf = 17.07 tflops.
STEP-62: step_time = 46.387199 ms, foward_time = 22.286337, backward_time = 24.016895, perf = 17.78 tflops.
STEP-63: step_time = 47.664127 ms, foward_time = 23.667711, backward_time = 23.906303, perf = 17.30 tflops.
STEP-64: step_time = 46.447617 ms, foward_time = 22.394880, backward_time = 23.961599, perf = 17.75 tflops.
STEP-65: step_time = 46.713856 ms, foward_time = 22.453247, backward_time = 24.170496, perf = 17.65 tflops.
STEP-66: step_time = 46.880768 ms, foward_time = 22.264832, backward_time = 24.527872, perf = 17.59 tflops.
STEP-67: step_time = 46.632961 ms, foward_time = 22.506496, backward_time = 24.038401, perf = 17.68 tflops.
STEP-68: step_time = 46.375935 ms, foward_time = 22.234112, backward_time = 24.050688, perf = 17.78 tflops.
STEP-69: step_time = 46.822399 ms, foward_time = 22.216703, backward_time = 24.515585, perf = 17.61 tflops.
STEP-70: step_time = 47.298561 ms, foward_time = 23.146496, backward_time = 24.065023, perf = 17.43 tflops.
STEP-71: step_time = 46.667774 ms, foward_time = 22.335487, backward_time = 24.244225, perf = 17.67 tflops.
STEP-72: step_time = 46.178303 ms, foward_time = 22.255615, backward_time = 23.833599, perf = 17.86 tflops.
STEP-73: step_time = 47.389694 ms, foward_time = 23.153664, backward_time = 24.145920, perf = 17.40 tflops.
STEP-74: step_time = 46.640129 ms, foward_time = 22.270975, backward_time = 24.279039, perf = 17.68 tflops.
STEP-75: step_time = 46.848000 ms, foward_time = 22.703104, backward_time = 24.050688, perf = 17.60 tflops.
STEP-76: step_time = 47.545345 ms, foward_time = 23.317505, backward_time = 24.136703, perf = 17.34 tflops.
STEP-77: step_time = 46.759937 ms, foward_time = 22.433792, backward_time = 24.231936, perf = 17.64 tflops.
STEP-78: step_time = 48.400383 ms, foward_time = 24.374271, backward_time = 23.936001, perf = 17.04 tflops.
STEP-79: step_time = 46.531586 ms, foward_time = 22.433792, backward_time = 24.005632, perf = 17.72 tflops.
STEP-80: step_time = 46.323711 ms, foward_time = 22.230017, backward_time = 24.013824, perf = 17.80 tflops.
STEP-81: step_time = 46.436352 ms, foward_time = 22.362112, backward_time = 23.986176, perf = 17.76 tflops.
STEP-82: step_time = 46.627838 ms, foward_time = 22.360064, backward_time = 24.146944, perf = 17.69 tflops.
STEP-83: step_time = 46.481407 ms, foward_time = 22.199297, backward_time = 24.197121, perf = 17.74 tflops.
STEP-84: step_time = 46.514175 ms, foward_time = 22.223871, backward_time = 24.198145, perf = 17.73 tflops.
STEP-85: step_time = 46.434303 ms, foward_time = 22.311935, backward_time = 24.032255, perf = 17.76 tflops.
STEP-86: step_time = 49.005569 ms, foward_time = 24.188929, backward_time = 24.729601, perf = 16.83 tflops.
STEP-87: step_time = 46.206978 ms, foward_time = 22.172672, backward_time = 23.949312, perf = 17.85 tflops.
STEP-88: step_time = 46.715904 ms, foward_time = 22.318081, backward_time = 24.314880, perf = 17.65 tflops.
STEP-89: step_time = 46.322689 ms, foward_time = 22.155264, backward_time = 24.065023, perf = 17.80 tflops.
STEP-90: step_time = 46.282753 ms, foward_time = 22.179840, backward_time = 24.016895, perf = 17.82 tflops.
STEP-91: step_time = 46.435329 ms, foward_time = 22.249472, backward_time = 24.100864, perf = 17.76 tflops.
STEP-92: step_time = 46.307327 ms, foward_time = 22.177792, backward_time = 24.043520, perf = 17.81 tflops.
STEP-93: step_time = 48.135166 ms, foward_time = 24.232960, backward_time = 23.817217, perf = 17.13 tflops.
STEP-94: step_time = 46.414848 ms, foward_time = 22.257664, backward_time = 24.073215, perf = 17.77 tflops.
STEP-95: step_time = 48.168961 ms, foward_time = 23.861248, backward_time = 24.221697, perf = 17.12 tflops.
STEP-96: step_time = 46.375935 ms, foward_time = 22.345728, backward_time = 23.945215, perf = 17.78 tflops.
STEP-97: step_time = 46.728191 ms, foward_time = 22.605824, backward_time = 24.033279, perf = 17.65 tflops.
STEP-98: step_time = 46.487553 ms, foward_time = 22.241280, backward_time = 24.161280, perf = 17.74 tflops.
STEP-99: step_time = 46.384129 ms, foward_time = 22.224895, backward_time = 24.073215, perf = 17.78 tflops.

 faster_moe 4 [Summary] Average synchronized step_time = 46.80089594523112 ms, forward = 22.616371154785156 , backward = 24.095505015055338 .
[Benchmark] world_size = 4, dtype = float16, model_dim = 1024, hidden_size = 4096, samples = 8192, num_local_experts = 8, topK = 2, a2a_ffn_overlap_degree = 1, device = `cuda:0`
STEP-0: step_time = 1653.900269 ms, foward_time = 1617.518555, backward_time = 36.081665, perf = 0.50 tflops.
STEP-1: step_time = 60.342274 ms, foward_time = 29.501440, backward_time = 30.708736, perf = 13.67 tflops.
STEP-2: step_time = 57.200642 ms, foward_time = 27.632641, backward_time = 29.451263, perf = 14.42 tflops.
STEP-3: step_time = 57.041920 ms, foward_time = 27.689983, backward_time = 29.234177, perf = 14.46 tflops.
STEP-4: step_time = 51.362816 ms, foward_time = 27.613184, backward_time = 23.616512, perf = 16.06 tflops.
STEP-5: step_time = 50.280449 ms, foward_time = 27.570175, backward_time = 22.592512, perf = 16.40 tflops.
STEP-6: step_time = 46.069759 ms, foward_time = 22.975489, backward_time = 22.975489, perf = 17.90 tflops.
STEP-7: step_time = 45.487103 ms, foward_time = 22.903809, backward_time = 22.466560, perf = 18.13 tflops.
STEP-8: step_time = 45.180927 ms, foward_time = 22.516735, backward_time = 22.548479, perf = 18.25 tflops.
STEP-9: step_time = 45.532162 ms, foward_time = 23.019520, backward_time = 22.392832, perf = 18.11 tflops.
STEP-10: step_time = 45.539330 ms, foward_time = 23.198721, backward_time = 22.203392, perf = 18.11 tflops.
STEP-11: step_time = 44.153854 ms, foward_time = 21.547009, backward_time = 22.480896, perf = 18.68 tflops.
STEP-12: step_time = 45.181953 ms, foward_time = 22.596607, backward_time = 22.468609, perf = 18.25 tflops.
STEP-13: step_time = 45.008896 ms, foward_time = 22.472704, backward_time = 22.419456, perf = 18.32 tflops.
STEP-14: step_time = 47.590401 ms, foward_time = 25.003008, backward_time = 22.448128, perf = 17.33 tflops.
STEP-15: step_time = 45.944832 ms, foward_time = 23.346176, backward_time = 22.481920, perf = 17.95 tflops.
STEP-16: step_time = 45.321217 ms, foward_time = 22.593536, backward_time = 22.611967, perf = 18.20 tflops.
STEP-17: step_time = 45.254658 ms, foward_time = 22.548479, backward_time = 22.584320, perf = 18.22 tflops.
STEP-18: step_time = 44.999680 ms, foward_time = 22.723583, backward_time = 22.127617, perf = 18.33 tflops.
STEP-19: step_time = 45.576191 ms, foward_time = 22.926336, backward_time = 22.531073, perf = 18.09 tflops.
STEP-20: step_time = 45.208576 ms, foward_time = 22.477823, backward_time = 22.602753, perf = 18.24 tflops.
STEP-21: step_time = 45.085697 ms, foward_time = 22.664192, backward_time = 22.305792, perf = 18.29 tflops.
STEP-22: step_time = 45.216766 ms, foward_time = 22.596607, backward_time = 22.504448, perf = 18.24 tflops.
STEP-23: step_time = 46.970879 ms, foward_time = 24.482817, backward_time = 22.372353, perf = 17.56 tflops.
STEP-24: step_time = 47.270912 ms, foward_time = 24.572927, backward_time = 22.584320, perf = 17.44 tflops.
STEP-25: step_time = 45.979649 ms, foward_time = 23.603201, backward_time = 22.259712, perf = 17.93 tflops.
STEP-26: step_time = 45.090816 ms, foward_time = 22.532097, backward_time = 22.448128, perf = 18.29 tflops.
STEP-27: step_time = 45.549568 ms, foward_time = 22.981632, backward_time = 22.434816, perf = 18.10 tflops.
STEP-28: step_time = 45.029377 ms, foward_time = 22.597631, backward_time = 22.316032, perf = 18.31 tflops.
STEP-29: step_time = 46.432255 ms, foward_time = 23.767040, backward_time = 22.548479, perf = 17.76 tflops.
STEP-30: step_time = 44.881920 ms, foward_time = 22.362112, backward_time = 22.404097, perf = 18.37 tflops.
STEP-31: step_time = 45.680641 ms, foward_time = 22.622208, backward_time = 22.942720, perf = 18.05 tflops.
STEP-32: step_time = 44.984322 ms, foward_time = 22.454271, backward_time = 22.417408, perf = 18.33 tflops.
STEP-33: step_time = 45.101055 ms, foward_time = 22.531073, backward_time = 22.447104, perf = 18.28 tflops.
STEP-34: step_time = 45.157375 ms, foward_time = 22.635521, backward_time = 22.409216, perf = 18.26 tflops.
STEP-35: step_time = 45.546497 ms, foward_time = 22.797312, backward_time = 22.636543, perf = 18.11 tflops.
STEP-36: step_time = 45.479935 ms, foward_time = 23.700480, backward_time = 21.608448, perf = 18.13 tflops.
STEP-37: step_time = 45.254658 ms, foward_time = 22.709248, backward_time = 22.424576, perf = 18.22 tflops.
STEP-38: step_time = 45.754368 ms, foward_time = 22.651903, backward_time = 22.984703, perf = 18.02 tflops.
STEP-39: step_time = 44.968960 ms, foward_time = 22.554625, backward_time = 22.296576, perf = 18.34 tflops.
STEP-40: step_time = 45.153278 ms, foward_time = 22.539265, backward_time = 22.495232, perf = 18.26 tflops.
STEP-41: step_time = 45.172737 ms, foward_time = 22.803455, backward_time = 22.242304, perf = 18.26 tflops.
STEP-42: step_time = 45.310974 ms, foward_time = 22.847488, backward_time = 22.347776, perf = 18.20 tflops.
STEP-43: step_time = 45.247486 ms, foward_time = 22.530048, backward_time = 22.596607, perf = 18.22 tflops.
STEP-44: step_time = 48.746494 ms, foward_time = 22.470655, backward_time = 26.155008, perf = 16.92 tflops.
STEP-45: step_time = 46.539776 ms, foward_time = 24.015871, backward_time = 22.277121, perf = 17.72 tflops.
STEP-46: step_time = 44.858368 ms, foward_time = 22.561792, backward_time = 22.140928, perf = 18.38 tflops.
STEP-47: step_time = 43.944962 ms, foward_time = 21.587969, backward_time = 22.199297, perf = 18.77 tflops.
STEP-48: step_time = 44.571648 ms, foward_time = 21.701632, backward_time = 22.720512, perf = 18.50 tflops.
STEP-49: step_time = 44.441601 ms, foward_time = 22.053888, backward_time = 22.236160, perf = 18.56 tflops.
STEP-50: step_time = 44.088322 ms, foward_time = 21.651457, backward_time = 22.285313, perf = 18.70 tflops.
STEP-51: step_time = 44.240894 ms, foward_time = 21.607424, backward_time = 22.495232, perf = 18.64 tflops.
STEP-52: step_time = 45.248512 ms, foward_time = 22.774784, backward_time = 22.348801, perf = 18.22 tflops.
STEP-53: step_time = 44.032001 ms, foward_time = 21.456896, backward_time = 22.449152, perf = 18.73 tflops.
STEP-54: step_time = 45.210625 ms, foward_time = 22.722561, backward_time = 22.367231, perf = 18.24 tflops.
STEP-55: step_time = 44.364799 ms, foward_time = 21.575680, backward_time = 22.667265, perf = 18.59 tflops.
STEP-56: step_time = 43.834370 ms, foward_time = 21.372929, backward_time = 22.339584, perf = 18.81 tflops.
STEP-57: step_time = 44.131329 ms, foward_time = 21.600256, backward_time = 22.407167, perf = 18.69 tflops.
STEP-58: step_time = 43.802624 ms, foward_time = 21.438463, backward_time = 22.242304, perf = 18.83 tflops.
STEP-59: step_time = 45.062145 ms, foward_time = 22.432768, backward_time = 22.503424, perf = 18.30 tflops.
STEP-60: step_time = 44.046337 ms, foward_time = 21.401600, backward_time = 22.518784, perf = 18.72 tflops.
STEP-61: step_time = 45.160446 ms, foward_time = 22.541311, backward_time = 22.493183, perf = 18.26 tflops.
STEP-62: step_time = 44.204033 ms, foward_time = 21.633024, backward_time = 22.454271, perf = 18.66 tflops.
STEP-63: step_time = 45.205505 ms, foward_time = 22.516735, backward_time = 22.565887, perf = 18.24 tflops.
STEP-64: step_time = 44.008450 ms, foward_time = 21.500929, backward_time = 22.389759, perf = 18.74 tflops.
STEP-65: step_time = 44.152832 ms, foward_time = 21.536768, backward_time = 22.490112, perf = 18.68 tflops.
STEP-66: step_time = 44.828671 ms, foward_time = 22.322176, backward_time = 22.381569, perf = 18.40 tflops.
STEP-67: step_time = 45.504513 ms, foward_time = 22.788095, backward_time = 22.595585, perf = 18.12 tflops.
STEP-68: step_time = 44.433407 ms, foward_time = 21.790720, backward_time = 22.516735, perf = 18.56 tflops.
STEP-69: step_time = 43.993088 ms, foward_time = 21.430271, backward_time = 22.436865, perf = 18.74 tflops.
STEP-70: step_time = 45.545471 ms, foward_time = 22.828032, backward_time = 22.593536, perf = 18.11 tflops.
STEP-71: step_time = 44.094463 ms, foward_time = 21.432320, backward_time = 22.540289, perf = 18.70 tflops.
STEP-72: step_time = 44.815361 ms, foward_time = 22.255615, backward_time = 22.434816, perf = 18.40 tflops.
STEP-73: step_time = 44.446720 ms, foward_time = 21.384192, backward_time = 22.939648, perf = 18.55 tflops.
STEP-74: step_time = 45.404160 ms, foward_time = 22.932480, backward_time = 22.348801, perf = 18.16 tflops.
STEP-75: step_time = 44.331009 ms, foward_time = 21.574656, backward_time = 22.635521, perf = 18.60 tflops.
STEP-76: step_time = 43.833344 ms, foward_time = 21.459969, backward_time = 22.246401, perf = 18.81 tflops.
STEP-77: step_time = 43.966465 ms, foward_time = 21.591040, backward_time = 22.261761, perf = 18.76 tflops.
STEP-78: step_time = 44.040192 ms, foward_time = 21.492737, backward_time = 22.424576, perf = 18.72 tflops.
STEP-79: step_time = 43.876350 ms, foward_time = 21.436417, backward_time = 22.321152, perf = 18.79 tflops.
STEP-80: step_time = 45.292545 ms, foward_time = 22.630400, backward_time = 22.541311, perf = 18.21 tflops.
STEP-81: step_time = 43.811840 ms, foward_time = 21.326847, backward_time = 22.361088, perf = 18.82 tflops.
STEP-82: step_time = 43.881474 ms, foward_time = 21.463039, backward_time = 22.290432, perf = 18.79 tflops.
STEP-83: step_time = 44.217342 ms, foward_time = 21.633024, backward_time = 22.444033, perf = 18.65 tflops.
STEP-84: step_time = 44.075008 ms, foward_time = 21.489664, backward_time = 22.461439, perf = 18.71 tflops.
STEP-85: step_time = 43.942913 ms, foward_time = 21.465088, backward_time = 22.338560, perf = 18.77 tflops.
STEP-86: step_time = 44.057598 ms, foward_time = 21.595137, backward_time = 22.340609, perf = 18.72 tflops.
STEP-87: step_time = 45.941761 ms, foward_time = 22.985727, backward_time = 22.833153, perf = 17.95 tflops.
STEP-88: step_time = 44.223488 ms, foward_time = 21.478399, backward_time = 22.622208, perf = 18.65 tflops.
STEP-89: step_time = 43.838463 ms, foward_time = 21.385216, backward_time = 22.324224, perf = 18.81 tflops.
STEP-90: step_time = 43.905025 ms, foward_time = 21.535744, backward_time = 22.255615, perf = 18.78 tflops.
STEP-91: step_time = 44.105728 ms, foward_time = 21.455872, backward_time = 22.531073, perf = 18.70 tflops.
STEP-92: step_time = 43.912193 ms, foward_time = 21.411840, backward_time = 22.377472, perf = 18.78 tflops.
STEP-93: step_time = 44.037121 ms, foward_time = 21.478399, backward_time = 22.441984, perf = 18.73 tflops.
STEP-94: step_time = 44.006401 ms, foward_time = 21.396481, backward_time = 22.490112, perf = 18.74 tflops.
STEP-95: step_time = 44.109825 ms, foward_time = 21.506048, backward_time = 22.482944, perf = 18.70 tflops.
STEP-96: step_time = 43.958271 ms, foward_time = 21.450752, backward_time = 22.382591, perf = 18.76 tflops.
STEP-97: step_time = 43.975681 ms, foward_time = 21.384192, backward_time = 22.466560, perf = 18.75 tflops.
STEP-98: step_time = 43.897858 ms, foward_time = 21.377024, backward_time = 22.398975, perf = 18.79 tflops.
STEP-99: step_time = 43.916286 ms, foward_time = 21.430271, backward_time = 22.365185, perf = 18.78 tflops.

 faster_moe 8 [Summary] Average synchronized step_time = 44.516676394144696 ms, forward = 21.8912254969279 , backward = 22.497587299346925 .
[Benchmark] world_size = 4, dtype = float16, model_dim = 1024, hidden_size = 4096, samples = 8192, num_local_experts = 16, topK = 2, a2a_ffn_overlap_degree = 1, device = `cuda:0`
STEP-0: step_time = 1609.666504 ms, foward_time = 1574.879272, backward_time = 34.400257, perf = 0.51 tflops.
STEP-1: step_time = 61.295616 ms, foward_time = 32.780289, backward_time = 28.333055, perf = 13.45 tflops.
STEP-2: step_time = 59.313152 ms, foward_time = 31.052799, backward_time = 28.084225, perf = 13.90 tflops.
STEP-3: step_time = 58.682369 ms, foward_time = 32.468990, backward_time = 26.029057, perf = 14.05 tflops.
STEP-4: step_time = 54.689793 ms, foward_time = 30.249985, backward_time = 24.257536, perf = 15.08 tflops.
STEP-5: step_time = 53.046272 ms, foward_time = 28.894209, backward_time = 23.974913, perf = 15.55 tflops.
STEP-6: step_time = 51.188736 ms, foward_time = 27.030527, backward_time = 23.984129, perf = 16.11 tflops.
STEP-7: step_time = 52.247551 ms, foward_time = 28.140545, backward_time = 23.906303, perf = 15.78 tflops.
STEP-8: step_time = 53.293056 ms, foward_time = 28.104704, backward_time = 25.019392, perf = 15.47 tflops.
STEP-9: step_time = 48.765953 ms, foward_time = 25.366528, backward_time = 23.227392, perf = 16.91 tflops.
STEP-10: step_time = 48.401409 ms, foward_time = 25.281536, backward_time = 22.946815, perf = 17.04 tflops.
STEP-11: step_time = 50.949120 ms, foward_time = 27.790337, backward_time = 22.986752, perf = 16.19 tflops.
STEP-12: step_time = 50.266113 ms, foward_time = 27.059200, backward_time = 23.062529, perf = 16.41 tflops.
STEP-13: step_time = 47.872002 ms, foward_time = 24.564735, backward_time = 23.165953, perf = 17.23 tflops.
STEP-14: step_time = 48.160767 ms, foward_time = 24.897535, backward_time = 23.130112, perf = 17.12 tflops.
STEP-15: step_time = 48.534527 ms, foward_time = 25.095167, backward_time = 23.292929, perf = 16.99 tflops.
STEP-16: step_time = 49.017857 ms, foward_time = 25.737217, backward_time = 23.141376, perf = 16.82 tflops.
STEP-17: step_time = 48.234497 ms, foward_time = 24.828928, backward_time = 23.271423, perf = 17.10 tflops.
STEP-18: step_time = 47.707134 ms, foward_time = 24.621056, backward_time = 22.946815, perf = 17.29 tflops.
STEP-19: step_time = 47.663105 ms, foward_time = 24.534016, backward_time = 22.982656, perf = 17.30 tflops.
STEP-20: step_time = 50.466816 ms, foward_time = 26.957825, backward_time = 23.344128, perf = 16.34 tflops.
STEP-21: step_time = 51.961857 ms, foward_time = 28.554239, backward_time = 23.262209, perf = 15.87 tflops.
STEP-22: step_time = 49.335297 ms, foward_time = 25.213951, backward_time = 23.979008, perf = 16.71 tflops.
STEP-23: step_time = 49.350655 ms, foward_time = 25.005056, backward_time = 24.200191, perf = 16.71 tflops.
STEP-24: step_time = 49.117184 ms, foward_time = 25.934849, backward_time = 23.038977, perf = 16.79 tflops.
STEP-25: step_time = 54.711296 ms, foward_time = 27.749376, backward_time = 26.821632, perf = 15.07 tflops.
STEP-26: step_time = 51.101696 ms, foward_time = 27.878401, backward_time = 23.036928, perf = 16.14 tflops.
STEP-27: step_time = 48.673794 ms, foward_time = 25.378817, backward_time = 23.097343, perf = 16.94 tflops.
STEP-28: step_time = 48.729088 ms, foward_time = 25.282560, backward_time = 23.305216, perf = 16.92 tflops.
STEP-29: step_time = 48.603134 ms, foward_time = 25.260033, backward_time = 23.206911, perf = 16.97 tflops.
STEP-30: step_time = 47.960064 ms, foward_time = 24.732672, backward_time = 23.093248, perf = 17.19 tflops.
STEP-31: step_time = 49.520641 ms, foward_time = 26.477568, backward_time = 22.902784, perf = 16.65 tflops.
STEP-32: step_time = 47.714306 ms, foward_time = 24.504320, backward_time = 23.046144, perf = 17.28 tflops.
STEP-33: step_time = 47.817726 ms, foward_time = 24.707071, backward_time = 22.955008, perf = 17.25 tflops.
STEP-34: step_time = 47.826942 ms, foward_time = 24.678400, backward_time = 23.006208, perf = 17.24 tflops.
STEP-35: step_time = 47.855618 ms, foward_time = 24.717312, backward_time = 22.993919, perf = 17.23 tflops.
STEP-36: step_time = 53.490688 ms, foward_time = 29.944832, backward_time = 23.263231, perf = 15.42 tflops.
STEP-37: step_time = 48.215038 ms, foward_time = 25.050112, backward_time = 22.994944, perf = 17.10 tflops.
STEP-38: step_time = 47.885311 ms, foward_time = 24.523775, backward_time = 23.204865, perf = 17.22 tflops.
STEP-39: step_time = 47.812607 ms, foward_time = 24.616961, backward_time = 23.042048, perf = 17.25 tflops.
STEP-40: step_time = 47.961086 ms, foward_time = 24.663040, backward_time = 23.139328, perf = 17.19 tflops.
STEP-41: step_time = 47.828991 ms, foward_time = 24.660992, backward_time = 23.006208, perf = 17.24 tflops.
STEP-42: step_time = 47.813633 ms, foward_time = 24.584192, backward_time = 23.072767, perf = 17.25 tflops.
STEP-43: step_time = 48.535553 ms, foward_time = 25.375744, backward_time = 22.996992, perf = 16.99 tflops.
STEP-44: step_time = 47.677441 ms, foward_time = 24.563711, backward_time = 22.941696, perf = 17.30 tflops.
STEP-45: step_time = 47.695873 ms, foward_time = 24.481792, backward_time = 23.053312, perf = 17.29 tflops.
STEP-46: step_time = 47.839233 ms, foward_time = 24.580095, backward_time = 23.119871, perf = 17.24 tflops.
STEP-47: step_time = 47.885311 ms, foward_time = 24.730623, backward_time = 22.975489, perf = 17.22 tflops.
STEP-48: step_time = 48.145409 ms, foward_time = 24.742912, backward_time = 23.228416, perf = 17.13 tflops.
STEP-49: step_time = 47.798271 ms, foward_time = 24.756224, backward_time = 22.894592, perf = 17.25 tflops.
STEP-50: step_time = 47.993855 ms, foward_time = 24.678400, backward_time = 23.134209, perf = 17.18 tflops.
STEP-51: step_time = 47.781887 ms, foward_time = 24.625153, backward_time = 22.981632, perf = 17.26 tflops.
STEP-52: step_time = 49.267712 ms, foward_time = 26.080256, backward_time = 23.027712, perf = 16.74 tflops.
STEP-53: step_time = 48.648193 ms, foward_time = 24.452097, backward_time = 24.039425, perf = 16.95 tflops.
STEP-54: step_time = 49.344513 ms, foward_time = 26.054655, backward_time = 23.128063, perf = 16.71 tflops.
STEP-55: step_time = 48.164864 ms, foward_time = 24.863745, backward_time = 23.140352, perf = 17.12 tflops.
STEP-56: step_time = 48.453632 ms, foward_time = 24.941568, backward_time = 23.342079, perf = 17.02 tflops.
STEP-57: step_time = 47.855618 ms, foward_time = 24.592384, backward_time = 23.103489, perf = 17.23 tflops.
STEP-58: step_time = 49.787903 ms, foward_time = 26.487808, backward_time = 23.145472, perf = 16.56 tflops.
STEP-59: step_time = 47.951874 ms, foward_time = 24.648705, backward_time = 23.143423, perf = 17.20 tflops.
STEP-60: step_time = 48.067585 ms, foward_time = 24.803328, backward_time = 23.086081, perf = 17.16 tflops.
STEP-61: step_time = 48.359425 ms, foward_time = 24.924160, backward_time = 23.280640, perf = 17.05 tflops.
STEP-62: step_time = 48.753662 ms, foward_time = 24.852480, backward_time = 23.744513, perf = 16.91 tflops.
STEP-63: step_time = 48.932865 ms, foward_time = 24.659967, backward_time = 24.129536, perf = 16.85 tflops.
STEP-64: step_time = 47.757313 ms, foward_time = 24.556543, backward_time = 23.048191, perf = 17.27 tflops.
STEP-65: step_time = 50.169857 ms, foward_time = 26.621952, backward_time = 23.393280, perf = 16.44 tflops.
STEP-66: step_time = 48.090111 ms, foward_time = 24.801279, backward_time = 23.134209, perf = 17.15 tflops.
STEP-67: step_time = 47.806465 ms, foward_time = 24.511488, backward_time = 23.135233, perf = 17.25 tflops.
STEP-68: step_time = 49.432575 ms, foward_time = 26.175488, backward_time = 23.100416, perf = 16.68 tflops.
STEP-69: step_time = 48.163841 ms, foward_time = 24.713217, backward_time = 23.290880, perf = 17.12 tflops.
STEP-70: step_time = 47.965183 ms, foward_time = 24.611839, backward_time = 23.182337, perf = 17.19 tflops.
STEP-71: step_time = 47.859711 ms, foward_time = 24.611839, backward_time = 23.072767, perf = 17.23 tflops.
STEP-72: step_time = 47.796223 ms, foward_time = 24.515585, backward_time = 23.101440, perf = 17.25 tflops.
STEP-73: step_time = 49.164288 ms, foward_time = 25.906176, backward_time = 23.081984, perf = 16.77 tflops.
STEP-74: step_time = 48.006145 ms, foward_time = 24.667135, backward_time = 23.178240, perf = 17.18 tflops.
STEP-75: step_time = 47.709183 ms, foward_time = 24.460287, backward_time = 23.090176, perf = 17.28 tflops.
STEP-76: step_time = 48.010239 ms, foward_time = 24.511488, backward_time = 23.343103, perf = 17.18 tflops.
STEP-77: step_time = 47.422462 ms, foward_time = 24.330240, backward_time = 22.933504, perf = 17.39 tflops.
STEP-78: step_time = 47.686657 ms, foward_time = 24.495104, backward_time = 23.034880, perf = 17.29 tflops.
STEP-79: step_time = 47.613953 ms, foward_time = 24.400896, backward_time = 23.069696, perf = 17.32 tflops.
STEP-80: step_time = 47.775745 ms, foward_time = 24.658943, backward_time = 22.959105, perf = 17.26 tflops.
STEP-81: step_time = 47.848450 ms, foward_time = 24.672256, backward_time = 23.003136, perf = 17.23 tflops.
STEP-82: step_time = 48.338943 ms, foward_time = 24.591360, backward_time = 23.595009, perf = 17.06 tflops.
STEP-83: step_time = 48.220161 ms, foward_time = 24.797184, backward_time = 23.264256, perf = 17.10 tflops.
STEP-84: step_time = 47.877121 ms, foward_time = 24.554497, backward_time = 23.164928, perf = 17.22 tflops.
STEP-85: step_time = 48.304127 ms, foward_time = 25.101313, backward_time = 23.043072, perf = 17.07 tflops.
STEP-86: step_time = 48.729088 ms, foward_time = 24.652800, backward_time = 23.912449, perf = 16.92 tflops.
STEP-87: step_time = 50.161663 ms, foward_time = 27.055103, backward_time = 22.947840, perf = 16.44 tflops.
STEP-88: step_time = 48.160767 ms, foward_time = 24.786943, backward_time = 23.167999, perf = 17.12 tflops.
STEP-89: step_time = 48.179199 ms, foward_time = 24.909824, backward_time = 23.108608, perf = 17.12 tflops.
STEP-90: step_time = 48.011265 ms, foward_time = 24.724480, backward_time = 23.124992, perf = 17.18 tflops.
STEP-91: step_time = 47.838207 ms, foward_time = 24.697857, backward_time = 22.994944, perf = 17.24 tflops.
STEP-92: step_time = 47.694847 ms, foward_time = 24.623104, backward_time = 22.916096, perf = 17.29 tflops.
STEP-93: step_time = 48.401409 ms, foward_time = 25.269247, backward_time = 22.960129, perf = 17.04 tflops.
STEP-94: step_time = 47.855618 ms, foward_time = 24.711168, backward_time = 22.989824, perf = 17.23 tflops.
STEP-95: step_time = 47.689728 ms, foward_time = 24.577024, backward_time = 22.959105, perf = 17.29 tflops.
STEP-96: step_time = 48.309250 ms, foward_time = 25.057280, backward_time = 23.095297, perf = 17.07 tflops.
STEP-97: step_time = 47.867905 ms, foward_time = 24.592384, backward_time = 23.119871, perf = 17.23 tflops.
STEP-98: step_time = 48.232449 ms, foward_time = 24.712193, backward_time = 23.364609, perf = 17.10 tflops.
STEP-99: step_time = 47.911938 ms, foward_time = 24.519680, backward_time = 23.236609, perf = 17.21 tflops.

 faster_moe 16 [Summary] Average synchronized step_time = 48.21010786692302 ms, forward = 24.88265380859375 , backward = 23.166225147247314 .
[Benchmark] world_size = 4, dtype = float16, model_dim = 1024, hidden_size = 4096, samples = 8192, num_local_experts = 32, topK = 2, a2a_ffn_overlap_degree = 1, device = `cuda:0`
STEP-0: step_time = 1469.667358 ms, foward_time = 1422.870483, backward_time = 45.930496, perf = 0.56 tflops.
STEP-1: step_time = 77.774849 ms, foward_time = 41.724930, backward_time = 35.818497, perf = 10.60 tflops.
STEP-2: step_time = 74.901505 ms, foward_time = 39.384064, backward_time = 35.284992, perf = 11.01 tflops.
STEP-3: step_time = 72.458237 ms, foward_time = 39.133183, backward_time = 33.090561, perf = 11.38 tflops.
STEP-4: step_time = 65.236992 ms, foward_time = 35.095551, backward_time = 29.911039, perf = 12.64 tflops.
STEP-5: step_time = 64.669693 ms, foward_time = 34.322433, backward_time = 30.114817, perf = 12.75 tflops.
STEP-6: step_time = 63.031296 ms, foward_time = 33.158146, backward_time = 29.645824, perf = 13.08 tflops.
STEP-7: step_time = 62.275585 ms, foward_time = 32.677887, backward_time = 29.372416, perf = 13.24 tflops.
STEP-8: step_time = 62.742527 ms, foward_time = 32.789505, backward_time = 29.761536, perf = 13.14 tflops.
STEP-9: step_time = 62.105598 ms, foward_time = 32.462849, backward_time = 29.450239, perf = 13.28 tflops.
STEP-10: step_time = 62.328831 ms, foward_time = 32.464897, backward_time = 29.677568, perf = 13.23 tflops.
STEP-11: step_time = 62.264320 ms, foward_time = 32.677887, backward_time = 29.387775, perf = 13.24 tflops.
STEP-12: step_time = 63.222782 ms, foward_time = 32.673794, backward_time = 30.362623, perf = 13.04 tflops.
STEP-13: step_time = 61.483009 ms, foward_time = 32.736256, backward_time = 28.540928, perf = 13.41 tflops.
STEP-14: step_time = 60.901375 ms, foward_time = 32.425983, backward_time = 28.282881, perf = 13.54 tflops.
STEP-15: step_time = 60.163071 ms, foward_time = 31.253504, backward_time = 28.697599, perf = 13.71 tflops.
STEP-16: step_time = 61.439999 ms, foward_time = 32.487423, backward_time = 28.772352, perf = 13.42 tflops.
STEP-17: step_time = 59.646976 ms, foward_time = 30.776320, backward_time = 28.678144, perf = 13.83 tflops.
STEP-18: step_time = 60.047359 ms, foward_time = 31.506432, backward_time = 28.355583, perf = 13.73 tflops.
STEP-19: step_time = 59.997185 ms, foward_time = 31.441919, backward_time = 28.352512, perf = 13.74 tflops.
STEP-20: step_time = 61.023232 ms, foward_time = 30.820353, backward_time = 30.023680, perf = 13.51 tflops.
STEP-21: step_time = 59.303936 ms, foward_time = 30.795776, backward_time = 28.316671, perf = 13.91 tflops.
STEP-22: step_time = 61.306881 ms, foward_time = 32.239616, backward_time = 28.868608, perf = 13.45 tflops.
STEP-23: step_time = 59.828224 ms, foward_time = 31.044607, backward_time = 28.594175, perf = 13.78 tflops.
STEP-24: step_time = 60.155903 ms, foward_time = 30.883841, backward_time = 29.097984, perf = 13.71 tflops.
STEP-25: step_time = 59.550720 ms, foward_time = 31.117311, backward_time = 28.251137, perf = 13.85 tflops.
STEP-26: step_time = 62.128128 ms, foward_time = 32.304127, backward_time = 29.641727, perf = 13.27 tflops.
STEP-27: step_time = 59.146240 ms, foward_time = 30.648319, backward_time = 28.316671, perf = 13.94 tflops.
STEP-28: step_time = 60.617729 ms, foward_time = 31.728640, backward_time = 28.674047, perf = 13.60 tflops.
STEP-29: step_time = 60.315647 ms, foward_time = 30.882816, backward_time = 29.247488, perf = 13.67 tflops.
STEP-30: step_time = 66.342911 ms, foward_time = 36.547585, backward_time = 29.582336, perf = 12.43 tflops.
STEP-31: step_time = 60.844032 ms, foward_time = 31.111168, backward_time = 29.531136, perf = 13.55 tflops.
STEP-32: step_time = 60.371967 ms, foward_time = 31.777792, backward_time = 28.398592, perf = 13.66 tflops.
STEP-33: step_time = 59.369473 ms, foward_time = 30.858240, backward_time = 28.328960, perf = 13.89 tflops.
STEP-34: step_time = 63.154175 ms, foward_time = 31.995905, backward_time = 30.974976, perf = 13.06 tflops.
STEP-35: step_time = 59.298817 ms, foward_time = 30.879744, backward_time = 28.236799, perf = 13.91 tflops.
STEP-36: step_time = 62.650368 ms, foward_time = 32.750591, backward_time = 29.716480, perf = 13.16 tflops.
STEP-37: step_time = 59.501568 ms, foward_time = 30.943232, backward_time = 28.360704, perf = 13.86 tflops.
STEP-38: step_time = 63.467522 ms, foward_time = 33.541119, backward_time = 29.746176, perf = 12.99 tflops.
STEP-39: step_time = 59.592705 ms, foward_time = 31.014912, backward_time = 28.393473, perf = 13.84 tflops.
STEP-40: step_time = 63.621120 ms, foward_time = 33.297409, backward_time = 30.127104, perf = 12.96 tflops.
STEP-41: step_time = 59.447296 ms, foward_time = 30.931969, backward_time = 28.335104, perf = 13.87 tflops.
STEP-42: step_time = 60.577793 ms, foward_time = 32.090111, backward_time = 28.299265, perf = 13.61 tflops.
STEP-43: step_time = 59.427841 ms, foward_time = 30.856192, backward_time = 28.359680, perf = 13.88 tflops.
STEP-44: step_time = 63.901695 ms, foward_time = 33.969151, backward_time = 29.737984, perf = 12.90 tflops.
STEP-45: step_time = 61.935616 ms, foward_time = 32.486401, backward_time = 29.255680, perf = 13.31 tflops.
STEP-46: step_time = 60.741631 ms, foward_time = 30.873600, backward_time = 29.668352, perf = 13.58 tflops.
STEP-47: step_time = 59.337727 ms, foward_time = 30.953472, backward_time = 28.204033, perf = 13.90 tflops.
STEP-48: step_time = 62.127106 ms, foward_time = 32.465919, backward_time = 29.474815, perf = 13.27 tflops.
STEP-49: step_time = 62.088192 ms, foward_time = 31.009792, backward_time = 29.732864, perf = 13.28 tflops.
STEP-50: step_time = 63.251457 ms, foward_time = 33.992702, backward_time = 28.921856, perf = 13.04 tflops.
STEP-51: step_time = 59.474945 ms, foward_time = 31.129601, backward_time = 28.089344, perf = 13.87 tflops.
STEP-52: step_time = 60.128258 ms, foward_time = 30.895103, backward_time = 28.984320, perf = 13.71 tflops.
STEP-53: step_time = 59.664383 ms, foward_time = 31.198208, backward_time = 28.219393, perf = 13.82 tflops.
STEP-54: step_time = 63.304703 ms, foward_time = 32.160767, backward_time = 30.893057, perf = 13.03 tflops.
STEP-55: step_time = 60.744705 ms, foward_time = 31.876097, backward_time = 28.618752, perf = 13.58 tflops.
STEP-56: step_time = 59.616257 ms, foward_time = 30.832640, backward_time = 28.523520, perf = 13.83 tflops.
STEP-57: step_time = 61.449215 ms, foward_time = 32.482304, backward_time = 28.704767, perf = 13.42 tflops.
STEP-58: step_time = 64.826370 ms, foward_time = 35.426304, backward_time = 29.150208, perf = 12.72 tflops.
STEP-59: step_time = 60.001282 ms, foward_time = 31.464449, backward_time = 28.284927, perf = 13.74 tflops.
STEP-60: step_time = 61.933567 ms, foward_time = 31.781887, backward_time = 29.946880, perf = 13.31 tflops.
STEP-61: step_time = 60.899326 ms, foward_time = 32.418816, backward_time = 28.252159, perf = 13.54 tflops.
STEP-62: step_time = 59.665409 ms, foward_time = 31.014912, backward_time = 28.432384, perf = 13.82 tflops.
STEP-63: step_time = 60.634113 ms, foward_time = 31.971329, backward_time = 28.447744, perf = 13.60 tflops.
STEP-64: step_time = 62.028801 ms, foward_time = 33.079296, backward_time = 28.811264, perf = 13.29 tflops.
STEP-65: step_time = 61.032448 ms, foward_time = 32.481281, backward_time = 28.406784, perf = 13.51 tflops.
STEP-66: step_time = 60.959743 ms, foward_time = 32.453632, backward_time = 28.357632, perf = 13.53 tflops.
STEP-67: step_time = 61.843456 ms, foward_time = 32.651264, backward_time = 29.056000, perf = 13.33 tflops.
STEP-68: step_time = 59.486210 ms, foward_time = 30.736383, backward_time = 28.616705, perf = 13.86 tflops.
STEP-69: step_time = 63.925247 ms, foward_time = 32.371712, backward_time = 31.404032, perf = 12.90 tflops.
STEP-70: step_time = 62.096382 ms, foward_time = 33.682430, backward_time = 28.263424, perf = 13.28 tflops.
STEP-71: step_time = 59.586559 ms, foward_time = 30.918655, backward_time = 28.521473, perf = 13.84 tflops.
STEP-72: step_time = 60.252159 ms, foward_time = 30.708736, backward_time = 29.399040, perf = 13.69 tflops.
STEP-73: step_time = 59.281406 ms, foward_time = 30.607361, backward_time = 28.503040, perf = 13.91 tflops.
STEP-74: step_time = 61.103104 ms, foward_time = 32.538624, backward_time = 28.413952, perf = 13.50 tflops.
STEP-75: step_time = 60.012543 ms, foward_time = 31.346687, backward_time = 28.527617, perf = 13.74 tflops.
STEP-76: step_time = 60.463104 ms, foward_time = 30.839808, backward_time = 29.488129, perf = 13.64 tflops.
STEP-77: step_time = 62.327808 ms, foward_time = 33.344513, backward_time = 28.844032, perf = 13.23 tflops.
STEP-78: step_time = 62.905342 ms, foward_time = 32.552959, backward_time = 30.187519, perf = 13.11 tflops.
STEP-79: step_time = 60.498943 ms, foward_time = 31.766527, backward_time = 28.578815, perf = 13.63 tflops.
STEP-80: step_time = 62.846977 ms, foward_time = 32.968704, backward_time = 29.623297, perf = 13.12 tflops.
STEP-81: step_time = 59.827202 ms, foward_time = 31.182848, backward_time = 28.500992, perf = 13.78 tflops.
STEP-82: step_time = 61.314049 ms, foward_time = 32.824322, backward_time = 28.352512, perf = 13.45 tflops.
STEP-83: step_time = 61.671425 ms, foward_time = 33.120255, backward_time = 28.412928, perf = 13.37 tflops.
STEP-84: step_time = 60.485634 ms, foward_time = 32.037888, backward_time = 28.313601, perf = 13.63 tflops.
STEP-85: step_time = 60.051456 ms, foward_time = 31.368193, backward_time = 28.550144, perf = 13.73 tflops.
STEP-86: step_time = 63.195137 ms, foward_time = 32.677887, backward_time = 30.377983, perf = 13.05 tflops.
STEP-87: step_time = 59.879425 ms, foward_time = 31.308800, backward_time = 28.409857, perf = 13.77 tflops.
STEP-88: step_time = 60.335106 ms, foward_time = 31.775743, backward_time = 28.423168, perf = 13.67 tflops.
STEP-89: step_time = 62.654465 ms, foward_time = 32.510975, backward_time = 30.006271, perf = 13.16 tflops.
STEP-90: step_time = 61.782017 ms, foward_time = 33.020927, backward_time = 28.625919, perf = 13.35 tflops.
STEP-91: step_time = 59.548672 ms, foward_time = 30.907393, backward_time = 28.508160, perf = 13.85 tflops.
STEP-92: step_time = 62.867455 ms, foward_time = 33.796097, backward_time = 28.935167, perf = 13.12 tflops.
STEP-93: step_time = 59.458561 ms, foward_time = 30.884865, backward_time = 28.438528, perf = 13.87 tflops.
STEP-94: step_time = 60.870655 ms, foward_time = 31.985664, backward_time = 28.723200, perf = 13.55 tflops.
STEP-95: step_time = 61.301762 ms, foward_time = 32.861183, backward_time = 28.295168, perf = 13.45 tflops.
STEP-96: step_time = 61.897728 ms, foward_time = 32.972801, backward_time = 28.791807, perf = 13.32 tflops.
STEP-97: step_time = 59.184128 ms, foward_time = 30.703615, backward_time = 28.346369, perf = 13.93 tflops.
STEP-98: step_time = 60.687359 ms, foward_time = 32.150528, backward_time = 28.396544, perf = 13.59 tflops.
STEP-99: step_time = 59.297791 ms, foward_time = 30.527489, backward_time = 28.639233, perf = 13.91 tflops.

 faster_moe 32 [Summary] Average synchronized step_time = 61.09600442250569 ms, forward = 32.02075297037761 , backward = 28.878574943542482 .
[Benchmark] world_size = 4, dtype = float16, model_dim = 1024, hidden_size = 4096, samples = 8192, num_local_experts = 64, topK = 2, a2a_ffn_overlap_degree = 1, device = `cuda:0`
STEP-0: step_time = 1413.136353 ms, foward_time = 1364.707275, backward_time = 48.047104, perf = 0.58 tflops.
STEP-1: step_time = 89.734146 ms, foward_time = 50.853889, backward_time = 38.631424, perf = 9.19 tflops.
STEP-2: step_time = 77.615105 ms, foward_time = 44.102657, backward_time = 33.259521, perf = 10.62 tflops.
STEP-3: step_time = 77.287422 ms, foward_time = 43.447296, backward_time = 33.624065, perf = 10.67 tflops.
STEP-4: step_time = 79.055870 ms, foward_time = 46.272511, backward_time = 32.566273, perf = 10.43 tflops.
STEP-5: step_time = 75.240448 ms, foward_time = 43.039745, backward_time = 31.983616, perf = 10.96 tflops.
STEP-6: step_time = 75.264000 ms, foward_time = 43.125759, backward_time = 31.926271, perf = 10.96 tflops.
STEP-7: step_time = 72.242172 ms, foward_time = 40.473598, backward_time = 31.538176, perf = 11.41 tflops.
STEP-8: step_time = 73.653252 ms, foward_time = 40.590336, backward_time = 32.846848, perf = 11.20 tflops.
STEP-9: step_time = 72.658943 ms, foward_time = 39.987202, backward_time = 32.496639, perf = 11.35 tflops.
STEP-10: step_time = 71.285759 ms, foward_time = 38.816769, backward_time = 32.305153, perf = 11.57 tflops.
STEP-11: step_time = 73.935875 ms, foward_time = 41.064449, backward_time = 32.700417, perf = 11.15 tflops.
STEP-12: step_time = 70.597633 ms, foward_time = 38.760448, backward_time = 31.674368, perf = 11.68 tflops.
STEP-13: step_time = 71.425026 ms, foward_time = 39.159809, backward_time = 32.090111, perf = 11.55 tflops.
STEP-14: step_time = 71.908356 ms, foward_time = 39.939072, backward_time = 31.805441, perf = 11.47 tflops.
STEP-15: step_time = 71.280640 ms, foward_time = 39.261185, backward_time = 31.841280, perf = 11.57 tflops.
STEP-16: step_time = 70.364159 ms, foward_time = 38.796288, backward_time = 31.406080, perf = 11.72 tflops.
STEP-17: step_time = 72.278015 ms, foward_time = 39.521278, backward_time = 32.583679, perf = 11.41 tflops.
STEP-18: step_time = 71.280640 ms, foward_time = 38.533119, backward_time = 32.587776, perf = 11.57 tflops.
STEP-19: step_time = 71.977982 ms, foward_time = 38.982655, backward_time = 32.822273, perf = 11.46 tflops.
STEP-20: step_time = 71.080963 ms, foward_time = 39.488510, backward_time = 31.420416, perf = 11.60 tflops.
STEP-21: step_time = 70.172668 ms, foward_time = 38.650879, backward_time = 31.360001, perf = 11.75 tflops.
STEP-22: step_time = 71.212029 ms, foward_time = 39.483391, backward_time = 31.564800, perf = 11.58 tflops.
STEP-23: step_time = 71.590912 ms, foward_time = 39.512066, backward_time = 31.918079, perf = 11.52 tflops.
STEP-24: step_time = 70.360062 ms, foward_time = 38.756351, backward_time = 31.424513, perf = 11.72 tflops.
STEP-25: step_time = 71.418877 ms, foward_time = 38.667263, backward_time = 32.584705, perf = 11.55 tflops.
STEP-26: step_time = 71.620605 ms, foward_time = 38.697983, backward_time = 32.747520, perf = 11.51 tflops.
STEP-27: step_time = 72.118271 ms, foward_time = 39.172096, backward_time = 32.759808, perf = 11.43 tflops.
STEP-28: step_time = 70.542336 ms, foward_time = 38.933502, backward_time = 31.418367, perf = 11.69 tflops.
STEP-29: step_time = 70.057983 ms, foward_time = 38.308865, backward_time = 31.588352, perf = 11.77 tflops.
STEP-30: step_time = 71.522301 ms, foward_time = 39.973888, backward_time = 31.327232, perf = 11.53 tflops.
STEP-31: step_time = 71.518211 ms, foward_time = 39.859200, backward_time = 31.486977, perf = 11.53 tflops.
STEP-32: step_time = 70.739967 ms, foward_time = 39.187454, backward_time = 31.389696, perf = 11.66 tflops.
STEP-33: step_time = 70.589439 ms, foward_time = 39.046143, backward_time = 31.378431, perf = 11.68 tflops.
STEP-34: step_time = 72.115196 ms, foward_time = 38.983681, backward_time = 32.954369, perf = 11.43 tflops.
STEP-35: step_time = 72.638466 ms, foward_time = 38.786049, backward_time = 33.688576, perf = 11.35 tflops.
STEP-36: step_time = 72.128510 ms, foward_time = 40.015873, backward_time = 31.948799, perf = 11.43 tflops.
STEP-37: step_time = 71.349251 ms, foward_time = 39.003136, backward_time = 32.183296, perf = 11.56 tflops.
STEP-38: step_time = 71.136253 ms, foward_time = 38.535168, backward_time = 32.440319, perf = 11.59 tflops.
STEP-39: step_time = 71.101440 ms, foward_time = 39.485439, backward_time = 31.441919, perf = 11.60 tflops.
STEP-40: step_time = 72.740868 ms, foward_time = 39.468033, backward_time = 33.107967, perf = 11.34 tflops.
STEP-41: step_time = 70.967293 ms, foward_time = 39.280640, backward_time = 31.505407, perf = 11.62 tflops.
STEP-42: step_time = 70.044670 ms, foward_time = 38.556671, backward_time = 31.326208, perf = 11.77 tflops.
STEP-43: step_time = 73.705475 ms, foward_time = 41.435135, backward_time = 32.107521, perf = 11.19 tflops.
STEP-44: step_time = 71.815170 ms, foward_time = 39.074818, backward_time = 32.577538, perf = 11.48 tflops.
STEP-45: step_time = 70.345726 ms, foward_time = 38.434814, backward_time = 31.735807, perf = 11.72 tflops.
STEP-46: step_time = 71.242752 ms, foward_time = 38.887424, backward_time = 32.193535, perf = 11.57 tflops.
STEP-47: step_time = 70.837250 ms, foward_time = 38.930431, backward_time = 31.737856, perf = 11.64 tflops.
STEP-48: step_time = 71.242752 ms, foward_time = 38.888447, backward_time = 32.177151, perf = 11.57 tflops.
STEP-49: step_time = 72.037376 ms, foward_time = 40.185856, backward_time = 31.685633, perf = 11.45 tflops.
STEP-50: step_time = 71.326721 ms, foward_time = 39.244801, backward_time = 31.907841, perf = 11.56 tflops.
STEP-51: step_time = 71.178238 ms, foward_time = 39.109631, backward_time = 31.902719, perf = 11.59 tflops.
STEP-52: step_time = 71.460861 ms, foward_time = 38.594559, backward_time = 32.704514, perf = 11.54 tflops.
STEP-53: step_time = 70.748161 ms, foward_time = 39.410686, backward_time = 31.163391, perf = 11.66 tflops.
STEP-54: step_time = 70.234116 ms, foward_time = 38.495232, backward_time = 31.577087, perf = 11.74 tflops.
STEP-55: step_time = 70.935555 ms, foward_time = 39.037952, backward_time = 31.722496, perf = 11.63 tflops.
STEP-56: step_time = 70.047745 ms, foward_time = 38.687744, backward_time = 31.198208, perf = 11.77 tflops.
STEP-57: step_time = 72.759293 ms, foward_time = 40.134655, backward_time = 32.450562, perf = 11.33 tflops.
STEP-58: step_time = 71.003136 ms, foward_time = 38.323200, backward_time = 32.518143, perf = 11.61 tflops.
STEP-59: step_time = 71.151619 ms, foward_time = 39.743488, backward_time = 31.223808, perf = 11.59 tflops.
STEP-60: step_time = 70.566910 ms, foward_time = 39.093246, backward_time = 31.286272, perf = 11.69 tflops.
STEP-61: step_time = 70.498306 ms, foward_time = 38.585342, backward_time = 31.737856, perf = 11.70 tflops.
STEP-62: step_time = 70.513664 ms, foward_time = 39.216129, backward_time = 31.104000, perf = 11.69 tflops.
STEP-63: step_time = 72.769539 ms, foward_time = 40.829952, backward_time = 31.776768, perf = 11.33 tflops.
STEP-64: step_time = 71.240707 ms, foward_time = 38.870014, backward_time = 32.180225, perf = 11.58 tflops.
STEP-65: step_time = 72.295425 ms, foward_time = 40.853504, backward_time = 31.276031, perf = 11.41 tflops.
STEP-66: step_time = 74.302467 ms, foward_time = 41.150463, backward_time = 32.987137, perf = 11.10 tflops.
STEP-67: step_time = 70.677505 ms, foward_time = 38.782974, backward_time = 31.715328, perf = 11.67 tflops.
STEP-68: step_time = 71.005180 ms, foward_time = 39.285759, backward_time = 31.557632, perf = 11.61 tflops.
STEP-69: step_time = 75.319298 ms, foward_time = 42.093567, backward_time = 33.051647, perf = 10.95 tflops.
STEP-70: step_time = 70.690819 ms, foward_time = 38.838272, backward_time = 31.691776, perf = 11.67 tflops.
STEP-71: step_time = 69.956612 ms, foward_time = 38.692863, backward_time = 31.099903, perf = 11.79 tflops.
STEP-72: step_time = 70.760445 ms, foward_time = 39.050240, backward_time = 31.547392, perf = 11.65 tflops.
STEP-73: step_time = 70.447105 ms, foward_time = 39.029758, backward_time = 31.254528, perf = 11.71 tflops.
STEP-74: step_time = 70.232063 ms, foward_time = 38.752254, backward_time = 31.312897, perf = 11.74 tflops.
STEP-75: step_time = 70.066177 ms, foward_time = 38.592510, backward_time = 31.310848, perf = 11.77 tflops.
STEP-76: step_time = 70.981628 ms, foward_time = 39.101440, backward_time = 31.719423, perf = 11.62 tflops.
STEP-77: step_time = 71.118851 ms, foward_time = 38.559746, backward_time = 32.392193, perf = 11.60 tflops.
STEP-78: step_time = 70.440964 ms, foward_time = 39.009281, backward_time = 31.265793, perf = 11.71 tflops.
STEP-79: step_time = 75.026428 ms, foward_time = 43.275265, backward_time = 31.588352, perf = 10.99 tflops.
STEP-80: step_time = 70.066177 ms, foward_time = 37.684223, backward_time = 32.207870, perf = 11.77 tflops.
STEP-81: step_time = 68.411392 ms, foward_time = 37.032959, backward_time = 31.217665, perf = 12.05 tflops.
STEP-82: step_time = 71.321602 ms, foward_time = 39.070721, backward_time = 32.087040, perf = 11.56 tflops.
STEP-83: step_time = 70.361092 ms, foward_time = 37.371902, backward_time = 32.823296, perf = 11.72 tflops.
STEP-84: step_time = 69.125122 ms, foward_time = 37.108734, backward_time = 31.843328, perf = 11.93 tflops.
STEP-85: step_time = 69.576706 ms, foward_time = 36.892673, backward_time = 32.522240, perf = 11.85 tflops.
STEP-86: step_time = 70.368256 ms, foward_time = 38.853634, backward_time = 31.340544, perf = 11.72 tflops.
STEP-87: step_time = 68.688896 ms, foward_time = 37.379070, backward_time = 31.144960, perf = 12.01 tflops.
STEP-88: step_time = 69.615616 ms, foward_time = 37.547009, backward_time = 31.902719, perf = 11.85 tflops.
STEP-89: step_time = 68.799484 ms, foward_time = 36.945919, backward_time = 31.680511, perf = 11.99 tflops.
STEP-90: step_time = 68.278275 ms, foward_time = 36.887550, backward_time = 31.227903, perf = 12.08 tflops.
STEP-91: step_time = 69.621758 ms, foward_time = 37.313538, backward_time = 32.135166, perf = 11.84 tflops.
STEP-92: step_time = 69.904381 ms, foward_time = 38.623234, backward_time = 31.089664, perf = 11.80 tflops.
STEP-93: step_time = 70.713341 ms, foward_time = 38.721535, backward_time = 31.814655, perf = 11.66 tflops.
STEP-94: step_time = 69.886978 ms, foward_time = 37.061630, backward_time = 32.660480, perf = 11.80 tflops.
STEP-95: step_time = 69.422081 ms, foward_time = 38.136833, backward_time = 31.119360, perf = 11.88 tflops.
STEP-96: step_time = 68.621315 ms, foward_time = 37.346306, backward_time = 31.085567, perf = 12.02 tflops.
STEP-97: step_time = 69.916672 ms, foward_time = 38.421505, backward_time = 31.332352, perf = 11.79 tflops.
STEP-98: step_time = 68.652031 ms, foward_time = 37.323776, backward_time = 31.157248, perf = 12.01 tflops.
STEP-99: step_time = 70.324226 ms, foward_time = 37.997566, backward_time = 32.165890, perf = 11.73 tflops.

 faster_moe 64 [Summary] Average synchronized step_time = 70.7735045115153 ms, forward = 38.82178529103597 , backward = 31.782297579447427 .
