cuda:0
cuda:2
cuda:3
cuda:1
[Benchmark] world_size = 4, dtype = float16, model_dim = 1024, hidden_size = 4096, samples = 8192, num_local_experts = 8, topK = 2, a2a_ffn_overlap_degree = 1, device = `cuda:0`
STEP-0: step_time = 39.479248 ms, foward_time = 20.147217, backward_time = 18.994177, perf = 20.89 tflops.
STEP-1: step_time = 24.243201 ms, foward_time = 10.964992, backward_time = 13.172736, perf = 34.02 tflops.
STEP-2: step_time = 23.938497 ms, foward_time = 10.947008, backward_time = 12.900352, perf = 34.45 tflops.
STEP-3: step_time = 23.568384 ms, foward_time = 10.524672, backward_time = 12.960768, perf = 34.99 tflops.
STEP-4: step_time = 22.630400 ms, foward_time = 10.412032, backward_time = 12.136448, perf = 36.44 tflops.
STEP-5: step_time = 23.216447 ms, foward_time = 10.644800, backward_time = 12.484608, perf = 35.52 tflops.
STEP-6: step_time = 22.591488 ms, foward_time = 10.408960, backward_time = 12.090368, perf = 36.50 tflops.
STEP-7: step_time = 23.206911 ms, foward_time = 10.843136, backward_time = 12.260352, perf = 35.53 tflops.
STEP-8: step_time = 22.765567 ms, foward_time = 10.560512, backward_time = 12.100608, perf = 36.22 tflops.
STEP-9: step_time = 22.153216 ms, foward_time = 10.556416, backward_time = 11.494400, perf = 37.22 tflops.
STEP-10: step_time = 22.078465 ms, foward_time = 10.267648, backward_time = 11.709440, perf = 37.35 tflops.
STEP-11: step_time = 21.411457 ms, foward_time = 9.630337, backward_time = 11.679744, perf = 38.51 tflops.
STEP-12: step_time = 20.251648 ms, foward_time = 9.507840, backward_time = 10.640384, perf = 40.72 tflops.
STEP-13: step_time = 20.492288 ms, foward_time = 9.587713, backward_time = 10.791936, perf = 40.24 tflops.
STEP-14: step_time = 20.544832 ms, foward_time = 9.975104, backward_time = 10.465280, perf = 40.14 tflops.
STEP-15: step_time = 20.345856 ms, foward_time = 9.885696, backward_time = 10.357760, perf = 40.53 tflops.
STEP-16: step_time = 20.245505 ms, foward_time = 9.548800, backward_time = 10.594304, perf = 40.73 tflops.
STEP-17: step_time = 19.186689 ms, foward_time = 9.009152, backward_time = 10.077184, perf = 42.98 tflops.
STEP-18: step_time = 19.841023 ms, foward_time = 9.118720, backward_time = 10.621952, perf = 41.56 tflops.
STEP-19: step_time = 19.677185 ms, foward_time = 8.934400, backward_time = 10.642432, perf = 41.91 tflops.
STEP-20: step_time = 19.679233 ms, foward_time = 9.326592, backward_time = 10.207232, perf = 41.90 tflops.
STEP-21: step_time = 20.128769 ms, foward_time = 9.210880, backward_time = 10.818560, perf = 40.97 tflops.
STEP-22: step_time = 20.903935 ms, foward_time = 9.995264, backward_time = 10.808320, perf = 39.45 tflops.
STEP-23: step_time = 19.503103 ms, foward_time = 9.026560, backward_time = 10.375168, perf = 42.28 tflops.
STEP-24: step_time = 19.401727 ms, foward_time = 9.110528, backward_time = 10.189824, perf = 42.50 tflops.
STEP-25: step_time = 20.139008 ms, foward_time = 9.320448, backward_time = 10.707968, perf = 40.95 tflops.
STEP-26: step_time = 19.850241 ms, foward_time = 9.197568, backward_time = 10.552320, perf = 41.54 tflops.
STEP-27: step_time = 19.946272 ms, foward_time = 9.320224, backward_time = 10.523648, perf = 41.34 tflops.
STEP-28: step_time = 20.110336 ms, foward_time = 9.403392, backward_time = 10.603520, perf = 41.01 tflops.
STEP-29: step_time = 20.035136 ms, foward_time = 9.382464, backward_time = 10.551296, perf = 41.16 tflops.
STEP-30: step_time = 20.057088 ms, foward_time = 9.492480, backward_time = 10.462208, perf = 41.11 tflops.
STEP-31: step_time = 20.014080 ms, foward_time = 9.314304, backward_time = 10.599424, perf = 41.20 tflops.
STEP-32: step_time = 19.475456 ms, foward_time = 9.120768, backward_time = 10.254336, perf = 42.34 tflops.
STEP-33: step_time = 20.844543 ms, foward_time = 9.670656, backward_time = 11.071488, perf = 39.56 tflops.
STEP-34: step_time = 19.622913 ms, foward_time = 9.095168, backward_time = 10.426368, perf = 42.02 tflops.
STEP-35: step_time = 20.371456 ms, foward_time = 9.934848, backward_time = 10.307584, perf = 40.48 tflops.
STEP-36: step_time = 19.976192 ms, foward_time = 9.438208, backward_time = 10.436608, perf = 41.28 tflops.
STEP-37: step_time = 20.104192 ms, foward_time = 9.162752, backward_time = 10.841088, perf = 41.02 tflops.
STEP-38: step_time = 20.866751 ms, foward_time = 9.924288, backward_time = 10.839040, perf = 39.52 tflops.
STEP-39: step_time = 20.197375 ms, foward_time = 9.566208, backward_time = 10.529792, perf = 40.83 tflops.
STEP-40: step_time = 19.978241 ms, foward_time = 9.624576, backward_time = 10.253312, perf = 41.28 tflops.
STEP-41: step_time = 20.132993 ms, foward_time = 9.516160, backward_time = 10.515456, perf = 40.96 tflops.
STEP-42: step_time = 19.986432 ms, foward_time = 9.398272, backward_time = 10.484736, perf = 41.26 tflops.
STEP-43: step_time = 20.013055 ms, foward_time = 9.528320, backward_time = 10.383360, perf = 41.20 tflops.
STEP-44: step_time = 20.547584 ms, foward_time = 10.083328, backward_time = 10.362880, perf = 40.13 tflops.
STEP-45: step_time = 20.806656 ms, foward_time = 10.125312, backward_time = 10.585088, perf = 39.63 tflops.
STEP-46: step_time = 19.330047 ms, foward_time = 8.793088, backward_time = 10.428416, perf = 42.66 tflops.
STEP-47: step_time = 20.048896 ms, foward_time = 9.550848, backward_time = 10.362880, perf = 41.13 tflops.
STEP-48: step_time = 20.060161 ms, foward_time = 9.468928, backward_time = 10.487808, perf = 41.11 tflops.
STEP-49: step_time = 20.641793 ms, foward_time = 9.701376, backward_time = 10.835968, perf = 39.95 tflops.
STEP-50: step_time = 20.166656 ms, foward_time = 9.242624, backward_time = 10.820608, perf = 40.89 tflops.
STEP-51: step_time = 19.861311 ms, foward_time = 9.569088, backward_time = 10.190848, perf = 41.52 tflops.
STEP-52: step_time = 20.649407 ms, foward_time = 9.963968, backward_time = 10.586112, perf = 39.93 tflops.
STEP-53: step_time = 19.364863 ms, foward_time = 9.028608, backward_time = 10.236928, perf = 42.58 tflops.
STEP-54: step_time = 19.742432 ms, foward_time = 9.408224, backward_time = 10.220544, perf = 41.77 tflops.
STEP-55: step_time = 20.596737 ms, foward_time = 9.864192, backward_time = 10.612736, perf = 40.04 tflops.
STEP-56: step_time = 18.861057 ms, foward_time = 8.519680, backward_time = 10.238976, perf = 43.72 tflops.
STEP-57: step_time = 20.214784 ms, foward_time = 9.588737, backward_time = 10.527744, perf = 40.79 tflops.
STEP-58: step_time = 20.418528 ms, foward_time = 9.651168, backward_time = 10.667008, perf = 40.39 tflops.
STEP-59: step_time = 19.741696 ms, foward_time = 9.252864, backward_time = 10.389504, perf = 41.77 tflops.
STEP-60: step_time = 19.987455 ms, foward_time = 9.494528, backward_time = 10.389504, perf = 41.26 tflops.
STEP-61: step_time = 19.823616 ms, foward_time = 9.319424, backward_time = 10.404864, perf = 41.60 tflops.
STEP-62: step_time = 20.143135 ms, foward_time = 9.664544, backward_time = 10.378240, perf = 40.94 tflops.
STEP-63: step_time = 19.993600 ms, foward_time = 9.372672, backward_time = 10.520576, perf = 41.24 tflops.
STEP-64: step_time = 20.033537 ms, foward_time = 9.585664, backward_time = 10.347520, perf = 41.16 tflops.
STEP-65: step_time = 19.546112 ms, foward_time = 9.406464, backward_time = 10.038272, perf = 42.19 tflops.
STEP-66: step_time = 20.409408 ms, foward_time = 9.765952, backward_time = 10.543104, perf = 40.40 tflops.
STEP-67: step_time = 20.294656 ms, foward_time = 9.572352, backward_time = 10.620928, perf = 40.63 tflops.
STEP-68: step_time = 20.034687 ms, foward_time = 9.433216, backward_time = 10.500096, perf = 41.16 tflops.
STEP-69: step_time = 19.862175 ms, foward_time = 9.266848, backward_time = 10.494976, perf = 41.52 tflops.
STEP-70: step_time = 20.453376 ms, foward_time = 9.723904, backward_time = 10.629120, perf = 40.32 tflops.
STEP-71: step_time = 19.976192 ms, foward_time = 9.517056, backward_time = 10.357760, perf = 41.28 tflops.
STEP-72: step_time = 20.300801 ms, foward_time = 9.797632, backward_time = 10.403840, perf = 40.62 tflops.
STEP-73: step_time = 20.481023 ms, foward_time = 9.708544, backward_time = 10.668032, perf = 40.26 tflops.
STEP-74: step_time = 19.864736 ms, foward_time = 9.613472, backward_time = 10.149888, perf = 41.51 tflops.
STEP-75: step_time = 20.056063 ms, foward_time = 9.453568, backward_time = 10.499072, perf = 41.12 tflops.
STEP-76: step_time = 20.669441 ms, foward_time = 10.010624, backward_time = 10.557440, perf = 39.90 tflops.
STEP-77: step_time = 19.392512 ms, foward_time = 9.023488, backward_time = 10.266624, perf = 42.52 tflops.
STEP-78: step_time = 19.297279 ms, foward_time = 8.929280, backward_time = 10.265600, perf = 42.73 tflops.
STEP-79: step_time = 19.228673 ms, foward_time = 9.001984, backward_time = 10.125312, perf = 42.89 tflops.
STEP-80: step_time = 20.059137 ms, foward_time = 8.992768, backward_time = 10.962944, perf = 41.11 tflops.
STEP-81: step_time = 20.456447 ms, foward_time = 9.678848, backward_time = 10.675200, perf = 40.31 tflops.
STEP-82: step_time = 20.236287 ms, foward_time = 9.375744, backward_time = 10.760192, perf = 40.75 tflops.
STEP-83: step_time = 19.674113 ms, foward_time = 9.363456, backward_time = 10.211328, perf = 41.91 tflops.
STEP-84: step_time = 19.983521 ms, foward_time = 9.540768, backward_time = 10.341376, perf = 41.27 tflops.
STEP-85: step_time = 20.262911 ms, foward_time = 9.498624, backward_time = 10.653696, perf = 40.70 tflops.
STEP-86: step_time = 20.406273 ms, foward_time = 9.412608, backward_time = 10.871808, perf = 40.41 tflops.
STEP-87: step_time = 19.875520 ms, foward_time = 9.791168, backward_time = 9.971712, perf = 41.49 tflops.
STEP-88: step_time = 19.713023 ms, foward_time = 9.319424, backward_time = 10.280960, perf = 41.83 tflops.
STEP-89: step_time = 19.914752 ms, foward_time = 9.119744, backward_time = 10.683392, perf = 41.41 tflops.
STEP-90: step_time = 19.791136 ms, foward_time = 9.453856, backward_time = 10.226688, perf = 41.67 tflops.
STEP-91: step_time = 20.356064 ms, foward_time = 9.548768, backward_time = 10.695680, perf = 40.51 tflops.
STEP-92: step_time = 20.493536 ms, foward_time = 10.054880, backward_time = 10.305536, perf = 40.24 tflops.
STEP-93: step_time = 19.935231 ms, foward_time = 9.208832, backward_time = 10.604544, perf = 41.37 tflops.
STEP-94: step_time = 19.864575 ms, foward_time = 9.445376, backward_time = 10.306560, perf = 41.51 tflops.
STEP-95: step_time = 19.997695 ms, foward_time = 9.488384, backward_time = 10.397696, perf = 41.24 tflops.
STEP-96: step_time = 19.916800 ms, foward_time = 9.321472, backward_time = 10.483712, perf = 41.40 tflops.
STEP-97: step_time = 19.963265 ms, foward_time = 9.282944, backward_time = 10.529792, perf = 41.31 tflops.
STEP-98: step_time = 20.142079 ms, foward_time = 9.492480, backward_time = 10.537984, perf = 40.94 tflops.
STEP-99: step_time = 20.095999 ms, foward_time = 9.282560, backward_time = 10.682368, perf = 41.03 tflops.

 mix_moe 8 [Summary] Average synchronized step_time = 20.055638217926024 ms, forward = 9.457955265045166 , backward = 10.477055931091309 .
cuda:0
cuda:1
cuda:2
cuda:3
[Benchmark] world_size = 4, dtype = float16, model_dim = 1024, hidden_size = 4096, samples = 8192, num_local_experts = 16, topK = 2, a2a_ffn_overlap_degree = 1, device = `cuda:0`
STEP-0: step_time = 41.761719 ms, foward_time = 17.503174, backward_time = 23.879681, perf = 19.75 tflops.
STEP-1: step_time = 22.782976 ms, foward_time = 10.810368, backward_time = 11.871232, perf = 36.20 tflops.
STEP-2: step_time = 22.075392 ms, foward_time = 10.130432, backward_time = 11.865088, perf = 37.36 tflops.
STEP-3: step_time = 22.922239 ms, foward_time = 11.234304, backward_time = 11.598848, perf = 35.98 tflops.
STEP-4: step_time = 22.528672 ms, foward_time = 10.786464, backward_time = 11.659264, perf = 36.60 tflops.
STEP-5: step_time = 22.584320 ms, foward_time = 10.801152, backward_time = 11.701248, perf = 36.51 tflops.
STEP-6: step_time = 22.476799 ms, foward_time = 10.815488, backward_time = 11.581440, perf = 36.69 tflops.
STEP-7: step_time = 22.950912 ms, foward_time = 10.726400, backward_time = 12.140544, perf = 35.93 tflops.
STEP-8: step_time = 21.995521 ms, foward_time = 10.447872, backward_time = 11.469824, perf = 37.49 tflops.
STEP-9: step_time = 20.602880 ms, foward_time = 9.741312, backward_time = 10.766336, perf = 40.03 tflops.
STEP-10: step_time = 20.773887 ms, foward_time = 9.953280, backward_time = 10.726400, perf = 39.70 tflops.
STEP-11: step_time = 20.862976 ms, foward_time = 9.850880, backward_time = 10.915840, perf = 39.53 tflops.
STEP-12: step_time = 21.055488 ms, foward_time = 9.737216, backward_time = 11.222016, perf = 39.16 tflops.
STEP-13: step_time = 21.305344 ms, foward_time = 9.894912, backward_time = 11.314176, perf = 38.71 tflops.
STEP-14: step_time = 20.861952 ms, foward_time = 9.679873, backward_time = 11.085824, perf = 39.53 tflops.
STEP-15: step_time = 20.889600 ms, foward_time = 9.631744, backward_time = 11.163648, perf = 39.48 tflops.
STEP-16: step_time = 20.805633 ms, foward_time = 9.698304, backward_time = 11.012096, perf = 39.64 tflops.
STEP-17: step_time = 21.294080 ms, foward_time = 9.909248, backward_time = 11.288576, perf = 38.73 tflops.
STEP-18: step_time = 21.128192 ms, foward_time = 9.837568, backward_time = 11.194368, perf = 39.03 tflops.
STEP-19: step_time = 21.193728 ms, foward_time = 9.860096, backward_time = 11.239424, perf = 38.91 tflops.
STEP-20: step_time = 21.108736 ms, foward_time = 9.740288, backward_time = 11.272192, perf = 39.07 tflops.
STEP-21: step_time = 19.889152 ms, foward_time = 9.369600, backward_time = 10.422272, perf = 41.46 tflops.
STEP-22: step_time = 21.554175 ms, foward_time = 9.724928, backward_time = 11.732992, perf = 38.26 tflops.
STEP-23: step_time = 21.553153 ms, foward_time = 10.415104, backward_time = 11.021312, perf = 38.26 tflops.
STEP-24: step_time = 20.849665 ms, foward_time = 9.176064, backward_time = 11.576320, perf = 39.55 tflops.
STEP-25: step_time = 21.928959 ms, foward_time = 10.120192, backward_time = 11.713536, perf = 37.60 tflops.
STEP-26: step_time = 20.822017 ms, foward_time = 9.104384, backward_time = 11.621376, perf = 39.60 tflops.
STEP-27: step_time = 20.896768 ms, foward_time = 9.974784, backward_time = 10.826752, perf = 39.46 tflops.
STEP-28: step_time = 21.127168 ms, foward_time = 9.466880, backward_time = 11.564032, perf = 39.03 tflops.
STEP-29: step_time = 20.329471 ms, foward_time = 9.246720, backward_time = 10.986496, perf = 40.56 tflops.
STEP-30: step_time = 20.839423 ms, foward_time = 9.767936, backward_time = 10.976256, perf = 39.57 tflops.
STEP-31: step_time = 20.792319 ms, foward_time = 9.744384, backward_time = 10.952704, perf = 39.66 tflops.
STEP-32: step_time = 21.496831 ms, foward_time = 10.063872, backward_time = 11.301888, perf = 38.36 tflops.
STEP-33: step_time = 18.915328 ms, foward_time = 8.326144, backward_time = 10.493952, perf = 43.60 tflops.
STEP-34: step_time = 21.264384 ms, foward_time = 9.814016, backward_time = 11.354112, perf = 38.78 tflops.
STEP-35: step_time = 21.146624 ms, foward_time = 10.071040, backward_time = 10.969088, perf = 39.00 tflops.
STEP-36: step_time = 21.064705 ms, foward_time = 10.182656, backward_time = 10.754048, perf = 39.15 tflops.
STEP-37: step_time = 19.620865 ms, foward_time = 8.540160, backward_time = 10.973184, perf = 42.03 tflops.
STEP-38: step_time = 20.869120 ms, foward_time = 9.566208, backward_time = 11.198464, perf = 39.51 tflops.
STEP-39: step_time = 21.006335 ms, foward_time = 9.859072, backward_time = 11.040768, perf = 39.26 tflops.
STEP-40: step_time = 20.105216 ms, foward_time = 8.862720, backward_time = 11.134976, perf = 41.02 tflops.
STEP-41: step_time = 19.300353 ms, foward_time = 8.415232, backward_time = 10.777600, perf = 42.73 tflops.
STEP-42: step_time = 20.357121 ms, foward_time = 9.865216, backward_time = 10.368000, perf = 40.51 tflops.
STEP-43: step_time = 19.175425 ms, foward_time = 8.637440, backward_time = 10.430464, perf = 43.00 tflops.
STEP-44: step_time = 20.363264 ms, foward_time = 9.612288, backward_time = 10.644480, perf = 40.50 tflops.
STEP-45: step_time = 20.622336 ms, foward_time = 9.645056, backward_time = 10.835968, perf = 39.99 tflops.
STEP-46: step_time = 20.300799 ms, foward_time = 9.166848, backward_time = 11.027456, perf = 40.62 tflops.
STEP-47: step_time = 20.874241 ms, foward_time = 9.680897, backward_time = 11.086848, perf = 39.50 tflops.
STEP-48: step_time = 20.642816 ms, foward_time = 9.614336, backward_time = 10.921984, perf = 39.95 tflops.
STEP-49: step_time = 20.887553 ms, foward_time = 9.660416, backward_time = 11.120640, perf = 39.48 tflops.
STEP-50: step_time = 20.851712 ms, foward_time = 9.626624, backward_time = 11.118592, perf = 39.55 tflops.
STEP-51: step_time = 20.579328 ms, foward_time = 9.371648, backward_time = 11.100160, perf = 40.07 tflops.
STEP-52: step_time = 21.125119 ms, foward_time = 9.766912, backward_time = 11.250688, perf = 39.04 tflops.
STEP-53: step_time = 20.393985 ms, foward_time = 9.156609, backward_time = 11.129856, perf = 40.44 tflops.
STEP-54: step_time = 20.198400 ms, foward_time = 8.969216, backward_time = 11.122688, perf = 40.83 tflops.
STEP-55: step_time = 20.262911 ms, foward_time = 8.935424, backward_time = 11.219968, perf = 40.70 tflops.
STEP-56: step_time = 21.820416 ms, foward_time = 10.150912, backward_time = 11.541504, perf = 37.79 tflops.
STEP-57: step_time = 20.362239 ms, foward_time = 9.024512, backward_time = 11.230208, perf = 40.50 tflops.
STEP-58: step_time = 21.028863 ms, foward_time = 9.782272, backward_time = 11.150336, perf = 39.21 tflops.
STEP-59: step_time = 21.046273 ms, foward_time = 9.995265, backward_time = 10.954752, perf = 39.18 tflops.
STEP-60: step_time = 21.159937 ms, foward_time = 9.936896, backward_time = 11.127808, perf = 38.97 tflops.
STEP-61: step_time = 21.033983 ms, foward_time = 9.794560, backward_time = 11.145216, perf = 39.20 tflops.
STEP-62: step_time = 21.293056 ms, foward_time = 9.726976, backward_time = 11.468800, perf = 38.73 tflops.
STEP-63: step_time = 21.137409 ms, foward_time = 9.774080, backward_time = 11.268096, perf = 39.01 tflops.
STEP-64: step_time = 21.030911 ms, foward_time = 9.694208, backward_time = 11.241472, perf = 39.21 tflops.
STEP-65: step_time = 21.596160 ms, foward_time = 10.363904, backward_time = 11.137024, perf = 38.18 tflops.
STEP-66: step_time = 21.592960 ms, foward_time = 10.419072, backward_time = 11.078656, perf = 38.19 tflops.
STEP-67: step_time = 21.181568 ms, foward_time = 9.758848, backward_time = 11.327488, perf = 38.93 tflops.
STEP-68: step_time = 21.371904 ms, foward_time = 9.932800, backward_time = 11.342848, perf = 38.58 tflops.
STEP-69: step_time = 21.600255 ms, foward_time = 10.355712, backward_time = 11.148288, perf = 38.18 tflops.
STEP-70: step_time = 21.403840 ms, foward_time = 10.214592, backward_time = 11.092992, perf = 38.53 tflops.
STEP-71: step_time = 20.854784 ms, foward_time = 9.562112, backward_time = 11.196416, perf = 39.54 tflops.
STEP-72: step_time = 21.249025 ms, foward_time = 10.018816, backward_time = 11.133952, perf = 38.81 tflops.
STEP-73: step_time = 21.190656 ms, foward_time = 10.254336, backward_time = 10.840064, perf = 38.91 tflops.
STEP-74: step_time = 20.780033 ms, foward_time = 9.531392, backward_time = 11.153408, perf = 39.68 tflops.
STEP-75: step_time = 21.297152 ms, foward_time = 10.078207, backward_time = 11.122688, perf = 38.72 tflops.
STEP-76: step_time = 21.175296 ms, foward_time = 9.769984, backward_time = 11.309056, perf = 38.94 tflops.
STEP-77: step_time = 20.527104 ms, foward_time = 9.442304, backward_time = 10.988544, perf = 40.17 tflops.
STEP-78: step_time = 20.910080 ms, foward_time = 9.646080, backward_time = 11.167744, perf = 39.44 tflops.
STEP-79: step_time = 20.956161 ms, foward_time = 9.682944, backward_time = 11.176960, perf = 39.35 tflops.
STEP-80: step_time = 21.104640 ms, foward_time = 9.859071, backward_time = 11.150336, perf = 39.07 tflops.
STEP-81: step_time = 21.100544 ms, foward_time = 9.833472, backward_time = 11.171840, perf = 39.08 tflops.
STEP-82: step_time = 21.722112 ms, foward_time = 10.003456, backward_time = 11.624448, perf = 37.96 tflops.
STEP-83: step_time = 20.489216 ms, foward_time = 9.718784, backward_time = 10.675200, perf = 40.25 tflops.
STEP-84: step_time = 20.234241 ms, foward_time = 9.602048, backward_time = 10.534912, perf = 40.75 tflops.
STEP-85: step_time = 19.692544 ms, foward_time = 8.898561, backward_time = 10.693632, perf = 41.88 tflops.
STEP-86: step_time = 21.052897 ms, foward_time = 10.379744, backward_time = 10.574848, perf = 39.17 tflops.
STEP-87: step_time = 20.917249 ms, foward_time = 9.919488, backward_time = 10.902528, perf = 39.42 tflops.
STEP-88: step_time = 21.204993 ms, foward_time = 9.929728, backward_time = 11.177984, perf = 38.89 tflops.
STEP-89: step_time = 20.947969 ms, foward_time = 9.901056, backward_time = 10.949632, perf = 39.37 tflops.
STEP-90: step_time = 21.052416 ms, foward_time = 9.897984, backward_time = 11.059200, perf = 39.17 tflops.
STEP-91: step_time = 22.955008 ms, foward_time = 9.553920, backward_time = 13.303808, perf = 35.92 tflops.
STEP-92: step_time = 20.700159 ms, foward_time = 10.008576, backward_time = 10.589184, perf = 39.84 tflops.
STEP-93: step_time = 20.673536 ms, foward_time = 9.606144, backward_time = 10.972160, perf = 39.89 tflops.
STEP-94: step_time = 20.629505 ms, foward_time = 9.518080, backward_time = 11.015168, perf = 39.97 tflops.
STEP-95: step_time = 20.613121 ms, foward_time = 9.507840, backward_time = 11.010048, perf = 40.01 tflops.
STEP-96: step_time = 20.954111 ms, foward_time = 9.629696, backward_time = 11.228160, perf = 39.35 tflops.
STEP-97: step_time = 20.791296 ms, foward_time = 9.740288, backward_time = 10.954752, perf = 39.66 tflops.
STEP-98: step_time = 20.573184 ms, foward_time = 9.314304, backward_time = 11.162624, perf = 40.08 tflops.
STEP-99: step_time = 20.638720 ms, foward_time = 9.624576, backward_time = 10.911744, perf = 39.96 tflops.

 mix_moe 16 [Summary] Average synchronized step_time = 20.95810549259186 ms, forward = 9.640140843391418 , backward = 11.220684909820557 .
cuda:2
cuda:3
cuda:1
cuda:0
[Benchmark] world_size = 4, dtype = float16, model_dim = 1024, hidden_size = 4096, samples = 8192, num_local_experts = 32, topK = 2, a2a_ffn_overlap_degree = 1, device = `cuda:0`
STEP-0: step_time = 50.800659 ms, foward_time = 28.401733, backward_time = 21.961727, perf = 16.23 tflops.
STEP-1: step_time = 33.366017 ms, foward_time = 17.143809, backward_time = 16.094208, perf = 24.71 tflops.
STEP-2: step_time = 31.172607 ms, foward_time = 15.666175, backward_time = 15.406080, perf = 26.45 tflops.
STEP-3: step_time = 32.033794 ms, foward_time = 16.508928, backward_time = 15.425536, perf = 25.74 tflops.
STEP-4: step_time = 32.732897 ms, foward_time = 16.706272, backward_time = 15.926272, perf = 25.19 tflops.
STEP-5: step_time = 32.479234 ms, foward_time = 17.081344, backward_time = 15.296512, perf = 25.39 tflops.
STEP-6: step_time = 32.527553 ms, foward_time = 16.784576, backward_time = 15.644672, perf = 25.35 tflops.
STEP-7: step_time = 30.375935 ms, foward_time = 16.774144, backward_time = 13.504512, perf = 27.15 tflops.
STEP-8: step_time = 23.766016 ms, foward_time = 12.263424, backward_time = 11.406336, perf = 34.70 tflops.
STEP-9: step_time = 23.979007 ms, foward_time = 12.108800, backward_time = 11.771904, perf = 34.39 tflops.
STEP-10: step_time = 24.238688 ms, foward_time = 12.742239, backward_time = 11.380736, perf = 34.02 tflops.
STEP-11: step_time = 23.275520 ms, foward_time = 12.062720, backward_time = 11.115520, perf = 35.43 tflops.
STEP-12: step_time = 23.337089 ms, foward_time = 12.257408, backward_time = 10.982400, perf = 35.34 tflops.
STEP-13: step_time = 23.743488 ms, foward_time = 12.405760, backward_time = 11.241472, perf = 34.73 tflops.
STEP-14: step_time = 23.638016 ms, foward_time = 11.982848, backward_time = 11.557888, perf = 34.89 tflops.
STEP-15: step_time = 24.316928 ms, foward_time = 12.507136, backward_time = 11.691008, perf = 33.91 tflops.
STEP-16: step_time = 23.129088 ms, foward_time = 11.438080, backward_time = 11.592704, perf = 35.65 tflops.
STEP-17: step_time = 23.526401 ms, foward_time = 11.975680, backward_time = 11.454464, perf = 35.05 tflops.
STEP-18: step_time = 23.627776 ms, foward_time = 12.136448, backward_time = 11.394048, perf = 34.90 tflops.
STEP-19: step_time = 23.060480 ms, foward_time = 11.401216, backward_time = 11.561984, perf = 35.76 tflops.
STEP-20: step_time = 24.084480 ms, foward_time = 12.477440, backward_time = 11.510784, perf = 34.24 tflops.
STEP-21: step_time = 23.698431 ms, foward_time = 12.574720, backward_time = 11.028480, perf = 34.80 tflops.
STEP-22: step_time = 23.199744 ms, foward_time = 11.804672, backward_time = 11.300864, perf = 35.54 tflops.
STEP-23: step_time = 23.340063 ms, foward_time = 12.007456, backward_time = 11.236352, perf = 35.33 tflops.
STEP-24: step_time = 25.505569 ms, foward_time = 14.507808, backward_time = 10.901504, perf = 32.33 tflops.
STEP-25: step_time = 23.704575 ms, foward_time = 12.090368, backward_time = 11.517952, perf = 34.79 tflops.
STEP-26: step_time = 24.189951 ms, foward_time = 12.662784, backward_time = 11.428864, perf = 34.09 tflops.
STEP-27: step_time = 23.463616 ms, foward_time = 11.919040, backward_time = 11.448320, perf = 35.15 tflops.
STEP-28: step_time = 24.270816 ms, foward_time = 12.440543, backward_time = 11.724800, perf = 33.98 tflops.
STEP-29: step_time = 23.952160 ms, foward_time = 12.409632, backward_time = 11.446272, perf = 34.43 tflops.
STEP-30: step_time = 24.238752 ms, foward_time = 12.577440, backward_time = 11.564032, perf = 34.02 tflops.
STEP-31: step_time = 24.403744 ms, foward_time = 12.424992, backward_time = 11.881472, perf = 33.79 tflops.
STEP-32: step_time = 26.177984 ms, foward_time = 15.040960, backward_time = 11.038720, perf = 31.50 tflops.
STEP-33: step_time = 24.259584 ms, foward_time = 12.425216, backward_time = 11.726848, perf = 33.99 tflops.
STEP-34: step_time = 23.548928 ms, foward_time = 12.193792, backward_time = 11.259904, perf = 35.02 tflops.
STEP-35: step_time = 23.605440 ms, foward_time = 12.056768, backward_time = 11.451392, perf = 34.93 tflops.
STEP-36: step_time = 23.757056 ms, foward_time = 12.061952, backward_time = 11.593728, perf = 34.71 tflops.
STEP-37: step_time = 23.730847 ms, foward_time = 12.192416, backward_time = 11.440128, perf = 34.75 tflops.
STEP-38: step_time = 24.403295 ms, foward_time = 12.559712, backward_time = 11.744256, perf = 33.79 tflops.
STEP-39: step_time = 23.583745 ms, foward_time = 11.920384, backward_time = 11.561984, perf = 34.97 tflops.
STEP-40: step_time = 23.427073 ms, foward_time = 12.033024, backward_time = 11.294720, perf = 35.20 tflops.
STEP-41: step_time = 25.014271 ms, foward_time = 13.528064, backward_time = 11.384832, perf = 32.97 tflops.
STEP-42: step_time = 23.851776 ms, foward_time = 12.344064, backward_time = 11.410432, perf = 34.57 tflops.
STEP-43: step_time = 24.064353 ms, foward_time = 12.673376, backward_time = 11.294720, perf = 34.27 tflops.
STEP-44: step_time = 23.997440 ms, foward_time = 12.728320, backward_time = 11.171840, perf = 34.36 tflops.
STEP-45: step_time = 23.650304 ms, foward_time = 12.127232, backward_time = 11.426816, perf = 34.87 tflops.
STEP-46: step_time = 23.953857 ms, foward_time = 12.576192, backward_time = 11.247616, perf = 34.43 tflops.
STEP-47: step_time = 23.603200 ms, foward_time = 11.784192, backward_time = 11.719680, perf = 34.94 tflops.
STEP-48: step_time = 24.229888 ms, foward_time = 12.756992, backward_time = 11.375616, perf = 34.03 tflops.
STEP-49: step_time = 23.421952 ms, foward_time = 12.063745, backward_time = 11.260928, perf = 35.21 tflops.
STEP-50: step_time = 24.180736 ms, foward_time = 12.379136, backward_time = 11.706368, perf = 34.10 tflops.
STEP-51: step_time = 23.603200 ms, foward_time = 12.178432, backward_time = 11.329536, perf = 34.94 tflops.
STEP-52: step_time = 23.800832 ms, foward_time = 12.473344, backward_time = 11.229184, perf = 34.65 tflops.
STEP-53: step_time = 24.264704 ms, foward_time = 12.528640, backward_time = 11.640832, perf = 33.98 tflops.
STEP-54: step_time = 23.825408 ms, foward_time = 12.286976, backward_time = 11.418624, perf = 34.61 tflops.
STEP-55: step_time = 23.882752 ms, foward_time = 12.531712, backward_time = 11.252736, perf = 34.53 tflops.
STEP-56: step_time = 23.918591 ms, foward_time = 12.217344, backward_time = 11.606016, perf = 34.48 tflops.
STEP-57: step_time = 23.701505 ms, foward_time = 12.084224, backward_time = 11.497472, perf = 34.79 tflops.
STEP-58: step_time = 23.747937 ms, foward_time = 12.232033, backward_time = 11.418624, perf = 34.72 tflops.
STEP-59: step_time = 24.394751 ms, foward_time = 12.549120, backward_time = 11.749376, perf = 33.80 tflops.
STEP-60: step_time = 24.130560 ms, foward_time = 12.635136, backward_time = 11.399168, perf = 34.17 tflops.
STEP-61: step_time = 23.386560 ms, foward_time = 11.974080, backward_time = 11.316224, perf = 35.26 tflops.
STEP-62: step_time = 23.560321 ms, foward_time = 12.248192, backward_time = 11.212800, perf = 35.00 tflops.
STEP-63: step_time = 23.926688 ms, foward_time = 12.577696, backward_time = 11.251712, perf = 34.47 tflops.
STEP-64: step_time = 23.916544 ms, foward_time = 12.229632, backward_time = 11.589632, perf = 34.48 tflops.
STEP-65: step_time = 23.550015 ms, foward_time = 12.118080, backward_time = 11.333632, perf = 35.02 tflops.
STEP-66: step_time = 23.939072 ms, foward_time = 12.418048, backward_time = 11.420672, perf = 34.45 tflops.
STEP-67: step_time = 23.744513 ms, foward_time = 12.237824, backward_time = 11.410432, perf = 34.73 tflops.
STEP-68: step_time = 24.001567 ms, foward_time = 12.447776, backward_time = 11.453440, perf = 34.36 tflops.
STEP-69: step_time = 23.651328 ms, foward_time = 12.001280, backward_time = 11.551744, perf = 34.87 tflops.
STEP-70: step_time = 22.885377 ms, foward_time = 11.677696, backward_time = 11.110400, perf = 36.03 tflops.
STEP-71: step_time = 24.054112 ms, foward_time = 12.513633, backward_time = 11.441152, perf = 34.28 tflops.
STEP-72: step_time = 23.859200 ms, foward_time = 12.277760, backward_time = 11.484160, perf = 34.56 tflops.
STEP-73: step_time = 23.533567 ms, foward_time = 12.220416, backward_time = 11.212800, perf = 35.04 tflops.
STEP-74: step_time = 23.773183 ms, foward_time = 12.051456, backward_time = 11.624448, perf = 34.69 tflops.
STEP-75: step_time = 23.568383 ms, foward_time = 12.034048, backward_time = 11.433984, perf = 34.99 tflops.
STEP-76: step_time = 23.862655 ms, foward_time = 12.261760, backward_time = 11.503616, perf = 34.56 tflops.
STEP-77: step_time = 24.598528 ms, foward_time = 12.703744, backward_time = 11.798528, perf = 33.52 tflops.
STEP-78: step_time = 23.593984 ms, foward_time = 11.997184, backward_time = 11.497472, perf = 34.95 tflops.
STEP-79: step_time = 23.424001 ms, foward_time = 11.973632, backward_time = 11.353088, perf = 35.20 tflops.
STEP-80: step_time = 24.515584 ms, foward_time = 12.672000, backward_time = 11.743232, perf = 33.64 tflops.
STEP-81: step_time = 23.058432 ms, foward_time = 11.508736, backward_time = 11.451392, perf = 35.76 tflops.
STEP-82: step_time = 23.948672 ms, foward_time = 12.418432, backward_time = 11.432960, perf = 34.43 tflops.
STEP-83: step_time = 23.792511 ms, foward_time = 12.257152, backward_time = 11.440128, perf = 34.66 tflops.
STEP-84: step_time = 23.682752 ms, foward_time = 12.318400, backward_time = 11.267072, perf = 34.82 tflops.
STEP-85: step_time = 24.288255 ms, foward_time = 12.449792, backward_time = 11.742208, perf = 33.95 tflops.
STEP-86: step_time = 23.445503 ms, foward_time = 11.868160, backward_time = 11.481088, perf = 35.17 tflops.
STEP-87: step_time = 23.067648 ms, foward_time = 11.741184, backward_time = 11.229184, perf = 35.75 tflops.
STEP-88: step_time = 24.001536 ms, foward_time = 12.086272, backward_time = 11.814912, perf = 34.36 tflops.
STEP-89: step_time = 23.971840 ms, foward_time = 12.151808, backward_time = 11.721728, perf = 34.40 tflops.
STEP-90: step_time = 24.076288 ms, foward_time = 12.620800, backward_time = 11.358208, perf = 34.25 tflops.
STEP-91: step_time = 23.696384 ms, foward_time = 11.973632, backward_time = 11.622400, perf = 34.80 tflops.
STEP-92: step_time = 23.741440 ms, foward_time = 11.959296, backward_time = 11.674624, perf = 34.73 tflops.
STEP-93: step_time = 23.664640 ms, foward_time = 12.177408, backward_time = 11.368448, perf = 34.85 tflops.
STEP-94: step_time = 23.873537 ms, foward_time = 12.183553, backward_time = 11.588608, perf = 34.54 tflops.
STEP-95: step_time = 24.121343 ms, foward_time = 12.786688, backward_time = 11.204608, perf = 34.19 tflops.
STEP-96: step_time = 23.595008 ms, foward_time = 12.281856, backward_time = 11.214848, perf = 34.95 tflops.
STEP-97: step_time = 24.159232 ms, foward_time = 12.539904, backward_time = 11.521024, perf = 34.13 tflops.
STEP-98: step_time = 23.375872 ms, foward_time = 11.812864, backward_time = 11.464704, perf = 35.28 tflops.
STEP-99: step_time = 24.055809 ms, foward_time = 12.417024, backward_time = 11.538432, perf = 34.28 tflops.

 mix_moe 32 [Summary] Average synchronized step_time = 23.83595539331436 ms, forward = 12.275302374362946 , backward = 11.455590343475341 .
cuda:0
cuda:1
cuda:2
cuda:3
[Benchmark] world_size = 4, dtype = float16, model_dim = 1024, hidden_size = 4096, samples = 8192, num_local_experts = 64, topK = 2, a2a_ffn_overlap_degree = 1, device = `cuda:0`
STEP-0: step_time = 69.432251 ms, foward_time = 26.281982, backward_time = 42.783745, perf = 11.88 tflops.
STEP-1: step_time = 33.758209 ms, foward_time = 19.212287, backward_time = 14.435328, perf = 24.43 tflops.
STEP-2: step_time = 33.389503 ms, foward_time = 19.812288, backward_time = 13.492224, perf = 24.70 tflops.
STEP-3: step_time = 28.732416 ms, foward_time = 16.613376, backward_time = 12.027904, perf = 28.70 tflops.
STEP-4: step_time = 28.197887 ms, foward_time = 16.192513, backward_time = 11.914240, perf = 29.24 tflops.
STEP-5: step_time = 28.705792 ms, foward_time = 16.448511, backward_time = 12.167168, perf = 28.73 tflops.
STEP-6: step_time = 28.494847 ms, foward_time = 16.309249, backward_time = 12.101632, perf = 28.94 tflops.
STEP-7: step_time = 28.456960 ms, foward_time = 16.510977, backward_time = 11.859968, perf = 28.98 tflops.
STEP-8: step_time = 27.722752 ms, foward_time = 15.693823, backward_time = 11.942912, perf = 29.75 tflops.
STEP-9: step_time = 24.607744 ms, foward_time = 14.012416, backward_time = 10.512384, perf = 33.51 tflops.
STEP-10: step_time = 25.224191 ms, foward_time = 14.706688, backward_time = 10.425344, perf = 32.69 tflops.
STEP-11: step_time = 24.890368 ms, foward_time = 14.026753, backward_time = 10.779648, perf = 33.13 tflops.
STEP-12: step_time = 25.378815 ms, foward_time = 14.956544, backward_time = 10.334208, perf = 32.49 tflops.
STEP-13: step_time = 24.428544 ms, foward_time = 14.107647, backward_time = 10.226688, perf = 33.76 tflops.
STEP-14: step_time = 25.293376 ms, foward_time = 14.388800, backward_time = 10.817536, perf = 32.60 tflops.
STEP-15: step_time = 25.165793 ms, foward_time = 14.834656, backward_time = 10.236928, perf = 32.77 tflops.
STEP-16: step_time = 24.851457 ms, foward_time = 14.386176, backward_time = 10.375168, perf = 33.18 tflops.
STEP-17: step_time = 25.167872 ms, foward_time = 14.411776, backward_time = 10.667008, perf = 32.77 tflops.
STEP-18: step_time = 24.677376 ms, foward_time = 14.377984, backward_time = 10.213376, perf = 33.42 tflops.
STEP-19: step_time = 24.349695 ms, foward_time = 14.047232, backward_time = 10.214400, perf = 33.87 tflops.
STEP-20: step_time = 24.547328 ms, foward_time = 14.251009, backward_time = 10.203136, perf = 33.59 tflops.
STEP-21: step_time = 24.748033 ms, foward_time = 14.233600, backward_time = 10.424320, perf = 33.32 tflops.
STEP-22: step_time = 25.653248 ms, foward_time = 15.115263, backward_time = 10.451968, perf = 32.15 tflops.
STEP-23: step_time = 26.127360 ms, foward_time = 14.767103, backward_time = 11.272192, perf = 31.56 tflops.
STEP-24: step_time = 25.155584 ms, foward_time = 14.763008, backward_time = 10.304512, perf = 32.78 tflops.
STEP-25: step_time = 25.191425 ms, foward_time = 14.694400, backward_time = 10.377216, perf = 32.73 tflops.
STEP-26: step_time = 25.068833 ms, foward_time = 14.626080, backward_time = 10.338304, perf = 32.89 tflops.
STEP-27: step_time = 24.981504 ms, foward_time = 14.502912, backward_time = 10.377216, perf = 33.01 tflops.
STEP-28: step_time = 24.271872 ms, foward_time = 13.968384, backward_time = 10.201088, perf = 33.97 tflops.
STEP-29: step_time = 25.207520 ms, foward_time = 14.865120, backward_time = 10.236928, perf = 32.71 tflops.
STEP-30: step_time = 25.205760 ms, foward_time = 14.845953, backward_time = 10.256384, perf = 32.72 tflops.
STEP-31: step_time = 25.225215 ms, foward_time = 14.521344, backward_time = 10.603520, perf = 32.69 tflops.
STEP-32: step_time = 24.832000 ms, foward_time = 14.219265, backward_time = 10.510336, perf = 33.21 tflops.
STEP-33: step_time = 24.706048 ms, foward_time = 14.253056, backward_time = 10.348544, perf = 33.38 tflops.
STEP-34: step_time = 24.720385 ms, foward_time = 14.084095, backward_time = 10.531840, perf = 33.36 tflops.
STEP-35: step_time = 25.062399 ms, foward_time = 14.665728, backward_time = 10.292224, perf = 32.90 tflops.
STEP-36: step_time = 24.856575 ms, foward_time = 14.281727, backward_time = 10.471424, perf = 33.18 tflops.
STEP-37: step_time = 24.923136 ms, foward_time = 14.340095, backward_time = 10.471424, perf = 33.09 tflops.
STEP-38: step_time = 25.321473 ms, foward_time = 14.710783, backward_time = 10.496000, perf = 32.57 tflops.
STEP-39: step_time = 25.709568 ms, foward_time = 14.932993, backward_time = 10.672128, perf = 32.07 tflops.
STEP-40: step_time = 25.260032 ms, foward_time = 14.729217, backward_time = 10.425344, perf = 32.65 tflops.
STEP-41: step_time = 24.722432 ms, foward_time = 14.081023, backward_time = 10.527744, perf = 33.36 tflops.
STEP-42: step_time = 25.397376 ms, foward_time = 14.573697, backward_time = 10.710016, perf = 32.47 tflops.
STEP-43: step_time = 25.561089 ms, foward_time = 14.669825, backward_time = 10.773504, perf = 32.26 tflops.
STEP-44: step_time = 25.371649 ms, foward_time = 14.385153, backward_time = 10.874880, perf = 32.50 tflops.
STEP-45: step_time = 25.167871 ms, foward_time = 14.136320, backward_time = 10.912768, perf = 32.77 tflops.
STEP-46: step_time = 25.585824 ms, foward_time = 14.495904, backward_time = 10.981376, perf = 32.23 tflops.
STEP-47: step_time = 25.248769 ms, foward_time = 14.532609, backward_time = 10.612736, perf = 32.66 tflops.
STEP-48: step_time = 24.901632 ms, foward_time = 14.197759, backward_time = 10.603520, perf = 33.12 tflops.
STEP-49: step_time = 24.604672 ms, foward_time = 13.908991, backward_time = 10.593280, perf = 33.52 tflops.
STEP-50: step_time = 24.846335 ms, foward_time = 14.559232, backward_time = 10.185728, perf = 33.19 tflops.
STEP-51: step_time = 24.466431 ms, foward_time = 14.099455, backward_time = 10.266624, perf = 33.70 tflops.
STEP-52: step_time = 25.044991 ms, foward_time = 14.070784, backward_time = 10.869760, perf = 32.93 tflops.
STEP-53: step_time = 24.056832 ms, foward_time = 13.769728, backward_time = 10.183680, perf = 34.28 tflops.
STEP-54: step_time = 24.843264 ms, foward_time = 13.927424, backward_time = 10.813440, perf = 33.19 tflops.
STEP-55: step_time = 24.818687 ms, foward_time = 14.112768, backward_time = 10.601472, perf = 33.23 tflops.
STEP-56: step_time = 24.129536 ms, foward_time = 13.753344, backward_time = 10.272768, perf = 34.18 tflops.
STEP-57: step_time = 24.622079 ms, foward_time = 14.167039, backward_time = 10.351616, perf = 33.49 tflops.
STEP-58: step_time = 24.989696 ms, foward_time = 14.201856, backward_time = 10.686464, perf = 33.00 tflops.
STEP-59: step_time = 24.754175 ms, foward_time = 13.942783, backward_time = 10.708992, perf = 33.31 tflops.
STEP-60: step_time = 25.477312 ms, foward_time = 14.659776, backward_time = 10.715136, perf = 32.37 tflops.
STEP-61: step_time = 25.812737 ms, foward_time = 14.916352, backward_time = 10.779648, perf = 31.95 tflops.
STEP-62: step_time = 24.822783 ms, foward_time = 14.515200, backward_time = 10.207232, perf = 33.22 tflops.
STEP-63: step_time = 24.431616 ms, foward_time = 14.039040, backward_time = 10.289152, perf = 33.75 tflops.
STEP-64: step_time = 24.443903 ms, foward_time = 13.910015, backward_time = 10.432512, perf = 33.74 tflops.
STEP-65: step_time = 25.403393 ms, foward_time = 14.655489, backward_time = 10.645504, perf = 32.46 tflops.
STEP-66: step_time = 25.306112 ms, foward_time = 14.487552, backward_time = 10.714112, perf = 32.59 tflops.
STEP-67: step_time = 25.292801 ms, foward_time = 14.844929, backward_time = 10.343424, perf = 32.60 tflops.
STEP-68: step_time = 24.470529 ms, foward_time = 14.004224, backward_time = 10.362880, perf = 33.70 tflops.
STEP-69: step_time = 26.214400 ms, foward_time = 14.918656, backward_time = 11.171840, perf = 31.46 tflops.
STEP-70: step_time = 24.648703 ms, foward_time = 14.163968, backward_time = 10.384384, perf = 33.46 tflops.
STEP-71: step_time = 25.395199 ms, foward_time = 14.140416, backward_time = 11.151360, perf = 32.47 tflops.
STEP-72: step_time = 24.384512 ms, foward_time = 13.876224, backward_time = 10.407936, perf = 33.82 tflops.
STEP-73: step_time = 24.800257 ms, foward_time = 14.326784, backward_time = 10.372096, perf = 33.25 tflops.
STEP-74: step_time = 24.962368 ms, foward_time = 14.386495, backward_time = 10.472448, perf = 33.04 tflops.
STEP-75: step_time = 24.825857 ms, foward_time = 14.452736, backward_time = 10.270720, perf = 33.22 tflops.
STEP-76: step_time = 25.329664 ms, foward_time = 14.342144, backward_time = 10.874880, perf = 32.56 tflops.
STEP-77: step_time = 24.268800 ms, foward_time = 14.057471, backward_time = 10.108928, perf = 33.98 tflops.
STEP-78: step_time = 25.707135 ms, foward_time = 15.082113, backward_time = 10.524672, perf = 32.08 tflops.
STEP-79: step_time = 25.959425 ms, foward_time = 15.034369, backward_time = 10.823680, perf = 31.77 tflops.
STEP-80: step_time = 25.604096 ms, foward_time = 14.431231, backward_time = 11.070464, perf = 32.21 tflops.
STEP-81: step_time = 25.034177 ms, foward_time = 14.532031, backward_time = 10.400768, perf = 32.94 tflops.
STEP-82: step_time = 23.825407 ms, foward_time = 13.257729, backward_time = 10.465280, perf = 34.61 tflops.
STEP-83: step_time = 24.669185 ms, foward_time = 14.174209, backward_time = 10.393600, perf = 33.43 tflops.
STEP-84: step_time = 24.886273 ms, foward_time = 14.381056, backward_time = 10.403840, perf = 33.14 tflops.
STEP-85: step_time = 24.294399 ms, foward_time = 13.985792, backward_time = 10.207232, perf = 33.94 tflops.
STEP-86: step_time = 26.747905 ms, foward_time = 16.316417, backward_time = 10.328064, perf = 30.83 tflops.
STEP-87: step_time = 25.225216 ms, foward_time = 14.445568, backward_time = 10.679296, perf = 32.69 tflops.
STEP-88: step_time = 24.826879 ms, foward_time = 14.362625, backward_time = 10.361856, perf = 33.22 tflops.
STEP-89: step_time = 25.054208 ms, foward_time = 14.469120, backward_time = 10.481664, perf = 32.91 tflops.
STEP-90: step_time = 24.830977 ms, foward_time = 14.368767, backward_time = 10.360832, perf = 33.21 tflops.
STEP-91: step_time = 24.633343 ms, foward_time = 14.086144, backward_time = 10.444800, perf = 33.48 tflops.
STEP-92: step_time = 24.650751 ms, foward_time = 14.147583, backward_time = 10.401792, perf = 33.45 tflops.
STEP-93: step_time = 24.444928 ms, foward_time = 14.054400, backward_time = 10.289152, perf = 33.73 tflops.
STEP-94: step_time = 25.982975 ms, foward_time = 15.196160, backward_time = 10.680320, perf = 31.74 tflops.
STEP-95: step_time = 24.680448 ms, foward_time = 14.065663, backward_time = 10.515456, perf = 33.41 tflops.
STEP-96: step_time = 25.749505 ms, foward_time = 15.134720, backward_time = 10.503168, perf = 32.03 tflops.
STEP-97: step_time = 25.191233 ms, foward_time = 14.347073, backward_time = 10.739712, perf = 32.73 tflops.
STEP-98: step_time = 24.912415 ms, foward_time = 14.343713, backward_time = 10.465280, perf = 33.10 tflops.
STEP-99: step_time = 24.974048 ms, foward_time = 14.474977, backward_time = 10.397696, perf = 33.02 tflops.

 mix_moe 64 [Summary] Average synchronized step_time = 25.005062222480774 ms, forward = 14.42191994190216 , backward = 10.479820728302002 .
[Benchmark] world_size = 4, dtype = float16, model_dim = 1024, hidden_size = 4096, samples = 8192, num_local_experts = 8, topK = 2, a2a_ffn_overlap_degree = 1, device = `cuda:0`
STEP-0: step_time = 1634.490356 ms, foward_time = 1610.257446, backward_time = 23.929855, perf = 0.50 tflops.
STEP-1: step_time = 44.316673 ms, foward_time = 26.683392, backward_time = 17.505280, perf = 18.61 tflops.
STEP-2: step_time = 43.464703 ms, foward_time = 25.956352, backward_time = 17.390593, perf = 18.97 tflops.
STEP-3: step_time = 44.613632 ms, foward_time = 28.428288, backward_time = 16.067583, perf = 18.48 tflops.
STEP-4: step_time = 40.871937 ms, foward_time = 24.757248, backward_time = 16.000000, perf = 20.18 tflops.
STEP-5: step_time = 40.518658 ms, foward_time = 24.810495, backward_time = 15.592448, perf = 20.35 tflops.
STEP-6: step_time = 40.040447 ms, foward_time = 24.294399, backward_time = 15.629312, perf = 20.60 tflops.
STEP-7: step_time = 40.188927 ms, foward_time = 24.247295, backward_time = 15.830016, perf = 20.52 tflops.
STEP-8: step_time = 40.193024 ms, foward_time = 24.664064, backward_time = 15.416320, perf = 20.52 tflops.
STEP-9: step_time = 39.010303 ms, foward_time = 23.462912, backward_time = 15.434752, perf = 21.14 tflops.
STEP-10: step_time = 39.255039 ms, foward_time = 23.811071, backward_time = 15.331328, perf = 21.01 tflops.
STEP-11: step_time = 39.396351 ms, foward_time = 23.799809, backward_time = 15.484928, perf = 20.93 tflops.
STEP-12: step_time = 44.232704 ms, foward_time = 28.956673, backward_time = 15.163392, perf = 18.64 tflops.
STEP-13: step_time = 40.135681 ms, foward_time = 25.097216, backward_time = 14.914560, perf = 20.55 tflops.
STEP-14: step_time = 39.000065 ms, foward_time = 23.789568, backward_time = 15.098880, perf = 21.14 tflops.
STEP-15: step_time = 38.824959 ms, foward_time = 23.785473, backward_time = 14.924800, perf = 21.24 tflops.
STEP-16: step_time = 41.318401 ms, foward_time = 26.335232, backward_time = 14.870528, perf = 19.96 tflops.
STEP-17: step_time = 39.958527 ms, foward_time = 24.883200, backward_time = 14.961664, perf = 20.64 tflops.
STEP-18: step_time = 38.457344 ms, foward_time = 23.458817, backward_time = 14.886912, perf = 21.44 tflops.
STEP-19: step_time = 39.091202 ms, foward_time = 24.011776, backward_time = 14.965760, perf = 21.10 tflops.
STEP-20: step_time = 40.427521 ms, foward_time = 25.281536, backward_time = 15.032320, perf = 20.40 tflops.
STEP-21: step_time = 38.857727 ms, foward_time = 23.819263, backward_time = 14.924800, perf = 21.22 tflops.
STEP-22: step_time = 38.952961 ms, foward_time = 23.898111, backward_time = 14.943232, perf = 21.17 tflops.
STEP-23: step_time = 41.530369 ms, foward_time = 26.469376, backward_time = 14.949376, perf = 19.86 tflops.
STEP-24: step_time = 39.032833 ms, foward_time = 23.934977, backward_time = 14.984192, perf = 21.13 tflops.
STEP-25: step_time = 42.553345 ms, foward_time = 27.404287, backward_time = 15.035392, perf = 19.38 tflops.
STEP-26: step_time = 39.045120 ms, foward_time = 23.768064, backward_time = 15.165440, perf = 21.12 tflops.
STEP-27: step_time = 38.871040 ms, foward_time = 23.802879, backward_time = 14.941184, perf = 21.21 tflops.
STEP-28: step_time = 38.840321 ms, foward_time = 23.751680, backward_time = 14.976000, perf = 21.23 tflops.
STEP-29: step_time = 41.092094 ms, foward_time = 25.784321, backward_time = 15.194112, perf = 20.07 tflops.
STEP-30: step_time = 41.635841 ms, foward_time = 26.361856, backward_time = 15.162368, perf = 19.81 tflops.
STEP-31: step_time = 40.464382 ms, foward_time = 24.517632, backward_time = 15.834112, perf = 20.38 tflops.
STEP-32: step_time = 39.011330 ms, foward_time = 23.960575, backward_time = 14.942208, perf = 21.14 tflops.
STEP-33: step_time = 40.795135 ms, foward_time = 25.748480, backward_time = 14.932992, perf = 20.21 tflops.
STEP-34: step_time = 39.228416 ms, foward_time = 23.910400, backward_time = 15.204352, perf = 21.02 tflops.
STEP-35: step_time = 39.003136 ms, foward_time = 23.892992, backward_time = 15.000576, perf = 21.14 tflops.
STEP-36: step_time = 39.349247 ms, foward_time = 24.244225, backward_time = 14.994432, perf = 20.96 tflops.
STEP-37: step_time = 42.266624 ms, foward_time = 27.158527, backward_time = 14.999552, perf = 19.51 tflops.
STEP-38: step_time = 39.100414 ms, foward_time = 23.733248, backward_time = 15.258624, perf = 21.09 tflops.
STEP-39: step_time = 39.680000 ms, foward_time = 23.720961, backward_time = 15.848448, perf = 20.78 tflops.
STEP-40: step_time = 39.225346 ms, foward_time = 24.098816, backward_time = 15.014912, perf = 21.02 tflops.
STEP-41: step_time = 38.939648 ms, foward_time = 23.775232, backward_time = 15.052800, perf = 21.18 tflops.
STEP-42: step_time = 40.745983 ms, foward_time = 25.725952, backward_time = 14.912512, perf = 20.24 tflops.
STEP-43: step_time = 38.921215 ms, foward_time = 23.781376, backward_time = 15.032320, perf = 21.19 tflops.
STEP-44: step_time = 39.270401 ms, foward_time = 24.194048, backward_time = 14.966784, perf = 21.00 tflops.
STEP-45: step_time = 39.163902 ms, foward_time = 23.951361, backward_time = 15.100928, perf = 21.06 tflops.
STEP-46: step_time = 39.576576 ms, foward_time = 24.261633, backward_time = 15.207424, perf = 20.84 tflops.
STEP-47: step_time = 39.960575 ms, foward_time = 24.574976, backward_time = 15.275008, perf = 20.64 tflops.
STEP-48: step_time = 39.738369 ms, foward_time = 24.358912, backward_time = 15.270912, perf = 20.75 tflops.
STEP-49: step_time = 39.661568 ms, foward_time = 24.350719, backward_time = 15.200256, perf = 20.79 tflops.
STEP-50: step_time = 42.258430 ms, foward_time = 24.620031, backward_time = 17.527807, perf = 19.51 tflops.
STEP-51: step_time = 40.215553 ms, foward_time = 24.855553, backward_time = 15.249408, perf = 20.51 tflops.
STEP-52: step_time = 39.222271 ms, foward_time = 23.907328, backward_time = 15.205376, perf = 21.02 tflops.
STEP-53: step_time = 39.269375 ms, foward_time = 23.925760, backward_time = 15.235072, perf = 21.00 tflops.
STEP-54: step_time = 39.009281 ms, foward_time = 23.599104, backward_time = 15.300608, perf = 21.14 tflops.
STEP-55: step_time = 39.537663 ms, foward_time = 23.933952, backward_time = 15.490048, perf = 20.86 tflops.
STEP-56: step_time = 40.264706 ms, foward_time = 24.470528, backward_time = 15.685632, perf = 20.48 tflops.
STEP-57: step_time = 38.789120 ms, foward_time = 23.536640, backward_time = 15.141888, perf = 21.26 tflops.
STEP-58: step_time = 38.809601 ms, foward_time = 23.779327, backward_time = 14.922752, perf = 21.25 tflops.
STEP-59: step_time = 39.403519 ms, foward_time = 24.300545, backward_time = 14.994432, perf = 20.93 tflops.
STEP-60: step_time = 39.025665 ms, foward_time = 23.972864, backward_time = 14.945280, perf = 21.13 tflops.
STEP-61: step_time = 38.427647 ms, foward_time = 23.417856, backward_time = 14.899200, perf = 21.46 tflops.
STEP-62: step_time = 38.494209 ms, foward_time = 23.440384, backward_time = 14.948352, perf = 21.42 tflops.
STEP-63: step_time = 38.907906 ms, foward_time = 23.710720, backward_time = 15.090688, perf = 21.19 tflops.
STEP-64: step_time = 39.403519 ms, foward_time = 24.347649, backward_time = 14.950400, perf = 20.93 tflops.
STEP-65: step_time = 39.823360 ms, foward_time = 24.731647, backward_time = 14.984192, perf = 20.71 tflops.
STEP-66: step_time = 39.560192 ms, foward_time = 24.499201, backward_time = 14.954496, perf = 20.85 tflops.
STEP-67: step_time = 41.590782 ms, foward_time = 24.457216, backward_time = 17.027073, perf = 19.83 tflops.
STEP-68: step_time = 38.339584 ms, foward_time = 23.272448, backward_time = 14.957568, perf = 21.51 tflops.
STEP-69: step_time = 38.582272 ms, foward_time = 23.535616, backward_time = 14.937088, perf = 21.37 tflops.
STEP-70: step_time = 38.702080 ms, foward_time = 23.653376, backward_time = 14.944256, perf = 21.31 tflops.
STEP-71: step_time = 38.334465 ms, foward_time = 23.297024, backward_time = 14.931968, perf = 21.51 tflops.
STEP-72: step_time = 38.875137 ms, foward_time = 23.989248, backward_time = 14.779392, perf = 21.21 tflops.
STEP-73: step_time = 39.384064 ms, foward_time = 24.345600, backward_time = 14.927872, perf = 20.94 tflops.
STEP-74: step_time = 39.706623 ms, foward_time = 24.549376, backward_time = 15.047680, perf = 20.77 tflops.
STEP-75: step_time = 38.818817 ms, foward_time = 23.701504, backward_time = 15.005696, perf = 21.24 tflops.
STEP-76: step_time = 39.069695 ms, foward_time = 24.042496, backward_time = 14.917632, perf = 21.11 tflops.
STEP-77: step_time = 38.408192 ms, foward_time = 23.449600, backward_time = 14.849024, perf = 21.47 tflops.
STEP-78: step_time = 38.836224 ms, foward_time = 23.787519, backward_time = 14.941184, perf = 21.23 tflops.
STEP-79: step_time = 38.837250 ms, foward_time = 23.861248, backward_time = 14.866432, perf = 21.23 tflops.
STEP-80: step_time = 38.636543 ms, foward_time = 23.728128, backward_time = 14.804992, perf = 21.34 tflops.
STEP-81: step_time = 38.951935 ms, foward_time = 23.920641, backward_time = 14.924800, perf = 21.17 tflops.
STEP-82: step_time = 39.270401 ms, foward_time = 24.152063, backward_time = 15.010816, perf = 21.00 tflops.
STEP-83: step_time = 39.306240 ms, foward_time = 24.297472, backward_time = 14.900224, perf = 20.98 tflops.
STEP-84: step_time = 39.773186 ms, foward_time = 24.691711, backward_time = 14.973952, perf = 20.73 tflops.
STEP-85: step_time = 39.151615 ms, foward_time = 24.194048, backward_time = 14.846976, perf = 21.06 tflops.
STEP-86: step_time = 38.837250 ms, foward_time = 23.814144, backward_time = 14.913536, perf = 21.23 tflops.
STEP-87: step_time = 39.051266 ms, foward_time = 24.155136, backward_time = 14.785536, perf = 21.12 tflops.
STEP-88: step_time = 40.025089 ms, foward_time = 23.972864, backward_time = 15.945728, perf = 20.60 tflops.
STEP-89: step_time = 39.026688 ms, foward_time = 23.642113, backward_time = 15.277056, perf = 21.13 tflops.
STEP-90: step_time = 39.152641 ms, foward_time = 23.674879, backward_time = 15.368192, perf = 21.06 tflops.
STEP-91: step_time = 39.469055 ms, foward_time = 23.888897, backward_time = 15.473664, perf = 20.89 tflops.
STEP-92: step_time = 39.869438 ms, foward_time = 24.430592, backward_time = 15.333376, perf = 20.68 tflops.
STEP-93: step_time = 39.257088 ms, foward_time = 24.125441, backward_time = 15.024128, perf = 21.01 tflops.
STEP-94: step_time = 38.945793 ms, foward_time = 23.954432, backward_time = 14.883840, perf = 21.17 tflops.
STEP-95: step_time = 38.889473 ms, foward_time = 23.752705, backward_time = 15.017984, perf = 21.20 tflops.
STEP-96: step_time = 38.701057 ms, foward_time = 23.740416, backward_time = 14.853120, perf = 21.31 tflops.
STEP-97: step_time = 38.806526 ms, foward_time = 23.831553, backward_time = 14.869504, perf = 21.25 tflops.
STEP-98: step_time = 38.903809 ms, foward_time = 23.952385, backward_time = 14.843904, perf = 21.20 tflops.
STEP-99: step_time = 39.667713 ms, foward_time = 24.546305, backward_time = 15.013888, perf = 20.79 tflops.

 fast_moe 8 [Summary] Average synchronized step_time = 39.280059814453125 ms, forward = 24.042171796162922 , backward = 15.129292805989584 .
[Benchmark] world_size = 4, dtype = float16, model_dim = 1024, hidden_size = 4096, samples = 8192, num_local_experts = 16, topK = 2, a2a_ffn_overlap_degree = 1, device = `cuda:0`
STEP-0: step_time = 1504.301025 ms, foward_time = 1474.007080, backward_time = 29.170689, perf = 0.55 tflops.
STEP-1: step_time = 61.505535 ms, foward_time = 36.867073, backward_time = 24.478720, perf = 13.41 tflops.
STEP-2: step_time = 62.850048 ms, foward_time = 40.280064, backward_time = 22.422527, perf = 13.12 tflops.
STEP-3: step_time = 55.090176 ms, foward_time = 33.240063, backward_time = 21.702656, perf = 14.97 tflops.
STEP-4: step_time = 55.494656 ms, foward_time = 33.800194, backward_time = 21.551104, perf = 14.86 tflops.
STEP-5: step_time = 54.526978 ms, foward_time = 32.900097, backward_time = 21.480448, perf = 15.12 tflops.
STEP-6: step_time = 54.970367 ms, foward_time = 33.300480, backward_time = 21.526527, perf = 15.00 tflops.
STEP-7: step_time = 53.776382 ms, foward_time = 32.249855, backward_time = 21.382145, perf = 15.33 tflops.
STEP-8: step_time = 55.605247 ms, foward_time = 33.860607, backward_time = 21.598207, perf = 14.83 tflops.
STEP-9: step_time = 55.052288 ms, foward_time = 33.477631, backward_time = 21.431295, perf = 14.98 tflops.
STEP-10: step_time = 52.550655 ms, foward_time = 31.145985, backward_time = 21.259264, perf = 15.69 tflops.
STEP-11: step_time = 51.629055 ms, foward_time = 30.312449, backward_time = 21.177343, perf = 15.97 tflops.
STEP-12: step_time = 58.650623 ms, foward_time = 34.776066, backward_time = 23.731199, perf = 14.06 tflops.
STEP-13: step_time = 51.361794 ms, foward_time = 30.498816, backward_time = 20.697088, perf = 16.06 tflops.
STEP-14: step_time = 51.170303 ms, foward_time = 30.432257, backward_time = 20.590591, perf = 16.12 tflops.
STEP-15: step_time = 51.750912 ms, foward_time = 30.599169, backward_time = 21.004288, perf = 15.93 tflops.
STEP-16: step_time = 56.399872 ms, foward_time = 35.214336, backward_time = 21.044224, perf = 14.62 tflops.
STEP-17: step_time = 51.085312 ms, foward_time = 30.302208, backward_time = 20.639744, perf = 16.14 tflops.
STEP-18: step_time = 52.731903 ms, foward_time = 31.848448, backward_time = 20.684799, perf = 15.64 tflops.
STEP-19: step_time = 57.233410 ms, foward_time = 36.571136, backward_time = 20.543488, perf = 14.41 tflops.
STEP-20: step_time = 54.584320 ms, foward_time = 33.736706, backward_time = 20.728832, perf = 15.11 tflops.
STEP-21: step_time = 59.534336 ms, foward_time = 37.835777, backward_time = 21.168127, perf = 13.85 tflops.
STEP-22: step_time = 53.713921 ms, foward_time = 32.600063, backward_time = 20.936705, perf = 15.35 tflops.
STEP-23: step_time = 51.648514 ms, foward_time = 30.420992, backward_time = 21.054464, perf = 15.97 tflops.
STEP-24: step_time = 51.996674 ms, foward_time = 31.140863, backward_time = 20.681728, perf = 15.86 tflops.
STEP-25: step_time = 50.861057 ms, foward_time = 30.148607, backward_time = 20.568064, perf = 16.21 tflops.
STEP-26: step_time = 52.177921 ms, foward_time = 31.429632, backward_time = 20.613119, perf = 15.80 tflops.
STEP-27: step_time = 53.573631 ms, foward_time = 31.895552, backward_time = 21.543936, perf = 15.39 tflops.
STEP-28: step_time = 52.022270 ms, foward_time = 31.093760, backward_time = 20.784128, perf = 15.85 tflops.
STEP-29: step_time = 51.206142 ms, foward_time = 30.283775, backward_time = 20.779009, perf = 16.10 tflops.
STEP-30: step_time = 52.683777 ms, foward_time = 31.168512, backward_time = 21.382145, perf = 15.65 tflops.
STEP-31: step_time = 51.228672 ms, foward_time = 30.232576, backward_time = 20.838400, perf = 16.10 tflops.
STEP-32: step_time = 50.881535 ms, foward_time = 30.104576, backward_time = 20.643841, perf = 16.21 tflops.
STEP-33: step_time = 52.638721 ms, foward_time = 30.830591, backward_time = 21.679104, perf = 15.67 tflops.
STEP-34: step_time = 51.059711 ms, foward_time = 30.194689, backward_time = 20.732927, perf = 16.15 tflops.
STEP-35: step_time = 50.950146 ms, foward_time = 30.128128, backward_time = 20.674561, perf = 16.19 tflops.
STEP-36: step_time = 51.082241 ms, foward_time = 30.099457, backward_time = 20.837376, perf = 16.14 tflops.
STEP-37: step_time = 51.137535 ms, foward_time = 30.303232, backward_time = 20.647936, perf = 16.13 tflops.
STEP-38: step_time = 50.396160 ms, foward_time = 29.707264, backward_time = 20.538368, perf = 16.36 tflops.
STEP-39: step_time = 50.885632 ms, foward_time = 30.088192, backward_time = 20.648960, perf = 16.21 tflops.
STEP-40: step_time = 50.569218 ms, foward_time = 29.893633, backward_time = 20.531200, perf = 16.31 tflops.
STEP-41: step_time = 50.923519 ms, foward_time = 30.010368, backward_time = 20.749311, perf = 16.19 tflops.
STEP-42: step_time = 50.614273 ms, foward_time = 30.148607, backward_time = 20.295679, perf = 16.29 tflops.
STEP-43: step_time = 51.508224 ms, foward_time = 30.548992, backward_time = 20.765696, perf = 16.01 tflops.
STEP-44: step_time = 51.745792 ms, foward_time = 30.837761, backward_time = 20.717567, perf = 15.94 tflops.
STEP-45: step_time = 50.734081 ms, foward_time = 30.020609, backward_time = 20.544512, perf = 16.25 tflops.
STEP-46: step_time = 50.655231 ms, foward_time = 29.854719, backward_time = 20.626432, perf = 16.28 tflops.
STEP-47: step_time = 51.189758 ms, foward_time = 30.123009, backward_time = 20.913153, perf = 16.11 tflops.
STEP-48: step_time = 50.830338 ms, foward_time = 30.046207, backward_time = 20.581375, perf = 16.22 tflops.
STEP-49: step_time = 50.920448 ms, foward_time = 30.109695, backward_time = 20.612097, perf = 16.19 tflops.
STEP-50: step_time = 50.906113 ms, foward_time = 29.977600, backward_time = 20.746241, perf = 16.20 tflops.
STEP-51: step_time = 51.790848 ms, foward_time = 31.046656, backward_time = 20.586496, perf = 15.92 tflops.
STEP-52: step_time = 50.484222 ms, foward_time = 29.591553, backward_time = 20.752384, perf = 16.33 tflops.
STEP-53: step_time = 50.571262 ms, foward_time = 29.921280, backward_time = 20.515841, perf = 16.31 tflops.
STEP-54: step_time = 50.834431 ms, foward_time = 30.394367, backward_time = 20.300800, perf = 16.22 tflops.
STEP-55: step_time = 50.529282 ms, foward_time = 29.640703, backward_time = 20.754433, perf = 16.32 tflops.
STEP-56: step_time = 54.801407 ms, foward_time = 32.486401, backward_time = 22.184959, perf = 15.05 tflops.
STEP-57: step_time = 52.879360 ms, foward_time = 32.035839, backward_time = 20.712448, perf = 15.59 tflops.
STEP-58: step_time = 53.009407 ms, foward_time = 32.174080, backward_time = 20.699137, perf = 15.56 tflops.
STEP-59: step_time = 52.967422 ms, foward_time = 32.123905, backward_time = 20.706305, perf = 15.57 tflops.
STEP-60: step_time = 53.206017 ms, foward_time = 31.796225, backward_time = 21.283840, perf = 15.50 tflops.
STEP-61: step_time = 52.795391 ms, foward_time = 32.026623, backward_time = 20.645887, perf = 15.62 tflops.
STEP-62: step_time = 52.707329 ms, foward_time = 31.926271, backward_time = 20.649984, perf = 15.65 tflops.
STEP-63: step_time = 52.594688 ms, foward_time = 31.675392, backward_time = 20.789248, perf = 15.68 tflops.
STEP-64: step_time = 52.546558 ms, foward_time = 31.742975, backward_time = 20.675585, perf = 15.69 tflops.
STEP-65: step_time = 54.389759 ms, foward_time = 32.100353, backward_time = 22.159361, perf = 15.16 tflops.
STEP-66: step_time = 52.606976 ms, foward_time = 31.805441, backward_time = 20.671488, perf = 15.68 tflops.
STEP-67: step_time = 52.591618 ms, foward_time = 31.856640, backward_time = 20.605951, perf = 15.68 tflops.
STEP-68: step_time = 52.669441 ms, foward_time = 31.874048, backward_time = 20.665344, perf = 15.66 tflops.
STEP-69: step_time = 52.502529 ms, foward_time = 31.841280, backward_time = 20.534271, perf = 15.71 tflops.
STEP-70: step_time = 52.334591 ms, foward_time = 31.591425, backward_time = 20.613119, perf = 15.76 tflops.
STEP-71: step_time = 52.809727 ms, foward_time = 32.066559, backward_time = 20.612097, perf = 15.62 tflops.
STEP-72: step_time = 52.660225 ms, foward_time = 31.792128, backward_time = 20.734976, perf = 15.66 tflops.
STEP-73: step_time = 52.674561 ms, foward_time = 31.985664, backward_time = 20.556801, perf = 15.66 tflops.
STEP-74: step_time = 52.798466 ms, foward_time = 31.947777, backward_time = 20.720640, perf = 15.62 tflops.
STEP-75: step_time = 52.556801 ms, foward_time = 31.803392, backward_time = 20.624384, perf = 15.69 tflops.
STEP-76: step_time = 52.662273 ms, foward_time = 31.968256, backward_time = 20.558847, perf = 15.66 tflops.
STEP-77: step_time = 52.804607 ms, foward_time = 31.717377, backward_time = 20.959232, perf = 15.62 tflops.
STEP-78: step_time = 52.471809 ms, foward_time = 31.724545, backward_time = 20.617216, perf = 15.72 tflops.
STEP-79: step_time = 52.945919 ms, foward_time = 32.071678, backward_time = 20.742144, perf = 15.58 tflops.
STEP-80: step_time = 52.586494 ms, foward_time = 31.942656, backward_time = 20.507648, perf = 15.68 tflops.
STEP-81: step_time = 52.895744 ms, foward_time = 32.073727, backward_time = 20.674561, perf = 15.59 tflops.
STEP-82: step_time = 52.915199 ms, foward_time = 32.048126, backward_time = 20.710400, perf = 15.58 tflops.
STEP-83: step_time = 53.101566 ms, foward_time = 32.297985, backward_time = 20.668415, perf = 15.53 tflops.
STEP-84: step_time = 53.209087 ms, foward_time = 32.001022, backward_time = 21.070848, perf = 15.50 tflops.
STEP-85: step_time = 50.978817 ms, foward_time = 30.454784, backward_time = 20.386816, perf = 16.18 tflops.
STEP-86: step_time = 50.642944 ms, foward_time = 30.180351, backward_time = 20.331520, perf = 16.28 tflops.
STEP-87: step_time = 51.056641 ms, foward_time = 30.459904, backward_time = 20.465664, perf = 16.15 tflops.
STEP-88: step_time = 50.618366 ms, foward_time = 30.203903, backward_time = 20.283392, perf = 16.29 tflops.
STEP-89: step_time = 51.243008 ms, foward_time = 30.767103, backward_time = 20.339712, perf = 16.09 tflops.
STEP-90: step_time = 51.431423 ms, foward_time = 31.170561, backward_time = 20.101120, perf = 16.03 tflops.
STEP-91: step_time = 50.987007 ms, foward_time = 30.597120, backward_time = 20.256767, perf = 16.17 tflops.
STEP-92: step_time = 54.274048 ms, foward_time = 32.941055, backward_time = 21.199871, perf = 15.19 tflops.
STEP-93: step_time = 52.406273 ms, foward_time = 32.064510, backward_time = 20.205568, perf = 15.74 tflops.
STEP-94: step_time = 52.739071 ms, foward_time = 32.106495, backward_time = 20.481024, perf = 15.64 tflops.
STEP-95: step_time = 51.908607 ms, foward_time = 31.112192, backward_time = 20.659201, perf = 15.89 tflops.
STEP-96: step_time = 51.856384 ms, foward_time = 30.927872, backward_time = 20.799488, perf = 15.90 tflops.
STEP-97: step_time = 51.394562 ms, foward_time = 30.781441, backward_time = 20.471807, perf = 16.05 tflops.
STEP-98: step_time = 50.800640 ms, foward_time = 30.193665, backward_time = 20.472832, perf = 16.23 tflops.
STEP-99: step_time = 51.658752 ms, foward_time = 30.712831, backward_time = 20.794369, perf = 15.96 tflops.

 fast_moe 16 [Summary] Average synchronized step_time = 52.041642634073895 ms, forward = 31.22228895823161 , backward = 20.6766250928243 .
[Benchmark] world_size = 4, dtype = float16, model_dim = 1024, hidden_size = 4096, samples = 8192, num_local_experts = 32, topK = 2, a2a_ffn_overlap_degree = 1, device = `cuda:0`
STEP-0: step_time = 1410.402344 ms, foward_time = 1371.697144, backward_time = 37.982208, perf = 0.58 tflops.
STEP-1: step_time = 75.197441 ms, foward_time = 46.918655, backward_time = 28.109823, perf = 10.97 tflops.
STEP-2: step_time = 67.864578 ms, foward_time = 44.196865, backward_time = 23.493631, perf = 12.15 tflops.
STEP-3: step_time = 64.029694 ms, foward_time = 41.204735, backward_time = 22.663168, perf = 12.88 tflops.
STEP-4: step_time = 61.921280 ms, foward_time = 39.185410, backward_time = 22.553600, perf = 13.32 tflops.
STEP-5: step_time = 61.283329 ms, foward_time = 38.802433, backward_time = 22.318081, perf = 13.46 tflops.
STEP-6: step_time = 62.758911 ms, foward_time = 41.447426, backward_time = 21.153791, perf = 13.14 tflops.
STEP-7: step_time = 61.229057 ms, foward_time = 39.901184, backward_time = 21.170176, perf = 13.47 tflops.
STEP-8: step_time = 60.356609 ms, foward_time = 38.906879, backward_time = 21.287935, perf = 13.66 tflops.
STEP-9: step_time = 58.629120 ms, foward_time = 36.578304, backward_time = 21.884928, perf = 14.07 tflops.
STEP-10: step_time = 59.417599 ms, foward_time = 37.964802, backward_time = 21.293056, perf = 13.88 tflops.
STEP-11: step_time = 57.597954 ms, foward_time = 36.334591, backward_time = 21.102592, perf = 14.32 tflops.
STEP-12: step_time = 57.088001 ms, foward_time = 35.783680, backward_time = 21.143553, perf = 14.44 tflops.
STEP-13: step_time = 56.900608 ms, foward_time = 35.830784, backward_time = 20.903936, perf = 14.49 tflops.
STEP-14: step_time = 58.150913 ms, foward_time = 35.956738, backward_time = 22.040577, perf = 14.18 tflops.
STEP-15: step_time = 56.956928 ms, foward_time = 35.730431, backward_time = 21.046272, perf = 14.48 tflops.
STEP-16: step_time = 57.470978 ms, foward_time = 35.712002, backward_time = 21.600256, perf = 14.35 tflops.
STEP-17: step_time = 57.512959 ms, foward_time = 35.566593, backward_time = 21.790720, perf = 14.34 tflops.
STEP-18: step_time = 58.685440 ms, foward_time = 35.755009, backward_time = 22.773760, perf = 14.05 tflops.
STEP-19: step_time = 58.764290 ms, foward_time = 35.568642, backward_time = 23.018496, perf = 14.03 tflops.
STEP-20: step_time = 57.562111 ms, foward_time = 35.605503, backward_time = 21.782528, perf = 14.33 tflops.
STEP-21: step_time = 58.166271 ms, foward_time = 35.851265, backward_time = 22.148096, perf = 14.18 tflops.
STEP-22: step_time = 58.009602 ms, foward_time = 35.856384, backward_time = 21.999617, perf = 14.22 tflops.
STEP-23: step_time = 57.880577 ms, foward_time = 36.907009, backward_time = 20.817921, perf = 14.25 tflops.
STEP-24: step_time = 59.143169 ms, foward_time = 36.088833, backward_time = 22.899712, perf = 13.94 tflops.
STEP-25: step_time = 59.879425 ms, foward_time = 38.195202, backward_time = 21.434368, perf = 13.77 tflops.
STEP-26: step_time = 62.612480 ms, foward_time = 39.383041, backward_time = 23.066624, perf = 13.17 tflops.
STEP-27: step_time = 63.963135 ms, foward_time = 40.580097, backward_time = 23.172096, perf = 12.89 tflops.
STEP-28: step_time = 63.394817 ms, foward_time = 40.266750, backward_time = 22.864897, perf = 13.01 tflops.
STEP-29: step_time = 61.021183 ms, foward_time = 39.198719, backward_time = 21.587969, perf = 13.51 tflops.
STEP-30: step_time = 63.097855 ms, foward_time = 41.661442, backward_time = 21.203968, perf = 13.07 tflops.
STEP-31: step_time = 59.165695 ms, foward_time = 36.476929, backward_time = 22.445057, perf = 13.94 tflops.
STEP-32: step_time = 62.467072 ms, foward_time = 41.113602, backward_time = 21.147648, perf = 13.20 tflops.
STEP-33: step_time = 65.582077 ms, foward_time = 43.231232, backward_time = 22.138880, perf = 12.57 tflops.
STEP-34: step_time = 62.755840 ms, foward_time = 39.011330, backward_time = 23.526400, perf = 13.14 tflops.
STEP-35: step_time = 59.981823 ms, foward_time = 35.758080, backward_time = 24.020992, perf = 13.75 tflops.
STEP-36: step_time = 62.963711 ms, foward_time = 39.961601, backward_time = 22.789120, perf = 13.10 tflops.
STEP-37: step_time = 59.787266 ms, foward_time = 36.373505, backward_time = 23.196672, perf = 13.79 tflops.
STEP-38: step_time = 58.446850 ms, foward_time = 36.580353, backward_time = 21.651457, perf = 14.11 tflops.
STEP-39: step_time = 60.751873 ms, foward_time = 37.669888, backward_time = 22.866943, perf = 13.57 tflops.
STEP-40: step_time = 59.702271 ms, foward_time = 37.230591, backward_time = 22.275072, perf = 13.81 tflops.
STEP-41: step_time = 59.829247 ms, foward_time = 37.213184, backward_time = 22.378496, perf = 13.78 tflops.
STEP-42: step_time = 58.878975 ms, foward_time = 36.113407, backward_time = 22.554625, perf = 14.01 tflops.
STEP-43: step_time = 56.761345 ms, foward_time = 35.349503, backward_time = 21.214209, perf = 14.53 tflops.
STEP-44: step_time = 59.191296 ms, foward_time = 36.823040, backward_time = 22.169600, perf = 13.93 tflops.
STEP-45: step_time = 58.539009 ms, foward_time = 35.764225, backward_time = 22.577152, perf = 14.09 tflops.
STEP-46: step_time = 59.022335 ms, foward_time = 35.741695, backward_time = 23.081984, perf = 13.97 tflops.
STEP-47: step_time = 58.265598 ms, foward_time = 36.249599, backward_time = 21.813248, perf = 14.15 tflops.
STEP-48: step_time = 58.731522 ms, foward_time = 36.473858, backward_time = 22.056959, perf = 14.04 tflops.
STEP-49: step_time = 58.152962 ms, foward_time = 36.000767, backward_time = 21.937153, perf = 14.18 tflops.
STEP-50: step_time = 59.458561 ms, foward_time = 36.070400, backward_time = 23.163904, perf = 13.87 tflops.
STEP-51: step_time = 59.382786 ms, foward_time = 35.875839, backward_time = 23.309313, perf = 13.89 tflops.
STEP-52: step_time = 56.557568 ms, foward_time = 35.520512, backward_time = 20.844543, perf = 14.58 tflops.
STEP-53: step_time = 57.652225 ms, foward_time = 36.499454, backward_time = 20.955135, perf = 14.30 tflops.
STEP-54: step_time = 56.933376 ms, foward_time = 35.637249, backward_time = 21.096449, perf = 14.48 tflops.
STEP-55: step_time = 56.919041 ms, foward_time = 35.704830, backward_time = 21.015553, perf = 14.49 tflops.
STEP-56: step_time = 61.921280 ms, foward_time = 40.846336, backward_time = 20.840448, perf = 13.32 tflops.
STEP-57: step_time = 60.299263 ms, foward_time = 38.960129, backward_time = 21.125120, perf = 13.68 tflops.
STEP-58: step_time = 59.222015 ms, foward_time = 37.902336, backward_time = 21.128193, perf = 13.92 tflops.
STEP-59: step_time = 56.934399 ms, foward_time = 35.405823, backward_time = 21.339136, perf = 14.48 tflops.
STEP-60: step_time = 59.144192 ms, foward_time = 37.840897, backward_time = 21.107712, perf = 13.94 tflops.
STEP-61: step_time = 56.270847 ms, foward_time = 35.345409, backward_time = 20.740095, perf = 14.65 tflops.
STEP-62: step_time = 56.538113 ms, foward_time = 35.431423, backward_time = 20.916224, perf = 14.59 tflops.
STEP-63: step_time = 56.555519 ms, foward_time = 35.574783, backward_time = 20.782080, perf = 14.58 tflops.
STEP-64: step_time = 56.496128 ms, foward_time = 35.457024, backward_time = 20.827135, perf = 14.60 tflops.
STEP-65: step_time = 57.055233 ms, foward_time = 35.652607, backward_time = 21.183489, perf = 14.45 tflops.
STEP-66: step_time = 59.215874 ms, foward_time = 37.909504, backward_time = 21.091328, perf = 13.93 tflops.
STEP-67: step_time = 56.507393 ms, foward_time = 35.439617, backward_time = 20.849665, perf = 14.59 tflops.
STEP-68: step_time = 56.676353 ms, foward_time = 35.501057, backward_time = 20.975616, perf = 14.55 tflops.
STEP-69: step_time = 56.552448 ms, foward_time = 35.505154, backward_time = 20.835327, perf = 14.58 tflops.
STEP-70: step_time = 56.300545 ms, foward_time = 35.326977, backward_time = 20.767744, perf = 14.65 tflops.
STEP-71: step_time = 56.281090 ms, foward_time = 35.395584, backward_time = 20.692991, perf = 14.65 tflops.
STEP-72: step_time = 57.259007 ms, foward_time = 36.031487, backward_time = 21.035007, perf = 14.40 tflops.
STEP-73: step_time = 57.924606 ms, foward_time = 36.743168, backward_time = 20.978687, perf = 14.24 tflops.
STEP-74: step_time = 58.741760 ms, foward_time = 37.091328, backward_time = 21.462015, perf = 14.04 tflops.
STEP-75: step_time = 56.402943 ms, foward_time = 35.389439, backward_time = 20.826113, perf = 14.62 tflops.
STEP-76: step_time = 56.654846 ms, foward_time = 35.549183, backward_time = 20.903936, perf = 14.56 tflops.
STEP-77: step_time = 56.627201 ms, foward_time = 35.540993, backward_time = 20.865025, perf = 14.56 tflops.
STEP-78: step_time = 56.700928 ms, foward_time = 35.622913, backward_time = 20.879360, perf = 14.54 tflops.
STEP-79: step_time = 56.738815 ms, foward_time = 35.271679, backward_time = 21.271551, perf = 14.53 tflops.
STEP-80: step_time = 58.209278 ms, foward_time = 37.105663, backward_time = 20.907007, perf = 14.17 tflops.
STEP-81: step_time = 57.669632 ms, foward_time = 36.317184, backward_time = 21.050367, perf = 14.30 tflops.
STEP-82: step_time = 57.421825 ms, foward_time = 36.046848, backward_time = 21.179392, perf = 14.36 tflops.
STEP-83: step_time = 57.713665 ms, foward_time = 35.247105, backward_time = 22.270975, perf = 14.29 tflops.
STEP-84: step_time = 57.235455 ms, foward_time = 35.807232, backward_time = 21.224447, perf = 14.41 tflops.
STEP-85: step_time = 56.734718 ms, foward_time = 35.598335, backward_time = 20.943872, perf = 14.53 tflops.
STEP-86: step_time = 56.410110 ms, foward_time = 35.251202, backward_time = 20.962303, perf = 14.62 tflops.
STEP-87: step_time = 56.292351 ms, foward_time = 35.338242, backward_time = 20.761600, perf = 14.65 tflops.
STEP-88: step_time = 60.318722 ms, foward_time = 38.960129, backward_time = 21.156864, perf = 13.67 tflops.
STEP-89: step_time = 57.634815 ms, foward_time = 36.653057, backward_time = 20.790272, perf = 14.31 tflops.
STEP-90: step_time = 56.566784 ms, foward_time = 35.359745, backward_time = 21.011456, perf = 14.58 tflops.
STEP-91: step_time = 56.706047 ms, foward_time = 35.651585, backward_time = 20.845568, perf = 14.54 tflops.
STEP-92: step_time = 56.564735 ms, foward_time = 35.300350, backward_time = 21.060608, perf = 14.58 tflops.
STEP-93: step_time = 56.477695 ms, foward_time = 35.298306, backward_time = 20.987904, perf = 14.60 tflops.
STEP-94: step_time = 56.931328 ms, foward_time = 35.812351, backward_time = 20.923391, perf = 14.48 tflops.
STEP-95: step_time = 57.646080 ms, foward_time = 36.510719, backward_time = 20.942848, perf = 14.31 tflops.
STEP-96: step_time = 56.308735 ms, foward_time = 35.281921, backward_time = 20.828159, perf = 14.64 tflops.
STEP-97: step_time = 56.126465 ms, foward_time = 35.020802, backward_time = 20.918272, perf = 14.69 tflops.
STEP-98: step_time = 56.720383 ms, foward_time = 35.488770, backward_time = 21.033983, perf = 14.54 tflops.
STEP-99: step_time = 59.041794 ms, foward_time = 37.700607, backward_time = 21.158913, perf = 13.97 tflops.

 fast_moe 32 [Summary] Average synchronized step_time = 57.62882550557455 ms, forward = 36.14588591257731 , backward = 21.28042656580607 .
[Benchmark] world_size = 4, dtype = float16, model_dim = 1024, hidden_size = 4096, samples = 8192, num_local_experts = 64, topK = 2, a2a_ffn_overlap_degree = 1, device = `cuda:0`
STEP-0: step_time = 1350.779907 ms, foward_time = 1304.939575, backward_time = 45.083649, perf = 0.61 tflops.
STEP-1: step_time = 104.537086 ms, foward_time = 70.389763, backward_time = 33.866753, perf = 7.89 tflops.
STEP-2: step_time = 104.195068 ms, foward_time = 69.124100, backward_time = 34.793472, perf = 7.91 tflops.
STEP-3: step_time = 88.440834 ms, foward_time = 57.711617, backward_time = 30.466047, perf = 9.32 tflops.
STEP-4: step_time = 88.072189 ms, foward_time = 57.144321, backward_time = 30.663679, perf = 9.36 tflops.
STEP-5: step_time = 86.417412 ms, foward_time = 54.834175, backward_time = 31.312897, perf = 9.54 tflops.
STEP-6: step_time = 88.467453 ms, foward_time = 58.050560, backward_time = 30.111744, perf = 9.32 tflops.
STEP-7: step_time = 84.091904 ms, foward_time = 53.756927, backward_time = 30.067713, perf = 9.81 tflops.
STEP-8: step_time = 89.995262 ms, foward_time = 59.681793, backward_time = 30.039040, perf = 9.16 tflops.
STEP-9: step_time = 84.629501 ms, foward_time = 54.452225, backward_time = 29.910015, perf = 9.74 tflops.
STEP-10: step_time = 89.024513 ms, foward_time = 58.972160, backward_time = 29.782017, perf = 9.26 tflops.
STEP-11: step_time = 82.536446 ms, foward_time = 53.327873, backward_time = 28.923904, perf = 9.99 tflops.
STEP-12: step_time = 86.838272 ms, foward_time = 57.071617, backward_time = 29.461504, perf = 9.50 tflops.
STEP-13: step_time = 88.107010 ms, foward_time = 56.055809, backward_time = 30.840832, perf = 9.36 tflops.
STEP-14: step_time = 91.669502 ms, foward_time = 62.569473, backward_time = 28.695553, perf = 9.00 tflops.
STEP-15: step_time = 88.835075 ms, foward_time = 59.449345, backward_time = 29.001728, perf = 9.28 tflops.
STEP-16: step_time = 84.550659 ms, foward_time = 54.323200, backward_time = 29.912064, perf = 9.75 tflops.
STEP-17: step_time = 83.145729 ms, foward_time = 53.570560, backward_time = 29.223936, perf = 9.92 tflops.
STEP-18: step_time = 83.445763 ms, foward_time = 53.529598, backward_time = 29.581312, perf = 9.88 tflops.
STEP-19: step_time = 82.256897 ms, foward_time = 53.640190, backward_time = 28.282881, perf = 10.03 tflops.
STEP-20: step_time = 82.292732 ms, foward_time = 53.451775, backward_time = 28.504065, perf = 10.02 tflops.
STEP-21: step_time = 82.299904 ms, foward_time = 53.696510, backward_time = 28.271616, perf = 10.02 tflops.
STEP-22: step_time = 82.110466 ms, foward_time = 53.600258, backward_time = 28.170240, perf = 10.04 tflops.
STEP-23: step_time = 83.663872 ms, foward_time = 55.249920, backward_time = 28.099585, perf = 9.86 tflops.
STEP-24: step_time = 83.167229 ms, foward_time = 54.782974, backward_time = 28.066816, perf = 9.92 tflops.
STEP-25: step_time = 83.899391 ms, foward_time = 53.635071, backward_time = 29.959167, perf = 9.83 tflops.
STEP-26: step_time = 82.151421 ms, foward_time = 53.402622, backward_time = 28.437504, perf = 10.04 tflops.
STEP-27: step_time = 83.251198 ms, foward_time = 53.551105, backward_time = 29.359104, perf = 9.91 tflops.
STEP-28: step_time = 82.144257 ms, foward_time = 53.520386, backward_time = 28.310528, perf = 10.04 tflops.
STEP-29: step_time = 83.250175 ms, foward_time = 54.285313, backward_time = 28.630016, perf = 9.91 tflops.
STEP-30: step_time = 83.395584 ms, foward_time = 54.788097, backward_time = 28.290049, perf = 9.89 tflops.
STEP-31: step_time = 82.362366 ms, foward_time = 53.691391, backward_time = 28.334080, perf = 10.01 tflops.
STEP-32: step_time = 82.364418 ms, foward_time = 53.821442, backward_time = 28.188671, perf = 10.01 tflops.
STEP-33: step_time = 82.983932 ms, foward_time = 54.454273, backward_time = 28.189695, perf = 9.94 tflops.
STEP-34: step_time = 83.889153 ms, foward_time = 55.068672, backward_time = 28.526592, perf = 9.83 tflops.
STEP-35: step_time = 83.537918 ms, foward_time = 54.973438, backward_time = 28.253183, perf = 9.87 tflops.
STEP-36: step_time = 84.008957 ms, foward_time = 55.275520, backward_time = 28.409857, perf = 9.82 tflops.
STEP-37: step_time = 85.616638 ms, foward_time = 55.863297, backward_time = 29.429760, perf = 9.63 tflops.
STEP-38: step_time = 83.306496 ms, foward_time = 54.827007, backward_time = 28.162048, perf = 9.90 tflops.
STEP-39: step_time = 85.296127 ms, foward_time = 55.795712, backward_time = 29.193216, perf = 9.67 tflops.
STEP-40: step_time = 84.605949 ms, foward_time = 56.297470, backward_time = 27.993088, perf = 9.75 tflops.
STEP-41: step_time = 81.930237 ms, foward_time = 53.495808, backward_time = 28.118015, perf = 10.07 tflops.
STEP-42: step_time = 86.456322 ms, foward_time = 57.740288, backward_time = 28.395519, perf = 9.54 tflops.
STEP-43: step_time = 83.089409 ms, foward_time = 54.240257, backward_time = 28.491776, perf = 9.92 tflops.
STEP-44: step_time = 85.056511 ms, foward_time = 56.134655, backward_time = 28.585983, perf = 9.70 tflops.
STEP-45: step_time = 82.228226 ms, foward_time = 53.436417, backward_time = 28.475391, perf = 10.03 tflops.
STEP-46: step_time = 82.139137 ms, foward_time = 53.767166, backward_time = 28.035072, perf = 10.04 tflops.
STEP-47: step_time = 83.192833 ms, foward_time = 53.976063, backward_time = 28.896255, perf = 9.91 tflops.
STEP-48: step_time = 82.459648 ms, foward_time = 53.955585, backward_time = 28.176384, perf = 10.00 tflops.
STEP-49: step_time = 83.100670 ms, foward_time = 54.649857, backward_time = 28.140545, perf = 9.92 tflops.
STEP-50: step_time = 81.982468 ms, foward_time = 53.501953, backward_time = 28.171265, perf = 10.06 tflops.
STEP-51: step_time = 83.789825 ms, foward_time = 53.459969, backward_time = 30.017536, perf = 9.84 tflops.
STEP-52: step_time = 82.172928 ms, foward_time = 53.941250, backward_time = 27.924480, perf = 10.04 tflops.
STEP-53: step_time = 82.295807 ms, foward_time = 53.572609, backward_time = 28.380159, perf = 10.02 tflops.
STEP-54: step_time = 85.196800 ms, foward_time = 54.803455, backward_time = 30.040064, perf = 9.68 tflops.
STEP-55: step_time = 83.682304 ms, foward_time = 53.735424, backward_time = 29.604864, perf = 9.85 tflops.
STEP-56: step_time = 84.074493 ms, foward_time = 54.464512, backward_time = 29.271040, perf = 9.81 tflops.
STEP-57: step_time = 83.472382 ms, foward_time = 54.929409, backward_time = 28.206079, perf = 9.88 tflops.
STEP-58: step_time = 83.093506 ms, foward_time = 54.435841, backward_time = 28.320768, perf = 9.92 tflops.
STEP-59: step_time = 82.969597 ms, foward_time = 54.515713, backward_time = 28.139521, perf = 9.94 tflops.
STEP-60: step_time = 82.182144 ms, foward_time = 53.759998, backward_time = 28.100609, perf = 10.03 tflops.
STEP-61: step_time = 83.032066 ms, foward_time = 53.497856, backward_time = 29.230080, perf = 9.93 tflops.
STEP-62: step_time = 82.179070 ms, foward_time = 53.391361, backward_time = 28.457985, perf = 10.03 tflops.
STEP-63: step_time = 82.758659 ms, foward_time = 53.404671, backward_time = 29.007872, perf = 9.96 tflops.
STEP-64: step_time = 82.259972 ms, foward_time = 53.897217, backward_time = 28.023808, perf = 10.02 tflops.
STEP-65: step_time = 82.118652 ms, foward_time = 53.518337, backward_time = 28.259329, perf = 10.04 tflops.
STEP-66: step_time = 84.274178 ms, foward_time = 54.756351, backward_time = 29.177856, perf = 9.79 tflops.
STEP-67: step_time = 82.049026 ms, foward_time = 53.509121, backward_time = 28.206079, perf = 10.05 tflops.
STEP-68: step_time = 82.148354 ms, foward_time = 53.484543, backward_time = 28.346369, perf = 10.04 tflops.
STEP-69: step_time = 82.489342 ms, foward_time = 53.957630, backward_time = 28.213247, perf = 10.00 tflops.
STEP-70: step_time = 83.691521 ms, foward_time = 55.397377, backward_time = 28.047359, perf = 9.85 tflops.
STEP-71: step_time = 82.619392 ms, foward_time = 54.360065, backward_time = 27.943935, perf = 9.98 tflops.
STEP-72: step_time = 83.705856 ms, foward_time = 54.865921, backward_time = 28.495872, perf = 9.85 tflops.
STEP-73: step_time = 83.086334 ms, foward_time = 53.730305, backward_time = 29.035521, perf = 9.93 tflops.
STEP-74: step_time = 81.649666 ms, foward_time = 53.566463, backward_time = 27.747328, perf = 10.10 tflops.
STEP-75: step_time = 82.942978 ms, foward_time = 54.047745, backward_time = 28.569599, perf = 9.94 tflops.
STEP-76: step_time = 81.888252 ms, foward_time = 53.435390, backward_time = 28.113920, perf = 10.07 tflops.
STEP-77: step_time = 83.942398 ms, foward_time = 55.300095, backward_time = 28.280832, perf = 9.82 tflops.
STEP-78: step_time = 82.557953 ms, foward_time = 54.356991, backward_time = 27.870209, perf = 9.99 tflops.
STEP-79: step_time = 83.053566 ms, foward_time = 54.148094, backward_time = 28.552193, perf = 9.93 tflops.
STEP-80: step_time = 83.689468 ms, foward_time = 54.599682, backward_time = 28.755968, perf = 9.85 tflops.
STEP-81: step_time = 84.623360 ms, foward_time = 55.955456, backward_time = 28.318720, perf = 9.74 tflops.
STEP-82: step_time = 82.466820 ms, foward_time = 53.890049, backward_time = 28.232704, perf = 10.00 tflops.
STEP-83: step_time = 82.473984 ms, foward_time = 53.883904, backward_time = 28.247040, perf = 10.00 tflops.
STEP-84: step_time = 83.751938 ms, foward_time = 54.171646, backward_time = 29.207552, perf = 9.85 tflops.
STEP-85: step_time = 83.574783 ms, foward_time = 54.202370, backward_time = 29.030399, perf = 9.87 tflops.
STEP-86: step_time = 83.069954 ms, foward_time = 53.636097, backward_time = 29.095936, perf = 9.93 tflops.
STEP-87: step_time = 83.165184 ms, foward_time = 53.564415, backward_time = 29.255680, perf = 9.92 tflops.
STEP-88: step_time = 82.200577 ms, foward_time = 53.687298, backward_time = 28.204033, perf = 10.03 tflops.
STEP-89: step_time = 83.866623 ms, foward_time = 53.759998, backward_time = 29.776896, perf = 9.83 tflops.
STEP-90: step_time = 82.000893 ms, foward_time = 53.784576, backward_time = 27.865088, perf = 10.06 tflops.
STEP-91: step_time = 84.662270 ms, foward_time = 54.838272, backward_time = 29.479937, perf = 9.74 tflops.
STEP-92: step_time = 81.944572 ms, foward_time = 53.576702, backward_time = 28.025856, perf = 10.06 tflops.
STEP-93: step_time = 82.038780 ms, foward_time = 53.492737, backward_time = 28.226561, perf = 10.05 tflops.
STEP-94: step_time = 81.711105 ms, foward_time = 53.602303, backward_time = 27.778048, perf = 10.09 tflops.
STEP-95: step_time = 84.925438 ms, foward_time = 56.818687, backward_time = 27.757568, perf = 9.71 tflops.
STEP-96: step_time = 83.463165 ms, foward_time = 54.760448, backward_time = 28.364799, perf = 9.88 tflops.
STEP-97: step_time = 82.450432 ms, foward_time = 54.282242, backward_time = 27.851776, perf = 10.00 tflops.
STEP-98: step_time = 81.284096 ms, foward_time = 52.977665, backward_time = 27.995136, perf = 10.15 tflops.
STEP-99: step_time = 81.753090 ms, foward_time = 52.989952, backward_time = 28.393473, perf = 10.09 tflops.

 fast_moe 64 [Summary] Average synchronized step_time = 83.01224937438965 ms, forward = 54.198562177022296 , backward = 28.48211628595988 .
[Benchmark] world_size = 4, dtype = float16, model_dim = 1024, hidden_size = 4096, samples = 8192, num_local_experts = 8, topK = 2, a2a_ffn_overlap_degree = 1, device = `cuda:0`
STEP-0: step_time = 1523.280884 ms, foward_time = 1516.080078, backward_time = 6.812672, perf = 0.54 tflops.
STEP-1: step_time = 29.516800 ms, foward_time = 27.378689, backward_time = 2.038784, perf = 27.94 tflops.
STEP-2: step_time = 28.728319 ms, foward_time = 26.563583, backward_time = 2.052096, perf = 28.70 tflops.
STEP-3: step_time = 30.284800 ms, foward_time = 26.377216, backward_time = 3.823616, perf = 27.23 tflops.
STEP-4: step_time = 27.659264 ms, foward_time = 25.513985, backward_time = 2.064384, perf = 29.81 tflops.
STEP-5: step_time = 27.244543 ms, foward_time = 25.053185, backward_time = 2.123776, perf = 30.27 tflops.
STEP-6: step_time = 27.134975 ms, foward_time = 25.286655, backward_time = 1.783808, perf = 30.39 tflops.
STEP-7: step_time = 26.847233 ms, foward_time = 24.890368, backward_time = 1.890304, perf = 30.72 tflops.
STEP-8: step_time = 29.111296 ms, foward_time = 27.265024, backward_time = 1.779712, perf = 28.33 tflops.
STEP-9: step_time = 26.999807 ms, foward_time = 25.244673, backward_time = 1.689600, perf = 30.54 tflops.
STEP-10: step_time = 28.353537 ms, foward_time = 26.603519, backward_time = 1.676288, perf = 29.08 tflops.
STEP-11: step_time = 24.024063 ms, foward_time = 22.415359, backward_time = 1.546240, perf = 34.33 tflops.
STEP-12: step_time = 26.351616 ms, foward_time = 24.783873, backward_time = 1.505280, perf = 31.29 tflops.
STEP-13: step_time = 23.885824 ms, foward_time = 22.402048, backward_time = 1.419264, perf = 34.52 tflops.
STEP-14: step_time = 25.756672 ms, foward_time = 22.294527, backward_time = 3.399680, perf = 32.02 tflops.
STEP-15: step_time = 27.796480 ms, foward_time = 25.448448, backward_time = 2.266112, perf = 29.67 tflops.
STEP-16: step_time = 24.901632 ms, foward_time = 23.081984, backward_time = 1.756160, perf = 33.12 tflops.
STEP-17: step_time = 23.958529 ms, foward_time = 22.354944, backward_time = 1.543168, perf = 34.42 tflops.
STEP-18: step_time = 24.054785 ms, foward_time = 22.382591, backward_time = 1.607680, perf = 34.28 tflops.
STEP-19: step_time = 24.800257 ms, foward_time = 23.140352, backward_time = 1.596416, perf = 33.25 tflops.
STEP-20: step_time = 23.998465 ms, foward_time = 22.383615, backward_time = 1.552384, perf = 34.36 tflops.
STEP-21: step_time = 26.723328 ms, foward_time = 24.090624, backward_time = 2.571264, perf = 30.86 tflops.
STEP-22: step_time = 24.628223 ms, foward_time = 22.964224, backward_time = 1.590272, perf = 33.48 tflops.
STEP-23: step_time = 26.023935 ms, foward_time = 22.284288, backward_time = 3.675136, perf = 31.69 tflops.
STEP-24: step_time = 24.216576 ms, foward_time = 22.620159, backward_time = 1.531904, perf = 34.05 tflops.
STEP-25: step_time = 24.301567 ms, foward_time = 22.702080, backward_time = 1.537024, perf = 33.93 tflops.
STEP-26: step_time = 28.816383 ms, foward_time = 26.515455, backward_time = 2.239488, perf = 28.62 tflops.
STEP-27: step_time = 26.143744 ms, foward_time = 24.317951, backward_time = 1.767424, perf = 31.54 tflops.
STEP-28: step_time = 25.940992 ms, foward_time = 24.220673, backward_time = 1.658880, perf = 31.79 tflops.
STEP-29: step_time = 25.428991 ms, foward_time = 23.851007, backward_time = 1.506304, perf = 32.43 tflops.
STEP-30: step_time = 24.136703 ms, foward_time = 22.626305, backward_time = 1.451008, perf = 34.17 tflops.
STEP-31: step_time = 26.394625 ms, foward_time = 24.426497, backward_time = 1.907712, perf = 31.24 tflops.
STEP-32: step_time = 24.638464 ms, foward_time = 23.005184, backward_time = 1.574912, perf = 33.47 tflops.
STEP-33: step_time = 24.700928 ms, foward_time = 22.998016, backward_time = 1.638400, perf = 33.38 tflops.
STEP-34: step_time = 24.186880 ms, foward_time = 22.703104, backward_time = 1.422336, perf = 34.09 tflops.
STEP-35: step_time = 24.054785 ms, foward_time = 22.523905, backward_time = 1.472512, perf = 34.28 tflops.
STEP-36: step_time = 24.397823 ms, foward_time = 22.792192, backward_time = 1.545216, perf = 33.80 tflops.
STEP-37: step_time = 27.149311 ms, foward_time = 23.272448, backward_time = 3.816448, perf = 30.37 tflops.
STEP-38: step_time = 25.923584 ms, foward_time = 24.351744, backward_time = 1.507328, perf = 31.81 tflops.
STEP-39: step_time = 24.120319 ms, foward_time = 22.581247, backward_time = 1.477632, perf = 34.19 tflops.
STEP-40: step_time = 23.942144 ms, foward_time = 22.354944, backward_time = 1.524736, perf = 34.44 tflops.
STEP-41: step_time = 24.406015 ms, foward_time = 22.679552, backward_time = 1.668096, perf = 33.79 tflops.
STEP-42: step_time = 28.460032 ms, foward_time = 26.057728, backward_time = 2.085888, perf = 28.98 tflops.
STEP-43: step_time = 25.026560 ms, foward_time = 23.315456, backward_time = 1.637376, perf = 32.95 tflops.
STEP-44: step_time = 24.264704 ms, foward_time = 22.589439, backward_time = 1.603584, perf = 33.98 tflops.
STEP-45: step_time = 24.162304 ms, foward_time = 22.532097, backward_time = 1.560576, perf = 34.13 tflops.
STEP-46: step_time = 24.425472 ms, foward_time = 22.474752, backward_time = 1.879040, perf = 33.76 tflops.
STEP-47: step_time = 25.074688 ms, foward_time = 23.310335, backward_time = 1.709056, perf = 32.89 tflops.
STEP-48: step_time = 24.563711 ms, foward_time = 22.780928, backward_time = 1.694720, perf = 33.57 tflops.
STEP-49: step_time = 24.417280 ms, foward_time = 22.582272, backward_time = 1.761280, perf = 33.77 tflops.
STEP-50: step_time = 24.385536 ms, foward_time = 22.501375, backward_time = 1.825792, perf = 33.82 tflops.
STEP-51: step_time = 24.593409 ms, foward_time = 22.551552, backward_time = 1.985536, perf = 33.53 tflops.
STEP-52: step_time = 24.132608 ms, foward_time = 22.396929, backward_time = 1.681408, perf = 34.17 tflops.
STEP-53: step_time = 24.261633 ms, foward_time = 22.500353, backward_time = 1.707008, perf = 33.99 tflops.
STEP-54: step_time = 24.287231 ms, foward_time = 22.488064, backward_time = 1.743872, perf = 33.95 tflops.
STEP-55: step_time = 24.297472 ms, foward_time = 22.421503, backward_time = 1.820672, perf = 33.94 tflops.
STEP-56: step_time = 26.060801 ms, foward_time = 22.489088, backward_time = 3.509248, perf = 31.64 tflops.
STEP-57: step_time = 24.872959 ms, foward_time = 23.042048, backward_time = 1.775616, perf = 33.15 tflops.
STEP-58: step_time = 24.182783 ms, foward_time = 22.323200, backward_time = 1.804288, perf = 34.10 tflops.
STEP-59: step_time = 24.239103 ms, foward_time = 22.490112, backward_time = 1.692672, perf = 34.02 tflops.
STEP-60: step_time = 24.238079 ms, foward_time = 22.402048, backward_time = 1.778688, perf = 34.02 tflops.
STEP-61: step_time = 24.630272 ms, foward_time = 22.600704, backward_time = 1.975296, perf = 33.48 tflops.
STEP-62: step_time = 24.476671 ms, foward_time = 22.523905, backward_time = 1.896448, perf = 33.69 tflops.
STEP-63: step_time = 24.393728 ms, foward_time = 22.402048, backward_time = 1.938432, perf = 33.81 tflops.
STEP-64: step_time = 24.231936 ms, foward_time = 22.431744, backward_time = 1.742848, perf = 34.03 tflops.
STEP-65: step_time = 24.467457 ms, foward_time = 22.525951, backward_time = 1.887232, perf = 33.70 tflops.
STEP-66: step_time = 25.358335 ms, foward_time = 22.334463, backward_time = 2.967552, perf = 32.52 tflops.
STEP-67: step_time = 24.799232 ms, foward_time = 23.000065, backward_time = 1.744896, perf = 33.25 tflops.
STEP-68: step_time = 24.325121 ms, foward_time = 22.472704, backward_time = 1.796096, perf = 33.90 tflops.
STEP-69: step_time = 24.455168 ms, foward_time = 22.507521, backward_time = 1.892352, perf = 33.72 tflops.
STEP-70: step_time = 24.194048 ms, foward_time = 22.326271, backward_time = 1.811456, perf = 34.08 tflops.
STEP-71: step_time = 24.098816 ms, foward_time = 22.352896, backward_time = 1.688576, perf = 34.22 tflops.
STEP-72: step_time = 24.316929 ms, foward_time = 22.443008, backward_time = 1.817600, perf = 33.91 tflops.
STEP-73: step_time = 24.378368 ms, foward_time = 22.500353, backward_time = 1.821696, perf = 33.83 tflops.
STEP-74: step_time = 24.223743 ms, foward_time = 22.387712, backward_time = 1.781760, perf = 34.04 tflops.
STEP-75: step_time = 24.348673 ms, foward_time = 22.444033, backward_time = 1.850368, perf = 33.87 tflops.
STEP-76: step_time = 24.273920 ms, foward_time = 22.428673, backward_time = 1.788928, perf = 33.97 tflops.
STEP-77: step_time = 24.258560 ms, foward_time = 22.489088, backward_time = 1.713152, perf = 33.99 tflops.
STEP-78: step_time = 24.161280 ms, foward_time = 22.352896, backward_time = 1.754112, perf = 34.13 tflops.
STEP-79: step_time = 24.450048 ms, foward_time = 22.514688, backward_time = 1.881088, perf = 33.73 tflops.
STEP-80: step_time = 24.430592 ms, foward_time = 22.513664, backward_time = 1.858560, perf = 33.75 tflops.
STEP-81: step_time = 24.423424 ms, foward_time = 22.525951, backward_time = 1.844224, perf = 33.76 tflops.
STEP-82: step_time = 24.313856 ms, foward_time = 22.470655, backward_time = 1.789952, perf = 33.92 tflops.
STEP-83: step_time = 24.307713 ms, foward_time = 22.397951, backward_time = 1.855488, perf = 33.92 tflops.
STEP-84: step_time = 24.369152 ms, foward_time = 22.504448, backward_time = 1.809408, perf = 33.84 tflops.
STEP-85: step_time = 24.228865 ms, foward_time = 22.476801, backward_time = 1.697792, perf = 34.04 tflops.
STEP-86: step_time = 24.263680 ms, foward_time = 22.400000, backward_time = 1.807360, perf = 33.99 tflops.
STEP-87: step_time = 24.276993 ms, foward_time = 22.378496, backward_time = 1.843200, perf = 33.97 tflops.
STEP-88: step_time = 24.199167 ms, foward_time = 22.373377, backward_time = 1.767424, perf = 34.08 tflops.
STEP-89: step_time = 24.321024 ms, foward_time = 22.487040, backward_time = 1.778688, perf = 33.91 tflops.
STEP-90: step_time = 24.240128 ms, foward_time = 22.401024, backward_time = 1.785856, perf = 34.02 tflops.
STEP-91: step_time = 24.337408 ms, foward_time = 22.462463, backward_time = 1.821696, perf = 33.88 tflops.
STEP-92: step_time = 24.270847 ms, foward_time = 22.564863, backward_time = 1.648640, perf = 33.98 tflops.
STEP-93: step_time = 24.572927 ms, foward_time = 22.825983, backward_time = 1.692672, perf = 33.56 tflops.
STEP-94: step_time = 24.315905 ms, foward_time = 22.404097, backward_time = 1.857536, perf = 33.91 tflops.
STEP-95: step_time = 24.468479 ms, foward_time = 22.475777, backward_time = 1.938432, perf = 33.70 tflops.
STEP-96: step_time = 24.249344 ms, foward_time = 22.345728, backward_time = 1.848320, perf = 34.01 tflops.
STEP-97: step_time = 24.230911 ms, foward_time = 22.368256, backward_time = 1.808384, perf = 34.03 tflops.
STEP-98: step_time = 24.249344 ms, foward_time = 22.350847, backward_time = 1.842176, perf = 34.01 tflops.
STEP-99: step_time = 24.357887 ms, foward_time = 22.436865, backward_time = 1.866752, perf = 33.85 tflops.

 faster_moe 8 [Summary] Average synchronized step_time = 24.476074600219725 ms, forward = 22.574779733022055 , backward = 1.839359998703003 .
[Benchmark] world_size = 4, dtype = float16, model_dim = 1024, hidden_size = 4096, samples = 8192, num_local_experts = 16, topK = 2, a2a_ffn_overlap_degree = 1, device = `cuda:0`
STEP-0: step_time = 1588.628540 ms, foward_time = 1581.671387, backward_time = 5.877760, perf = 0.52 tflops.
STEP-1: step_time = 35.197952 ms, foward_time = 33.363968, backward_time = 1.737728, perf = 23.43 tflops.
STEP-2: step_time = 35.183617 ms, foward_time = 33.414143, backward_time = 1.671168, perf = 23.44 tflops.
STEP-3: step_time = 36.305920 ms, foward_time = 34.359295, backward_time = 1.852416, perf = 22.71 tflops.
STEP-4: step_time = 34.221058 ms, foward_time = 32.273407, backward_time = 1.862656, perf = 24.10 tflops.
STEP-5: step_time = 33.041409 ms, foward_time = 31.187967, backward_time = 1.767424, perf = 24.96 tflops.
STEP-6: step_time = 30.286848 ms, foward_time = 28.439552, backward_time = 1.778688, perf = 27.23 tflops.
STEP-7: step_time = 31.338495 ms, foward_time = 29.486080, backward_time = 1.761280, perf = 26.31 tflops.
STEP-8: step_time = 29.782017 ms, foward_time = 27.942911, backward_time = 1.773568, perf = 27.69 tflops.
STEP-9: step_time = 27.638784 ms, foward_time = 25.835520, backward_time = 1.738752, perf = 29.84 tflops.
STEP-10: step_time = 26.611712 ms, foward_time = 25.033728, backward_time = 1.510400, perf = 30.99 tflops.
STEP-11: step_time = 28.344320 ms, foward_time = 26.435583, backward_time = 1.820672, perf = 29.09 tflops.
STEP-12: step_time = 28.613632 ms, foward_time = 26.749952, backward_time = 1.802240, perf = 28.82 tflops.
STEP-13: step_time = 26.629120 ms, foward_time = 24.949760, backward_time = 1.618944, perf = 30.97 tflops.
STEP-14: step_time = 26.616833 ms, foward_time = 24.926208, backward_time = 1.624064, perf = 30.98 tflops.
STEP-15: step_time = 27.439104 ms, foward_time = 25.794559, backward_time = 1.546240, perf = 30.05 tflops.
STEP-16: step_time = 30.509056 ms, foward_time = 28.753920, backward_time = 1.693696, perf = 27.03 tflops.
STEP-17: step_time = 27.741184 ms, foward_time = 26.145792, backward_time = 1.534976, perf = 29.73 tflops.
STEP-18: step_time = 26.344448 ms, foward_time = 24.786943, backward_time = 1.494016, perf = 31.30 tflops.
STEP-19: step_time = 26.230783 ms, foward_time = 24.648705, backward_time = 1.522688, perf = 31.44 tflops.
STEP-20: step_time = 28.767233 ms, foward_time = 26.992640, backward_time = 1.711104, perf = 28.67 tflops.
STEP-21: step_time = 26.211329 ms, foward_time = 24.697857, backward_time = 1.455104, perf = 31.46 tflops.
STEP-22: step_time = 26.704897 ms, foward_time = 24.902657, backward_time = 1.742848, perf = 30.88 tflops.
STEP-23: step_time = 26.255360 ms, foward_time = 24.634369, backward_time = 1.559552, perf = 31.41 tflops.
STEP-24: step_time = 26.152960 ms, foward_time = 24.534016, backward_time = 1.560576, perf = 31.53 tflops.
STEP-25: step_time = 26.939392 ms, foward_time = 24.948736, backward_time = 1.929216, perf = 30.61 tflops.
STEP-26: step_time = 26.334208 ms, foward_time = 24.691711, backward_time = 1.579008, perf = 31.31 tflops.
STEP-27: step_time = 27.518976 ms, foward_time = 25.649153, backward_time = 1.809408, perf = 29.97 tflops.
STEP-28: step_time = 26.346497 ms, foward_time = 24.721409, backward_time = 1.551360, perf = 31.30 tflops.
STEP-29: step_time = 28.863487 ms, foward_time = 26.089472, backward_time = 2.715648, perf = 28.57 tflops.
STEP-30: step_time = 26.776575 ms, foward_time = 25.235456, backward_time = 1.479680, perf = 30.80 tflops.
STEP-31: step_time = 26.603519 ms, foward_time = 24.914944, backward_time = 1.627136, perf = 31.00 tflops.
STEP-32: step_time = 29.254656 ms, foward_time = 27.531263, backward_time = 1.661952, perf = 28.19 tflops.
STEP-33: step_time = 33.200127 ms, foward_time = 31.127552, backward_time = 2.012160, perf = 24.84 tflops.
STEP-34: step_time = 26.786816 ms, foward_time = 25.299969, backward_time = 1.426432, perf = 30.79 tflops.
STEP-35: step_time = 28.939264 ms, foward_time = 27.018240, backward_time = 1.754112, perf = 28.50 tflops.
STEP-36: step_time = 27.273216 ms, foward_time = 25.588736, backward_time = 1.623040, perf = 30.24 tflops.
STEP-37: step_time = 26.476543 ms, foward_time = 24.833023, backward_time = 1.582080, perf = 31.15 tflops.
STEP-38: step_time = 28.276735 ms, foward_time = 26.250240, backward_time = 1.967104, perf = 29.16 tflops.
STEP-39: step_time = 26.733568 ms, foward_time = 25.182207, backward_time = 1.477632, perf = 30.85 tflops.
STEP-40: step_time = 26.389503 ms, foward_time = 24.835072, backward_time = 1.495040, perf = 31.25 tflops.
STEP-41: step_time = 26.145792 ms, foward_time = 24.505344, backward_time = 1.579008, perf = 31.54 tflops.
STEP-42: step_time = 26.070017 ms, foward_time = 24.467457, backward_time = 1.532928, perf = 31.63 tflops.
STEP-43: step_time = 26.096640 ms, foward_time = 24.600576, backward_time = 1.437696, perf = 31.60 tflops.
STEP-44: step_time = 26.219521 ms, foward_time = 24.628223, backward_time = 1.533952, perf = 31.45 tflops.
STEP-45: step_time = 26.225664 ms, foward_time = 24.630272, backward_time = 1.533952, perf = 31.44 tflops.
STEP-46: step_time = 26.242048 ms, foward_time = 24.631296, backward_time = 1.553408, perf = 31.42 tflops.
STEP-47: step_time = 26.036224 ms, foward_time = 24.457216, backward_time = 1.521664, perf = 31.67 tflops.
STEP-48: step_time = 26.304512 ms, foward_time = 24.812544, backward_time = 1.432576, perf = 31.35 tflops.
STEP-49: step_time = 26.286079 ms, foward_time = 24.738815, backward_time = 1.488896, perf = 31.37 tflops.
STEP-50: step_time = 26.121216 ms, foward_time = 24.564735, backward_time = 1.496064, perf = 31.57 tflops.
STEP-51: step_time = 26.092545 ms, foward_time = 24.547329, backward_time = 1.485824, perf = 31.60 tflops.
STEP-52: step_time = 25.957376 ms, foward_time = 24.442881, backward_time = 1.437696, perf = 31.77 tflops.
STEP-53: step_time = 26.294271 ms, foward_time = 24.655872, backward_time = 1.581056, perf = 31.36 tflops.
STEP-54: step_time = 26.222591 ms, foward_time = 24.589312, backward_time = 1.573888, perf = 31.45 tflops.
STEP-55: step_time = 25.983999 ms, foward_time = 24.369152, backward_time = 1.556480, perf = 31.74 tflops.
STEP-56: step_time = 26.082304 ms, foward_time = 24.531967, backward_time = 1.492992, perf = 31.62 tflops.
STEP-57: step_time = 26.008575 ms, foward_time = 24.512512, backward_time = 1.436672, perf = 31.71 tflops.
STEP-58: step_time = 26.257408 ms, foward_time = 24.697857, backward_time = 1.499136, perf = 31.41 tflops.
STEP-59: step_time = 26.034176 ms, foward_time = 24.427521, backward_time = 1.528832, perf = 31.68 tflops.
STEP-60: step_time = 25.930752 ms, foward_time = 24.683519, backward_time = 1.184768, perf = 31.80 tflops.
STEP-61: step_time = 26.137600 ms, foward_time = 24.691711, backward_time = 1.386496, perf = 31.55 tflops.
STEP-62: step_time = 26.118143 ms, foward_time = 24.659967, backward_time = 1.397760, perf = 31.57 tflops.
STEP-63: step_time = 26.138624 ms, foward_time = 24.521729, backward_time = 1.554432, perf = 31.55 tflops.
STEP-64: step_time = 26.391552 ms, foward_time = 24.769535, backward_time = 1.559552, perf = 31.25 tflops.
STEP-65: step_time = 26.298368 ms, foward_time = 24.670208, backward_time = 1.568768, perf = 31.36 tflops.
STEP-66: step_time = 26.048512 ms, foward_time = 24.443905, backward_time = 1.540096, perf = 31.66 tflops.
STEP-67: step_time = 25.948160 ms, foward_time = 24.370176, backward_time = 1.517568, perf = 31.78 tflops.
STEP-68: step_time = 25.987072 ms, foward_time = 24.357887, backward_time = 1.568768, perf = 31.73 tflops.
STEP-69: step_time = 26.143744 ms, foward_time = 24.591360, backward_time = 1.494016, perf = 31.54 tflops.
STEP-70: step_time = 26.196993 ms, foward_time = 24.597504, backward_time = 1.537024, perf = 31.48 tflops.
STEP-71: step_time = 26.308607 ms, foward_time = 24.697857, backward_time = 1.551360, perf = 31.34 tflops.
STEP-72: step_time = 26.286079 ms, foward_time = 24.701952, backward_time = 1.524736, perf = 31.37 tflops.
STEP-73: step_time = 26.058752 ms, foward_time = 24.441856, backward_time = 1.529856, perf = 31.65 tflops.
STEP-74: step_time = 28.822529 ms, foward_time = 27.261951, backward_time = 1.497088, perf = 28.61 tflops.
STEP-75: step_time = 27.680767 ms, foward_time = 26.109953, backward_time = 1.513472, perf = 29.79 tflops.
STEP-76: step_time = 27.327488 ms, foward_time = 25.751553, backward_time = 1.517568, perf = 30.18 tflops.
STEP-77: step_time = 27.385857 ms, foward_time = 25.751553, backward_time = 1.576960, perf = 30.11 tflops.
STEP-78: step_time = 26.577921 ms, foward_time = 24.949760, backward_time = 1.568768, perf = 31.03 tflops.
STEP-79: step_time = 26.468351 ms, foward_time = 24.954880, backward_time = 1.443840, perf = 31.16 tflops.
STEP-80: step_time = 26.216448 ms, foward_time = 24.727552, backward_time = 1.431552, perf = 31.45 tflops.
STEP-81: step_time = 26.309631 ms, foward_time = 24.719360, backward_time = 1.532928, perf = 31.34 tflops.
STEP-82: step_time = 26.209280 ms, foward_time = 24.654848, backward_time = 1.495040, perf = 31.46 tflops.
STEP-83: step_time = 26.247168 ms, foward_time = 24.579073, backward_time = 1.608704, perf = 31.42 tflops.
STEP-84: step_time = 26.080256 ms, foward_time = 24.507393, backward_time = 1.499136, perf = 31.62 tflops.
STEP-85: step_time = 25.968639 ms, foward_time = 24.535040, backward_time = 1.363968, perf = 31.75 tflops.
STEP-86: step_time = 26.142719 ms, foward_time = 24.699903, backward_time = 1.385472, perf = 31.54 tflops.
STEP-87: step_time = 26.224640 ms, foward_time = 24.623104, backward_time = 1.545216, perf = 31.44 tflops.
STEP-88: step_time = 26.202112 ms, foward_time = 24.611839, backward_time = 1.533952, perf = 31.47 tflops.
STEP-89: step_time = 26.347521 ms, foward_time = 24.716288, backward_time = 1.557504, perf = 31.30 tflops.
STEP-90: step_time = 26.116096 ms, foward_time = 24.650751, backward_time = 1.408000, perf = 31.58 tflops.
STEP-91: step_time = 26.587135 ms, foward_time = 25.050112, backward_time = 1.479680, perf = 31.02 tflops.
STEP-92: step_time = 26.168320 ms, foward_time = 24.496128, backward_time = 1.597440, perf = 31.51 tflops.
STEP-93: step_time = 26.281984 ms, foward_time = 24.660992, backward_time = 1.563648, perf = 31.38 tflops.
STEP-94: step_time = 26.067968 ms, foward_time = 24.657921, backward_time = 1.350656, perf = 31.63 tflops.
STEP-95: step_time = 26.088448 ms, foward_time = 24.584192, backward_time = 1.446912, perf = 31.61 tflops.
STEP-96: step_time = 26.220545 ms, foward_time = 24.639488, backward_time = 1.522688, perf = 31.45 tflops.
STEP-97: step_time = 26.404863 ms, foward_time = 24.889343, backward_time = 1.456128, perf = 31.23 tflops.
STEP-98: step_time = 26.536961 ms, foward_time = 24.956928, backward_time = 1.521664, perf = 31.07 tflops.
STEP-99: step_time = 25.985023 ms, foward_time = 24.551424, backward_time = 1.376256, perf = 31.73 tflops.

 faster_moe 16 [Summary] Average synchronized step_time = 26.29553486506144 ms, forward = 24.735607528686522 , backward = 1.4984533349672953 .
[Benchmark] world_size = 4, dtype = float16, model_dim = 1024, hidden_size = 4096, samples = 8192, num_local_experts = 32, topK = 2, a2a_ffn_overlap_degree = 1, device = `cuda:0`
STEP-0: step_time = 1468.763184 ms, foward_time = 1462.053833, backward_time = 5.851136, perf = 0.56 tflops.
STEP-1: step_time = 45.479935 ms, foward_time = 43.542526, backward_time = 1.838080, perf = 18.13 tflops.
STEP-2: step_time = 44.285954 ms, foward_time = 42.402817, backward_time = 1.796096, perf = 18.62 tflops.
STEP-3: step_time = 44.237823 ms, foward_time = 42.430466, backward_time = 1.721344, perf = 18.64 tflops.
STEP-4: step_time = 43.810818 ms, foward_time = 41.978882, backward_time = 1.745920, perf = 18.82 tflops.
STEP-5: step_time = 40.650753 ms, foward_time = 38.831104, backward_time = 1.737728, perf = 20.29 tflops.
STEP-6: step_time = 39.042049 ms, foward_time = 37.224449, backward_time = 1.752064, perf = 21.12 tflops.
STEP-7: step_time = 37.022720 ms, foward_time = 35.343361, backward_time = 1.613824, perf = 22.27 tflops.
STEP-8: step_time = 37.134335 ms, foward_time = 35.477505, backward_time = 1.591296, perf = 22.21 tflops.
STEP-9: step_time = 37.086208 ms, foward_time = 35.547134, backward_time = 1.474560, perf = 22.24 tflops.
STEP-10: step_time = 36.835327 ms, foward_time = 35.295231, backward_time = 1.475584, perf = 22.39 tflops.
STEP-11: step_time = 36.786175 ms, foward_time = 35.172352, backward_time = 1.541120, perf = 22.42 tflops.
STEP-12: step_time = 36.796417 ms, foward_time = 35.147778, backward_time = 1.586176, perf = 22.41 tflops.
STEP-13: step_time = 36.848640 ms, foward_time = 35.187714, backward_time = 1.594368, perf = 22.38 tflops.
STEP-14: step_time = 37.045246 ms, foward_time = 35.431423, backward_time = 1.550336, perf = 22.26 tflops.
STEP-15: step_time = 37.029888 ms, foward_time = 35.389439, backward_time = 1.573888, perf = 22.27 tflops.
STEP-16: step_time = 36.861954 ms, foward_time = 35.254272, backward_time = 1.542144, perf = 22.37 tflops.
STEP-17: step_time = 36.889599 ms, foward_time = 35.300350, backward_time = 1.526784, perf = 22.35 tflops.
STEP-18: step_time = 37.029888 ms, foward_time = 35.352577, backward_time = 1.608704, perf = 22.27 tflops.
STEP-19: step_time = 36.793343 ms, foward_time = 35.063808, backward_time = 1.668096, perf = 22.41 tflops.
STEP-20: step_time = 37.049343 ms, foward_time = 35.311615, backward_time = 1.676288, perf = 22.26 tflops.
STEP-21: step_time = 36.712448 ms, foward_time = 35.005440, backward_time = 1.643520, perf = 22.46 tflops.
STEP-22: step_time = 36.613121 ms, foward_time = 34.925568, backward_time = 1.592320, perf = 22.52 tflops.
STEP-23: step_time = 36.540417 ms, foward_time = 34.835457, backward_time = 1.641472, perf = 22.57 tflops.
STEP-24: step_time = 36.588543 ms, foward_time = 34.895870, backward_time = 1.631232, perf = 22.54 tflops.
STEP-25: step_time = 36.681728 ms, foward_time = 34.912254, backward_time = 1.708032, perf = 22.48 tflops.
STEP-26: step_time = 36.603905 ms, foward_time = 34.949120, backward_time = 1.595392, perf = 22.53 tflops.
STEP-27: step_time = 36.600834 ms, foward_time = 34.824192, backward_time = 1.699840, perf = 22.53 tflops.
STEP-28: step_time = 36.677631 ms, foward_time = 34.919422, backward_time = 1.696768, perf = 22.48 tflops.
STEP-29: step_time = 36.563969 ms, foward_time = 34.911232, backward_time = 1.587200, perf = 22.55 tflops.
STEP-30: step_time = 36.702209 ms, foward_time = 34.955265, backward_time = 1.684480, perf = 22.47 tflops.
STEP-31: step_time = 36.918270 ms, foward_time = 35.175423, backward_time = 1.683456, perf = 22.34 tflops.
STEP-32: step_time = 36.881409 ms, foward_time = 35.205120, backward_time = 1.613824, perf = 22.36 tflops.
STEP-33: step_time = 36.611073 ms, foward_time = 34.886658, backward_time = 1.665024, perf = 22.52 tflops.
STEP-34: step_time = 36.661247 ms, foward_time = 34.941952, backward_time = 1.653760, perf = 22.49 tflops.
STEP-35: step_time = 36.842495 ms, foward_time = 35.126270, backward_time = 1.653760, perf = 22.38 tflops.
STEP-36: step_time = 36.734978 ms, foward_time = 35.038208, backward_time = 1.636352, perf = 22.45 tflops.
STEP-37: step_time = 36.703232 ms, foward_time = 34.999294, backward_time = 1.641472, perf = 22.47 tflops.
STEP-38: step_time = 36.768768 ms, foward_time = 35.073025, backward_time = 1.634304, perf = 22.43 tflops.
STEP-39: step_time = 36.554752 ms, foward_time = 34.796543, backward_time = 1.697792, perf = 22.56 tflops.
STEP-40: step_time = 36.460545 ms, foward_time = 34.800640, backward_time = 1.593344, perf = 22.62 tflops.
STEP-41: step_time = 36.788223 ms, foward_time = 35.127296, backward_time = 1.597440, perf = 22.42 tflops.
STEP-42: step_time = 36.743168 ms, foward_time = 35.026943, backward_time = 1.657856, perf = 22.44 tflops.
STEP-43: step_time = 36.539391 ms, foward_time = 34.897919, backward_time = 1.581056, perf = 22.57 tflops.
STEP-44: step_time = 36.745216 ms, foward_time = 35.104767, backward_time = 1.580032, perf = 22.44 tflops.
STEP-45: step_time = 36.830208 ms, foward_time = 35.320831, backward_time = 1.447936, perf = 22.39 tflops.
STEP-46: step_time = 36.598785 ms, foward_time = 35.060738, backward_time = 1.477632, perf = 22.53 tflops.
STEP-47: step_time = 36.712448 ms, foward_time = 35.127296, backward_time = 1.525760, perf = 22.46 tflops.
STEP-48: step_time = 36.384769 ms, foward_time = 34.664448, backward_time = 1.661952, perf = 22.66 tflops.
STEP-49: step_time = 36.644863 ms, foward_time = 34.981888, backward_time = 1.601536, perf = 22.50 tflops.
STEP-50: step_time = 38.390785 ms, foward_time = 34.941952, backward_time = 3.387392, perf = 21.48 tflops.
STEP-51: step_time = 42.295296 ms, foward_time = 40.478722, backward_time = 1.755136, perf = 19.50 tflops.
STEP-52: step_time = 36.775936 ms, foward_time = 35.122177, backward_time = 1.595392, perf = 22.42 tflops.
STEP-53: step_time = 37.113857 ms, foward_time = 35.451904, backward_time = 1.600512, perf = 22.22 tflops.
STEP-54: step_time = 41.074688 ms, foward_time = 39.370750, backward_time = 1.633280, perf = 20.08 tflops.
STEP-55: step_time = 36.836353 ms, foward_time = 35.179520, backward_time = 1.596416, perf = 22.39 tflops.
STEP-56: step_time = 37.046272 ms, foward_time = 35.321857, backward_time = 1.666048, perf = 22.26 tflops.
STEP-57: step_time = 40.284161 ms, foward_time = 38.420479, backward_time = 1.797120, perf = 20.47 tflops.
STEP-58: step_time = 40.829952 ms, foward_time = 39.303169, backward_time = 1.447936, perf = 20.20 tflops.
STEP-59: step_time = 39.231487 ms, foward_time = 37.603329, backward_time = 1.551360, perf = 21.02 tflops.
STEP-60: step_time = 41.508865 ms, foward_time = 39.761921, backward_time = 1.672192, perf = 19.87 tflops.
STEP-61: step_time = 36.912128 ms, foward_time = 35.234818, backward_time = 1.617920, perf = 22.34 tflops.
STEP-62: step_time = 37.068802 ms, foward_time = 34.916351, backward_time = 2.092032, perf = 22.25 tflops.
STEP-63: step_time = 39.528446 ms, foward_time = 37.826561, backward_time = 1.640448, perf = 20.86 tflops.
STEP-64: step_time = 37.193729 ms, foward_time = 35.546112, backward_time = 1.588224, perf = 22.17 tflops.
STEP-65: step_time = 36.609024 ms, foward_time = 34.979839, backward_time = 1.566720, perf = 22.53 tflops.
STEP-66: step_time = 39.827457 ms, foward_time = 38.086655, backward_time = 1.682432, perf = 20.71 tflops.
STEP-67: step_time = 36.849663 ms, foward_time = 35.085312, backward_time = 1.705984, perf = 22.38 tflops.
STEP-68: step_time = 36.531200 ms, foward_time = 34.896896, backward_time = 1.572864, perf = 22.57 tflops.
STEP-69: step_time = 40.977409 ms, foward_time = 39.038975, backward_time = 1.787904, perf = 20.12 tflops.
STEP-70: step_time = 37.288960 ms, foward_time = 35.655682, backward_time = 1.570816, perf = 22.11 tflops.
STEP-71: step_time = 36.795391 ms, foward_time = 35.068928, backward_time = 1.666048, perf = 22.41 tflops.
STEP-72: step_time = 36.591618 ms, foward_time = 34.955265, backward_time = 1.574912, perf = 22.54 tflops.
STEP-73: step_time = 36.977665 ms, foward_time = 35.334145, backward_time = 1.581056, perf = 22.30 tflops.
STEP-74: step_time = 37.028866 ms, foward_time = 35.368961, backward_time = 1.600512, perf = 22.27 tflops.
STEP-75: step_time = 36.866047 ms, foward_time = 35.274754, backward_time = 1.528832, perf = 22.37 tflops.
STEP-76: step_time = 36.533249 ms, foward_time = 34.895870, backward_time = 1.580032, perf = 22.57 tflops.
STEP-77: step_time = 36.514816 ms, foward_time = 34.917377, backward_time = 1.536000, perf = 22.58 tflops.
STEP-78: step_time = 36.571136 ms, foward_time = 34.895870, backward_time = 1.616896, perf = 22.55 tflops.
STEP-79: step_time = 36.725761 ms, foward_time = 34.971649, backward_time = 1.692672, perf = 22.45 tflops.
STEP-80: step_time = 36.608002 ms, foward_time = 34.827263, backward_time = 1.720320, perf = 22.53 tflops.
STEP-81: step_time = 36.547585 ms, foward_time = 34.797569, backward_time = 1.690624, perf = 22.56 tflops.
STEP-82: step_time = 36.655106 ms, foward_time = 34.978817, backward_time = 1.616896, perf = 22.50 tflops.
STEP-83: step_time = 36.725761 ms, foward_time = 35.023872, backward_time = 1.640448, perf = 22.45 tflops.
STEP-84: step_time = 36.827137 ms, foward_time = 35.149822, backward_time = 1.617920, perf = 22.39 tflops.
STEP-85: step_time = 36.557823 ms, foward_time = 34.845695, backward_time = 1.652736, perf = 22.56 tflops.
STEP-86: step_time = 36.826111 ms, foward_time = 35.142654, backward_time = 1.620992, perf = 22.39 tflops.
STEP-87: step_time = 36.902912 ms, foward_time = 35.193855, backward_time = 1.650688, perf = 22.35 tflops.
STEP-88: step_time = 36.661247 ms, foward_time = 34.934784, backward_time = 1.667072, perf = 22.49 tflops.
STEP-89: step_time = 36.707329 ms, foward_time = 34.972672, backward_time = 1.676288, perf = 22.47 tflops.
STEP-90: step_time = 36.787201 ms, foward_time = 35.186687, backward_time = 1.541120, perf = 22.42 tflops.
STEP-91: step_time = 36.671490 ms, foward_time = 34.961407, backward_time = 1.650688, perf = 22.49 tflops.
STEP-92: step_time = 36.666367 ms, foward_time = 34.884609, backward_time = 1.722368, perf = 22.49 tflops.
STEP-93: step_time = 36.401154 ms, foward_time = 34.783234, backward_time = 1.559552, perf = 22.65 tflops.
STEP-94: step_time = 36.467712 ms, foward_time = 34.838528, backward_time = 1.571840, perf = 22.61 tflops.
STEP-95: step_time = 36.555775 ms, foward_time = 34.820095, backward_time = 1.678336, perf = 22.56 tflops.
STEP-96: step_time = 36.624386 ms, foward_time = 34.931713, backward_time = 1.631232, perf = 22.52 tflops.
STEP-97: step_time = 37.201920 ms, foward_time = 35.474434, backward_time = 1.668096, perf = 22.17 tflops.
STEP-98: step_time = 37.864449 ms, foward_time = 36.098049, backward_time = 1.700864, perf = 21.78 tflops.
STEP-99: step_time = 37.602303 ms, foward_time = 35.899391, backward_time = 1.640448, perf = 21.93 tflops.

 faster_moe 32 [Summary] Average synchronized step_time = 37.38480676015218 ms, forward = 35.66272862752279 , backward = 1.6591360112031301 .
[Benchmark] world_size = 4, dtype = float16, model_dim = 1024, hidden_size = 4096, samples = 8192, num_local_experts = 64, topK = 2, a2a_ffn_overlap_degree = 1, device = `cuda:0`
STEP-0: step_time = 1204.462646 ms, foward_time = 1196.517334, backward_time = 7.194624, perf = 0.68 tflops.
STEP-1: step_time = 47.409153 ms, foward_time = 44.777473, backward_time = 2.551808, perf = 17.39 tflops.
STEP-2: step_time = 42.375168 ms, foward_time = 40.018944, backward_time = 2.289664, perf = 19.46 tflops.
STEP-3: step_time = 52.274178 ms, foward_time = 49.239040, backward_time = 2.969600, perf = 15.78 tflops.
STEP-4: step_time = 49.010689 ms, foward_time = 45.913090, backward_time = 3.035136, perf = 16.83 tflops.
STEP-5: step_time = 45.326336 ms, foward_time = 43.448318, backward_time = 1.808384, perf = 18.19 tflops.
STEP-6: step_time = 44.169216 ms, foward_time = 42.195969, backward_time = 1.911808, perf = 18.67 tflops.
STEP-7: step_time = 44.843006 ms, foward_time = 42.726398, backward_time = 2.055168, perf = 18.39 tflops.
STEP-8: step_time = 47.263744 ms, foward_time = 45.321217, backward_time = 1.868800, perf = 17.45 tflops.
STEP-9: step_time = 40.520702 ms, foward_time = 38.815742, backward_time = 1.638400, perf = 20.35 tflops.
STEP-10: step_time = 43.203583 ms, foward_time = 41.097218, backward_time = 1.974272, perf = 19.09 tflops.
STEP-11: step_time = 40.810497 ms, foward_time = 39.166977, backward_time = 1.564672, perf = 20.21 tflops.
STEP-12: step_time = 40.439808 ms, foward_time = 38.754303, backward_time = 1.607680, perf = 20.39 tflops.
STEP-13: step_time = 40.224770 ms, foward_time = 38.524929, backward_time = 1.622016, perf = 20.50 tflops.
STEP-14: step_time = 40.321026 ms, foward_time = 38.564865, backward_time = 1.695744, perf = 20.45 tflops.
STEP-15: step_time = 40.280064 ms, foward_time = 38.602753, backward_time = 1.599488, perf = 20.47 tflops.
STEP-16: step_time = 40.283134 ms, foward_time = 38.563839, backward_time = 1.659904, perf = 20.47 tflops.
STEP-17: step_time = 40.154114 ms, foward_time = 38.395905, backward_time = 1.695744, perf = 20.54 tflops.
STEP-18: step_time = 40.046593 ms, foward_time = 38.294529, backward_time = 1.677312, perf = 20.59 tflops.
STEP-19: step_time = 40.285183 ms, foward_time = 38.694912, backward_time = 1.529856, perf = 20.47 tflops.
STEP-20: step_time = 40.172543 ms, foward_time = 38.598656, backward_time = 1.511424, perf = 20.53 tflops.
STEP-21: step_time = 40.117249 ms, foward_time = 38.522881, backward_time = 1.523712, perf = 20.56 tflops.
STEP-22: step_time = 40.128513 ms, foward_time = 38.454273, backward_time = 1.612800, perf = 20.55 tflops.
STEP-23: step_time = 40.445953 ms, foward_time = 38.715393, backward_time = 1.671168, perf = 20.39 tflops.
STEP-24: step_time = 40.616959 ms, foward_time = 38.866943, backward_time = 1.693696, perf = 20.30 tflops.
STEP-25: step_time = 39.926785 ms, foward_time = 38.178818, backward_time = 1.689600, perf = 20.65 tflops.
STEP-26: step_time = 39.977985 ms, foward_time = 38.221825, backward_time = 1.698816, perf = 20.63 tflops.
STEP-27: step_time = 40.174591 ms, foward_time = 38.404095, backward_time = 1.693696, perf = 20.53 tflops.
STEP-28: step_time = 40.143871 ms, foward_time = 38.338558, backward_time = 1.747968, perf = 20.54 tflops.
STEP-29: step_time = 40.299519 ms, foward_time = 38.563839, backward_time = 1.661952, perf = 20.46 tflops.
STEP-30: step_time = 40.510464 ms, foward_time = 38.699009, backward_time = 1.751040, perf = 20.36 tflops.
STEP-31: step_time = 40.605698 ms, foward_time = 38.818817, backward_time = 1.728512, perf = 20.31 tflops.
STEP-32: step_time = 40.837120 ms, foward_time = 38.895615, backward_time = 1.859584, perf = 20.19 tflops.
STEP-33: step_time = 40.487934 ms, foward_time = 38.725632, backward_time = 1.705984, perf = 20.37 tflops.
STEP-34: step_time = 40.115200 ms, foward_time = 38.483967, backward_time = 1.570816, perf = 20.56 tflops.
STEP-35: step_time = 40.177666 ms, foward_time = 38.447105, backward_time = 1.668096, perf = 20.52 tflops.
STEP-36: step_time = 40.054783 ms, foward_time = 38.342655, backward_time = 1.634304, perf = 20.59 tflops.
STEP-37: step_time = 40.065025 ms, foward_time = 38.331390, backward_time = 1.673216, perf = 20.58 tflops.
STEP-38: step_time = 40.436737 ms, foward_time = 38.530048, backward_time = 1.823744, perf = 20.39 tflops.
STEP-39: step_time = 39.987202 ms, foward_time = 38.278145, backward_time = 1.649664, perf = 20.62 tflops.
STEP-40: step_time = 40.188927 ms, foward_time = 38.428673, backward_time = 1.701888, perf = 20.52 tflops.
STEP-41: step_time = 43.429890 ms, foward_time = 41.515007, backward_time = 1.856512, perf = 18.99 tflops.
STEP-42: step_time = 40.589314 ms, foward_time = 38.893566, backward_time = 1.635328, perf = 20.32 tflops.
STEP-43: step_time = 40.627201 ms, foward_time = 38.942719, backward_time = 1.618944, perf = 20.30 tflops.
STEP-44: step_time = 38.522881 ms, foward_time = 36.777985, backward_time = 1.668096, perf = 21.41 tflops.
STEP-45: step_time = 38.376450 ms, foward_time = 36.455425, backward_time = 1.859584, perf = 21.49 tflops.
STEP-46: step_time = 38.071297 ms, foward_time = 36.343807, backward_time = 1.649664, perf = 21.66 tflops.
STEP-47: step_time = 37.944321 ms, foward_time = 36.244480, backward_time = 1.639424, perf = 21.73 tflops.
STEP-48: step_time = 37.968895 ms, foward_time = 36.259838, backward_time = 1.596416, perf = 21.72 tflops.
STEP-49: step_time = 38.161407 ms, foward_time = 36.399105, backward_time = 1.684480, perf = 21.61 tflops.
STEP-50: step_time = 38.113281 ms, foward_time = 36.366337, backward_time = 1.685504, perf = 21.64 tflops.
STEP-51: step_time = 37.840897 ms, foward_time = 36.217857, backward_time = 1.550336, perf = 21.79 tflops.
STEP-52: step_time = 38.081535 ms, foward_time = 36.362240, backward_time = 1.661952, perf = 21.65 tflops.
STEP-53: step_time = 38.533119 ms, foward_time = 36.812801, backward_time = 1.646592, perf = 21.40 tflops.
STEP-54: step_time = 37.910526 ms, foward_time = 36.245502, backward_time = 1.592320, perf = 21.75 tflops.
STEP-55: step_time = 38.102016 ms, foward_time = 36.468735, backward_time = 1.571840, perf = 21.64 tflops.
STEP-56: step_time = 37.883904 ms, foward_time = 36.117504, backward_time = 1.690624, perf = 21.77 tflops.
STEP-57: step_time = 37.999615 ms, foward_time = 36.398079, backward_time = 1.540096, perf = 21.70 tflops.
STEP-58: step_time = 37.854210 ms, foward_time = 36.185089, backward_time = 1.593344, perf = 21.78 tflops.
STEP-59: step_time = 38.177792 ms, foward_time = 36.375553, backward_time = 1.724416, perf = 21.60 tflops.
STEP-60: step_time = 38.072319 ms, foward_time = 36.342785, backward_time = 1.656832, perf = 21.66 tflops.
STEP-61: step_time = 37.883904 ms, foward_time = 36.150272, backward_time = 1.659904, perf = 21.77 tflops.
STEP-62: step_time = 47.289345 ms, foward_time = 44.229633, backward_time = 2.464768, perf = 17.44 tflops.
STEP-63: step_time = 40.276993 ms, foward_time = 38.456322, backward_time = 1.751040, perf = 20.47 tflops.
STEP-64: step_time = 38.223873 ms, foward_time = 36.416512, backward_time = 1.739776, perf = 21.57 tflops.
STEP-65: step_time = 38.409218 ms, foward_time = 36.547585, backward_time = 1.779712, perf = 21.47 tflops.
STEP-66: step_time = 39.995392 ms, foward_time = 37.891071, backward_time = 1.992704, perf = 20.62 tflops.
STEP-67: step_time = 38.836224 ms, foward_time = 37.096447, backward_time = 1.651712, perf = 21.23 tflops.
STEP-68: step_time = 38.163456 ms, foward_time = 36.377602, backward_time = 1.717248, perf = 21.61 tflops.
STEP-69: step_time = 37.990398 ms, foward_time = 36.302849, backward_time = 1.623040, perf = 21.71 tflops.
STEP-70: step_time = 38.425598 ms, foward_time = 36.561920, backward_time = 1.800192, perf = 21.46 tflops.
STEP-71: step_time = 38.148094 ms, foward_time = 36.326401, backward_time = 1.758208, perf = 21.62 tflops.
STEP-72: step_time = 38.870014 ms, foward_time = 37.088257, backward_time = 1.717248, perf = 21.22 tflops.
STEP-73: step_time = 39.895039 ms, foward_time = 37.900288, backward_time = 1.934336, perf = 20.67 tflops.
STEP-74: step_time = 38.332417 ms, foward_time = 36.382721, backward_time = 1.886208, perf = 21.51 tflops.
STEP-75: step_time = 39.939072 ms, foward_time = 37.949440, backward_time = 1.908736, perf = 20.65 tflops.
STEP-76: step_time = 38.115330 ms, foward_time = 36.375553, backward_time = 1.659904, perf = 21.64 tflops.
STEP-77: step_time = 38.052864 ms, foward_time = 36.248577, backward_time = 1.740800, perf = 21.67 tflops.
STEP-78: step_time = 38.004738 ms, foward_time = 36.272129, backward_time = 1.670144, perf = 21.70 tflops.
STEP-79: step_time = 40.859650 ms, foward_time = 39.063553, backward_time = 1.733632, perf = 20.18 tflops.
STEP-80: step_time = 38.403072 ms, foward_time = 36.576256, backward_time = 1.760256, perf = 21.47 tflops.
STEP-81: step_time = 37.960705 ms, foward_time = 36.195328, backward_time = 1.689600, perf = 21.72 tflops.
STEP-82: step_time = 41.867264 ms, foward_time = 40.100864, backward_time = 1.703936, perf = 19.70 tflops.
STEP-83: step_time = 38.089729 ms, foward_time = 36.384769, backward_time = 1.622016, perf = 21.65 tflops.
STEP-84: step_time = 38.490112 ms, foward_time = 36.695042, backward_time = 1.721344, perf = 21.42 tflops.
STEP-85: step_time = 38.132736 ms, foward_time = 36.335617, backward_time = 1.716224, perf = 21.63 tflops.
STEP-86: step_time = 38.380543 ms, foward_time = 36.620289, backward_time = 1.697792, perf = 21.49 tflops.
STEP-87: step_time = 38.097919 ms, foward_time = 36.184063, backward_time = 1.848320, perf = 21.65 tflops.
STEP-88: step_time = 38.138882 ms, foward_time = 36.265984, backward_time = 1.809408, perf = 21.62 tflops.
STEP-89: step_time = 39.987202 ms, foward_time = 37.728256, backward_time = 2.196480, perf = 20.62 tflops.
STEP-90: step_time = 38.407169 ms, foward_time = 36.586494, backward_time = 1.758208, perf = 21.47 tflops.
STEP-91: step_time = 38.766590 ms, foward_time = 36.841473, backward_time = 1.863680, perf = 21.27 tflops.
STEP-92: step_time = 38.129665 ms, foward_time = 36.401154, backward_time = 1.667072, perf = 21.63 tflops.
STEP-93: step_time = 40.247295 ms, foward_time = 37.993473, backward_time = 2.192384, perf = 20.49 tflops.
STEP-94: step_time = 38.260735 ms, foward_time = 36.406273, backward_time = 1.792000, perf = 21.55 tflops.
STEP-95: step_time = 38.172672 ms, foward_time = 36.395008, backward_time = 1.713152, perf = 21.60 tflops.
STEP-96: step_time = 38.194176 ms, foward_time = 36.381695, backward_time = 1.747968, perf = 21.59 tflops.
STEP-97: step_time = 39.111679 ms, foward_time = 37.131264, backward_time = 1.915904, perf = 21.08 tflops.
STEP-98: step_time = 38.508545 ms, foward_time = 36.659199, backward_time = 1.769472, perf = 21.41 tflops.
STEP-99: step_time = 38.083584 ms, foward_time = 36.235264, backward_time = 1.787904, perf = 21.65 tflops.

 faster_moe 64 [Summary] Average synchronized step_time = 38.85986143747966 ms, forward = 37.031799697875975 , backward = 1.7497770647207895 .
