cuda:0
cuda:2
cuda:1
cuda:3
rank: 2, nranks: 4
rank: 0, nranks: 4
rank: 1, nranks: 4
rank: 3, nranks: 4
DistributedDataParallel(
  (module): ExampleModel(
    (attn): MultiHeadSelfAttention(
      (linear_q): Linear(in_features=1024, out_features=1024, bias=False)
      (linear_k): Linear(in_features=1024, out_features=1024, bias=False)
      (linear_v): Linear(in_features=1024, out_features=1024, bias=False)
      (linear_o): Linear(in_features=1024, out_features=1024, bias=False)
    )
    (_moe_layer): MixMOETransformerMLP(
      (gate): NaiveGate(
        (gate): Linear(in_features=1024, out_features=32, bias=True)
      )
      (experts): _Expert(
        (htoh4): FMoELinear(num_expert=14, in_features=1024,         out_features=4096, bias=True, rank=0)
        (h4toh): FMoELinear(num_expert=14, in_features=4096,         out_features=1024, bias=True, rank=0)
        (activation): GELU(approximate='none')
      )
    )
  )
)
[Benchmark] world_size = 4, dtype = float16, model_dim = 1024, hidden_size = 4096, samples = 8192, num_local_experts = 8, topK = 2, a2a_ffn_overlap_degree = 1, device = `cuda:0`
start
start
start
start
block_info 312 83
cuda:2 process time:126.57594680786133, a: 10.768413543701172, b: 113.34800720214844, c: 0.1876354217529297, d: 2.271890640258789
block_info 256 37
block_info 228 16
2 wait time: 2.414
312
block_info 248 33
cuda:0 process time:127.59828567504883, a: 8.599281311035156, b: 115.98753929138184, c: 0.2524852752685547, d: 2.7589797973632812
cuda:3 process time:127.47335433959961, a: 7.038593292236328, b: 117.17557907104492, c: 0.25844573974609375, d: 3.0007362365722656
cuda:1 process time:128.04794311523438, a: 10.716676712036133, b: 114.40515518188477, c: 0.5278587341308594, d: 2.398252487182617
3 wait time: 2.52
256
0 wait time: 2.812
228
1 wait time: 2.818
248
AG, 0.070175, 1.753088, 0 
perpare first forward gemm: 1.655,  fisrt gemm forward duration: 3.064
AG, 0.144531, 1.862656, 0 
perpare first forward gemm: 1.367,  fisrt gemm forward duration: 3.163
AG, 0.133065, 1.836032, 0 
perpare first forward gemm: 1.521,  fisrt gemm forward duration: 3.11
AG, 0.266026, 1.936384, 0 
perpare first forward gemm: 2.159,  fisrt gemm forward duration: 4.348
GA, 0.070175, 1.393664, 0 
GA, 0.133065, 1.563648, 0 
GA, 0.144531, 1.843200, 0 
GA, 0.266026, 2.398208, 0 
forward:  11.741
forward:  12.144
forward:  12.11
forward:  13.267
AG, 0.144531, 1.848320, 0 
AG, 0.133065, 1.848320, 0 
AG, 0.070175, 1.765376, 0 
AG, 0.266026, 1.997824, 0 
Linear 2 Backward: 3.741, second_gemm: 3.724
Linear 2 Backward: 7.845, second_gemm: 7.828
Linear 2 Backward: 7.351, second_gemm: 7.334
Linear 2 Backward: 8.528, second_gemm: 8.508
GA, 0.070175, 1.412096, 0 
GA, 0.133065, 1.556480, 0 
GA, 0.144531, 1.694720, 0 
GA, 0.266026, 2.247680, 0 
perpare first backward gemm: 0.031,  fisrt gemm backward duration: 2.521,  weight grad: 1.599,  other: 1.831
Linear 1 Backward:  6.047
perpare first backward gemm: 0.037,  fisrt gemm backward duration: 2.676,  weight grad: 1.527,  other: 2.241
Linear 1 Backward:  6.532
perpare first backward gemm: 0.027,  fisrt gemm backward duration: 2.768,  weight grad: 1.53,  other: 2.275
Linear 1 Backward:  6.646
perpare first backward gemm: 0.032,  fisrt gemm backward duration: 2.299,  weight grad: 1.78,  other: 2.188
Linear 1 Backward:  6.351
STEP-0: step_time = 37.116943 ms, foward_time = 16.876465, backward_time = 19.885056, perf = 22.22 tflops.
start
start
start
start
block_info 248 33
block_info 312 83
block_info 256 37
cuda:1 process time:3.5343170166015625, a: 0.6964206695556641, b: 1.3875961303710938, c: 0.06699562072753906, d: 1.3833045959472656
cuda:3 process time:3.0944347381591797, a: 0.6010532379150391, b: 0.9982585906982422, c: 0.0591278076171875, d: 1.435995101928711
cuda:2 process time:3.288745880126953, a: 0.7116794586181641, b: 0.9882450103759766, c: 0.05793571472167969, d: 1.5308856964111328
1 wait time: 1.519
248
block_info 228 16
3 wait time: 1.043
256
2 wait time: 1.555
312
cuda:0 process time:4.341602325439453, a: 0.7114410400390625, b: 1.524209976196289, c: 0.11134147644042969, d: 1.9946098327636719
0 wait time: 2.557
228
AG, 0.133065, 1.826816, 0 
perpare first forward gemm: 0.258,  fisrt gemm forward duration: 2.882
AG, 0.070175, 1.763328, 0 
perpare first forward gemm: 0.251,  fisrt gemm forward duration: 1.815
AG, 0.144531, 1.906688, 0 
perpare first forward gemm: 0.314,  fisrt gemm forward duration: 2.608
AG, 0.266026, 2.018304, 0 
perpare first forward gemm: 0.329,  fisrt gemm forward duration: 2.791
GA, 0.070175, 1.421312, 0 
GA, 0.133065, 1.583104, 0 
GA, 0.144531, 1.825792, 0 
GA, 0.266026, 2.347008, 0 
forward:  7.648
forward:  6.865
forward:  7.871
forward:  7.783
AG, 0.144531, 1.845248, 0 
AG, 0.133065, 1.854464, 0 
AG, 0.070175, 1.774592, 0 
AG, 0.266026, 2.012160, 0 
Linear 2 Backward: 3.572, second_gemm: 3.558
Linear 2 Backward: 3.681, second_gemm: 3.67
Linear 2 Backward: 3.566, second_gemm: 3.553
Linear 2 Backward: 3.632, second_gemm: 3.618
GA, 0.070175, 1.404928, 0 
GA, 0.133065, 1.611776, 0 
GA, 0.144531, 1.682432, 0 
GA, 0.266026, 2.166784, 0 
perpare first backward gemm: 0.037,  fisrt gemm backward duration: 2.634,  weight grad: 1.554,  other: 0.469
Linear 1 Backward:  4.759
perpare first backward gemm: 0.031,  fisrt gemm backward duration: 2.651,  weight grad: 1.6,  other: 0.442
Linear 1 Backward:  4.774
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 2.582,  weight grad: 1.528,  other: 0.422
Linear 1 Backward:  4.617
perpare first backward gemm: 0.045,  fisrt gemm backward duration: 2.238,  weight grad: 1.81,  other: 0.47
Linear 1 Backward:  4.629
STEP-1: step_time = 22.140160 ms, foward_time = 10.403072, backward_time = 11.620352, perf = 37.25 tflops.
start
start
start
start
block_info 228 16
block_info 256 37
block_info 248 33
cuda:0 process time:4.088640213012695, a: 1.2257099151611328, b: 1.287698745727539, c: 0.09012222290039062, d: 1.4851093292236328
block_info 312 83
cuda:3 process time:4.804134368896484, a: 0.9248256683349609, b: 2.043485641479492, c: 0.07843971252441406, d: 1.7573833465576172
cuda:1 process time:4.620552062988281, a: 1.1701583862304688, b: 1.4071464538574219, c: 0.07963180541992188, d: 1.9636154174804688
0 wait time: 2.029
228
cuda:2 process time:4.779577255249023, a: 1.146554946899414, b: 1.44195556640625, c: 0.08630752563476562, d: 2.1047592163085938
3 wait time: 2.27
256
1 wait time: 1.886
248
2 wait time: 2.612
312
AG, 0.070175, 1.789952, 0 
perpare first forward gemm: 0.299,  fisrt gemm forward duration: 2.333
AG, 0.133065, 1.831936, 0 
perpare first forward gemm: 0.307,  fisrt gemm forward duration: 2.225
AG, 0.144531, 1.850368, 0 
perpare first forward gemm: 0.302,  fisrt gemm forward duration: 2.246
AG, 0.266026, 2.004992, 0 
perpare first forward gemm: 0.306,  fisrt gemm forward duration: 2.064
GA, 0.070175, 1.458176, 0 
GA, 0.133065, 1.591296, 0 
GA, 0.144531, 1.830912, 0 
GA, 0.266026, 2.383872, 0 
forward:  7.245
forward:  7.266
forward:  7.423
forward:  6.953
AG, 0.070175, 1.777664, 0 
AG, 0.133065, 1.833984, 0 
AG, 0.144531, 1.878016, 0 
AG, 0.266026, 2.022400, 0 
Linear 2 Backward: 3.709, second_gemm: 3.7
Linear 2 Backward: 3.567, second_gemm: 3.554
Linear 2 Backward: 3.585, second_gemm: 3.57
Linear 2 Backward: 3.659, second_gemm: 3.644
GA, 0.070175, 1.483776, 0 
GA, 0.133065, 1.664000, 0 
GA, 0.144531, 1.686528, 0 
GA, 0.266026, 2.181120, 0 
perpare first backward gemm: 0.035,  fisrt gemm backward duration: 2.701,  weight grad: 1.546,  other: 0.447
Linear 1 Backward:  4.77
perpare first backward gemm: 0.03,  fisrt gemm backward duration: 2.735,  weight grad: 1.539,  other: 0.424
Linear 1 Backward:  4.776
perpare first backward gemm: 0.039,  fisrt gemm backward duration: 2.547,  weight grad: 1.625,  other: 0.462
Linear 1 Backward:  4.738
perpare first backward gemm: 0.045,  fisrt gemm backward duration: 2.248,  weight grad: 1.808,  other: 0.482
Linear 1 Backward:  4.632
STEP-2: step_time = 21.900640 ms, foward_time = 10.591584, backward_time = 11.208704, perf = 37.65 tflops.
start
start
start
start
block_info 256 37
block_info 248 33
block_info 312 83
block_info 228 16
cuda:3 process time:3.7729740142822266, a: 0.7052421569824219, b: 1.2180805206298828, c: 0.10728836059570312, d: 1.7423629760742188
cuda:1 process time:3.770589828491211, a: 0.7650852203369141, b: 1.1794567108154297, c: 0.09703636169433594, d: 1.7290115356445312
3 wait time: 1.883
256
cuda:0 process time:4.059076309204102, a: 0.6275177001953125, b: 1.1715888977050781, c: 0.11277198791503906, d: 2.147197723388672
cuda:2 process time:4.132270812988281, a: 0.6837844848632812, b: 1.2867450714111328, c: 0.08416175842285156, d: 2.0775794982910156
1 wait time: 2.155
248
2 wait time: 2.588
312
0 wait time: 2.325
228
AG, 0.133065, 1.824768, 0 
perpare first forward gemm: 0.284,  fisrt gemm forward duration: 2.262
AG, 0.144531, 1.867776, 0 
perpare first forward gemm: 0.289,  fisrt gemm forward duration: 2.433
AG, 0.070175, 1.777664, 0 
perpare first forward gemm: 0.274,  fisrt gemm forward duration: 1.841
AG, 0.266026, 1.995776, 0 
perpare first forward gemm: 0.294,  fisrt gemm forward duration: 2.154
GA, 0.070175, 1.409024, 0 
GA, 0.133065, 1.599488, 0 
GA, 0.144531, 1.795072, 0 
GA, 0.266026, 2.394112, 0 
forward:  7.202
forward:  7.338
forward:  6.836
forward:  6.903
AG, 0.070175, 1.744896, 0 
AG, 0.133065, 1.847296, 0 
AG, 0.144531, 1.862656, 0 
AG, 0.266026, 2.019328, 0 
Linear 2 Backward: 3.34, second_gemm: 3.327
Linear 2 Backward: 3.324, second_gemm: 3.309
Linear 2 Backward: 3.575, second_gemm: 3.562
Linear 2 Backward: 3.699, second_gemm: 3.686
GA, 0.070175, 1.421312, 0 
GA, 0.133065, 1.577984, 0 
GA, 0.144531, 1.644544, 0 
GA, 0.266026, 2.189312, 0 
perpare first backward gemm: 0.034,  fisrt gemm backward duration: 2.715,  weight grad: 1.559,  other: 0.471
Linear 1 Backward:  4.837
perpare first backward gemm: 0.039,  fisrt gemm backward duration: 2.575,  weight grad: 1.558,  other: 0.475
Linear 1 Backward:  4.713
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 2.566,  weight grad: 1.63,  other: 0.451
Linear 1 Backward:  4.74
perpare first backward gemm: 0.041,  fisrt gemm backward duration: 2.252,  weight grad: 1.812,  other: 0.443
Linear 1 Backward:  4.607
STEP-3: step_time = 21.327872 ms, foward_time = 10.200064, backward_time = 11.029504, perf = 38.66 tflops.
start
start
start
start
block_info 248 33
block_info 312 83
block_info 228 16
block_info 256 37
cuda:1 process time:3.7240982055664062, a: 0.7827281951904297, b: 1.026153564453125, c: 0.08702278137207031, d: 1.8281936645507812
cuda:2 process time:4.146099090576172, a: 0.6954669952392578, b: 1.28936767578125, c: 0.08106231689453125, d: 2.080202102661133
1 wait time: 1.915
248
cuda:0 process time:4.281520843505859, a: 0.6840229034423828, b: 1.4133453369140625, c: 0.09632110595703125, d: 2.087831497192383
cuda:3 process time:4.461526870727539, a: 0.6945133209228516, b: 1.3170242309570312, c: 0.09942054748535156, d: 2.3505687713623047
2 wait time: 2.271
312
3 wait time: 2.493
256
0 wait time: 2.282
228
AG, 0.133065, 1.848320, 0 
perpare first forward gemm: 0.283,  fisrt gemm forward duration: 2.441
AG, 0.144531, 1.855488, 0 
perpare first forward gemm: 0.284,  fisrt gemm forward duration: 1.917
AG, 0.070175, 1.782784, 0 
perpare first forward gemm: 0.274,  fisrt gemm forward duration: 1.871
AG, 0.266026, 1.995776, 0 
perpare first forward gemm: 0.291,  fisrt gemm forward duration: 2.32
GA, 0.070175, 1.461248, 0 
GA, 0.133065, 1.560576, 0 
GA, 0.144531, 1.754112, 0 
GA, 0.266026, 2.341888, 0 
forward:  6.822
forward:  7.31
forward:  6.805
forward:  7.047
AG, 0.070175, 1.778688, 0 
AG, 0.144531, 1.865728, 0 
AG, 0.133065, 1.845248, 0 
AG, 0.266026, 2.025472, 0 
Linear 2 Backward: 3.313, second_gemm: 3.3
Linear 2 Backward: 3.526, second_gemm: 3.513
Linear 2 Backward: 3.65, second_gemm: 3.637
Linear 2 Backward: 3.664, second_gemm: 3.65
GA, 0.070175, 1.449984, 0 
GA, 0.133065, 1.623040, 0 
GA, 0.144531, 1.647616, 0 
GA, 0.266026, 2.186240, 0 
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 2.691,  weight grad: 1.548,  other: 0.442
Linear 1 Backward:  4.775
perpare first backward gemm: 0.033,  fisrt gemm backward duration: 2.741,  weight grad: 1.547,  other: 0.445
Linear 1 Backward:  4.824
perpare first backward gemm: 0.035,  fisrt gemm backward duration: 2.639,  weight grad: 1.609,  other: 0.476
Linear 1 Backward:  4.8
perpare first backward gemm: 0.056,  fisrt gemm backward duration: 2.254,  weight grad: 1.806,  other: 0.453
Linear 1 Backward:  4.619
STEP-4: step_time = 21.219328 ms, foward_time = 10.076160, backward_time = 11.043840, perf = 38.86 tflops.
start
start
start
start
block_info 256 37
cuda:3 process time:3.004312515258789, a: 0.6186962127685547, b: 1.1582374572753906, c: 0.06508827209472656, d: 1.1622905731201172
3 wait time: 1.222
256
block_info 312 83
block_info 228 16
block_info 248 33
cuda:2 process time:4.052162170410156, a: 0.6873607635498047, b: 1.3380050659179688, c: 0.08058547973632812, d: 1.9462108612060547
cuda:0 process time:4.021167755126953, a: 0.7617473602294922, b: 1.0805130004882812, c: 0.09822845458984375, d: 2.080678939819336
cuda:1 process time:4.238128662109375, a: 0.7255077362060547, b: 1.161813735961914, c: 0.09751319885253906, d: 2.253293991088867
2 wait time: 2.425
312
0 wait time: 2.217
228
1 wait time: 2.353
248
AG, 0.070175, 1.765376, 0 
perpare first forward gemm: 0.268,  fisrt gemm forward duration: 1.999
AG, 0.144531, 1.849344, 0 
perpare first forward gemm: 0.283,  fisrt gemm forward duration: 3.253
AG, 0.133065, 1.825792, 0 
perpare first forward gemm: 0.279,  fisrt gemm forward duration: 1.887
AG, 0.266026, 2.021376, 0 
perpare first forward gemm: 0.299,  fisrt gemm forward duration: 2.301
GA, 0.070175, 1.437696, 0 
GA, 0.133065, 1.571840, 0 
GA, 0.144531, 1.780736, 0 
GA, 0.266026, 2.278400, 0 
forward:  6.723
forward:  8.092
forward:  6.887
forward:  6.957
AG, 0.070175, 1.758208, 0 
AG, 0.133065, 1.829888, 0 
AG, 0.144531, 1.868800, 0 
AG, 0.266026, 2.016256, 0 
Linear 2 Backward: 3.562, second_gemm: 3.55
Linear 2 Backward: 3.501, second_gemm: 3.488
Linear 2 Backward: 3.335, second_gemm: 3.323
Linear 2 Backward: 3.856, second_gemm: 3.844
GA, 0.070175, 1.427456, 0 
GA, 0.133065, 1.600512, 0 
GA, 0.144531, 1.633280, 0 
GA, 0.266026, 2.165760, 0 
perpare first backward gemm: 0.033,  fisrt gemm backward duration: 2.699,  weight grad: 1.545,  other: 0.447
Linear 1 Backward:  4.765
perpare first backward gemm: 0.035,  fisrt gemm backward duration: 2.636,  weight grad: 1.548,  other: 0.443
Linear 1 Backward:  4.706
perpare first backward gemm: 0.033,  fisrt gemm backward duration: 2.584,  weight grad: 1.604,  other: 0.461
Linear 1 Backward:  4.737
perpare first backward gemm: 0.052,  fisrt gemm backward duration: 2.228,  weight grad: 1.797,  other: 0.431
Linear 1 Backward:  4.554
STEP-5: step_time = 21.291008 ms, foward_time = 10.167296, backward_time = 11.025408, perf = 38.73 tflops.
start
start
start
start
block_info 228 16
block_info 248 33
block_info 256 37
block_info 312 83
cuda:0 process time:3.497600555419922, a: 0.7312297821044922, b: 1.1830329895019531, c: 0.07677078247070312, d: 1.5065670013427734
cuda:1 process time:3.6520957946777344, a: 0.7245540618896484, b: 1.220703125, c: 0.07557868957519531, d: 1.6312599182128906
0 wait time: 2.046
228
cuda:2 process time:4.208564758300781, a: 0.7195472717285156, b: 1.4681816101074219, c: 0.08082389831542969, d: 1.940011978149414
cuda:3 process time:4.310131072998047, a: 0.7824897766113281, b: 1.3828277587890625, c: 0.087738037109375, d: 2.0570755004882812
1 wait time: 2.145
248
3 wait time: 2.059
256
2 wait time: 2.418
312
AG, 0.133065, 1.831936, 0 
perpare first forward gemm: 0.282,  fisrt gemm forward duration: 2.189
AG, 0.070175, 1.761280, 0 
perpare first forward gemm: 0.271,  fisrt gemm forward duration: 2.238
AG, 0.144531, 1.862656, 0 
perpare first forward gemm: 0.319,  fisrt gemm forward duration: 1.94
AG, 0.266026, 2.001920, 0 
perpare first forward gemm: 0.318,  fisrt gemm forward duration: 2.082
GA, 0.070175, 1.415168, 0 
GA, 0.133065, 1.575936, 0 
GA, 0.144531, 1.837056, 0 
GA, 0.266026, 2.396160, 0 
forward:  7.195
forward:  7.299
forward:  6.949
forward:  7.084
AG, 0.070175, 1.766400, 0 
AG, 0.133065, 1.812480, 0 
AG, 0.144531, 1.869824, 0 
AG, 0.266026, 2.019328, 0 
Linear 2 Backward: 3.24, second_gemm: 3.228
Linear 2 Backward: 3.282, second_gemm: 3.269
Linear 2 Backward: 3.498, second_gemm: 3.485
Linear 2 Backward: 3.647, second_gemm: 3.634
GA, 0.070175, 1.437696, 0 
GA, 0.133065, 1.624064, 0 
GA, 0.144531, 1.659904, 0 
GA, 0.266026, 2.203648, 0 
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 2.558,  weight grad: 1.608,  other: 0.45
Linear 1 Backward:  4.71
perpare first backward gemm: 0.034,  fisrt gemm backward duration: 2.645,  weight grad: 1.546,  other: 0.443
Linear 1 Backward:  4.727
perpare first backward gemm: 0.033,  fisrt gemm backward duration: 2.703,  weight grad: 1.542,  other: 0.442
Linear 1 Backward:  4.777
perpare first backward gemm: 0.039,  fisrt gemm backward duration: 2.267,  weight grad: 1.797,  other: 0.492
Linear 1 Backward:  4.64
STEP-6: step_time = 21.317664 ms, foward_time = 10.319904, backward_time = 10.897408, perf = 38.68 tflops.
start
start
start
start
block_info 228 16
block_info 248 33
block_info 312 83
cuda:0 process time:3.426790237426758, a: 0.7278919219970703, b: 1.1661052703857422, c: 0.08749961853027344, d: 1.4452934265136719
block_info 256 37
cuda:1 process time:3.589153289794922, a: 0.7216930389404297, b: 1.0273456573486328, c: 0.07367134094238281, d: 1.7664432525634766
0 wait time: 1.961
228
cuda:2 process time:3.938913345336914, a: 0.7047653198242188, b: 1.0657310485839844, c: 0.080108642578125, d: 2.088308334350586
1 wait time: 1.953
248
cuda:3 process time:4.264593124389648, a: 0.6840229034423828, b: 1.4977455139160156, c: 0.09799003601074219, d: 1.9848346710205078
2 wait time: 2.256
312
3 wait time: 2.27
256
AG, 0.133065, 1.822720, 0 
perpare first forward gemm: 0.283,  fisrt gemm forward duration: 2.139
AG, 0.070175, 1.779712, 0 
perpare first forward gemm: 0.269,  fisrt gemm forward duration: 2.348
AG, 0.144531, 1.859584, 0 
perpare first forward gemm: 0.275,  fisrt gemm forward duration: 1.915
AG, 0.266026, 2.014208, 0 
perpare first forward gemm: 0.315,  fisrt gemm forward duration: 2.133
GA, 0.070175, 1.424384, 0 
GA, 0.133065, 1.601536, 0 
GA, 0.144531, 1.775616, 0 
GA, 0.266026, 2.284544, 0 
forward:  7.286
forward:  7.113
forward:  6.875
forward:  6.794
AG, 0.133065, 1.845248, 0 
AG, 0.070175, 1.766400, 0 
AG, 0.144531, 1.864704, 0 
AG, 0.266026, 2.013184, 0 
Linear 2 Backward: 3.405, second_gemm: 3.393
Linear 2 Backward: 3.429, second_gemm: 3.417
Linear 2 Backward: 3.375, second_gemm: 3.363
Linear 2 Backward: 3.708, second_gemm: 3.696
GA, 0.070175, 1.451008, 0 
GA, 0.133065, 1.585152, 0 
GA, 0.144531, 1.710080, 0 
GA, 0.266026, 2.231296, 0 
perpare first backward gemm: 0.035,  fisrt gemm backward duration: 2.723,  weight grad: 1.535,  other: 0.441
Linear 1 Backward:  4.793
perpare first backward gemm: 0.035,  fisrt gemm backward duration: 2.64,  weight grad: 1.548,  other: 0.44
Linear 1 Backward:  4.719
perpare first backward gemm: 0.038,  fisrt gemm backward duration: 2.554,  weight grad: 1.618,  other: 0.459
Linear 1 Backward:  4.727
perpare first backward gemm: 0.04,  fisrt gemm backward duration: 2.31,  weight grad: 1.815,  other: 0.443
Linear 1 Backward:  4.666
STEP-7: step_time = 21.453184 ms, foward_time = 10.213760, backward_time = 11.140096, perf = 38.44 tflops.
start
start
start
start
block_info 228 16
block_info 256 37
block_info 248 33
cuda:0 process time:3.549337387084961, a: 0.7166862487792969, b: 1.0309219360351562, c: 0.07987022399902344, d: 1.7218589782714844
cuda:3 process time:3.781557083129883, a: 0.6663799285888672, b: 1.3241767883300781, c: 0.07319450378417969, d: 1.7178058624267578
cuda:1 process time:3.811359405517578, a: 0.7319450378417969, b: 1.0485649108886719, c: 0.07772445678710938, d: 1.953125
3 wait time: 1.635
256
0 wait time: 1.874
228
block_info 312 83
1 wait time: 2.173
248
cuda:2 process time:4.788398742675781, a: 0.6532669067382812, b: 1.4505386352539062, c: 0.11849403381347656, d: 2.566099166870117
2 wait time: 3.116
312
AG, 0.133065, 1.816576, 0 
perpare first forward gemm: 0.282,  fisrt gemm forward duration: 2.898
AG, 0.144531, 1.857536, 0 
perpare first forward gemm: 0.312,  fisrt gemm forward duration: 3.156
AG, 0.070175, 1.772544, 0 
perpare first forward gemm: 0.282,  fisrt gemm forward duration: 3.119
AG, 0.266026, 2.034688, 0 
perpare first forward gemm: 0.333,  fisrt gemm forward duration: 2.098
GA, 0.070175, 1.441792, 0 
GA, 0.133065, 1.617920, 0 
GA, 0.144531, 1.773568, 0 
GA, 0.266026, 2.336768, 0 
forward:  8.205
forward:  6.972
forward:  8.161
forward:  7.913
AG, 0.144531, 1.857536, 0 
AG, 0.070175, 1.753088, 0 
AG, 0.133065, 1.831936, 0 
AG, 0.266026, 2.041856, 0 
Linear 2 Backward: 3.312, second_gemm: 3.3
Linear 2 Backward: 3.528, second_gemm: 3.514
Linear 2 Backward: 3.709, second_gemm: 3.695
Linear 2 Backward: 3.668, second_gemm: 3.655
GA, 0.070175, 1.415168, 0 
GA, 0.133065, 1.589248, 0 
GA, 0.144531, 1.678336, 0 
GA, 0.266026, 2.164736, 0 
perpare first backward gemm: 0.032,  fisrt gemm backward duration: 2.753,  weight grad: 1.525,  other: 0.416
Linear 1 Backward:  4.77
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 2.647,  weight grad: 1.555,  other: 0.451
Linear 1 Backward:  4.737
perpare first backward gemm: 0.038,  fisrt gemm backward duration: 2.573,  weight grad: 1.616,  other: 0.42
Linear 1 Backward:  4.707
perpare first backward gemm: 0.043,  fisrt gemm backward duration: 2.231,  weight grad: 1.817,  other: 0.459
Linear 1 Backward:  4.597
STEP-8: step_time = 22.218753 ms, foward_time = 11.064320, backward_time = 11.055104, perf = 37.11 tflops.
start
start
start
start
block_info 228 16
block_info 248 33
block_info 256 37
block_info 312 83
cuda:0 process time:3.587961196899414, a: 0.7374286651611328, b: 1.1849403381347656, c: 0.08153915405273438, d: 1.5840530395507812
cuda:1 process time:3.8480758666992188, a: 0.7603168487548828, b: 1.2021064758300781, c: 0.07963180541992188, d: 1.806020736694336
cuda:3 process time:4.143238067626953, a: 0.6134510040283203, b: 1.2943744659423828, c: 0.0934600830078125, d: 2.1419525146484375
0 wait time: 2.103
228
1 wait time: 1.954
248
cuda:2 process time:4.25267219543457, a: 0.7104873657226562, b: 1.4543533325195312, c: 0.08821487426757812, d: 1.9996166229248047
3 wait time: 2.245
256
2 wait time: 2.489
312
AG, 0.070175, 1.769472, 0 
perpare first forward gemm: 0.27,  fisrt gemm forward duration: 2.324
AG, 0.144531, 1.853440, 0 
perpare first forward gemm: 0.285,  fisrt gemm forward duration: 2.088
AG, 0.133065, 1.819648, 0 
perpare first forward gemm: 0.28,  fisrt gemm forward duration: 2.27
AG, 0.266026, 2.016256, 0 
perpare first forward gemm: 0.328,  fisrt gemm forward duration: 2.078
GA, 0.070175, 1.411072, 0 
GA, 0.133065, 1.591296, 0 
GA, 0.144531, 1.724416, 0 
GA, 0.266026, 2.271232, 0 
forward:  7.255
forward:  6.958
forward:  7.159
forward:  6.832
AG, 0.133065, 1.825792, 0 
AG, 0.070175, 1.760256, 0 
AG, 0.144531, 1.847296, 0 
AG, 0.266026, 2.019328, 0 
Linear 2 Backward: 3.565, second_gemm: 3.553
Linear 2 Backward: 3.269, second_gemm: 3.257
Linear 2 Backward: 3.318, second_gemm: 3.273
Linear 2 Backward: 3.837, second_gemm: 3.825
GA, 0.070175, 1.503232, 0 
GA, 0.144531, 1.667072, 0 
GA, 0.133065, 1.666048, 0 
GA, 0.266026, 2.183168, 0 
perpare first backward gemm: 0.033,  fisrt gemm backward duration: 2.661,  weight grad: 1.573,  other: 0.437
Linear 1 Backward:  4.748
perpare first backward gemm: 0.032,  fisrt gemm backward duration: 2.64,  weight grad: 1.573,  other: 0.464
Linear 1 Backward:  4.753
perpare first backward gemm: 0.039,  fisrt gemm backward duration: 2.246,  weight grad: 1.81,  other: 0.441
Linear 1 Backward:  4.581
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 2.625,  weight grad: 5.182,  other: 0.544
Linear 1 Backward:  8.476
STEP-9: step_time = 25.445632 ms, foward_time = 10.319104, backward_time = 15.025152, perf = 32.41 tflops.
start
start
start
start
block_info 228 16
block_info 256 37
block_info 248 33
block_info 312 83
cuda:0 process time:3.2432079315185547, a: 0.7557868957519531, b: 1.2350082397460938, c: 0.06461143493652344, d: 1.1878013610839844
cuda:3 process time:3.8144588470458984, a: 0.7119178771972656, b: 1.4464855194091797, c: 0.07772445678710938, d: 1.5783309936523438
0 wait time: 1.677
228
cuda:1 process time:3.6830902099609375, a: 0.7386207580566406, b: 1.0838508605957031, c: 0.07915496826171875, d: 1.781463623046875
cuda:2 process time:3.9370059967041016, a: 0.7028579711914062, b: 1.4166831970214844, c: 0.07748603820800781, d: 1.7399787902832031
3 wait time: 1.996
256
1 wait time: 1.9
248
2 wait time: 2.198
312
AG, 0.070175, 1.762304, 0 
perpare first forward gemm: 0.275,  fisrt gemm forward duration: 2.434
AG, 0.144531, 1.809408, 0 
perpare first forward gemm: 0.284,  fisrt gemm forward duration: 2.099
AG, 0.133065, 1.825792, 0 
perpare first forward gemm: 0.282,  fisrt gemm forward duration: 2.078
AG, 0.266026, 2.025472, 0 
perpare first forward gemm: 0.318,  fisrt gemm forward duration: 2.09
GA, 0.070175, 1.422336, 0 
GA, 0.133065, 1.601536, 0 
GA, 0.144531, 1.675264, 0 
GA, 0.266026, 2.202624, 0 
forward:  7.343
forward:  7.018
forward:  6.934
forward:  6.844
AG, 0.133065, 1.843200, 0 
AG, 0.070175, 1.763328, 0 
AG, 0.144531, 1.818624, 0 
AG, 0.266026, 2.034688, 0 
Linear 2 Backward: 3.576, second_gemm: 3.567
Linear 2 Backward: 3.264, second_gemm: 3.251
Linear 2 Backward: 3.53, second_gemm: 3.52
Linear 2 Backward: 3.853, second_gemm: 3.844
GA, 0.133065, 1.670144, 0 
GA, 0.070175, 1.510400, 0 
GA, 0.144531, 1.647616, 0 
GA, 0.266026, 2.222080, 0 
perpare first backward gemm: 0.028,  fisrt gemm backward duration: 2.677,  weight grad: 1.554,  other: 0.441
Linear 1 Backward:  4.741
perpare first backward gemm: 0.028,  fisrt gemm backward duration: 2.649,  weight grad: 1.535,  other: 0.418
Linear 1 Backward:  4.693
perpare first backward gemm: 0.038,  fisrt gemm backward duration: 2.628,  weight grad: 1.553,  other: 0.461
Linear 1 Backward:  4.737
perpare first backward gemm: 0.032,  fisrt gemm backward duration: 2.278,  weight grad: 1.799,  other: 0.436
Linear 1 Backward:  4.586
STEP-10: step_time = 21.011519 ms, foward_time = 9.999424, backward_time = 10.909696, perf = 39.25 tflops.
start
start
start
start
block_info 228 16
block_info 248 33
block_info 256 37
cuda:0 process time:3.5369396209716797, a: 0.7224082946777344, b: 1.0256767272949219, c: 0.07963180541992188, d: 1.7092227935791016
block_info 312 83
cuda:1 process time:3.6771297454833984, a: 0.7421970367431641, b: 1.0328292846679688, c: 0.07987022399902344, d: 1.8222332000732422
cuda:3 process time:4.071235656738281, a: 0.682830810546875, b: 1.1868476867675781, c: 0.09059906005859375, d: 2.1109580993652344
0 wait time: 1.862
228
1 wait time: 2.028
248
cuda:2 process time:4.282474517822266, a: 0.70953369140625, b: 1.2094974517822266, c: 0.09131431579589844, d: 2.2721290588378906
3 wait time: 2.182
256
2 wait time: 2.358
312
AG, 0.070175, 1.776640, 0 
perpare first forward gemm: 0.274,  fisrt gemm forward duration: 2.352
AG, 0.144531, 1.811456, 0 
perpare first forward gemm: 0.275,  fisrt gemm forward duration: 2.139
AG, 0.133065, 1.828864, 0 
perpare first forward gemm: 0.282,  fisrt gemm forward duration: 2.294
AG, 0.266026, 1.989632, 0 
perpare first forward gemm: 0.316,  fisrt gemm forward duration: 2.052
GA, 0.070175, 1.438720, 0 
GA, 0.144531, 1.627136, 0 
GA, 0.133065, 1.607680, 0 
GA, 0.266026, 2.209792, 0 
forward:  7.097
forward:  7.209
forward:  6.727
forward:  6.964
AG, 0.070175, 1.770496, 0 
AG, 0.133065, 1.846272, 0 
AG, 0.144531, 1.819648, 0 
AG, 0.266026, 2.016256, 0 
Linear 2 Backward: 3.392, second_gemm: 3.379
Linear 2 Backward: 3.304, second_gemm: 3.291
Linear 2 Backward: 3.564, second_gemm: 3.551
Linear 2 Backward: 3.907, second_gemm: 3.895
GA, 0.070175, 1.424384, 0 
GA, 0.133065, 1.628160, 0 
GA, 0.144531, 1.668096, 0 
GA, 0.266026, 2.181120, 0 
perpare first backward gemm: 0.04,  fisrt gemm backward duration: 2.622,  weight grad: 1.556,  other: 0.465
Linear 1 Backward:  4.745
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 2.613,  weight grad: 1.572,  other: 0.44
Linear 1 Backward:  4.718
perpare first backward gemm: 0.035,  fisrt gemm backward duration: 2.596,  weight grad: 1.551,  other: 0.438
Linear 1 Backward:  4.677
perpare first backward gemm: 0.04,  fisrt gemm backward duration: 2.243,  weight grad: 1.798,  other: 0.441
Linear 1 Backward:  4.58
STEP-11: step_time = 21.334016 ms, foward_time = 10.031104, backward_time = 11.201536, perf = 38.65 tflops.
start
start
start
block_info 256 37
start
block_info 228 16
block_info 312 83
block_info 248 33
cuda:3 process time:3.068685531616211, a: 0.5595684051513672, b: 1.07574462890625, c: 0.049591064453125, d: 1.3837814331054688
cuda:0 process time:3.518819808959961, a: 0.7266998291015625, b: 1.1644363403320312, c: 0.08249282836914062, d: 1.5451908111572266
3 wait time: 0.372
256
cuda:2 process time:3.7729740142822266, a: 0.6928443908691406, b: 1.2118816375732422, c: 0.07200241088867188, d: 1.7962455749511719
cuda:1 process time:3.784656524658203, a: 0.7419586181640625, b: 1.0170936584472656, c: 0.07867813110351562, d: 1.9469261169433594
2 wait time: 1.796
312
0 wait time: 2.056
228
1 wait time: 2.058
248
AG, 0.070175, 1.760256, 0 
perpare first forward gemm: 0.259,  fisrt gemm forward duration: 2.132
AG, 0.144531, 1.819648, 0 
perpare first forward gemm: 0.306,  fisrt gemm forward duration: 2.458
AG, 0.133065, 1.821696, 0 
perpare first forward gemm: 0.28,  fisrt gemm forward duration: 1.886
AG, 0.266026, 2.009088, 0 
perpare first forward gemm: 0.315,  fisrt gemm forward duration: 2.391
GA, 0.070175, 1.408000, 0 
GA, 0.133065, 1.557504, 0 
GA, 0.144531, 1.674240, 0 
GA, 0.266026, 2.291712, 0 
forward:  7.434
forward:  7.15
forward:  7.079
forward:  6.805
AG, 0.070175, 1.761280, 0 
AG, 0.144531, 1.816576, 0 
AG, 0.133065, 1.816576, 0 
AG, 0.266026, 1.986560, 0 
Linear 2 Backward: 3.618, second_gemm: 3.605
Linear 2 Backward: 3.911, second_gemm: 3.898
Linear 2 Backward: 3.303, second_gemm: 3.289
Linear 2 Backward: 3.992, second_gemm: 3.978
GA, 0.070175, 1.504256, 0 
GA, 0.133065, 1.674240, 0 
GA, 0.144531, 1.678336, 0 
GA, 0.266026, 2.194432, 0 
perpare first backward gemm: 0.038,  fisrt gemm backward duration: 2.713,  weight grad: 1.574,  other: 0.456
Linear 1 Backward:  4.843
perpare first backward gemm: 0.04,  fisrt gemm backward duration: 2.742,  weight grad: 1.559,  other: 0.465
Linear 1 Backward:  4.867
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 2.759,  weight grad: 1.552,  other: 0.445
Linear 1 Backward:  4.853
perpare first backward gemm: 0.116,  fisrt gemm backward duration: 2.267,  weight grad: 1.805,  other: 0.453
Linear 1 Backward:  4.712
STEP-12: step_time = 21.711328 ms, foward_time = 10.110432, backward_time = 11.482112, perf = 37.98 tflops.
start
start
start
start
block_info 312 83
block_info 228 16
block_info 256 37
block_info 248 33
cuda:2 process time:3.905057907104492, a: 0.7162094116210938, b: 1.299142837524414, c: 0.07987022399902344, d: 1.809835433959961
cuda:0 process time:3.607511520385742, a: 0.6992816925048828, b: 0.972747802734375, c: 0.08106231689453125, d: 1.8544197082519531
cuda:1 process time:3.858804702758789, a: 0.7479190826416016, b: 1.1968612670898438, c: 0.08535385131835938, d: 1.8286705017089844
cuda:3 process time:4.04667854309082, a: 0.5922317504882812, b: 1.5377998352050781, c: 0.08893013000488281, d: 1.8277168273925781
2 wait time: 1.821
312
3 wait time: 1.879
256
0 wait time: 1.706
228
1 wait time: 1.937
248
AG, 0.144531, 1.811456, 0 
perpare first forward gemm: 0.289,  fisrt gemm forward duration: 1.971
AG, 0.070175, 1.774592, 0 
perpare first forward gemm: 0.295,  fisrt gemm forward duration: 1.85
AG, 0.133065, 1.826816, 0 
perpare first forward gemm: 0.29,  fisrt gemm forward duration: 1.903
AG, 0.266026, 2.001920, 0 
perpare first forward gemm: 0.321,  fisrt gemm forward duration: 2.261
GA, 0.070175, 1.495040, 0 
GA, 0.133065, 1.669120, 0 
GA, 0.144531, 1.687552, 0 
GA, 0.266026, 2.238464, 0 
forward:  6.896
forward:  6.796
forward:  6.82
forward:  7.003
AG, 0.070175, 1.763328, 0 
AG, 0.144531, 1.808384, 0 
AG, 0.133065, 1.827840, 0 
AG, 0.266026, 2.000896, 0 
Linear 2 Backward: 3.275, second_gemm: 3.261
Linear 2 Backward: 3.609, second_gemm: 3.597
Linear 2 Backward: 3.43, second_gemm: 3.417
Linear 2 Backward: 3.706, second_gemm: 3.694
GA, 0.070175, 1.481728, 0 
GA, 0.144531, 1.607680, 0 
GA, 0.133065, 1.649664, 0 
GA, 0.266026, 2.167808, 0 
perpare first backward gemm: 0.04,  fisrt gemm backward duration: 2.636,  weight grad: 1.558,  other: 0.479
Linear 1 Backward:  4.775
perpare first backward gemm: 0.035,  fisrt gemm backward duration: 2.651,  weight grad: 1.563,  other: 0.455
Linear 1 Backward:  4.762
perpare first backward gemm: 0.034,  fisrt gemm backward duration: 2.632,  weight grad: 1.548,  other: 0.451
Linear 1 Backward:  4.723
perpare first backward gemm: 0.042,  fisrt gemm backward duration: 2.235,  weight grad: 1.799,  other: 0.441
Linear 1 Backward:  4.574
STEP-13: step_time = 20.959231 ms, foward_time = 9.572352, backward_time = 11.286528, perf = 39.34 tflops.
start
start
start
start
block_info 312 83
block_info 228 16
block_info 256 37
cuda:0 process time:3.6830902099609375, a: 0.6480216979980469, b: 1.1966228485107422, c: 0.08559226989746094, d: 1.7528533935546875
cuda:2 process time:3.839731216430664, a: 0.7302761077880859, b: 1.4052391052246094, c: 0.07224082946777344, d: 1.6319751739501953
block_info 248 33
cuda:3 process time:3.6554336547851562, a: 0.7078647613525391, b: 0.9968280792236328, c: 0.08654594421386719, d: 1.8641948699951172
2 wait time: 2.021
312
0 wait time: 1.905
228
3 wait time: 2.037
256
cuda:1 process time:4.536867141723633, a: 0.804901123046875, b: 1.478433609008789, c: 0.09894371032714844, d: 2.1545886993408203
1 wait time: 2.72
248
AG, 0.144531, 1.806336, 0 
perpare first forward gemm: 0.289,  fisrt gemm forward duration: 2.66
AG, 0.070175, 1.769472, 0 
perpare first forward gemm: 0.279,  fisrt gemm forward duration: 2.666
AG, 0.133065, 1.836032, 0 
perpare first forward gemm: 0.29,  fisrt gemm forward duration: 1.902
AG, 0.266026, 1.997824, 0 
perpare first forward gemm: 0.321,  fisrt gemm forward duration: 2.963
GA, 0.070175, 1.433600, 0 
GA, 0.133065, 1.594368, 0 
GA, 0.144531, 1.719296, 0 
GA, 0.266026, 2.250752, 0 
forward:  7.559
forward:  7.74
forward:  6.814
forward:  7.61
AG, 0.144531, 1.811456, 0 
AG, 0.133065, 1.829888, 0 
AG, 0.070175, 1.772544, 0 
AG, 0.266026, 2.014208, 0 
Linear 2 Backward: 3.292, second_gemm: 3.279
Linear 2 Backward: 3.707, second_gemm: 3.694
Linear 2 Backward: 3.61, second_gemm: 3.597
Linear 2 Backward: 3.925, second_gemm: 3.912
GA, 0.133065, 1.609728, 0 
GA, 0.070175, 1.485824, 0 
GA, 0.144531, 1.631232, 0 
GA, 0.266026, 2.196480, 0 
perpare first backward gemm: 0.041,  fisrt gemm backward duration: 2.653,  weight grad: 1.557,  other: 0.469
Linear 1 Backward:  4.782
perpare first backward gemm: 0.037,  fisrt gemm backward duration: 2.62,  weight grad: 1.569,  other: 0.454
Linear 1 Backward:  4.746
perpare first backward gemm: 0.037,  fisrt gemm backward duration: 2.611,  weight grad: 1.552,  other: 0.453
Linear 1 Backward:  4.717
perpare first backward gemm: 0.042,  fisrt gemm backward duration: 2.26,  weight grad: 1.803,  other: 0.471
Linear 1 Backward:  4.638
STEP-14: step_time = 21.796864 ms, foward_time = 10.445824, backward_time = 11.250688, perf = 37.83 tflops.
start
start
start
start
block_info 256 37
block_info 248 33
block_info 228 16
block_info 312 83
cuda:1 process time:3.6249160766601562, a: 0.7445812225341797, b: 1.0669231414794922, c: 0.07414817810058594, d: 1.7392635345458984
cuda:3 process time:3.5047531127929688, a: 0.6895065307617188, b: 0.9541511535644531, c: 0.07748603820800781, d: 1.783609390258789
cuda:0 process time:3.563404083251953, a: 0.6504058837890625, b: 1.096487045288086, c: 0.07843971252441406, d: 1.7380714416503906
cuda:2 process time:3.755807876586914, a: 0.6797313690185547, b: 1.3580322265625, c: 0.08296966552734375, d: 1.6350746154785156
3 wait time: 1.803
256
1 wait time: 1.831
248
2 wait time: 2.075
0 wait time: 1.886
228
312
AG, 0.070175, 1.770496, 0 
perpare first forward gemm: 0.273,  fisrt gemm forward duration: 1.947
AG, 0.144531, 1.840128, 0 
perpare first forward gemm: 0.285,  fisrt gemm forward duration: 2.069
AG, 0.133065, 1.831936, 0 
perpare first forward gemm: 0.282,  fisrt gemm forward duration: 2.04
AG, 0.266026, 1.995776, 0 
perpare first forward gemm: 0.317,  fisrt gemm forward duration: 2.06
GA, 0.070175, 1.433600, 0 
GA, 0.133065, 1.573888, 0 
GA, 0.144531, 1.772544, 0 
GA, 0.266026, 2.294784, 0 
forward:  6.894
forward:  6.998
forward:  6.928
forward:  6.884
AG, 0.133065, 1.835008, 0 
AG, 0.070175, 1.770496, 0 
AG, 0.144531, 1.851392, 0 
AG, 0.266026, 2.012160, 0 
Linear 2 Backward: 3.423, second_gemm: 3.411
Linear 2 Backward: 3.376, second_gemm: 3.363
Linear 2 Backward: 3.302, second_gemm: 3.289
Linear 2 Backward: 3.677, second_gemm: 3.665
GA, 0.070175, 1.491968, 0 
GA, 0.133065, 1.654784, 0 
GA, 0.144531, 1.648640, 0 
GA, 0.266026, 2.167808, 0 
perpare first backward gemm: 0.037,  fisrt gemm backward duration: 2.552,  weight grad: 1.567,  other: 0.439
Linear 1 Backward:  4.654
perpare first backward gemm: 0.035,  fisrt gemm backward duration: 2.587,  weight grad: 1.548,  other: 0.441
Linear 1 Backward:  4.667
perpare first backward gemm: 0.038,  fisrt gemm backward duration: 2.599,  weight grad: 1.55,  other: 0.458
Linear 1 Backward:  4.701
perpare first backward gemm: 0.039,  fisrt gemm backward duration: 2.246,  weight grad: 1.8,  other: 0.441
Linear 1 Backward:  4.585
STEP-15: step_time = 20.970497 ms, foward_time = 9.694208, backward_time = 11.175936, perf = 39.32 tflops.
start
start
start
start
block_info 256 37
block_info 312 83
block_info 228 16
block_info 248 33
cuda:3 process time:3.9305686950683594, a: 0.7107257843017578, b: 1.528024673461914, c: 0.07700920104980469, d: 1.6148090362548828
cuda:2 process time:3.9908885955810547, a: 0.7221698760986328, b: 1.4462471008300781, c: 0.07700920104980469, d: 1.745462417602539
3 wait time: 2.105
256
cuda:0 process time:4.152536392211914, a: 0.766754150390625, b: 1.176595687866211, c: 0.09512901306152344, d: 2.1140575408935547
2 wait time: 2.146
312
cuda:1 process time:4.156589508056641, a: 0.7295608520507812, b: 1.3384819030761719, c: 0.09512901306152344, d: 1.993417739868164
0 wait time: 2.199
228
1 wait time: 2.484
248
AG, 0.144531, 1.814528, 0 
perpare first forward gemm: 0.291,  fisrt gemm forward duration: 2.331
AG, 0.070175, 1.781760, 0 
perpare first forward gemm: 0.278,  fisrt gemm forward duration: 1.975
AG, 0.133065, 1.836032, 0 
perpare first forward gemm: 0.266,  fisrt gemm forward duration: 1.892
AG, 0.266026, 2.016256, 0 
perpare first forward gemm: 0.324,  fisrt gemm forward duration: 2.46
GA, 0.070175, 1.487872, 0 
GA, 0.133065, 1.653760, 0 
GA, 0.144531, 1.700864, 0 
GA, 0.266026, 2.233344, 0 
forward:  7.259
forward:  7.228
forward:  6.908
forward:  6.743
AG, 0.144531, 1.825792, 0 
AG, 0.070175, 1.761280, 0 
AG, 0.133065, 1.836032, 0 
AG, 0.266026, 2.012160, 0 
Linear 2 Backward: 3.276, second_gemm: 3.262
Linear 2 Backward: 3.501, second_gemm: 3.488
Linear 2 Backward: 3.439, second_gemm: 3.426
Linear 2 Backward: 3.834, second_gemm: 3.821
GA, 0.070175, 1.447936, 0 
GA, 0.133065, 1.604608, 0 
GA, 0.144531, 1.635328, 0 
GA, 0.266026, 2.187264, 0 
perpare first backward gemm: 0.039,  fisrt gemm backward duration: 2.692,  weight grad: 1.556,  other: 0.479
Linear 1 Backward:  4.829
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 2.656,  weight grad: 1.55,  other: 0.448
Linear 1 Backward:  4.752
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 2.656,  weight grad: 1.57,  other: 0.447
Linear 1 Backward:  4.77
perpare first backward gemm: 0.043,  fisrt gemm backward duration: 2.257,  weight grad: 1.806,  other: 0.449
Linear 1 Backward:  4.616
STEP-16: step_time = 21.548031 ms, foward_time = 10.014719, backward_time = 11.431936, perf = 38.27 tflops.
start
start
start
start
block_info 228 16
block_info 248 33
block_info 312 83
block_info 256 37
cuda:0 process time:3.488302230834961, a: 0.7445812225341797, b: 1.2140274047851562, c: 0.07700920104980469, d: 1.4526844024658203
cuda:1 process time:3.7927627563476562, a: 0.8223056793212891, b: 1.0991096496582031, c: 0.07486343383789062, d: 1.7964839935302734
cuda:2 process time:3.9703845977783203, a: 0.6949901580810547, b: 1.4653205871582031, c: 0.07748603820800781, d: 1.7325878143310547
0 wait time: 1.928
228
cuda:3 process time:4.033565521240234, a: 0.7081031799316406, b: 1.1038780212402344, c: 0.10251998901367188, d: 2.1190643310546875
2 wait time: 2.168
1 wait time: 1.783
248
312
3 wait time: 2.16
256
AG, 0.070175, 1.781760, 0 
perpare first forward gemm: 0.279,  fisrt gemm forward duration: 2.268
AG, 0.133065, 1.839104, 0 
perpare first forward gemm: 0.305,  fisrt gemm forward duration: 2.075
AG, 0.144531, 1.808384, 0 
perpare first forward gemm: 0.288,  fisrt gemm forward duration: 1.875
AG, 0.266026, 2.018304, 0 
perpare first forward gemm: 0.323,  fisrt gemm forward duration: 2.179
GA, 0.070175, 1.443840, 0 
GA, 0.133065, 1.570816, 0 
GA, 0.144531, 1.737728, 0 
GA, 0.266026, 2.258944, 0 
forward:  7.038
forward:  6.818
forward:  7.021
forward:  7.249
AG, 0.144531, 1.821696, 0 
AG, 0.133065, 1.826816, 0 
AG, 0.070175, 1.763328, 0 
AG, 0.266026, 1.997824, 0 
Linear 2 Backward: 3.274, second_gemm: 3.261
Linear 2 Backward: 3.63, second_gemm: 3.617
Linear 2 Backward: 3.605, second_gemm: 3.593
Linear 2 Backward: 3.816, second_gemm: 3.803
GA, 0.070175, 1.494016, 0 
GA, 0.144531, 1.659904, 0 
GA, 0.133065, 1.643520, 0 
GA, 0.266026, 2.198528, 0 
perpare first backward gemm: 0.04,  fisrt gemm backward duration: 2.719,  weight grad: 1.556,  other: 0.465
Linear 1 Backward:  4.841
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 2.692,  weight grad: 1.553,  other: 0.469
Linear 1 Backward:  4.812
perpare first backward gemm: 0.034,  fisrt gemm backward duration: 2.718,  weight grad: 1.542,  other: 0.417
Linear 1 Backward:  4.756
perpare first backward gemm: 0.046,  fisrt gemm backward duration: 2.273,  weight grad: 1.83,  other: 0.451
Linear 1 Backward:  4.664
STEP-17: step_time = 21.630015 ms, foward_time = 10.030144, backward_time = 11.500544, perf = 38.12 tflops.
start
start
start
start
block_info 228 16
block_info 312 83
block_info 256 37
block_info 248 33
cuda:0 process time:3.492593765258789, a: 0.7448196411132812, b: 1.2068748474121094, c: 0.08988380432128906, d: 1.4510154724121094
cuda:2 process time:3.8487911224365234, a: 0.6883144378662109, b: 1.2772083282470703, c: 0.07677078247070312, d: 1.806497573852539
2 wait time: 1.742
312
cuda:3 process time:4.294872283935547, a: 0.698089599609375, b: 1.4238357543945312, c: 0.09322166442871094, d: 2.0797252655029297
0 wait time: 1.994
228
cuda:1 process time:4.23741340637207, a: 0.7724761962890625, b: 1.148223876953125, c: 0.09489059448242188, d: 2.221822738647461
3 wait time: 2.197
256
1 wait time: 2.391
248
AG, 0.144531, 1.814528, 0 
perpare first forward gemm: 0.27,  fisrt gemm forward duration: 2.159
AG, 0.070175, 1.776640, 0 
perpare first forward gemm: 0.279,  fisrt gemm forward duration: 2.48
AG, 0.133065, 1.829888, 0 
perpare first forward gemm: 0.286,  fisrt gemm forward duration: 1.896
AG, 0.266026, 2.011136, 0 
perpare first forward gemm: 0.322,  fisrt gemm forward duration: 2.727
GA, 0.070175, 1.460224, 0 
GA, 0.144531, 1.603584, 0 
GA, 0.133065, 1.591296, 0 
GA, 0.266026, 2.169856, 0 
forward:  6.721
forward:  7.351
forward:  7.408
forward:  6.994
AG, 0.070175, 1.792000, 0 
AG, 0.133065, 1.852416, 0 
AG, 0.144531, 1.797120, 0 
AG, 0.266026, 2.028544, 0 
Linear 2 Backward: 3.321, second_gemm: 3.312
Linear 2 Backward: 3.301, second_gemm: 3.288
Linear 2 Backward: 3.33, second_gemm: 3.316
Linear 2 Backward: 3.663, second_gemm: 3.65
GA, 0.070175, 1.490944, 0 
GA, 0.144531, 1.680384, 0 
GA, 0.133065, 1.642496, 0 
GA, 0.266026, 2.190336, 0 
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 2.639,  weight grad: 1.553,  other: 0.445
Linear 1 Backward:  4.736
perpare first backward gemm: 0.041,  fisrt gemm backward duration: 2.634,  weight grad: 1.555,  other: 0.465
Linear 1 Backward:  4.755
perpare first backward gemm: 0.028,  fisrt gemm backward duration: 2.78,  weight grad: 1.554,  other: 0.421
Linear 1 Backward:  4.827
perpare first backward gemm: 0.044,  fisrt gemm backward duration: 2.256,  weight grad: 1.816,  other: 0.452
Linear 1 Backward:  4.632
STEP-18: step_time = 21.604287 ms, foward_time = 10.277824, backward_time = 11.225088, perf = 38.17 tflops.
start
start
start
start
block_info 312 83
block_info 228 16
block_info 248 33
block_info 256 37
cuda:1 process time:3.706693649291992, a: 0.7381439208984375, b: 1.15966796875, c: 0.07367134094238281, d: 1.7352104187011719
cuda:0 process time:3.553152084350586, a: 0.743865966796875, b: 1.1889934539794922, c: 0.080108642578125, d: 1.5401840209960938
cuda:2 process time:3.7965774536132812, a: 0.6728172302246094, b: 1.2657642364501953, c: 0.07200241088867188, d: 1.7859935760498047
2 wait time: 1.763
312
1 wait time: 1.783
248
0 wait time: 2.129
228
cuda:3 process time:4.272699356079102, a: 0.6880760192871094, b: 1.3418197631835938, c: 0.0934600830078125, d: 2.149343490600586
3 wait time: 2.15
256
AG, 0.070175, 1.772544, 0 
perpare first forward gemm: 0.274,  fisrt gemm forward duration: 2.197
AG, 0.133065, 1.828864, 0 
perpare first forward gemm: 0.282,  fisrt gemm forward duration: 2.329
AG, 0.144531, 1.825792, 0 
perpare first forward gemm: 0.305,  fisrt gemm forward duration: 1.9
AG, 0.266026, 2.036736, 0 
perpare first forward gemm: 0.319,  fisrt gemm forward duration: 2.595
GA, 0.070175, 1.418240, 0 
GA, 0.133065, 1.585152, 0 
GA, 0.144531, 1.712128, 0 
GA, 0.266026, 2.288640, 0 
forward:  6.877
forward:  7.266
forward:  7.188
forward:  7.364
AG, 0.144531, 1.813504, 0 
AG, 0.133065, 1.830912, 0 
AG, 0.266026, 2.034688, 0 
AG, 0.070175, 2.421760, 0 
Linear 2 Backward: 3.633, second_gemm: 3.62
Linear 2 Backward: 3.417, second_gemm: 3.404
Linear 2 Backward: 3.765, second_gemm: 3.752
Linear 2 Backward: 4.015, second_gemm: 4.001
GA, 0.144531, 1.601536, 0 
GA, 0.133065, 1.587200, 0 
GA, 0.070175, 1.432576, 0 
GA, 0.266026, 2.194432, 0 
perpare first backward gemm: 0.035,  fisrt gemm backward duration: 2.653,  weight grad: 1.545,  other: 0.441
Linear 1 Backward:  4.731
perpare first backward gemm: 0.041,  fisrt gemm backward duration: 1.874,  weight grad: 1.563,  other: 0.466
Linear 1 Backward:  4.024
perpare first backward gemm: 0.035,  fisrt gemm backward duration: 2.663,  weight grad: 1.565,  other: 0.439
Linear 1 Backward:  4.76
perpare first backward gemm: 0.039,  fisrt gemm backward duration: 2.277,  weight grad: 1.814,  other: 0.445
Linear 1 Backward:  4.633
STEP-19: step_time = 21.577152 ms, foward_time = 10.242496, backward_time = 11.233280, perf = 38.22 tflops.
start
start
start
start
block_info 256 37
cuda:3 process time:4.225015640258789, a: 0.6573200225830078, b: 2.0940303802490234, c: 0.057697296142578125, d: 1.4159679412841797
block_info 228 16
block_info 312 83
3 wait time: 1.362
256
cuda:2 process time:4.805088043212891, a: 0.5996227264404297, b: 2.249002456665039, c: 0.07510185241699219, d: 1.8813610076904297
block_info 248 33
cuda:0 process time:3.73077392578125, a: 0.7567405700683594, b: 1.1982917785644531, c: 0.10991096496582031, d: 1.6658306121826172
2 wait time: 1.913
312
0 wait time: 2.159
228
cuda:1 process time:5.183219909667969, a: 0.7512569427490234, b: 2.2346973419189453, c: 0.09655952453613281, d: 2.100706100463867
1 wait time: 2.665
248
AG, 0.144531, 1.810432, 0 
perpare first forward gemm: 0.284,  fisrt gemm forward duration: 3.082
AG, 0.070175, 1.782784, 0 
perpare first forward gemm: 0.272,  fisrt gemm forward duration: 2.403
AG, 0.133065, 1.826816, 0 
perpare first forward gemm: 0.285,  fisrt gemm forward duration: 1.89
AG, 0.266026, 2.006016, 0 
perpare first forward gemm: 0.318,  fisrt gemm forward duration: 2.746
GA, 0.070175, 1.469440, 0 
GA, 0.133065, 1.615872, 0 
GA, 0.144531, 1.756160, 0 
GA, 0.266026, 2.216960, 0 
forward:  7.921
forward:  7.449
forward:  6.747
forward:  7.284
AG, 0.144531, 1.815552, 0 
AG, 0.133065, 1.833984, 0 
AG, 0.070175, 1.755136, 0 
AG, 0.266026, 2.011136, 0 
Linear 2 Backward: 3.271, second_gemm: 3.258
Linear 2 Backward: 3.571, second_gemm: 3.557
Linear 2 Backward: 3.471, second_gemm: 3.457
Linear 2 Backward: 3.832, second_gemm: 3.818
GA, 0.070175, 1.425408, 0 
GA, 0.133065, 1.574912, 0 
GA, 0.144531, 1.655808, 0 
GA, 0.266026, 2.169856, 0 
perpare first backward gemm: 0.039,  fisrt gemm backward duration: 2.584,  weight grad: 1.557,  other: 0.446
Linear 1 Backward:  4.687
perpare first backward gemm: 0.04,  fisrt gemm backward duration: 2.663,  weight grad: 1.574,  other: 0.475
Linear 1 Backward:  4.807
perpare first backward gemm: 0.049,  fisrt gemm backward duration: 2.606,  weight grad: 1.578,  other: 0.448
Linear 1 Backward:  4.728
perpare first backward gemm: 0.041,  fisrt gemm backward duration: 2.235,  weight grad: 1.802,  other: 0.409
Linear 1 Backward:  4.534
STEP-20: step_time = 21.727967 ms, foward_time = 10.570464, backward_time = 11.054080, perf = 37.95 tflops.
start
start
start
start
block_info 228 16
block_info 248 33
block_info 256 37
block_info 312 83
cuda:1 process time:3.4766197204589844, a: 0.7281303405761719, b: 1.03759765625, c: 0.07128715515136719, d: 1.6396045684814453
cuda:0 process time:3.403902053833008, a: 0.7221698760986328, b: 1.169443130493164, c: 0.07915496826171875, d: 1.4331340789794922
cuda:3 process time:3.6139488220214844, a: 0.6933212280273438, b: 1.2030601501464844, c: 0.07152557373046875, d: 1.6460418701171875
cuda:2 process time:3.7889480590820312, a: 0.6785392761230469, b: 1.1649131774902344, c: 0.0762939453125, d: 1.86920166015625
3 wait time: 1.678
256
1 wait time: 1.772
248
0 wait time: 1.944
228
2 wait time: 1.911
312
AG, 0.133065, 1.819648, 0 
perpare first forward gemm: 0.279,  fisrt gemm forward duration: 2.028
AG, 0.070175, 1.772544, 0 
perpare first forward gemm: 0.268,  fisrt gemm forward duration: 1.971
AG, 0.144531, 1.843200, 0 
perpare first forward gemm: 0.277,  fisrt gemm forward duration: 2.166
AG, 0.266026, 1.996800, 0 
perpare first forward gemm: 0.312,  fisrt gemm forward duration: 2.058
GA, 0.070175, 1.469440, 0 
GA, 0.133065, 1.619968, 0 
GA, 0.144531, 1.690624, 0 
GA, 0.266026, 2.244608, 0 
forward:  6.954
forward:  6.858
forward:  6.843
forward:  6.743
AG, 0.144531, 1.808384, 0 
AG, 0.133065, 1.832960, 0 
AG, 0.070175, 1.763328, 0 
AG, 0.266026, 1.990656, 0 
Linear 2 Backward: 3.255, second_gemm: 3.243
Linear 2 Backward: 3.532, second_gemm: 3.52
Linear 2 Backward: 3.383, second_gemm: 3.371
Linear 2 Backward: 3.76, second_gemm: 3.747
GA, 0.070175, 1.498112, 0 
GA, 0.144531, 1.609728, 0 
GA, 0.133065, 1.635328, 0 
GA, 0.266026, 2.191360, 0 
perpare first backward gemm: 0.033,  fisrt gemm backward duration: 2.647,  weight grad: 1.56,  other: 0.45
Linear 1 Backward:  4.745
perpare first backward gemm: 0.033,  fisrt gemm backward duration: 2.618,  weight grad: 1.545,  other: 0.467
Linear 1 Backward:  4.718
perpare first backward gemm: 0.037,  fisrt gemm backward duration: 2.641,  weight grad: 1.555,  other: 0.459
Linear 1 Backward:  4.749
perpare first backward gemm: 0.038,  fisrt gemm backward duration: 2.254,  weight grad: 1.799,  other: 0.435
Linear 1 Backward:  4.582
STEP-21: step_time = 20.932353 ms, foward_time = 9.741056, backward_time = 11.089920, perf = 39.40 tflops.
start
start
start
start
block_info 256 37
cuda:3 process time:3.6950111389160156, a: 0.6773471832275391, b: 1.4553070068359375, c: 0.07367134094238281, d: 1.4886856079101562
block_info 248 33
block_info 312 83
block_info 228 16
3 wait time: 1.982
256
cuda:2 process time:4.315614700317383, a: 0.6093978881835938, b: 1.3225078582763672, c: 0.0934600830078125, d: 2.2902488708496094
cuda:0 process time:4.230022430419922, a: 0.7529258728027344, b: 1.415252685546875, c: 0.11301040649414062, d: 1.9488334655761719
cuda:1 process time:4.450798034667969, a: 0.7810592651367188, b: 1.2619495391845703, c: 0.095367431640625, d: 2.3124217987060547
2 wait time: 2.396
312
1 wait time: 2.451
248
0 wait time: 2.491
228
AG, 0.133065, 1.833984, 0 
perpare first forward gemm: 0.282,  fisrt gemm forward duration: 1.898
AG, 0.144531, 1.807360, 0 
perpare first forward gemm: 0.276,  fisrt gemm forward duration: 2.576
AG, 0.070175, 1.767424, 0 
perpare first forward gemm: 0.275,  fisrt gemm forward duration: 1.834
AG, 0.266026, 2.037760, 0 
perpare first forward gemm: 0.321,  fisrt gemm forward duration: 2.175
GA, 0.070175, 1.447936, 0 
GA, 0.144531, 1.606656, 0 
GA, 0.133065, 1.592320, 0 
GA, 0.266026, 2.184192, 0 
forward:  6.734
forward:  6.736
forward:  6.856
forward:  7.537
AG, 0.070175, 1.781760, 0 
AG, 0.133065, 1.840128, 0 
AG, 0.144531, 1.828864, 0 
AG, 0.266026, 2.056192, 0 
Linear 2 Backward: 3.602, second_gemm: 3.59
Linear 2 Backward: 3.28, second_gemm: 3.267
Linear 2 Backward: 3.387, second_gemm: 3.374
Linear 2 Backward: 3.812, second_gemm: 3.8
GA, 0.070175, 1.477632, 0 
GA, 0.144531, 1.673216, 0 
GA, 0.133065, 1.669120, 0 
GA, 0.266026, 2.215936, 0 
perpare first backward gemm: 0.035,  fisrt gemm backward duration: 2.679,  weight grad: 1.554,  other: 0.44
Linear 1 Backward:  4.765
perpare first backward gemm: 0.043,  fisrt gemm backward duration: 2.62,  weight grad: 1.56,  other: 0.468
Linear 1 Backward:  4.762
perpare first backward gemm: 0.034,  fisrt gemm backward duration: 2.663,  weight grad: 1.569,  other: 0.442
Linear 1 Backward:  4.768
perpare first backward gemm: 0.038,  fisrt gemm backward duration: 2.27,  weight grad: 1.806,  other: 0.424
Linear 1 Backward:  4.583
STEP-22: step_time = 21.407647 ms, foward_time = 10.208160, backward_time = 11.099136, perf = 38.52 tflops.
start
start
start
block_info 228 16
block_info 256 37
block_info 312 83
cuda:0 process time:3.7724971771240234, a: 0.7352828979492188, b: 1.2743473052978516, c: 0.09894371032714844, d: 1.6639232635498047
0 wait time: 2.171
228
cuda:3 process time:4.148960113525391, a: 0.6530284881591797, b: 1.1670589447021484, c: 0.14662742614746094, d: 2.1822452545166016
cuda:2 process time:4.648447036743164, a: 0.6456375122070312, b: 1.6357898712158203, c: 0.09512901306152344, d: 2.271890640258789
3 wait time: 2.02
256
2 wait time: 2.354
312
start
block_info 248 33
cuda:1 process time:8.026599884033203, a: 0.7505416870117188, b: 1.2128353118896484, c: 0.0743865966796875, d: 5.988836288452148
1 wait time: 1.935
248
AG, 0.070175, 1.781760, 0 
perpare first forward gemm: 0.273,  fisrt gemm forward duration: 5.934
AG, 0.144531, 1.808384, 0 
perpare first forward gemm: 0.306,  fisrt gemm forward duration: 5.522
AG, 0.133065, 1.817600, 0 
perpare first forward gemm: 0.272,  fisrt gemm forward duration: 1.876
AG, 0.266026, 2.033664, 0 
perpare first forward gemm: 0.321,  fisrt gemm forward duration: 5.681
GA, 0.070175, 1.442816, 0 
GA, 0.133065, 1.573888, 0 
GA, 0.144531, 1.651712, 0 
GA, 0.266026, 2.198528, 0 
forward:  10.362
forward:  10.302
forward:  6.667
forward:  10.745
AG, 0.133065, 1.832960, 0 
AG, 0.144531, 1.808384, 0 
AG, 0.070175, 1.752064, 0 
AG, 0.266026, 2.039808, 0 
Linear 2 Backward: 3.173, second_gemm: 3.165
Linear 2 Backward: 3.569, second_gemm: 3.561
Linear 2 Backward: 3.2, second_gemm: 3.192
Linear 2 Backward: 3.672, second_gemm: 3.657
GA, 0.070175, 1.435648, 0 
GA, 0.133065, 1.589248, 0 
GA, 0.144531, 1.631232, 0 
GA, 0.266026, 2.213888, 0 
perpare first backward gemm: 0.026,  fisrt gemm backward duration: 2.935,  weight grad: 1.526,  other: 0.423
Linear 1 Backward:  4.948
perpare first backward gemm: 0.024,  fisrt gemm backward duration: 2.899,  weight grad: 1.544,  other: 0.408
Linear 1 Backward:  4.912
perpare first backward gemm: 0.025,  fisrt gemm backward duration: 2.872,  weight grad: 1.528,  other: 0.41
Linear 1 Backward:  4.871
perpare first backward gemm: 0.048,  fisrt gemm backward duration: 2.305,  weight grad: 1.824,  other: 0.457
Linear 1 Backward:  4.731
STEP-23: step_time = 25.164161 ms, foward_time = 13.883777, backward_time = 11.180032, perf = 32.77 tflops.
start
start
start
start
block_info 248 33
cuda:1 process time:2.9070377349853516, a: 0.7171630859375, b: 1.1026859283447266, c: 0.05412101745605469, d: 1.0330677032470703
block_info 228 16
block_info 312 83
block_info 256 37
1 wait time: 1.482
248
cuda:0 process time:3.7124156951904297, a: 0.6799697875976562, b: 1.1646747589111328, c: 0.07605552673339844, d: 1.7917156219482422
cuda:2 process time:4.00996208190918, a: 0.7686614990234375, b: 1.5177726745605469, c: 0.08940696716308594, d: 1.6341209411621094
cuda:3 process time:3.8492679595947266, a: 0.7710456848144531, b: 1.1348724365234375, c: 0.0762939453125, d: 1.867055892944336
3 wait time: 1.575
256
0 wait time: 1.57
228
2 wait time: 2.007
312
AG, 0.133065, 1.828864, 0 
perpare first forward gemm: 0.259,  fisrt gemm forward duration: 2.776
AG, 0.070175, 1.799168, 0 
perpare first forward gemm: 0.295,  fisrt gemm forward duration: 1.979
AG, 0.144531, 1.841152, 0 
perpare first forward gemm: 0.31,  fisrt gemm forward duration: 2.048
AG, 0.266026, 2.037760, 0 
perpare first forward gemm: 0.346,  fisrt gemm forward duration: 2.114
GA, 0.070175, 1.506304, 0 
GA, 0.133065, 1.647616, 0 
GA, 0.144531, 1.710080, 0 
GA, 0.266026, 2.254848, 0 
forward:  7.071
forward:  7.715
forward:  7.036
forward:  7.044
AG, 0.144531, 1.821696, 0 
AG, 0.133065, 1.833984, 0 
AG, 0.070175, 1.782784, 0 
AG, 0.266026, 2.016256, 0 
Linear 2 Backward: 3.372, second_gemm: 3.359
Linear 2 Backward: 3.367, second_gemm: 3.354
Linear 2 Backward: 3.466, second_gemm: 3.453
Linear 2 Backward: 3.628, second_gemm: 3.615
GA, 0.070175, 1.461248, 0 
GA, 0.133065, 1.632256, 0 
GA, 0.144531, 1.623040, 0 
GA, 0.266026, 2.177024, 0 
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 2.625,  weight grad: 1.578,  other: 0.443
Linear 1 Backward:  4.743
perpare first backward gemm: 0.04,  fisrt gemm backward duration: 2.615,  weight grad: 1.556,  other: 0.479
Linear 1 Backward:  4.752
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 2.577,  weight grad: 1.549,  other: 0.447
Linear 1 Backward:  4.67
perpare first backward gemm: 0.04,  fisrt gemm backward duration: 2.231,  weight grad: 1.789,  other: 0.41
Linear 1 Backward:  4.517
STEP-24: step_time = 20.775937 ms, foward_time = 9.579520, backward_time = 11.096064, perf = 39.69 tflops.
start
start
start
start
block_info 312 83
block_info 256 37
block_info 228 16
cuda:2 process time:3.72314453125, a: 0.6928443908691406, b: 1.1646747589111328, c: 0.08034706115722656, d: 1.7852783203125
cuda:0 process time:3.618001937866211, a: 0.7672309875488281, b: 1.0297298431396484, c: 0.08916854858398438, d: 1.73187255859375
cuda:3 process time:3.805875778198242, a: 0.720977783203125, b: 1.4128684997558594, c: 0.07748603820800781, d: 1.59454345703125
block_info 248 33
2 wait time: 1.829
312
0 wait time: 1.893
228
3 wait time: 2.093
256
cuda:1 process time:4.471302032470703, a: 0.7693767547607422, b: 1.4581680297851562, c: 0.09965896606445312, d: 2.1440982818603516
1 wait time: 2.714
248
AG, 0.070175, 1.780736, 0 
perpare first forward gemm: 0.281,  fisrt gemm forward duration: 2.768
AG, 0.144531, 1.818624, 0 
perpare first forward gemm: 0.29,  fisrt gemm forward duration: 2.738
AG, 0.133065, 1.820672, 0 
perpare first forward gemm: 0.289,  fisrt gemm forward duration: 1.888
AG, 0.266026, 2.013184, 0 
perpare first forward gemm: 0.323,  fisrt gemm forward duration: 3.049
GA, 0.133065, 1.561600, 0 
GA, 0.144531, 1.630208, 0 
GA, 0.070175, 1.431552, 0 
GA, 0.266026, 2.221056, 0 
forward:  6.818
forward:  7.787
forward:  7.698
forward:  7.677
AG, 0.133065, 1.847296, 0 
AG, 0.070175, 1.771520, 0 
AG, 0.144531, 1.811456, 0 
AG, 0.266026, 2.031616, 0 
Linear 2 Backward: 4.003, second_gemm: 3.99
Linear 2 Backward: 3.357, second_gemm: 3.343
Linear 2 Backward: 3.828, second_gemm: 3.815
Linear 2 Backward: 4.255, second_gemm: 4.245
GA, 0.070175, 1.489920, 0 
GA, 0.144531, 1.670144, 0 
GA, 0.133065, 1.670144, 0 
GA, 0.266026, 2.198528, 0 
perpare first backward gemm: 0.037,  fisrt gemm backward duration: 2.586,  weight grad: 1.569,  other: 0.463
Linear 1 Backward:  4.718
perpare first backward gemm: 0.042,  fisrt gemm backward duration: 2.534,  weight grad: 1.558,  other: 0.478
Linear 1 Backward:  4.679
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 2.554,  weight grad: 1.55,  other: 0.467
Linear 1 Backward:  4.672
perpare first backward gemm: 0.034,  fisrt gemm backward duration: 2.252,  weight grad: 1.799,  other: 0.435
Linear 1 Backward:  4.559
STEP-25: step_time = 21.897216 ms, foward_time = 10.894336, backward_time = 10.871808, perf = 37.66 tflops.
start
start
start
start
block_info 228 16
block_info 256 37
block_info 248 33
block_info 312 83
cuda:0 process time:3.4852027893066406, a: 0.7495880126953125, b: 1.1887550354003906, c: 0.07939338684082031, d: 1.4674663543701172
cuda:3 process time:4.174709320068359, a: 0.6856918334960938, b: 1.6911029815673828, c: 0.07653236389160156, d: 1.7213821411132812
cuda:1 process time:4.034757614135742, a: 0.7340908050537109, b: 1.5077590942382812, c: 0.07581710815429688, d: 1.7170906066894531
cuda:2 process time:4.3430328369140625, a: 0.7255077362060547, b: 1.5897750854492188, c: 0.07700920104980469, d: 1.9507408142089844
3 wait time: 1.767
256
0 wait time: 2.026
228
1 wait time: 1.801
248
2 wait time: 2.019
312
AG, 0.144531, 1.816576, 0 
perpare first forward gemm: 0.285,  fisrt gemm forward duration: 2.227
AG, 0.133065, 1.827840, 0 
perpare first forward gemm: 0.282,  fisrt gemm forward duration: 2.078
AG, 0.070175, 1.769472, 0 
perpare first forward gemm: 0.275,  fisrt gemm forward duration: 2.044
AG, 0.266026, 2.026496, 0 
perpare first forward gemm: 0.323,  fisrt gemm forward duration: 2.092
GA, 0.070175, 1.434624, 0 
GA, 0.133065, 1.612800, 0 
GA, 0.144531, 1.622016, 0 
GA, 0.266026, 2.252800, 0 
forward:  7.131
forward:  6.986
forward:  7.006
forward:  6.878
AG, 0.070175, 1.763328, 0 
AG, 0.144531, 1.825792, 0 
AG, 0.133065, 1.822720, 0 
AG, 0.266026, 2.027520, 0 
Linear 2 Backward: 3.415, second_gemm: 3.403
Linear 2 Backward: 3.305, second_gemm: 3.291
Linear 2 Backward: 3.35, second_gemm: 3.337
Linear 2 Backward: 3.726, second_gemm: 3.713
GA, 0.070175, 1.502208, 0 
GA, 0.144531, 1.611776, 0 
GA, 0.133065, 1.655808, 0 
GA, 0.266026, 2.197504, 0 
perpare first backward gemm: 0.04,  fisrt gemm backward duration: 2.636,  weight grad: 1.553,  other: 0.465
Linear 1 Backward:  4.755
perpare first backward gemm: 0.035,  fisrt gemm backward duration: 2.639,  weight grad: 1.564,  other: 0.441
Linear 1 Backward:  4.734
perpare first backward gemm: 0.035,  fisrt gemm backward duration: 2.653,  weight grad: 1.547,  other: 0.443
Linear 1 Backward:  4.736
perpare first backward gemm: 0.041,  fisrt gemm backward duration: 2.259,  weight grad: 1.829,  other: 0.446
Linear 1 Backward:  4.633
STEP-26: step_time = 21.290687 ms, foward_time = 10.079936, backward_time = 11.109376, perf = 38.73 tflops.
start
start
start
start
block_info 256 37
block_info 248 33
block_info 312 83
block_info 228 16
cuda:3 process time:3.823995590209961, a: 0.6048679351806641, b: 1.3988018035888672, c: 0.07677078247070312, d: 1.7435550689697266
cuda:1 process time:3.6110877990722656, a: 0.7162094116210938, b: 1.104593276977539, c: 0.07534027099609375, d: 1.714944839477539
cuda:2 process time:3.7255287170410156, a: 0.6814002990722656, b: 1.0797977447509766, c: 0.07581710815429688, d: 1.8885135650634766
3 wait time: 1.777
256
1 wait time: 1.842
248
2 wait time: 1.907
312
cuda:0 process time:3.995180130004883, a: 0.7457733154296875, b: 1.1775493621826172, c: 0.11348724365234375, d: 1.9583702087402344
0 wait time: 2.488
228
AG, 0.144531, 1.811456, 0 
perpare first forward gemm: 0.285,  fisrt gemm forward duration: 2.491
AG, 0.133065, 1.825792, 0 
perpare first forward gemm: 0.286,  fisrt gemm forward duration: 2.388
AG, 0.070175, 1.779712, 0 
perpare first forward gemm: 0.274,  fisrt gemm forward duration: 1.844
AG, 0.266026, 2.031616, 0 
perpare first forward gemm: 0.318,  fisrt gemm forward duration: 2.519
GA, 0.070175, 1.440768, 0 
GA, 0.133065, 1.610752, 0 
GA, 0.144531, 1.682432, 0 
GA, 0.266026, 2.207744, 0 
forward:  6.76
forward:  7.369
forward:  7.263
forward:  7.235
AG, 0.133065, 1.831936, 0 
AG, 0.070175, 1.770496, 0 
AG, 0.144531, 1.810432, 0 
AG, 0.266026, 2.048000, 0 
Linear 2 Backward: 3.515, second_gemm: 3.502
Linear 2 Backward: 3.28, second_gemm: 3.266
Linear 2 Backward: 3.388, second_gemm: 3.375
Linear 2 Backward: 3.756, second_gemm: 3.743
GA, 0.070175, 1.447936, 0 
GA, 0.133065, 1.633280, 0 
GA, 0.144531, 1.688576, 0 
GA, 0.266026, 2.198528, 0 
perpare first backward gemm: 0.039,  fisrt gemm backward duration: 2.7,  weight grad: 1.555,  other: 0.479
Linear 1 Backward:  4.835
perpare first backward gemm: 0.035,  fisrt gemm backward duration: 2.688,  weight grad: 1.568,  other: 0.44
Linear 1 Backward:  4.787
perpare first backward gemm: 0.034,  fisrt gemm backward duration: 2.673,  weight grad: 1.548,  other: 0.44
Linear 1 Backward:  4.753
perpare first backward gemm: 0.044,  fisrt gemm backward duration: 2.266,  weight grad: 1.813,  other: 0.459
Linear 1 Backward:  4.639
STEP-27: step_time = 21.413696 ms, foward_time = 10.200896, backward_time = 11.111424, perf = 38.51 tflops.
start
start
start
start
block_info 312 83
block_info 256 37
block_info 248 33
block_info 228 16
cuda:2 process time:3.985166549682617, a: 0.7159709930419922, b: 1.3048648834228516, c: 0.07271766662597656, d: 1.8916130065917969
2 wait time: 1.706
312
cuda:3 process time:4.053831100463867, a: 0.6895065307617188, b: 1.1892318725585938, c: 0.0934600830078125, d: 2.081632614135742
cuda:0 process time:3.9992332458496094, a: 0.7481575012207031, b: 1.195669174194336, c: 0.09870529174804688, d: 1.9567012786865234
cuda:1 process time:4.139423370361328, a: 0.743865966796875, b: 1.1272430419921875, c: 0.09560585021972656, d: 2.172708511352539
3 wait time: 2.199
256
0 wait time: 2.511
228
1 wait time: 2.3
248
AG, 0.070175, 1.773568, 0 
perpare first forward gemm: 0.274,  fisrt gemm forward duration: 1.904
AG, 0.144531, 1.812480, 0 
perpare first forward gemm: 0.281,  fisrt gemm forward duration: 2.042
AG, 0.133065, 1.835008, 0 
perpare first forward gemm: 0.281,  fisrt gemm forward duration: 1.898
AG, 0.266026, 2.002944, 0 
perpare first forward gemm: 0.318,  fisrt gemm forward duration: 2.651
GA, 0.070175, 1.457152, 0 
GA, 0.144531, 1.662976, 0 
GA, 0.133065, 1.599488, 0 
GA, 0.266026, 2.194432, 0 
forward:  6.761
forward:  6.891
forward:  6.71
forward:  7.331
AG, 0.133065, 1.828864, 0 
AG, 0.070175, 1.779712, 0 
AG, 0.144531, 1.820672, 0 
AG, 0.266026, 2.019328, 0 
Linear 2 Backward: 3.273, second_gemm: 3.26
Linear 2 Backward: 3.281, second_gemm: 3.269
Linear 2 Backward: 3.345, second_gemm: 3.331
Linear 2 Backward: 3.752, second_gemm: 3.739
GA, 0.070175, 1.523712, 0 
GA, 0.144531, 1.609728, 0 
GA, 0.133065, 1.656832, 0 
GA, 0.266026, 2.197504, 0 
perpare first backward gemm: 0.034,  fisrt gemm backward duration: 2.693,  weight grad: 1.523,  other: 0.411
Linear 1 Backward:  4.705
perpare first backward gemm: 0.039,  fisrt gemm backward duration: 2.689,  weight grad: 1.559,  other: 0.463
Linear 1 Backward:  4.809
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 2.672,  weight grad: 1.572,  other: 0.463
Linear 1 Backward:  4.805
perpare first backward gemm: 0.041,  fisrt gemm backward duration: 2.283,  weight grad: 1.82,  other: 0.449
Linear 1 Backward:  4.654
STEP-28: step_time = 21.464768 ms, foward_time = 10.141376, backward_time = 11.223040, perf = 38.42 tflops.
start
start
start
start
block_info 228 16
block_info 248 33
block_info 312 83
cuda:0 process time:3.5080909729003906, a: 0.7603168487548828, b: 1.2078285217285156, c: 0.0762939453125, d: 1.4636516571044922
cuda:1 process time:3.6809444427490234, a: 0.7390975952148438, b: 1.127004623413086, c: 0.07748603820800781, d: 1.737356185913086
block_info 256 37
cuda:2 process time:3.685474395751953, a: 0.7135868072509766, b: 1.0700225830078125, c: 0.07915496826171875, d: 1.8227100372314453
2 wait time: 1.868
312
0 wait time: 1.997
228
1 wait time: 1.886
248
cuda:3 process time:4.381656646728516, a: 0.5345344543457031, b: 1.6169548034667969, c: 0.09512901306152344, d: 2.135038375854492
3 wait time: 2.116
256
AG, 0.133065, 1.825792, 0 
perpare first forward gemm: 0.29,  fisrt gemm forward duration: 2.443
AG, 0.070175, 1.764352, 0 
perpare first forward gemm: 0.279,  fisrt gemm forward duration: 2.509
AG, 0.144531, 1.818624, 0 
perpare first forward gemm: 0.314,  fisrt gemm forward duration: 1.896
AG, 0.266026, 2.022400, 0 
perpare first forward gemm: 0.321,  fisrt gemm forward duration: 2.764
GA, 0.070175, 1.432576, 0 
GA, 0.133065, 1.600512, 0 
GA, 0.144531, 1.662976, 0 
GA, 0.266026, 2.331648, 0 
forward:  7.143
forward:  7.737
forward:  7.647
forward:  7.776
AG, 0.133065, 1.822720, 0 
AG, 0.144531, 1.815552, 0 
AG, 0.070175, 1.764352, 0 
AG, 0.266026, 2.018304, 0 
Linear 2 Backward: 3.308, second_gemm: 3.298
Linear 2 Backward: 3.512, second_gemm: 3.499
Linear 2 Backward: 3.3, second_gemm: 3.286
Linear 2 Backward: 3.645, second_gemm: 3.631
GA, 0.070175, 1.495040, 0 
GA, 0.133065, 1.647616, 0 
GA, 0.144531, 1.661952, 0 
GA, 0.266026, 2.191360, 0 
perpare first backward gemm: 0.028,  fisrt gemm backward duration: 2.76,  weight grad: 1.547,  other: 0.424
Linear 1 Backward:  4.806
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 2.666,  weight grad: 1.573,  other: 0.451
Linear 1 Backward:  4.789
perpare first backward gemm: 0.04,  fisrt gemm backward duration: 2.658,  weight grad: 1.557,  other: 0.466
Linear 1 Backward:  4.78
perpare first backward gemm: 0.042,  fisrt gemm backward duration: 2.259,  weight grad: 1.82,  other: 0.446
Linear 1 Backward:  4.629
STEP-29: step_time = 21.883201 ms, foward_time = 10.698048, backward_time = 11.085824, perf = 37.68 tflops.
start
start
start
start
block_info 256 37
block_info 228 16
block_info 312 83
cuda:3 process time:3.7593841552734375, a: 0.6763935089111328, b: 1.5256404876708984, c: 0.072479248046875, d: 1.4848709106445312
cuda:0 process time:3.438711166381836, a: 0.7195472717285156, b: 0.9949207305908203, c: 0.07414817810058594, d: 1.650094985961914
block_info 248 33
cuda:2 process time:4.1351318359375, a: 0.7071495056152344, b: 1.4524459838867188, c: 0.07581710815429688, d: 1.89971923828125
3 wait time: 1.966
256
0 wait time: 1.663
228
2 wait time: 1.921
312
cuda:1 process time:4.5013427734375, a: 0.7376670837402344, b: 1.3363361358642578, c: 0.09512901306152344, d: 2.3322105407714844
1 wait time: 2.46
248
AG, 0.070175, 1.772544, 0 
perpare first forward gemm: 0.272,  fisrt gemm forward duration: 2.6
AG, 0.133065, 1.826816, 0 
perpare first forward gemm: 0.282,  fisrt gemm forward duration: 1.892
AG, 0.144531, 1.943552, 0 
perpare first forward gemm: 0.274,  fisrt gemm forward duration: 2.9
AG, 0.266026, 2.021376, 0 
perpare first forward gemm: 0.319,  fisrt gemm forward duration: 2.721
GA, 0.070175, 1.440768, 0 
GA, 0.133065, 1.589248, 0 
GA, 0.144531, 1.696768, 0 
GA, 0.266026, 2.331648, 0 
forward:  6.859
forward:  7.623
forward:  7.537
forward:  7.749
AG, 0.070175, 1.765376, 0 
AG, 0.133065, 1.833984, 0 
AG, 0.144531, 1.807360, 0 
AG, 0.266026, 2.032640, 0 
Linear 2 Backward: 3.269, second_gemm: 3.256
Linear 2 Backward: 3.371, second_gemm: 3.357
Linear 2 Backward: 3.48, second_gemm: 3.467
Linear 2 Backward: 3.786, second_gemm: 3.774
GA, 0.070175, 1.441792, 0 
GA, 0.144531, 1.628160, 0 
GA, 0.133065, 1.616896, 0 
GA, 0.266026, 2.179072, 0 
perpare first backward gemm: 0.037,  fisrt gemm backward duration: 2.575,  weight grad: 1.553,  other: 0.443
Linear 1 Backward:  4.669
perpare first backward gemm: 0.035,  fisrt gemm backward duration: 2.654,  weight grad: 1.568,  other: 0.442
Linear 1 Backward:  4.744
perpare first backward gemm: 0.04,  fisrt gemm backward duration: 2.633,  weight grad: 1.559,  other: 0.469
Linear 1 Backward:  4.764
perpare first backward gemm: 0.04,  fisrt gemm backward duration: 2.246,  weight grad: 1.819,  other: 0.47
Linear 1 Backward:  4.634
STEP-30: step_time = 21.473279 ms, foward_time = 10.341377, backward_time = 11.031552, perf = 38.40 tflops.
start
start
start
start
block_info 228 16
block_info 256 37
block_info 248 33
cuda:0 process time:3.465414047241211, a: 0.7407665252685547, b: 1.0142326354980469, c: 0.07486343383789062, d: 1.6355514526367188
block_info 312 83
cuda:3 process time:3.730297088623047, a: 0.6585121154785156, b: 1.2977123260498047, c: 0.07152557373046875, d: 1.7025470733642578
cuda:1 process time:3.6797523498535156, a: 0.7352828979492188, b: 1.0859966278076172, c: 0.0743865966796875, d: 1.7840862274169922
3 wait time: 1.546
256
0 wait time: 1.778
228
1 wait time: 1.898
248
cuda:2 process time:4.235744476318359, a: 0.6287097930908203, b: 1.219034194946289, c: 0.0934600830078125, d: 2.2945404052734375
2 wait time: 2.369
312
AG, 0.144531, 1.810432, 0 
perpare first forward gemm: 0.306,  fisrt gemm forward duration: 2.472
AG, 0.070175, 1.781760, 0 
perpare first forward gemm: 0.273,  fisrt gemm forward duration: 2.455
AG, 0.133065, 1.826816, 0 
perpare first forward gemm: 0.283,  fisrt gemm forward duration: 2.328
AG, 0.266026, 2.033664, 0 
perpare first forward gemm: 0.326,  fisrt gemm forward duration: 2.096
GA, 0.070175, 1.437696, 0 
GA, 0.133065, 1.600512, 0 
GA, 0.144531, 1.660928, 0 
GA, 0.266026, 2.246656, 0 
forward:  7.436
forward:  7.237
forward:  6.85
forward:  7.402
AG, 0.144531, 1.825792, 0 
AG, 0.133065, 1.837056, 0 
AG, 0.070175, 1.839104, 0 
AG, 0.266026, 2.044928, 0 
Linear 2 Backward: 3.479, second_gemm: 3.466
Linear 2 Backward: 3.368, second_gemm: 3.356
Linear 2 Backward: 3.444, second_gemm: 3.432
Linear 2 Backward: 3.702, second_gemm: 3.69
GA, 0.133065, 1.594368, 0 
GA, 0.144531, 1.653760, 0 
GA, 0.070175, 1.423360, 0 
GA, 0.266026, 2.196480, 0 
perpare first backward gemm: 0.05,  fisrt gemm backward duration: 2.41,  weight grad: 1.56,  other: 0.479
Linear 1 Backward:  4.591
perpare first backward gemm: 0.035,  fisrt gemm backward duration: 2.664,  weight grad: 1.543,  other: 0.44
Linear 1 Backward:  4.74
perpare first backward gemm: 0.037,  fisrt gemm backward duration: 2.672,  weight grad: 1.568,  other: 0.44
Linear 1 Backward:  4.775
perpare first backward gemm: 0.041,  fisrt gemm backward duration: 2.264,  weight grad: 1.833,  other: 0.448
Linear 1 Backward:  4.644
STEP-31: step_time = 21.302271 ms, foward_time = 10.144768, backward_time = 11.058176, perf = 38.71 tflops.
start
start
start
start
block_info 256 37
block_info 228 16
block_info 248 33
cuda:3 process time:4.239559173583984, a: 0.7009506225585938, b: 1.814126968383789, c: 0.07724761962890625, d: 1.6472339630126953
block_info 312 83
cuda:0 process time:3.784656524658203, a: 0.7472038269042969, b: 1.1317729949951172, c: 0.07867813110351562, d: 1.8270015716552734
3 wait time: 2.134
256
cuda:1 process time:4.59599494934082, a: 0.6158351898193359, b: 2.0318031311035156, c: 0.08559226989746094, d: 1.8627643585205078
0 wait time: 1.983
228
cuda:2 process time:4.88734245300293, a: 0.6570816040039062, b: 1.8663406372070312, c: 0.0934600830078125, d: 2.2704601287841797
1 wait time: 2.422
248
2 wait time: 2.396
312
AG, 0.133065, 1.831936, 0 
perpare first forward gemm: 0.282,  fisrt gemm forward duration: 2.072
AG, 0.070175, 1.767424, 0 
perpare first forward gemm: 0.274,  fisrt gemm forward duration: 2.385
AG, 0.144531, 1.813504, 0 
perpare first forward gemm: 0.284,  fisrt gemm forward duration: 2.518
AG, 0.266026, 2.034688, 0 
perpare first forward gemm: 0.324,  fisrt gemm forward duration: 2.1
GA, 0.070175, 1.418240, 0 
GA, 0.144531, 1.601536, 0 
GA, 0.133065, 1.595392, 0 
GA, 0.266026, 2.199552, 0 
forward:  7.406
forward:  6.919
forward:  6.807
forward:  7.317
AG, 0.133065, 1.835008, 0 
AG, 0.144531, 1.804288, 0 
AG, 0.070175, 1.771520, 0 
AG, 0.266026, 2.050048, 0 
Linear 2 Backward: 3.282, second_gemm: 3.268
Linear 2 Backward: 3.816, second_gemm: 3.803
Linear 2 Backward: 3.756, second_gemm: 3.744
Linear 2 Backward: 3.927, second_gemm: 3.913
GA, 0.070175, 1.482752, 0 
GA, 0.133065, 1.656832, 0 
GA, 0.144531, 1.620992, 0 
GA, 0.266026, 2.197504, 0 
perpare first backward gemm: 0.04,  fisrt gemm backward duration: 2.734,  weight grad: 1.558,  other: 0.463
Linear 1 Backward:  4.843
perpare first backward gemm: 0.05,  fisrt gemm backward duration: 2.691,  weight grad: 1.571,  other: 0.411
Linear 1 Backward:  4.772
perpare first backward gemm: 0.034,  fisrt gemm backward duration: 2.727,  weight grad: 1.552,  other: 0.453
Linear 1 Backward:  4.81
perpare first backward gemm: 0.046,  fisrt gemm backward duration: 2.266,  weight grad: 1.821,  other: 0.413
Linear 1 Backward:  4.595
STEP-32: step_time = 21.738497 ms, foward_time = 10.385407, backward_time = 11.236352, perf = 37.93 tflops.
start
start
start
start
block_info 312 83
block_info 248 33
block_info 228 16
block_info 256 37
cuda:2 process time:3.6728382110595703, a: 0.6814002990722656, b: 1.3022422790527344, c: 0.07271766662597656, d: 1.6164779663085938
cuda:1 process time:3.6983489990234375, a: 0.7226467132568359, b: 1.041412353515625, c: 0.07486343383789062, d: 1.859426498413086
2 wait time: 1.981
312
cuda:0 process time:3.9958953857421875, a: 0.7658004760742188, b: 1.0616779327392578, c: 0.09560585021972656, d: 2.0728111267089844
cuda:3 process time:4.024744033813477, a: 0.7240772247314453, b: 1.2598037719726562, c: 0.09489059448242188, d: 1.9459724426269531
1 wait time: 1.793
248
3 wait time: 2.382
256
0 wait time: 2.206
228
AG, 0.133065, 1.832960, 0 
perpare first forward gemm: 0.279,  fisrt gemm forward duration: 2.279
AG, 0.144531, 1.812480, 0 
perpare first forward gemm: 0.28,  fisrt gemm forward duration: 1.896
AG, 0.070175, 1.782784, 0 
perpare first forward gemm: 0.279,  fisrt gemm forward duration: 1.846
AG, 0.266026, 2.021376, 0 
perpare first forward gemm: 0.306,  fisrt gemm forward duration: 2.622
GA, 0.070175, 1.453056, 0 
GA, 0.133065, 1.604608, 0 
GA, 0.144531, 1.646592, 0 
GA, 0.266026, 2.257920, 0 
forward:  7.123
forward:  6.828
forward:  7.318
forward:  6.77
AG, 0.144531, 1.814528, 0 
AG, 0.133065, 1.820672, 0 
AG, 0.070175, 1.760256, 0 
AG, 0.266026, 2.032640, 0 
Linear 2 Backward: 3.415, second_gemm: 3.404
Linear 2 Backward: 3.681, second_gemm: 3.669
Linear 2 Backward: 3.384, second_gemm: 3.372
Linear 2 Backward: 3.608, second_gemm: 3.596
GA, 0.070175, 1.414144, 0 
GA, 0.144531, 1.616896, 0 
GA, 0.133065, 1.626112, 0 
GA, 0.266026, 2.162688, 0 
perpare first backward gemm: 0.033,  fisrt gemm backward duration: 2.704,  weight grad: 1.532,  other: 0.425
Linear 1 Backward:  4.74
perpare first backward gemm: 0.033,  fisrt gemm backward duration: 2.655,  weight grad: 1.565,  other: 0.436
Linear 1 Backward:  4.733
perpare first backward gemm: 0.033,  fisrt gemm backward duration: 2.655,  weight grad: 1.56,  other: 0.447
Linear 1 Backward:  4.739
perpare first backward gemm: 0.043,  fisrt gemm backward duration: 2.227,  weight grad: 1.812,  other: 0.416
Linear 1 Backward:  4.543
STEP-33: step_time = 21.090304 ms, foward_time = 9.949184, backward_time = 11.039744, perf = 39.10 tflops.
start
start
start
start
block_info 228 16
block_info 256 37
block_info 312 83
cuda:0 process time:3.4554004669189453, a: 0.7166862487792969, b: 1.188516616821289, c: 0.07653236389160156, d: 1.4736652374267578
block_info 248 33
0 wait time: 1.98
228
cuda:2 process time:4.0454864501953125, a: 0.5919933319091797, b: 1.461029052734375, c: 0.07104873657226562, d: 1.9214153289794922
cuda:3 process time:4.190921783447266, a: 0.7071495056152344, b: 1.2810230255126953, c: 0.0972747802734375, d: 2.1054744720458984
2 wait time: 1.487
312
cuda:1 process time:4.298686981201172, a: 0.7426738739013672, b: 1.3735294342041016, c: 0.10085105895996094, d: 2.081632614135742
3 wait time: 2.272
256
1 wait time: 2.659
248
AG, 0.070175, 1.772544, 0 
perpare first forward gemm: 0.268,  fisrt gemm forward duration: 2.679
AG, 0.144531, 1.811456, 0 
perpare first forward gemm: 0.282,  fisrt gemm forward duration: 2.232
AG, 0.133065, 1.821696, 0 
perpare first forward gemm: 0.281,  fisrt gemm forward duration: 1.883
AG, 0.266026, 2.007040, 0 
perpare first forward gemm: 0.341,  fisrt gemm forward duration: 2.513
GA, 0.070175, 1.424384, 0 
GA, 0.133065, 1.605632, 0 
GA, 0.144531, 1.620992, 0 
GA, 0.266026, 2.203648, 0 
forward:  6.793
forward:  7.143
forward:  7.337
forward:  7.631
AG, 0.144531, 1.817600, 0 
AG, 0.133065, 1.828864, 0 
AG, 0.070175, 1.768448, 0 
AG, 0.266026, 2.024448, 0 
Linear 2 Backward: 3.773, second_gemm: 3.761
Linear 2 Backward: 3.308, second_gemm: 3.293
Linear 2 Backward: 3.479, second_gemm: 3.466
Linear 2 Backward: 4.021, second_gemm: 4.009
GA, 0.144531, 1.593344, 0 
GA, 0.070175, 1.494016, 0 
GA, 0.133065, 1.680384, 0 
GA, 0.266026, 2.192384, 0 
perpare first backward gemm: 0.034,  fisrt gemm backward duration: 2.65,  weight grad: 1.55,  other: 0.44
Linear 1 Backward:  4.72
perpare first backward gemm: 0.034,  fisrt gemm backward duration: 2.675,  weight grad: 1.569,  other: 0.411
Linear 1 Backward:  4.733
perpare first backward gemm: 0.041,  fisrt gemm backward duration: 2.644,  weight grad: 1.56,  other: 0.473
Linear 1 Backward:  4.768
perpare first backward gemm: 0.042,  fisrt gemm backward duration: 2.261,  weight grad: 1.818,  other: 0.415
Linear 1 Backward:  4.582
STEP-34: step_time = 21.801600 ms, foward_time = 10.525312, backward_time = 11.173888, perf = 37.82 tflops.
start
start
start
start
block_info 256 37
cuda:3 process time:3.055572509765625, a: 0.5154609680175781, b: 1.3155937194824219, c: 0.04887580871582031, d: 1.1756420135498047
block_info 312 83
block_info 248 33
3 wait time: 1.057
256
cuda:2 process time:3.569364547729492, a: 0.6475448608398438, b: 1.1751651763916016, c: 0.06961822509765625, d: 1.6770362854003906
cuda:1 process time:3.6482810974121094, a: 0.728607177734375, b: 1.0652542114257812, c: 0.07486343383789062, d: 1.7795562744140625
block_info 228 16
2 wait time: 1.542
312
1 wait time: 1.976
248
cuda:0 process time:4.192590713500977, a: 0.7803440093994141, b: 1.1899471282958984, c: 0.09679794311523438, d: 2.1255016326904297
0 wait time: 2.71
228
AG, 0.133065, 1.831936, 0 
perpare first forward gemm: 0.278,  fisrt gemm forward duration: 2.419
AG, 0.144531, 1.805312, 0 
perpare first forward gemm: 0.279,  fisrt gemm forward duration: 3.256
AG, 0.070175, 1.770496, 0 
perpare first forward gemm: 0.268,  fisrt gemm forward duration: 1.825
AG, 0.266026, 2.016256, 0 
perpare first forward gemm: 0.315,  fisrt gemm forward duration: 2.973
GA, 0.070175, 1.441792, 0 
GA, 0.144531, 1.686528, 0 
GA, 0.266026, 2.173952, 0 
GA, 0.133065, 3.117056, 0 
forward:  8.752
forward:  7.362
forward:  8.313
forward:  7.948
AG, 0.144531, 1.811456, 0 
AG, 0.070175, 1.764352, 0 
AG, 0.133065, 1.830912, 0 
AG, 0.266026, 2.031616, 0 
Linear 2 Backward: 3.224, second_gemm: 3.214
Linear 2 Backward: 3.548, second_gemm: 3.535
Linear 2 Backward: 3.312, second_gemm: 3.294
Linear 2 Backward: 3.686, second_gemm: 3.673
GA, 0.070175, 1.419264, 0 
GA, 0.133065, 1.548288, 0 
GA, 0.144531, 1.653760, 0 
GA, 0.266026, 2.185216, 0 
perpare first backward gemm: 0.035,  fisrt gemm backward duration: 2.606,  weight grad: 1.548,  other: 0.41
Linear 1 Backward:  4.647
perpare first backward gemm: 0.027,  fisrt gemm backward duration: 2.797,  weight grad: 1.53,  other: 0.41
Linear 1 Backward:  4.805
perpare first backward gemm: 0.035,  fisrt gemm backward duration: 2.679,  weight grad: 1.564,  other: 0.411
Linear 1 Backward:  4.735
perpare first backward gemm: 0.044,  fisrt gemm backward duration: 2.252,  weight grad: 1.838,  other: 0.413
Linear 1 Backward:  4.596
STEP-35: step_time = 22.003713 ms, foward_time = 11.038720, backward_time = 10.851328, perf = 37.48 tflops.
start
start
start
block_info 312 83
start
cuda:2 process time:3.957033157348633, a: 0.5817413330078125, b: 2.050161361694336, c: 0.04935264587402344, d: 1.275777816772461
block_info 248 33
block_info 256 37
2 wait time: 1.201
312
block_info 228 16
cuda:1 process time:3.7114620208740234, a: 0.7574558258056641, b: 1.2059211730957031, c: 0.0972747802734375, d: 1.6508102416992188
cuda:3 process time:4.759073257446289, a: 0.690460205078125, b: 1.9004344940185547, c: 0.09369850158691406, d: 2.0744800567626953
cuda:0 process time:4.641532897949219, a: 0.6875991821289062, b: 2.030611038208008, c: 0.07414817810058594, d: 1.8491744995117188
1 wait time: 2.232
248
3 wait time: 2.106
256
0 wait time: 1.44
228
AG, 0.144531, 1.810432, 0 
perpare first forward gemm: 0.265,  fisrt gemm forward duration: 2.243
AG, 0.133065, 1.822720, 0 
perpare first forward gemm: 0.273,  fisrt gemm forward duration: 2.4
AG, 0.070175, 1.785856, 0 
perpare first forward gemm: 0.337,  fisrt gemm forward duration: 1.866
AG, 0.266026, 2.013184, 0 
perpare first forward gemm: 0.31,  fisrt gemm forward duration: 3.208
GA, 0.133065, 1.659904, 0 
GA, 0.070175, 1.501184, 0 
GA, 0.144531, 1.687552, 0 
GA, 0.266026, 2.183168, 0 
forward:  7.039
forward:  7.199
forward:  6.852
forward:  7.846
AG, 0.070175, 1.756160, 0 
AG, 0.144531, 1.816576, 0 
AG, 0.133065, 1.819648, 0 
AG, 0.266026, 2.024448, 0 
Linear 2 Backward: 3.297, second_gemm: 3.289
Linear 2 Backward: 3.409, second_gemm: 3.397
Linear 2 Backward: 3.32, second_gemm: 3.308
Linear 2 Backward: 3.619, second_gemm: 3.606
GA, 0.070175, 1.403904, 0 
GA, 0.133065, 1.575936, 0 
GA, 0.144531, 1.634304, 0 
GA, 0.266026, 2.210816, 0 
perpare first backward gemm: 0.033,  fisrt gemm backward duration: 2.721,  weight grad: 1.558,  other: 0.41
Linear 1 Backward:  4.765
perpare first backward gemm: 0.032,  fisrt gemm backward duration: 2.721,  weight grad: 1.562,  other: 0.411
Linear 1 Backward:  4.773
perpare first backward gemm: 0.024,  fisrt gemm backward duration: 2.875,  weight grad: 1.526,  other: 0.419
Linear 1 Backward:  4.883
perpare first backward gemm: 0.044,  fisrt gemm backward duration: 2.282,  weight grad: 1.814,  other: 0.417
Linear 1 Backward:  4.605
STEP-36: step_time = 20.325376 ms, foward_time = 9.316352, backward_time = 10.898432, perf = 40.57 tflops.
start
start
start
start
block_info 312 83
cuda:2 process time:3.2095909118652344, a: 0.5726814270019531, b: 1.3308525085449219, c: 0.04839897155761719, d: 1.2576580047607422
block_info 248 33
2 wait time: 1.232
312
block_info 256 37
block_info 228 16
cuda:1 process time:3.7429332733154297, a: 0.7138252258300781, b: 1.1823177337646484, c: 0.07867813110351562, d: 1.7681121826171875
cuda:3 process time:4.138946533203125, a: 0.6730556488037109, b: 1.4197826385498047, c: 0.09441375732421875, d: 1.9516944885253906
cuda:0 process time:3.9958953857421875, a: 0.6775856018066406, b: 1.1887550354003906, c: 0.09608268737792969, d: 2.0334720611572266
1 wait time: 2.292
248
3 wait time: 2.36
256
0 wait time: 2.165
228
AG, 0.133065, 1.835008, 0 
perpare first forward gemm: 0.272,  fisrt gemm forward duration: 2.27
AG, 0.144531, 1.813504, 0 
perpare first forward gemm: 0.28,  fisrt gemm forward duration: 2.141
AG, 0.070175, 1.781760, 0 
perpare first forward gemm: 0.286,  fisrt gemm forward duration: 1.843
AG, 0.266026, 2.020352, 0 
perpare first forward gemm: 0.306,  fisrt gemm forward duration: 3.233
GA, 0.144531, 1.620992, 0 
GA, 0.133065, 1.610752, 0 
GA, 0.070175, 1.721344, 0 
GA, 0.266026, 2.220032, 0 
forward:  6.756
forward:  7.017
forward:  7.087
forward:  7.886
AG, 0.133065, 1.835008, 0 
AG, 0.070175, 1.759232, 0 
AG, 0.144531, 1.851392, 0 
AG, 0.266026, 2.011136, 0 
Linear 2 Backward: 3.457, second_gemm: 3.446
Linear 2 Backward: 3.252, second_gemm: 3.241
Linear 2 Backward: 3.605, second_gemm: 3.593
Linear 2 Backward: 3.809, second_gemm: 3.798
GA, 0.070175, 1.414144, 0 
GA, 0.133065, 1.604608, 0 
GA, 0.144531, 1.666048, 0 
GA, 0.266026, 2.188288, 0 
perpare first backward gemm: 0.032,  fisrt gemm backward duration: 2.659,  weight grad: 1.56,  other: 0.412
Linear 1 Backward:  4.705
perpare first backward gemm: 0.031,  fisrt gemm backward duration: 2.66,  weight grad: 1.541,  other: 0.413
Linear 1 Backward:  4.689
perpare first backward gemm: 0.031,  fisrt gemm backward duration: 2.735,  weight grad: 1.537,  other: 0.414
Linear 1 Backward:  4.758
perpare first backward gemm: 0.038,  fisrt gemm backward duration: 2.255,  weight grad: 1.812,  other: 0.416
Linear 1 Backward:  4.567
STEP-37: step_time = 21.032960 ms, foward_time = 9.950208, backward_time = 10.972160, perf = 39.21 tflops.
start
start
start
start
block_info 312 83
cuda:2 process time:3.3559799194335938, a: 0.5095005035400391, b: 1.5349388122558594, c: 0.049114227294921875, d: 1.2624263763427734
block_info 228 16
block_info 248 33
2 wait time: 1.172
312
cuda:0 process time:3.645181655883789, a: 0.77056884765625, b: 1.3551712036132812, c: 0.07748603820800781, d: 1.44195556640625
cuda:1 process time:3.7355422973632812, a: 0.7350444793701172, b: 1.4045238494873047, c: 0.07796287536621094, d: 1.5180110931396484
block_info 256 37
0 wait time: 1.971
1 wait time: 2.016
248
228
cuda:3 process time:4.09245491027832, a: 0.640869140625, b: 1.1696815490722656, c: 0.09417533874511719, d: 2.1877288818359375
3 wait time: 1.964
256
AG, 0.070175, 1.774592, 0 
perpare first forward gemm: 0.307,  fisrt gemm forward duration: 2.33
AG, 0.133065, 1.823744, 0 
perpare first forward gemm: 0.286,  fisrt gemm forward duration: 2.476
AG, 0.144531, 1.813504, 0 
perpare first forward gemm: 0.308,  fisrt gemm forward duration: 1.886
AG, 0.266026, 2.016256, 0 
perpare first forward gemm: 0.311,  fisrt gemm forward duration: 3.192
GA, 0.133065, 1.619968, 0 
GA, 0.070175, 1.464320, 0 
GA, 0.144531, 1.688576, 0 
GA, 0.266026, 2.312192, 0 
forward:  6.883
forward:  7.4
forward:  7.393
forward:  7.952
AG, 0.070175, 1.751040, 0 
AG, 0.144531, 1.810432, 0 
AG, 0.133065, 1.840128, 0 
AG, 0.266026, 2.025472, 0 
Linear 2 Backward: 3.282, second_gemm: 3.274
Linear 2 Backward: 3.407, second_gemm: 3.397
Linear 2 Backward: 3.444, second_gemm: 3.433
Linear 2 Backward: 3.622, second_gemm: 3.61
GA, 0.070175, 1.406976, 0 
GA, 0.144531, 1.667072, 0 
GA, 0.133065, 1.584128, 0 
GA, 0.266026, 2.184192, 0 
perpare first backward gemm: 0.024,  fisrt gemm backward duration: 2.843,  weight grad: 1.522,  other: 0.417
Linear 1 Backward:  4.844
perpare first backward gemm: 0.03,  fisrt gemm backward duration: 2.737,  weight grad: 1.546,  other: 0.417
Linear 1 Backward:  4.77
perpare first backward gemm: 0.033,  fisrt gemm backward duration: 2.626,  weight grad: 1.538,  other: 0.427
Linear 1 Backward:  4.67
perpare first backward gemm: 0.042,  fisrt gemm backward duration: 2.249,  weight grad: 1.809,  other: 0.414
Linear 1 Backward:  4.563
STEP-38: step_time = 21.284961 ms, foward_time = 10.337376, backward_time = 10.835968, perf = 38.74 tflops.
start
start
start
start
block_info 312 83
cuda:2 process time:2.8731822967529297, a: 0.5354881286621094, b: 1.0707378387451172, c: 0.049114227294921875, d: 1.2178421020507812
block_info 228 16
block_info 256 37
block_info 248 33
2 wait time: 1.257
312
cuda:3 process time:3.299713134765625, a: 0.6656646728515625, b: 1.0793209075927734, c: 0.07128715515136719, d: 1.4834403991699219
cuda:0 process time:3.4503936767578125, a: 0.6494522094726562, b: 1.0876655578613281, c: 0.07486343383789062, d: 1.6384124755859375
cuda:1 process time:3.6110877990722656, a: 0.7565021514892578, b: 1.0216236114501953, c: 0.07534027099609375, d: 1.7576217651367188
3 wait time: 1.91
256
0 wait time: 1.63
228
1 wait time: 1.891
248
AG, 0.144531, 1.818624, 0 
perpare first forward gemm: 0.275,  fisrt gemm forward duration: 2.135
AG, 0.070175, 1.771520, 0 
perpare first forward gemm: 0.293,  fisrt gemm forward duration: 1.888
AG, 0.133065, 1.841152, 0 
perpare first forward gemm: 0.274,  fisrt gemm forward duration: 1.901
AG, 0.266026, 2.011136, 0 
perpare first forward gemm: 0.309,  fisrt gemm forward duration: 2.753
GA, 0.070175, 1.441792, 0 
GA, 0.133065, 1.622016, 0 
GA, 0.144531, 1.705984, 0 
GA, 0.266026, 2.235392, 0 
forward:  6.713
forward:  7.432
forward:  7.001
forward:  6.831
AG, 0.133065, 1.826816, 0 
AG, 0.144531, 1.818624, 0 
AG, 0.070175, 1.757184, 0 
AG, 0.266026, 2.008064, 0 
Linear 2 Backward: 3.42, second_gemm: 3.409
Linear 2 Backward: 3.29, second_gemm: 3.276
Linear 2 Backward: 3.547, second_gemm: 3.535
Linear 2 Backward: 3.731, second_gemm: 3.719
GA, 0.070175, 1.409024, 0 
GA, 0.133065, 1.594368, 0 
GA, 0.144531, 1.623040, 0 
GA, 0.266026, 2.157568, 0 
perpare first backward gemm: 0.03,  fisrt gemm backward duration: 2.695,  weight grad: 1.538,  other: 0.449
Linear 1 Backward:  4.765
perpare first backward gemm: 0.033,  fisrt gemm backward duration: 2.61,  weight grad: 1.553,  other: 0.458
perpare first backward gemm: 0.038,  fisrt gemm backward duration: 2.555,  weight grad: 1.577,  other: 0.454
Linear 1 Backward:  4.71
Linear 1 Backward:  4.69
perpare first backward gemm: 0.038,  fisrt gemm backward duration: 2.217,  weight grad: 1.794,  other: 0.436
Linear 1 Backward:  4.54
STEP-39: step_time = 20.567039 ms, foward_time = 9.463808, backward_time = 10.992640, perf = 40.09 tflops.
start
start
start
start
block_info 312 83
cuda:2 process time:3.562450408935547, a: 0.5109310150146484, b: 1.6787052154541016, c: 0.05507469177246094, d: 1.317739486694336
2 wait time: 1.079
312
block_info 228 16
block_info 248 33
block_info 256 37
cuda:0 process time:4.115819931030273, a: 0.823974609375, b: 1.0993480682373047, c: 0.09679794311523438, d: 2.0956993103027344
cuda:1 process time:4.192113876342773, a: 0.7708072662353516, b: 1.1649131774902344, c: 0.095367431640625, d: 2.1610260009765625
cuda:3 process time:4.189968109130859, a: 0.7953643798828125, b: 1.1565685272216797, c: 0.09512901306152344, d: 2.1429061889648438
0 wait time: 2.213
228
1 wait time: 2.302
248
3 wait time: 2.21
256
AG, 0.070175, 1.778688, 0 
perpare first forward gemm: 0.296,  fisrt gemm forward duration: 1.905
AG, 0.133065, 1.825792, 0 
perpare first forward gemm: 0.281,  fisrt gemm forward duration: 1.96
AG, 0.144531, 1.815552, 0 
perpare first forward gemm: 0.309,  fisrt gemm forward duration: 1.889
AG, 0.266026, 2.002944, 0 
perpare first forward gemm: 0.316,  fisrt gemm forward duration: 3.129
GA, 0.070175, 1.445888, 0 
GA, 0.133065, 1.600512, 0 
GA, 0.144531, 1.780736, 0 
GA, 0.266026, 2.302976, 0 
forward:  6.873
forward:  6.914
forward:  6.861
forward:  7.903
AG, 0.144531, 1.810432, 0 
AG, 0.133065, 1.841152, 0 
AG, 0.070175, 1.750016, 0 
AG, 0.266026, 2.010112, 0 
Linear 2 Backward: 3.202, second_gemm: 3.194
Linear 2 Backward: 3.324, second_gemm: 3.311
Linear 2 Backward: 3.275, second_gemm: 3.263
Linear 2 Backward: 3.618, second_gemm: 3.605
GA, 0.070175, 1.395712, 0 
GA, 0.133065, 1.587200, 0 
GA, 0.144531, 1.616896, 0 
GA, 0.266026, 2.192384, 0 
perpare first backward gemm: 0.029,  fisrt gemm backward duration: 2.782,  weight grad: 1.531,  other: 0.445
Linear 1 Backward:  4.835
perpare first backward gemm: 0.035,  fisrt gemm backward duration: 2.672,  weight grad: 1.566,  other: 0.454
Linear 1 Backward:  4.824
perpare first backward gemm: 0.035,  fisrt gemm backward duration: 2.649,  weight grad: 1.552,  other: 0.441
Linear 1 Backward:  4.733
perpare first backward gemm: 0.041,  fisrt gemm backward duration: 2.258,  weight grad: 1.796,  other: 0.44
Linear 1 Backward:  4.594
STEP-40: step_time = 21.122047 ms, foward_time = 10.187776, backward_time = 10.825728, perf = 39.04 tflops.
start
start
start
start
block_info 256 37
block_info 312 83
block_info 228 16
cuda:2 process time:3.0045509338378906, a: 0.5095005035400391, b: 1.1169910430908203, c: 0.049114227294921875, d: 1.3289451599121094
cuda:3 process time:3.3576488494873047, a: 0.8726119995117188, b: 0.9124279022216797, c: 0.07772445678710938, d: 1.4948844909667969
block_info 248 33
2 wait time: 1.112
312
cuda:0 process time:3.532886505126953, a: 0.7860660552978516, b: 1.2297630310058594, c: 0.08940696716308594, d: 1.4276504516601562
3 wait time: 2.162
256
cuda:1 process time:3.7992000579833984, a: 0.7524490356445312, b: 1.1627674102783203, c: 0.07796287536621094, d: 1.806020736694336
0 wait time: 1.966
228
1 wait time: 1.971
248
AG, 0.070175, 1.776640, 0 
perpare first forward gemm: 0.295,  fisrt gemm forward duration: 1.935
AG, 0.144531, 1.817600, 0 
perpare first forward gemm: 0.258,  fisrt gemm forward duration: 2.462
AG, 0.133065, 1.828864, 0 
perpare first forward gemm: 0.28,  fisrt gemm forward duration: 1.891
AG, 0.266026, 1.995776, 0 
perpare first forward gemm: 0.311,  fisrt gemm forward duration: 2.679
GA, 0.144531, 1.667072, 0 
GA, 0.070175, 1.473536, 0 
GA, 0.133065, 1.635328, 0 
GA, 0.266026, 2.183168, 0 
forward:  6.683
forward:  7.2
forward:  7.3
forward:  6.826
AG, 0.144531, 1.823744, 0 
AG, 0.133065, 1.838080, 0 
AG, 0.070175, 1.756160, 0 
AG, 0.266026, 2.032640, 0 
Linear 2 Backward: 3.165, second_gemm: 3.155
Linear 2 Backward: 3.291, second_gemm: 3.276
Linear 2 Backward: 3.505, second_gemm: 3.493
Linear 2 Backward: 3.673, second_gemm: 3.66
GA, 0.070175, 1.392640, 0 
GA, 0.133065, 1.586176, 0 
GA, 0.144531, 1.657856, 0 
GA, 0.266026, 2.171904, 0 
perpare first backward gemm: 0.027,  fisrt gemm backward duration: 2.759,  weight grad: 1.518,  other: 0.413
Linear 1 Backward:  4.758
perpare first backward gemm: 0.035,  fisrt gemm backward duration: 2.595,  weight grad: 1.55,  other: 0.441
Linear 1 Backward:  4.678
perpare first backward gemm: 0.038,  fisrt gemm backward duration: 2.586,  weight grad: 1.58,  other: 0.454
Linear 1 Backward:  4.725
perpare first backward gemm: 0.039,  fisrt gemm backward duration: 2.233,  weight grad: 1.796,  other: 0.439
Linear 1 Backward:  4.563
STEP-41: step_time = 20.979167 ms, foward_time = 9.727457, backward_time = 11.140096, perf = 39.31 tflops.
start
start
start
start
block_info 312 83
block_info 228 16
cuda:2 process time:3.3028125762939453, a: 0.5245208740234375, b: 1.374959945678711, c: 0.04863739013671875, d: 1.3546943664550781
block_info 256 37
2 wait time: 1.097
312
block_info 248 33
cuda:0 process time:3.5622119903564453, a: 0.8220672607421875, b: 1.0132789611816406, c: 0.07390975952148438, d: 1.6529560089111328
0 wait time: 1.77
228
cuda:3 process time:4.130125045776367, a: 0.7309913635253906, b: 1.346588134765625, c: 0.09322166442871094, d: 1.9593238830566406
cuda:1 process time:4.17780876159668, a: 0.7755756378173828, b: 1.2373924255371094, c: 0.09822845458984375, d: 2.0666122436523438
3 wait time: 2.462
256
1 wait time: 2.628
248
AG, 0.144531, 1.810432, 0 
perpare first forward gemm: 0.266,  fisrt gemm forward duration: 2.173
AG, 0.070175, 1.778688, 0 
perpare first forward gemm: 0.31,  fisrt gemm forward duration: 2.426
AG, 0.133065, 1.829888, 0 
perpare first forward gemm: 0.286,  fisrt gemm forward duration: 1.897
AG, 0.266026, 2.017280, 0 
perpare first forward gemm: 0.325,  fisrt gemm forward duration: 3.161
GA, 0.070175, 1.478656, 0 
GA, 0.144531, 1.649664, 0 
GA, 0.133065, 1.654784, 0 
GA, 0.266026, 2.195456, 0 
forward:  7.018
forward:  6.753
forward:  7.869
forward:  7.396
AG, 0.133065, 1.825792, 0 
AG, 0.144531, 1.842176, 0 
AG, 0.070175, 1.768448, 0 
AG, 0.266026, 2.015232, 0 
Linear 2 Backward: 3.233, second_gemm: 3.22
Linear 2 Backward: 3.403, second_gemm: 3.39
Linear 2 Backward: 3.293, second_gemm: 3.279
Linear 2 Backward: 3.737, second_gemm: 3.723
GA, 0.070175, 1.415168, 0 
GA, 0.133065, 1.600512, 0 
GA, 0.144531, 1.659904, 0 
GA, 0.266026, 2.192384, 0 
perpare first backward gemm: 0.032,  fisrt gemm backward duration: 2.729,  weight grad: 1.538,  other: 0.441
Linear 1 Backward:  4.796
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 2.636,  weight grad: 1.579,  other: 0.448
Linear 1 Backward:  4.762
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 2.658,  weight grad: 1.55,  other: 0.446
Linear 1 Backward:  4.751
perpare first backward gemm: 0.042,  fisrt gemm backward duration: 2.26,  weight grad: 1.823,  other: 0.449
Linear 1 Backward:  4.636
STEP-42: step_time = 21.386241 ms, foward_time = 10.162176, backward_time = 11.112448, perf = 38.56 tflops.
start
start
start
start
block_info 312 83
block_info 248 33
cuda:2 process time:3.3164024353027344, a: 0.545501708984375, b: 1.4941692352294922, c: 0.04982948303222656, d: 1.2269020080566406
block_info 256 37
cuda:1 process time:3.424406051635742, a: 0.606536865234375, b: 1.36566162109375, c: 0.0629425048828125, d: 1.3892650604248047
2 wait time: 1.317
312
cuda:3 process time:3.6859512329101562, a: 0.7789134979248047, b: 1.3408660888671875, c: 0.07200241088867188, d: 1.4941692352294922
1 wait time: 1.277
248
block_info 228 16
3 wait time: 2.006
256
cuda:0 process time:4.190683364868164, a: 0.6973743438720703, b: 1.2211799621582031, c: 0.11324882507324219, d: 2.1588802337646484
0 wait time: 2.009
228
AG, 0.070175, 1.768448, 0 
perpare first forward gemm: 0.307,  fisrt gemm forward duration: 1.838
AG, 0.144531, 1.810432, 0 
perpare first forward gemm: 0.288,  fisrt gemm forward duration: 2.552
AG, 0.133065, 1.842176, 0 
perpare first forward gemm: 0.289,  fisrt gemm forward duration: 2.915
AG, 0.266026, 2.032640, 0 
perpare first forward gemm: 0.292,  fisrt gemm forward duration: 3.304
GA, 0.070175, 1.438720, 0 
GA, 0.133065, 1.607680, 0 
GA, 0.144531, 1.722368, 0 
GA, 0.266026, 2.299904, 0 
forward:  7.779
forward:  7.438
forward:  6.824
forward:  7.957
AG, 0.070175, 1.754112, 0 
AG, 0.133065, 1.826816, 0 
AG, 0.144531, 1.813504, 0 
AG, 0.266026, 2.041856, 0 
Linear 2 Backward: 3.346, second_gemm: 3.337
Linear 2 Backward: 3.374, second_gemm: 3.361
Linear 2 Backward: 3.437, second_gemm: 3.424
Linear 2 Backward: 3.64, second_gemm: 3.628
GA, 0.070175, 1.406976, 0 
GA, 0.133065, 1.562624, 0 
GA, 0.144531, 1.601536, 0 
GA, 0.266026, 2.187264, 0 
perpare first backward gemm: 0.035,  fisrt gemm backward duration: 2.667,  weight grad: 1.541,  other: 0.407
Linear 1 Backward:  4.695
perpare first backward gemm: 0.024,  fisrt gemm backward duration: 2.839,  weight grad: 1.52,  other: 0.407
Linear 1 Backward:  4.828
perpare first backward gemm: 0.037,  fisrt gemm backward duration: 2.648,  weight grad: 1.554,  other: 0.446
Linear 1 Backward:  4.745
perpare first backward gemm: 0.041,  fisrt gemm backward duration: 2.254,  weight grad: 1.815,  other: 0.441
Linear 1 Backward:  4.608
STEP-43: step_time = 21.082112 ms, foward_time = 9.949184, backward_time = 11.022336, perf = 39.12 tflops.
start
start
start
start
block_info 312 83
cuda:2 process time:3.094911575317383, a: 0.5981922149658203, b: 1.2104511260986328, c: 0.056743621826171875, d: 1.2295246124267578
2 wait time: 1.321
312
block_info 228 16
block_info 248 33
block_info 256 37
cuda:0 process time:4.251241683959961, a: 0.6954669952392578, b: 1.3322830200195312, c: 0.09679794311523438, d: 2.1266937255859375
cuda:3 process time:4.082202911376953, a: 0.7500648498535156, b: 1.2469291687011719, c: 0.09417533874511719, d: 1.9910335540771484
cuda:1 process time:4.157066345214844, a: 0.7791519165039062, b: 1.0867118835449219, c: 0.09489059448242188, d: 2.1963119506835938
0 wait time: 2.136
228
3 wait time: 2.507
256
1 wait time: 2.31
248
AG, 0.144531, 1.815552, 0 
perpare first forward gemm: 0.287,  fisrt gemm forward duration: 1.975
AG, 0.070175, 1.781760, 0 
perpare first forward gemm: 0.3,  fisrt gemm forward duration: 2.003
AG, 0.133065, 1.824768, 0 
perpare first forward gemm: 0.289,  fisrt gemm forward duration: 1.891
AG, 0.266026, 2.021376, 0 
perpare first forward gemm: 0.301,  fisrt gemm forward duration: 3.331
GA, 0.070175, 1.475584, 0 
GA, 0.133065, 1.623040, 0 
GA, 0.144531, 1.747968, 0 
GA, 0.266026, 2.277376, 0 
forward:  6.866
forward:  6.762
forward:  7.99
forward:  6.953
AG, 0.133065, 1.845248, 0 
AG, 0.144531, 1.854464, 0 
AG, 0.070175, 1.773568, 0 
AG, 0.266026, 2.030592, 0 
Linear 2 Backward: 3.368, second_gemm: 3.356
Linear 2 Backward: 3.313, second_gemm: 3.3
Linear 2 Backward: 3.345, second_gemm: 3.331
Linear 2 Backward: 3.819, second_gemm: 3.806
GA, 0.070175, 1.418240, 0 
GA, 0.133065, 1.605632, 0 
GA, 0.144531, 1.635328, 0 
GA, 0.266026, 2.182144, 0 
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 2.605,  weight grad: 1.56,  other: 0.445
Linear 1 Backward:  4.708
perpare first backward gemm: 0.035,  fisrt gemm backward duration: 2.657,  weight grad: 1.54,  other: 0.441
Linear 1 Backward:  4.731
perpare first backward gemm: 0.039,  fisrt gemm backward duration: 2.542,  weight grad: 1.571,  other: 0.451
Linear 1 Backward:  4.667
perpare first backward gemm: 0.039,  fisrt gemm backward duration: 2.244,  weight grad: 1.813,  other: 0.458
Linear 1 Backward:  4.612
STEP-44: step_time = 21.371904 ms, foward_time = 10.054656, backward_time = 11.209728, perf = 38.58 tflops.
start
start
start
start
block_info 312 83
block_info 256 37
cuda:2 process time:3.331422805786133, a: 0.5261898040771484, b: 1.3935565948486328, c: 0.04887580871582031, d: 1.3628005981445312
cuda:3 process time:3.5581588745117188, a: 0.7503032684326172, b: 1.230478286743164, c: 0.08320808410644531, d: 1.4941692352294922
block_info 248 33
2 wait time: 1.015
312
block_info 228 16
3 wait time: 1.946
256
cuda:1 process time:4.126548767089844, a: 0.7722377777099609, b: 1.209259033203125, c: 0.09870529174804688, d: 2.046346664428711
cuda:0 process time:4.347801208496094, a: 0.64849853515625, b: 1.3866424560546875, c: 0.14066696166992188, d: 2.1719932556152344
0 wait time: 2.028
228
1 wait time: 2.593
248
AG, 0.070175, 1.761280, 0 
perpare first forward gemm: 0.307,  fisrt gemm forward duration: 1.9
AG, 0.144531, 1.822720, 0 
perpare first forward gemm: 0.287,  fisrt gemm forward duration: 2.662
AG, 0.133065, 1.820672, 0 
perpare first forward gemm: 0.289,  fisrt gemm forward duration: 1.887
AG, 0.266026, 2.011136, 0 
perpare first forward gemm: 0.324,  fisrt gemm forward duration: 3.116
GA, 0.070175, 1.471488, 0 
GA, 0.144531, 1.615872, 0 
GA, 0.133065, 1.653760, 0 
GA, 0.266026, 2.226176, 0 
forward:  6.813
forward:  7.544
forward:  7.851
forward:  6.908
AG, 0.144531, 1.814528, 0 
AG, 0.133065, 1.837056, 0 
AG, 0.070175, 1.763328, 0 
AG, 0.266026, 2.024448, 0 
Linear 2 Backward: 3.349, second_gemm: 3.34
Linear 2 Backward: 3.422, second_gemm: 3.409
Linear 2 Backward: 3.305, second_gemm: 3.292
Linear 2 Backward: 3.771, second_gemm: 3.758
GA, 0.070175, 1.397760, 0 
GA, 0.133065, 1.582080, 0 
GA, 0.144531, 1.637376, 0 
GA, 0.266026, 2.192384, 0 
perpare first backward gemm: 0.026,  fisrt gemm backward duration: 2.788,  weight grad: 1.516,  other: 0.41
Linear 1 Backward:  4.78
perpare first backward gemm: 0.037,  fisrt gemm backward duration: 2.612,  weight grad: 1.553,  other: 0.447
Linear 1 Backward:  4.709
perpare first backward gemm: 0.034,  fisrt gemm backward duration: 2.646,  weight grad: 1.542,  other: 0.407
Linear 1 Backward:  4.675
perpare first backward gemm: 0.04,  fisrt gemm backward duration: 2.276,  weight grad: 1.798,  other: 0.441
Linear 1 Backward:  4.61
STEP-45: step_time = 21.149696 ms, foward_time = 9.929728, backward_time = 11.109376, perf = 38.99 tflops.
start
start
start
start
block_info 312 83
block_info 228 16
cuda:2 process time:3.36456298828125, a: 0.5033016204833984, b: 1.4896392822265625, c: 0.04935264587402344, d: 1.3222694396972656
block_info 256 37
2 wait time: 1.063
312
block_info 248 33
cuda:0 process time:3.7832260131835938, a: 0.8132457733154297, b: 1.1563301086425781, c: 0.07390975952148438, d: 1.7397403717041016
0 wait time: 1.679
228
cuda:3 process time:4.015207290649414, a: 0.7562637329101562, b: 1.1713504791259766, c: 0.09465217590332031, d: 1.992940902709961
cuda:1 process time:4.170656204223633, a: 0.7483959197998047, b: 1.4193058013916016, c: 0.09012222290039062, d: 1.912832260131836
3 wait time: 2.491
256
1 wait time: 2.461
248
AG, 0.144531, 1.814528, 0 
perpare first forward gemm: 0.289,  fisrt gemm forward duration: 2.004
AG, 0.070175, 1.771520, 0 
perpare first forward gemm: 0.299,  fisrt gemm forward duration: 2.448
AG, 0.133065, 1.832960, 0 
perpare first forward gemm: 0.284,  fisrt gemm forward duration: 1.896
AG, 0.266026, 2.016256, 0 
perpare first forward gemm: 0.315,  fisrt gemm forward duration: 3.077
GA, 0.070175, 1.457152, 0 
GA, 0.133065, 1.611776, 0 
GA, 0.144531, 1.671168, 0 
GA, 0.266026, 2.237440, 0 
forward:  6.919
forward:  6.783
forward:  7.778
forward:  7.412
AG, 0.133065, 1.836032, 0 
AG, 0.144531, 1.817600, 0 
AG, 0.070175, 1.758208, 0 
AG, 0.266026, 2.014208, 0 
Linear 2 Backward: 3.458, second_gemm: 3.45
Linear 2 Backward: 3.337, second_gemm: 3.322
Linear 2 Backward: 3.499, second_gemm: 3.486
Linear 2 Backward: 3.869, second_gemm: 3.856
GA, 0.070175, 1.427456, 0 
GA, 0.133065, 1.567744, 0 
GA, 0.144531, 1.667072, 0 
GA, 0.266026, 2.171904, 0 
perpare first backward gemm: 0.027,  fisrt gemm backward duration: 2.751,  weight grad: 1.524,  other: 0.422
Linear 1 Backward:  4.769
perpare first backward gemm: 0.039,  fisrt gemm backward duration: 2.561,  weight grad: 1.572,  other: 0.45
Linear 1 Backward:  4.689
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 2.587,  weight grad: 1.55,  other: 0.453
Linear 1 Backward:  4.688
perpare first backward gemm: 0.039,  fisrt gemm backward duration: 2.235,  weight grad: 1.798,  other: 0.439
Linear 1 Backward:  4.569
STEP-46: step_time = 21.376000 ms, foward_time = 10.076160, backward_time = 11.190272, perf = 38.58 tflops.
start
start
start
start
block_info 312 83
cuda:2 process time:3.0405521392822266, a: 0.5719661712646484, b: 1.1205673217773438, c: 0.04839897155761719, d: 1.2996196746826172
block_info 256 37
2 wait time: 1.205
312
cuda:3 process time:3.4716129302978516, a: 0.6990432739257812, b: 1.210927963256836, c: 0.07224082946777344, d: 1.489400863647461
block_info 248 33
block_info 228 16
3 wait time: 1.948
256
cuda:1 process time:4.108667373657227, a: 0.7481575012207031, b: 1.249551773071289, c: 0.11301040649414062, d: 1.9979476928710938
cuda:0 process time:4.304647445678711, a: 0.67138671875, b: 1.332998275756836, c: 0.14066696166992188, d: 2.159595489501953
1 wait time: 2.528
248
0 wait time: 2.1
228
AG, 0.133065, 1.829888, 0 
perpare first forward gemm: 0.281,  fisrt gemm forward duration: 2.006
AG, 0.144531, 1.814528, 0 
perpare first forward gemm: 0.284,  fisrt gemm forward duration: 2.691
AG, 0.070175, 1.768448, 0 
perpare first forward gemm: 0.299,  fisrt gemm forward duration: 1.836
AG, 0.266026, 2.027520, 0 
perpare first forward gemm: 0.321,  fisrt gemm forward duration: 3.433
GA, 0.070175, 1.437696, 0 
GA, 0.133065, 1.624064, 0 
GA, 0.144531, 1.678336, 0 
GA, 0.266026, 2.199552, 0 
forward:  7.598
forward:  6.878
forward:  6.821
forward:  8.144
AG, 0.070175, 1.758208, 0 
AG, 0.144531, 1.815552, 0 
AG, 0.133065, 1.836032, 0 
AG, 0.266026, 2.017280, 0 
Linear 2 Backward: 3.17, second_gemm: 3.16
Linear 2 Backward: 3.252, second_gemm: 3.24
Linear 2 Backward: 3.358, second_gemm: 3.344
Linear 2 Backward: 3.708, second_gemm: 3.695
GA, 0.070175, 1.414144, 0 
GA, 0.133065, 1.583104, 0 
GA, 0.144531, 1.769472, 0 
GA, 0.266026, 2.215936, 0 
perpare first backward gemm: 0.034,  fisrt gemm backward duration: 2.701,  weight grad: 1.543,  other: 0.439
Linear 1 Backward:  4.776
perpare first backward gemm: 0.028,  fisrt gemm backward duration: 2.829,  weight grad: 1.519,  other: 0.407
Linear 1 Backward:  4.824
perpare first backward gemm: 0.033,  fisrt gemm backward duration: 2.731,  weight grad: 1.55,  other: 0.425
Linear 1 Backward:  4.785
perpare first backward gemm: 0.043,  fisrt gemm backward duration: 2.282,  weight grad: 1.836,  other: 0.447
Linear 1 Backward:  4.665
STEP-47: step_time = 21.035008 ms, foward_time = 9.972736, backward_time = 10.953728, perf = 39.20 tflops.
start
start
start
start
block_info 312 83
block_info 248 33
block_info 256 37
cuda:2 process time:3.2422542572021484, a: 0.5168914794921875, b: 1.3523101806640625, c: 0.04863739013671875, d: 1.3244152069091797
cuda:1 process time:3.12042236328125, a: 0.7333755493164062, b: 1.1856555938720703, c: 0.05888938903808594, d: 1.1425018310546875
block_info 228 16
cuda:3 process time:3.7169456481933594, a: 0.6890296936035156, b: 1.4641284942626953, c: 0.072479248046875, d: 1.4913082122802734
2 wait time: 1.062
312
1 wait time: 1.626
248
cuda:0 process time:3.9281845092773438, a: 0.8068084716796875, b: 1.27410888671875, c: 0.07510185241699219, d: 1.772165298461914
3 wait time: 1.966
256
0 wait time: 1.542
228
AG, 0.070175, 1.760256, 0 
perpare first forward gemm: 0.301,  fisrt gemm forward duration: 1.826
AG, 0.144531, 1.814528, 0 
perpare first forward gemm: 0.272,  fisrt gemm forward duration: 1.964
AG, 0.133065, 1.821696, 0 
perpare first forward gemm: 0.282,  fisrt gemm forward duration: 2.206
AG, 0.266026, 2.011136, 0 
perpare first forward gemm: 0.319,  fisrt gemm forward duration: 2.503
GA, 0.070175, 1.459200, 0 
GA, 0.144531, 1.633280, 0 
GA, 0.133065, 1.623040, 0 
GA, 0.266026, 2.192384, 0 
forward:  6.763
forward:  6.809
forward:  7.172
forward:  7.448
AG, 0.144531, 1.812480, 0 
AG, 0.070175, 1.756160, 0 
AG, 0.133065, 1.837056, 0 
AG, 0.266026, 2.033664, 0 
Linear 2 Backward: 4.194, second_gemm: 4.181
Linear 2 Backward: 3.989, second_gemm: 3.975
Linear 2 Backward: 3.338, second_gemm: 3.322
Linear 2 Backward: 4.473, second_gemm: 4.46
GA, 0.070175, 1.401856, 0 
GA, 0.133065, 1.588224, 0 
GA, 0.144531, 1.659904, 0 
GA, 0.266026, 2.198528, 0 
perpare first backward gemm: 0.033,  fisrt gemm backward duration: 2.727,  weight grad: 1.563,  other: 0.441
Linear 1 Backward:  4.82
perpare first backward gemm: 0.037,  fisrt gemm backward duration: 2.598,  weight grad: 1.552,  other: 0.45
Linear 1 Backward:  4.709
perpare first backward gemm: 0.041,  fisrt gemm backward duration: 2.6,  weight grad: 1.578,  other: 0.455
Linear 1 Backward:  4.743
perpare first backward gemm: 0.04,  fisrt gemm backward duration: 2.261,  weight grad: 1.817,  other: 0.465
Linear 1 Backward:  4.641
STEP-48: step_time = 21.210113 ms, foward_time = 9.243648, backward_time = 11.855872, perf = 38.88 tflops.
start
start
start
block_info 312 83
start
block_info 228 16
cuda:2 process time:3.570556640625, a: 0.5071163177490234, b: 1.64031982421875, c: 0.04935264587402344, d: 1.3737678527832031
block_info 256 37
block_info 248 33
2 wait time: 0.442
312
cuda:0 process time:4.195690155029297, a: 0.6601810455322266, b: 1.714944839477539, c: 0.07748603820800781, d: 1.7430782318115234
cuda:3 process time:4.499197006225586, a: 0.5743503570556641, b: 1.8184185028076172, c: 0.09465217590332031, d: 2.0117759704589844
0 wait time: 1.555
cuda:1 process time:4.071950912475586, a: 0.7650852203369141, b: 1.3186931610107422, c: 0.09655952453613281, d: 1.8916130065917969
228
3 wait time: 1.823
256
1 wait time: 2.459
248
AG, 0.070175, 1.779712, 0 
perpare first forward gemm: 0.312,  fisrt gemm forward duration: 2.215
AG, 0.144531, 1.810432, 0 
perpare first forward gemm: 0.286,  fisrt gemm forward duration: 2.116
AG, 0.133065, 1.827840, 0 
perpare first forward gemm: 0.284,  fisrt gemm forward duration: 1.891
AG, 0.266026, 2.020352, 0 
perpare first forward gemm: 0.326,  fisrt gemm forward duration: 2.929
GA, 0.144531, 1.622016, 0 
GA, 0.133065, 1.647616, 0 
GA, 0.070175, 1.477632, 0 
GA, 0.266026, 2.195456, 0 
forward:  7.037
forward:  6.8
forward:  7.697
forward:  7.234
AG, 0.133065, 1.847296, 0 
AG, 0.144531, 1.809408, 0 
AG, 0.070175, 1.761280, 0 
AG, 0.266026, 2.022400, 0 
Linear 2 Backward: 3.342, second_gemm: 3.332
Linear 2 Backward: 3.382, second_gemm: 3.37
Linear 2 Backward: 3.332, second_gemm: 3.319
Linear 2 Backward: 3.629, second_gemm: 3.617
GA, 0.070175, 1.413120, 0 
GA, 0.133065, 1.571840, 0 
GA, 0.144531, 1.637376, 0 
GA, 0.266026, 2.177024, 0 
perpare first backward gemm: 0.027,  fisrt gemm backward duration: 2.749,  weight grad: 1.529,  other: 0.421
Linear 1 Backward:  4.772
perpare first backward gemm: 0.033,  fisrt gemm backward duration: 2.65,  weight grad: 1.542,  other: 0.414
Linear 1 Backward:  4.683
perpare first backward gemm: 0.034,  fisrt gemm backward duration: 2.614,  weight grad: 1.554,  other: 0.455
Linear 1 Backward:  4.715
perpare first backward gemm: 0.039,  fisrt gemm backward duration: 2.26,  weight grad: 1.811,  other: 0.465
Linear 1 Backward:  4.631
STEP-49: step_time = 20.869120 ms, foward_time = 9.787392, backward_time = 10.971136, perf = 39.51 tflops.
start
start
start
start
block_info 312 83
block_info 248 33
cuda:2 process time:3.308534622192383, a: 0.4200935363769531, b: 1.5492439270019531, c: 0.04863739013671875, d: 1.2905597686767578
cuda:1 process time:3.009319305419922, a: 0.6840229034423828, b: 0.9720325469970703, c: 0.05221366882324219, d: 1.3010501861572266
block_info 228 16
block_info 256 37
2 wait time: 1.181
312
1 wait time: 1.29
248
cuda:0 process time:3.757953643798828, a: 0.6649494171142578, b: 1.2385845184326172, c: 0.07390975952148438, d: 1.7805099487304688
cuda:3 process time:4.076242446899414, a: 0.7584095001220703, b: 1.3914108276367188, c: 0.09012222290039062, d: 1.8362998962402344
0 wait time: 1.356
228
3 wait time: 2.275
256
AG, 0.133065, 1.828864, 0 
perpare first forward gemm: 0.279,  fisrt gemm forward duration: 2.67
AG, 0.070175, 1.764352, 0 
perpare first forward gemm: 0.295,  fisrt gemm forward duration: 2.044
AG, 0.144531, 1.811456, 0 
perpare first forward gemm: 0.284,  fisrt gemm forward duration: 1.875
AG, 0.266026, 2.012160, 0 
perpare first forward gemm: 0.317,  fisrt gemm forward duration: 2.855
GA, 0.070175, 1.441792, 0 
GA, 0.133065, 1.608704, 0 
GA, 0.144531, 1.612800, 0 
GA, 0.266026, 2.239488, 0 
forward:  6.784
forward:  7.536
forward:  7.573
forward:  7.016
AG, 0.133065, 1.830912, 0 
AG, 0.144531, 1.817600, 0 
AG, 0.070175, 1.760256, 0 
AG, 0.266026, 2.023424, 0 
Linear 2 Backward: 3.372, second_gemm: 3.364
Linear 2 Backward: 3.361, second_gemm: 3.348
Linear 2 Backward: 3.312, second_gemm: 3.298
Linear 2 Backward: 3.747, second_gemm: 3.735
GA, 0.070175, 1.427456, 0 
GA, 0.133065, 1.566720, 0 
GA, 0.144531, 1.693696, 0 
GA, 0.266026, 2.181120, 0 
perpare first backward gemm: 0.023,  fisrt gemm backward duration: 2.8,  weight grad: 1.517,  other: 0.411
Linear 1 Backward:  4.788
perpare first backward gemm: 0.035,  fisrt gemm backward duration: 2.63,  weight grad: 1.549,  other: 0.444
Linear 1 Backward:  4.716
perpare first backward gemm: 0.038,  fisrt gemm backward duration: 2.569,  weight grad: 1.579,  other: 0.449
Linear 1 Backward:  4.7
perpare first backward gemm: 0.038,  fisrt gemm backward duration: 2.241,  weight grad: 1.813,  other: 0.438
Linear 1 Backward:  4.583
STEP-50: step_time = 20.543488 ms, foward_time = 9.482240, backward_time = 10.950656, perf = 40.14 tflops.
start
start
start
start
block_info 312 83
block_info 256 37
cuda:2 process time:3.365039825439453, a: 0.5083084106445312, b: 1.4426708221435547, c: 0.04863739013671875, d: 1.3654232025146484
block_info 228 16
cuda:3 process time:3.734588623046875, a: 0.7114410400390625, b: 1.4336109161376953, c: 0.07367134094238281, d: 1.5158653259277344
2 wait time: 1.056
312
block_info 248 33
cuda:0 process time:3.885984420776367, a: 0.6413459777832031, b: 1.3682842254638672, c: 0.07510185241699219, d: 1.8012523651123047
3 wait time: 2.01
256
0 wait time: 1.568
228
cuda:1 process time:4.311323165893555, a: 0.7710456848144531, b: 1.4026165008544922, c: 0.10085105895996094, d: 2.0368099212646484
1 wait time: 2.526
248
AG, 0.144531, 1.822720, 0 
perpare first forward gemm: 0.299,  fisrt gemm forward duration: 2.513
AG, 0.070175, 1.768448, 0 
perpare first forward gemm: 0.28,  fisrt gemm forward duration: 2.475
AG, 0.133065, 1.831936, 0 
perpare first forward gemm: 0.282,  fisrt gemm forward duration: 1.897
AG, 0.266026, 2.026496, 0 
perpare first forward gemm: 0.317,  fisrt gemm forward duration: 3.115
GA, 0.070175, 1.413120, 0 
GA, 0.133065, 1.567744, 0 
GA, 0.144531, 1.620992, 0 
GA, 0.266026, 2.222080, 0 
forward:  7.462
forward:  6.768
forward:  7.816
forward:  7.428
AG, 0.133065, 1.832960, 0 
AG, 0.144531, 1.806336, 0 
AG, 0.070175, 1.756160, 0 
AG, 0.266026, 1.992704, 0 
Linear 2 Backward: 3.264, second_gemm: 3.252
Linear 2 Backward: 3.326, second_gemm: 3.315
Linear 2 Backward: 3.284, second_gemm: 3.27
Linear 2 Backward: 3.635, second_gemm: 3.622
GA, 0.070175, 1.416192, 0 
GA, 0.133065, 1.576960, 0 
GA, 0.144531, 1.683456, 0 
GA, 0.266026, 2.176000, 0 
perpare first backward gemm: 0.033,  fisrt gemm backward duration: 2.688,  weight grad: 1.54,  other: 0.442
Linear 1 Backward:  4.76
perpare first backward gemm: 0.033,  fisrt gemm backward duration: 2.67,  weight grad: 1.544,  other: 0.416
Linear 1 Backward:  4.707
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 2.606,  weight grad: 1.552,  other: 0.446
Linear 1 Backward:  4.702
perpare first backward gemm: 0.044,  fisrt gemm backward duration: 2.242,  weight grad: 1.799,  other: 0.44
Linear 1 Backward:  4.583
STEP-51: step_time = 21.090305 ms, foward_time = 10.024960, backward_time = 10.939392, perf = 39.10 tflops.
start
start
start
block_info 248 33
block_info 312 83
start
cuda:1 process time:3.232717514038086, a: 0.5769729614257812, b: 1.176595687866211, c: 0.05793571472167969, d: 1.421213150024414
cuda:2 process time:3.370046615600586, a: 0.5035400390625, b: 1.4977455139160156, c: 0.049114227294921875, d: 1.3196468353271484
block_info 256 37
block_info 228 16
1 wait time: 1.332
248
2 wait time: 1.078
312
cuda:0 process time:3.8607120513916016, a: 0.7073879241943359, b: 1.127481460571289, c: 0.07176399230957031, d: 1.9540786743164062
cuda:3 process time:4.108190536499023, a: 0.7469654083251953, b: 1.3027191162109375, c: 0.09512901306152344, d: 1.9633769989013672
0 wait time: 1.254
228
3 wait time: 2.484
256
AG, 0.133065, 1.831936, 0 
perpare first forward gemm: 0.284,  fisrt gemm forward duration: 2.836
AG, 0.070175, 1.790976, 0 
perpare first forward gemm: 0.333,  fisrt gemm forward duration: 2.011
AG, 0.144531, 1.807360, 0 
perpare first forward gemm: 0.284,  fisrt gemm forward duration: 1.871
AG, 0.266026, 2.007040, 0 
perpare first forward gemm: 0.317,  fisrt gemm forward duration: 2.915
GA, 0.070175, 1.402880, 0 
GA, 0.133065, 1.574912, 0 
GA, 0.144531, 1.679360, 0 
GA, 0.266026, 2.210816, 0 
forward:  6.758
forward:  6.988
forward:  7.676
forward:  7.614
AG, 0.133065, 1.838080, 0 
AG, 0.144531, 1.813504, 0 
AG, 0.070175, 1.761280, 0 
AG, 0.266026, 2.042880, 0 
Linear 2 Backward: 3.138, second_gemm: 3.129
Linear 2 Backward: 3.401, second_gemm: 3.389
Linear 2 Backward: 3.418, second_gemm: 3.404
Linear 2 Backward: 3.765, second_gemm: 3.752
GA, 0.070175, 1.389568, 0 
GA, 0.133065, 1.574912, 0 
GA, 0.144531, 1.668096, 0 
GA, 0.266026, 2.201600, 0 
perpare first backward gemm: 0.035,  fisrt gemm backward duration: 2.668,  weight grad: 1.551,  other: 0.438
Linear 1 Backward:  4.749
perpare first backward gemm: 0.039,  fisrt gemm backward duration: 2.648,  weight grad: 1.579,  other: 0.457
Linear 1 Backward:  4.787
perpare first backward gemm: 0.027,  fisrt gemm backward duration: 2.824,  weight grad: 1.545,  other: 0.422
Linear 1 Backward:  4.862
perpare first backward gemm: 0.04,  fisrt gemm backward duration: 2.264,  weight grad: 1.816,  other: 0.442
Linear 1 Backward:  4.621
STEP-52: step_time = 20.620288 ms, foward_time = 9.377792, backward_time = 11.130880, perf = 39.99 tflops.
start
start
start
start
block_info 312 83
cuda:2 process time:3.2613277435302734, a: 0.518798828125, b: 1.4498233795166016, c: 0.04887580871582031, d: 1.2438297271728516
block_info 256 37
2 wait time: 1.269
312
cuda:3 process time:3.576040267944336, a: 0.7205009460449219, b: 1.2822151184082031, c: 0.072479248046875, d: 1.500844955444336
block_info 228 16
block_info 248 33
3 wait time: 1.998
256
cuda:0 process time:4.333019256591797, a: 0.8461475372314453, b: 1.2614727020263672, c: 0.09870529174804688, d: 2.1266937255859375
cuda:1 process time:4.099607467651367, a: 0.7565021514892578, b: 1.2481212615966797, c: 0.09655952453613281, d: 1.9984245300292969
0 wait time: 2.297
228
1 wait time: 2.543
248
AG, 0.070175, 1.782784, 0 
perpare first forward gemm: 0.32,  fisrt gemm forward duration: 1.857
AG, 0.144531, 1.806336, 0 
perpare first forward gemm: 0.29,  fisrt gemm forward duration: 2.615
AG, 0.133065, 1.831936, 0 
perpare first forward gemm: 0.283,  fisrt gemm forward duration: 2.051
AG, 0.266026, 2.017280, 0 
perpare first forward gemm: 0.319,  fisrt gemm forward duration: 3.405
GA, 0.133065, 1.637376, 0 
GA, 0.144531, 1.625088, 0 
GA, 0.070175, 1.484800, 0 
GA, 0.266026, 2.234368, 0 
forward:  6.944
forward:  7.564
forward:  8.148
forward:  6.913
AG, 0.144531, 1.821696, 0 
AG, 0.133065, 1.839104, 0 
AG, 0.070175, 1.765376, 0 
AG, 0.266026, 2.012160, 0 
Linear 2 Backward: 3.226, second_gemm: 3.216
Linear 2 Backward: 3.386, second_gemm: 3.372
Linear 2 Backward: 3.279, second_gemm: 3.267
Linear 2 Backward: 3.709, second_gemm: 3.697
GA, 0.070175, 1.429504, 0 
GA, 0.144531, 1.607680, 0 
GA, 0.133065, 1.581056, 0 
GA, 0.266026, 2.177024, 0 
perpare first backward gemm: 0.029,  fisrt gemm backward duration: 2.752,  weight grad: 1.52,  other: 0.411
Linear 1 Backward:  4.752
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 2.599,  weight grad: 1.553,  other: 0.448
Linear 1 Backward:  4.698
perpare first backward gemm: 0.035,  fisrt gemm backward duration: 2.613,  weight grad: 1.548,  other: 0.409
Linear 1 Backward:  4.649
perpare first backward gemm: 0.04,  fisrt gemm backward duration: 2.256,  weight grad: 1.817,  other: 0.444
Linear 1 Backward:  4.615
STEP-53: step_time = 21.263359 ms, foward_time = 10.185728, backward_time = 10.968064, perf = 38.78 tflops.
start
start
start
start
block_info 248 33
block_info 312 83
block_info 256 37
cuda:1 process time:3.2701492309570312, a: 0.6852149963378906, b: 1.1069774627685547, c: 0.05745887756347656, d: 1.4204978942871094
cuda:2 process time:3.4644603729248047, a: 0.4985332489013672, b: 1.567840576171875, c: 0.04863739013671875, d: 1.3494491577148438
1 wait time: 1.271
248
cuda:3 process time:3.4689903259277344, a: 0.6976127624511719, b: 1.1987686157226562, c: 0.07319450378417969, d: 1.4994144439697266
block_info 228 16
2 wait time: 1.096
312
3 wait time: 1.988
256
cuda:0 process time:4.111766815185547, a: 0.8170604705810547, b: 1.2886524200439453, c: 0.11277198791503906, d: 1.8932819366455078
0 wait time: 2.378
228
AG, 0.144531, 1.821696, 0 
perpare first forward gemm: 0.285,  fisrt gemm forward duration: 2.453
AG, 0.133065, 1.819648, 0 
perpare first forward gemm: 0.28,  fisrt gemm forward duration: 2.927
AG, 0.070175, 1.784832, 0 
perpare first forward gemm: 0.309,  fisrt gemm forward duration: 1.854
AG, 0.266026, 2.010112, 0 
perpare first forward gemm: 0.317,  fisrt gemm forward duration: 2.952
GA, 0.133065, 1.649664, 0 
GA, 0.144531, 1.631232, 0 
GA, 0.070175, 1.516544, 0 
GA, 0.266026, 2.268160, 0 
forward:  7.835
forward:  7.393
forward:  7.704
forward:  6.896
AG, 0.144531, 1.820672, 0 
AG, 0.133065, 1.829888, 0 
AG, 0.070175, 1.778688, 0 
AG, 0.266026, 2.032640, 0 
Linear 2 Backward: 3.396, second_gemm: 3.384
Linear 2 Backward: 3.501, second_gemm: 3.488
Linear 2 Backward: 3.311, second_gemm: 3.297
Linear 2 Backward: 3.834, second_gemm: 3.821
GA, 0.070175, 1.427456, 0 
GA, 0.133065, 1.616896, 0 
GA, 0.144531, 1.668096, 0 
GA, 0.266026, 2.182144, 0 
perpare first backward gemm: 0.034,  fisrt gemm backward duration: 2.671,  weight grad: 1.546,  other: 0.442
Linear 1 Backward:  4.75
perpare first backward gemm: 0.039,  fisrt gemm backward duration: 2.615,  weight grad: 1.58,  other: 0.466
Linear 1 Backward:  4.764
perpare first backward gemm: 0.032,  fisrt gemm backward duration: 2.712,  weight grad: 1.541,  other: 0.439
Linear 1 Backward:  4.779
perpare first backward gemm: 0.041,  fisrt gemm backward duration: 2.246,  weight grad: 1.814,  other: 0.445
Linear 1 Backward:  4.605
STEP-54: step_time = 21.520864 ms, foward_time = 10.295776, backward_time = 11.114496, perf = 38.32 tflops.
start
start
start
start
block_info 312 83
cuda:2 process time:3.479480743408203, a: 0.5059242248535156, b: 1.5981197357177734, c: 0.04863739013671875, d: 1.3267993927001953
block_info 228 16
block_info 256 37
block_info 248 33
2 wait time: 1.073
312
cuda:0 process time:3.6678314208984375, a: 0.8232593536376953, b: 1.0139942169189453, c: 0.07534027099609375, d: 1.7552375793457031
cuda:3 process time:3.5588741302490234, a: 0.7123947143554688, b: 1.196146011352539, c: 0.0782012939453125, d: 1.5721321105957031
cuda:1 process time:4.122018814086914, a: 0.6668567657470703, b: 1.4696121215820312, c: 0.09083747863769531, d: 1.8947124481201172
0 wait time: 1.536
228
3 wait time: 2.072
256
1 wait time: 1.775
248
AG, 0.070175, 1.768448, 0 
perpare first forward gemm: 0.303,  fisrt gemm forward duration: 2.138
AG, 0.144531, 1.822720, 0 
perpare first forward gemm: 0.294,  fisrt gemm forward duration: 2.063
AG, 0.133065, 1.833984, 0 
perpare first forward gemm: 0.282,  fisrt gemm forward duration: 1.895
AG, 0.266026, 2.017280, 0 
perpare first forward gemm: 0.318,  fisrt gemm forward duration: 2.833
GA, 0.144531, 1.615872, 0 
GA, 0.070175, 1.479680, 0 
GA, 0.133065, 1.631232, 0 
GA, 0.266026, 2.255872, 0 
forward:  6.784
forward:  7.033
forward:  7.573
forward:  7.171
AG, 0.144531, 1.811456, 0 
AG, 0.133065, 1.836032, 0 
AG, 0.070175, 1.762304, 0 
AG, 0.266026, 2.009088, 0 
Linear 2 Backward: 3.362, second_gemm: 3.354
Linear 2 Backward: 3.373, second_gemm: 3.361
Linear 2 Backward: 3.474, second_gemm: 3.462
Linear 2 Backward: 3.608, second_gemm: 3.595
GA, 0.070175, 1.425408, 0 
GA, 0.144531, 1.630208, 0 
GA, 0.133065, 1.577984, 0 
GA, 0.266026, 2.182144, 0 
perpare first backward gemm: 0.028,  fisrt gemm backward duration: 2.75,  weight grad: 1.535,  other: 0.428
Linear 1 Backward:  4.786
perpare first backward gemm: 0.034,  fisrt gemm backward duration: 2.63,  weight grad: 1.548,  other: 0.439
Linear 1 Backward:  4.708
perpare first backward gemm: 0.033,  fisrt gemm backward duration: 2.671,  weight grad: 1.545,  other: 0.411
Linear 1 Backward:  4.704
perpare first backward gemm: 0.042,  fisrt gemm backward duration: 2.247,  weight grad: 1.795,  other: 0.439
Linear 1 Backward:  4.583
STEP-55: step_time = 20.868096 ms, foward_time = 9.753600, backward_time = 11.004928, perf = 39.52 tflops.
start
start
start
start
block_info 312 83
cuda:2 process time:3.193378448486328, a: 0.5118846893310547, b: 1.3151168823242188, c: 0.04839897155761719, d: 1.3179779052734375
block_info 256 37
block_info 248 33
2 wait time: 1.062
312
block_info 228 16
cuda:1 process time:3.683328628540039, a: 0.7245540618896484, b: 1.056671142578125, c: 0.07915496826171875, d: 1.8229484558105469
cuda:3 process time:4.0149688720703125, a: 0.6978511810302734, b: 1.2898445129394531, c: 0.07772445678710938, d: 1.9495487213134766
cuda:0 process time:3.871917724609375, a: 0.7221698760986328, b: 1.1398792266845703, c: 0.0858306884765625, d: 1.9240379333496094
3 wait time: 1.784
256
1 wait time: 1.95
248
0 wait time: 1.387
228
AG, 0.070175, 1.765376, 0 
perpare first forward gemm: 0.336,  fisrt gemm forward duration: 1.847
AG, 0.144531, 1.821696, 0 
perpare first forward gemm: 0.29,  fisrt gemm forward duration: 2.212
AG, 0.133065, 1.823744, 0 
perpare first forward gemm: 0.284,  fisrt gemm forward duration: 2.136
AG, 0.266026, 2.019328, 0 
perpare first forward gemm: 0.318,  fisrt gemm forward duration: 2.966
GA, 0.133065, 1.655808, 0 
GA, 0.070175, 1.500160, 0 
GA, 0.144531, 1.746944, 0 
GA, 0.266026, 2.255872, 0 
forward:  7.141
forward:  7.064
forward:  7.69
forward:  6.917
AG, 0.133065, 1.835008, 0 
AG, 0.144531, 1.826816, 0 
AG, 0.070175, 1.768448, 0 
AG, 0.266026, 2.024448, 0 
Linear 2 Backward: 3.177, second_gemm: 3.168
Linear 2 Backward: 3.367, second_gemm: 3.352
Linear 2 Backward: 3.288, second_gemm: 3.274
Linear 2 Backward: 3.673, second_gemm: 3.66
GA, 0.070175, 1.440768, 0 
GA, 0.133065, 1.568768, 0 
GA, 0.144531, 1.670144, 0 
GA, 0.266026, 2.145280, 0 
perpare first backward gemm: 0.038,  fisrt gemm backward duration: 2.547,  weight grad: 1.573,  other: 0.469
Linear 1 Backward:  4.692
perpare first backward gemm: 0.035,  fisrt gemm backward duration: 2.572,  weight grad: 1.551,  other: 0.444
Linear 1 Backward:  4.663
perpare first backward gemm: 0.029,  fisrt gemm backward duration: 2.714,  weight grad: 1.518,  other: 0.423
Linear 1 Backward:  4.724
perpare first backward gemm: 0.039,  fisrt gemm backward duration: 2.207,  weight grad: 1.797,  other: 0.456
Linear 1 Backward:  4.558
STEP-56: step_time = 20.508672 ms, foward_time = 9.414656, backward_time = 10.983424, perf = 40.21 tflops.
start
start
start
start
block_info 248 33
block_info 312 83
cuda:1 process time:2.593994140625, a: 0.5035400390625, b: 1.0192394256591797, c: 0.03981590270996094, d: 1.0313987731933594
cuda:2 process time:3.0570030212402344, a: 0.537872314453125, b: 1.1355876922607422, c: 0.05817413330078125, d: 1.325368881225586
block_info 256 37
1 wait time: 0.906
248
2 wait time: 1.157
312
cuda:3 process time:3.4635066986083984, a: 0.7040500640869141, b: 1.1835098266601562, c: 0.07319450378417969, d: 1.5027523040771484
block_info 228 16
3 wait time: 1.94
256
cuda:0 process time:4.235267639160156, a: 0.8304119110107422, b: 1.3990402221679688, c: 0.09775161743164062, d: 1.9080638885498047
0 wait time: 2.347
228
AG, 0.144531, 1.804288, 0 
perpare first forward gemm: 0.267,  fisrt gemm forward duration: 2.635
AG, 0.070175, 1.779712, 0 
perpare first forward gemm: 0.292,  fisrt gemm forward duration: 1.854
AG, 0.133065, 1.823744, 0 
perpare first forward gemm: 0.274,  fisrt gemm forward duration: 3.286
AG, 0.266026, 1.994752, 0 
perpare first forward gemm: 0.321,  fisrt gemm forward duration: 3.265
GA, 0.070175, 1.495040, 0 
GA, 0.133065, 1.647616, 0 
GA, 0.144531, 1.656832, 0 
GA, 0.266026, 2.177024, 0 
forward:  6.75
forward:  8.086
forward:  7.934
forward:  7.438
AG, 0.133065, 1.836032, 0 
AG, 0.070175, 1.763328, 0 
AG, 0.144531, 1.799168, 0 
AG, 0.266026, 2.006016, 0 
Linear 2 Backward: 3.32, second_gemm: 3.307
Linear 2 Backward: 3.452, second_gemm: 3.439
Linear 2 Backward: 3.28, second_gemm: 3.266
Linear 2 Backward: 3.808, second_gemm: 3.795
GA, 0.070175, 1.419264, 0 
GA, 0.133065, 1.589248, 0 
GA, 0.144531, 1.653760, 0 
GA, 0.266026, 2.186240, 0 
perpare first backward gemm: 0.033,  fisrt gemm backward duration: 2.705,  weight grad: 1.546,  other: 0.444
Linear 1 Backward:  4.784
perpare first backward gemm: 0.041,  fisrt gemm backward duration: 2.609,  weight grad: 1.554,  other: 0.446
Linear 1 Backward:  4.713
perpare first backward gemm: 0.028,  fisrt gemm backward duration: 2.732,  weight grad: 1.555,  other: 0.42
Linear 1 Backward:  4.778
perpare first backward gemm: 0.044,  fisrt gemm backward duration: 2.267,  weight grad: 1.799,  other: 0.44
Linear 1 Backward:  4.607
STEP-57: step_time = 21.360608 ms, foward_time = 10.035168, backward_time = 11.224064, perf = 38.61 tflops.
start
start
block_info 248 33
start
cuda:1 process time:2.5048255920410156, a: 0.4467964172363281, b: 0.8842945098876953, c: 0.03981590270996094, d: 1.1339187622070312
block_info 312 83
start
block_info 256 37
cuda:2 process time:3.367185592651367, a: 0.4863739013671875, b: 1.5115737915039062, c: 0.057697296142578125, d: 1.3115406036376953
1 wait time: 0.3
248
2 wait time: 1.006
312
block_info 228 16
cuda:3 process time:3.586292266845703, a: 0.7536411285400391, b: 1.2578964233398438, c: 0.07462501525878906, d: 1.5001296997070312
3 wait time: 1.87
256
cuda:0 process time:4.119873046875, a: 0.8072853088378906, b: 1.0440349578857422, c: 0.1380443572998047, d: 2.1305084228515625
0 wait time: 2.083
228
AG, 0.070175, 1.770496, 0 
perpare first forward gemm: 0.278,  fisrt gemm forward duration: 1.837
AG, 0.133065, 1.817600, 0 
AG, 0.144531, 1.825792, 0 
perpare first forward gemm: 0.286,  fisrt gemm forward duration: 2.585
perpare first forward gemm: 0.284,  fisrt gemm forward duration: 3.073
AG, 0.266026, 2.004992, 0 
perpare first forward gemm: 0.322,  fisrt gemm forward duration: 3.031
GA, 0.070175, 1.447936, 0 
GA, 0.133065, 1.612800, 0 
GA, 0.144531, 1.645568, 0 
GA, 0.266026, 2.277376, 0 
forward:  7.508
forward:  7.828
forward:  8.027
forward:  6.849
AG, 0.144531, 1.809408, 0 
AG, 0.133065, 1.842176, 0 
AG, 0.070175, 1.769472, 0 
AG, 0.266026, 2.026496, 0 
Linear 2 Backward: 3.458, second_gemm: 3.449
Linear 2 Backward: 3.476, second_gemm: 3.462
Linear 2 Backward: 3.434, second_gemm: 3.42
Linear 2 Backward: 3.628, second_gemm: 3.615
GA, 0.070175, 1.429504, 0 
GA, 0.133065, 1.582080, 0 
GA, 0.144531, 1.668096, 0 
GA, 0.266026, 2.185216, 0 
perpare first backward gemm: 0.037,  fisrt gemm backward duration: 2.628,  weight grad: 1.575,  other: 0.443
Linear 1 Backward:  4.743
perpare first backward gemm: 0.035,  fisrt gemm backward duration: 2.626,  weight grad: 1.552,  other: 0.443
Linear 1 Backward:  4.715
perpare first backward gemm: 0.027,  fisrt gemm backward duration: 2.776,  weight grad: 1.524,  other: 0.42
Linear 1 Backward:  4.789
perpare first backward gemm: 0.039,  fisrt gemm backward duration: 2.247,  weight grad: 1.797,  other: 0.44
Linear 1 Backward:  4.581
STEP-58: step_time = 21.343231 ms, foward_time = 9.932800, backward_time = 11.308032, perf = 38.64 tflops.
start
start
start
start
block_info 312 83
block_info 256 37
block_info 248 33
cuda:2 process time:3.641366958618164, a: 0.7085800170898438, b: 1.3666152954101562, c: 0.05459785461425781, d: 1.5115737915039062
cuda:1 process time:3.3342838287353516, a: 0.5772113800048828, b: 1.1706352233886719, c: 0.09632110595703125, d: 1.4901161193847656
block_info 228 16
2 wait time: 1.417
312
cuda:3 process time:4.035472869873047, a: 0.705718994140625, b: 1.4848709106445312, c: 0.07867813110351562, d: 1.766204833984375
1 wait time: 1.255
248
cuda:0 process time:4.315853118896484, a: 0.6527900695800781, b: 1.4748573303222656, c: 0.10323524475097656, d: 2.084970474243164
3 wait time: 1.942
256
0 wait time: 2.091
228
AG, 0.070175, 1.768448, 0 
perpare first forward gemm: 0.278,  fisrt gemm forward duration: 1.836
AG, 0.144531, 1.815552, 0 
perpare first forward gemm: 0.289,  fisrt gemm forward duration: 2.12
AG, 0.133065, 1.831936, 0 
perpare first forward gemm: 0.285,  fisrt gemm forward duration: 2.445
AG, 0.266026, 1.996800, 0 
perpare first forward gemm: 0.322,  fisrt gemm forward duration: 2.727
GA, 0.070175, 1.413120, 0 
GA, 0.133065, 1.581056, 0 
GA, 0.144531, 1.649664, 0 
GA, 0.266026, 2.243584, 0 
forward:  7.317
forward:  6.775
forward:  7.058
forward:  7.525
AG, 0.144531, 1.818624, 0 
AG, 0.133065, 1.830912, 0 
AG, 0.070175, 1.767424, 0 
AG, 0.266026, 2.024448, 0 
Linear 2 Backward: 3.336, second_gemm: 3.323
Linear 2 Backward: 3.374, second_gemm: 3.361
Linear 2 Backward: 3.382, second_gemm: 3.368
Linear 2 Backward: 3.603, second_gemm: 3.59
GA, 0.144531, 1.609728, 0 
GA, 0.070175, 1.443840, 0 
GA, 0.133065, 1.603584, 0 
GA, 0.266026, 2.186240, 0 
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 2.621,  weight grad: 1.551,  other: 0.443
Linear 1 Backward:  4.712
perpare first backward gemm: 0.035,  fisrt gemm backward duration: 2.679,  weight grad: 1.552,  other: 0.464
Linear 1 Backward:  4.791
perpare first backward gemm: 0.028,  fisrt gemm backward duration: 2.723,  weight grad: 1.552,  other: 0.43
Linear 1 Backward:  4.777
perpare first backward gemm: 0.043,  fisrt gemm backward duration: 2.253,  weight grad: 1.795,  other: 0.44
Linear 1 Backward:  4.588
STEP-59: step_time = 21.207041 ms, foward_time = 9.842688, backward_time = 11.262976, perf = 38.88 tflops.
start
start
start
start
block_info 248 33
cuda:1 process time:2.880096435546875, a: 0.5879402160644531, b: 0.9014606475830078, c: 0.05030632019042969, d: 1.3403892517089844
block_info 228 16
block_info 256 37
1 wait time: 1.253
248
cuda:0 process time:3.781557083129883, a: 0.7760524749755859, b: 1.4712810516357422, c: 0.0762939453125, d: 1.4579296112060547
block_info 312 83
cuda:3 process time:3.8433074951171875, a: 0.7288455963134766, b: 1.4348030090332031, c: 0.09036064147949219, d: 1.5892982482910156
0 wait time: 1.897
228
3 wait time: 2.065
256
cuda:2 process time:4.561185836791992, a: 0.7686614990234375, b: 1.316070556640625, c: 0.09202957153320312, d: 2.3844242095947266
2 wait time: 2.211
312
AG, 0.133065, 1.827840, 0 
perpare first forward gemm: 0.288,  fisrt gemm forward duration: 2.941
AG, 0.144531, 1.806336, 0 
perpare first forward gemm: 0.29,  fisrt gemm forward duration: 2.329
AG, 0.070175, 1.790976, 0 
perpare first forward gemm: 0.278,  fisrt gemm forward duration: 2.452
AG, 0.266026, 2.004992, 0 
perpare first forward gemm: 0.32,  fisrt gemm forward duration: 2.07
GA, 0.070175, 1.451008, 0 
GA, 0.144531, 1.613824, 0 
GA, 0.133065, 1.618944, 0 
GA, 0.266026, 2.208768, 0 
forward:  7.837
forward:  7.236
forward:  7.365
forward:  6.78
AG, 0.070175, 1.790976, 0 
AG, 0.133065, 1.832960, 0 
AG, 0.144531, 1.808384, 0 
AG, 0.266026, 1.996800, 0 
Linear 2 Backward: 3.199, second_gemm: 3.188
Linear 2 Backward: 3.306, second_gemm: 3.294
Linear 2 Backward: 3.325, second_gemm: 3.312
Linear 2 Backward: 3.616, second_gemm: 3.603
GA, 0.070175, 1.434624, 0 
GA, 0.144531, 1.671168, 0 
GA, 0.133065, 1.611776, 0 
GA, 0.266026, 2.184192, 0 
perpare first backward gemm: 0.029,  fisrt gemm backward duration: 2.688,  weight grad: 1.546,  other: 0.409
Linear 1 Backward:  4.715
perpare first backward gemm: 0.033,  fisrt gemm backward duration: 2.64,  weight grad: 1.569,  other: 0.443
Linear 1 Backward:  4.742
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 2.595,  weight grad: 1.548,  other: 0.447
Linear 1 Backward:  4.687
perpare first backward gemm: 0.043,  fisrt gemm backward duration: 2.25,  weight grad: 1.816,  other: 0.461
Linear 1 Backward:  4.628
STEP-60: step_time = 21.276224 ms, foward_time = 10.137152, backward_time = 11.037696, perf = 38.76 tflops.
start
start
start
start
block_info 248 33
block_info 256 37
block_info 228 16
cuda:1 process time:3.028392791748047, a: 0.5733966827392578, b: 1.0917186737060547, c: 0.05054473876953125, d: 1.3127326965332031
cuda:3 process time:3.6857128143310547, a: 0.7162094116210938, b: 1.234292984008789, c: 0.072479248046875, d: 1.6627311706542969
1 wait time: 1.161
248
cuda:0 process time:3.5729408264160156, a: 0.7421970367431641, b: 1.1019706726074219, c: 0.0782012939453125, d: 1.6505718231201172
block_info 312 83
0 wait time: 1.556
228
3 wait time: 1.687
256
cuda:2 process time:4.529476165771484, a: 0.7739067077636719, b: 1.0793209075927734, c: 0.10347366333007812, d: 2.572774887084961
2 wait time: 2.576
312
AG, 0.144531, 1.808384, 0 
perpare first forward gemm: 0.286,  fisrt gemm forward duration: 2.79
AG, 0.070175, 1.773568, 0 
perpare first forward gemm: 0.279,  fisrt gemm forward duration: 2.825
AG, 0.133065, 1.826816, 0 
perpare first forward gemm: 0.285,  fisrt gemm forward duration: 3.23
AG, 0.266026, 2.024448, 0 
perpare first forward gemm: 0.323,  fisrt gemm forward duration: 2.093
GA, 0.070175, 1.422336, 0 
GA, 0.133065, 1.598464, 0 
GA, 0.144531, 1.661952, 0 
GA, 0.266026, 2.172928, 0 
forward:  7.716
forward:  8.08
forward:  7.653
forward:  6.778
AG, 0.144531, 1.825792, 0 
AG, 0.070175, 1.773568, 0 
AG, 0.133065, 1.824768, 0 
AG, 0.266026, 2.031616, 0 
Linear 2 Backward: 3.489, second_gemm: 3.476
Linear 2 Backward: 3.497, second_gemm: 3.484
Linear 2 Backward: 3.345, second_gemm: 3.33
Linear 2 Backward: 3.643, second_gemm: 3.629
GA, 0.070175, 1.448960, 0 
GA, 0.133065, 1.636352, 0 
GA, 0.144531, 1.687552, 0 
GA, 0.266026, 2.177024, 0 
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 2.672,  weight grad: 1.551,  other: 0.456
Linear 1 Backward:  4.777
perpare first backward gemm: 0.039,  fisrt gemm backward duration: 2.615,  weight grad: 1.575,  other: 0.453
Linear 1 Backward:  4.748
perpare first backward gemm: 0.035,  fisrt gemm backward duration: 2.694,  weight grad: 1.545,  other: 0.45
Linear 1 Backward:  4.786
perpare first backward gemm: 0.042,  fisrt gemm backward duration: 2.259,  weight grad: 1.815,  other: 0.45
Linear 1 Backward:  4.627
STEP-61: step_time = 21.696511 ms, foward_time = 10.304512, backward_time = 11.292672, perf = 38.01 tflops.
start
start
start
start
block_info 248 33
block_info 256 37
cuda:1 process time:3.247976303100586, a: 0.568389892578125, b: 1.260995864868164, c: 0.04982948303222656, d: 1.3687610626220703
block_info 228 16
1 wait time: 0.937
248
cuda:3 process time:3.712892532348633, a: 0.7085800170898438, b: 1.4264583587646484, c: 0.07343292236328125, d: 1.5044212341308594
block_info 312 83
3 wait time: 1.995
256
cuda:0 process time:4.092693328857422, a: 0.7920265197753906, b: 1.0738372802734375, c: 0.10037422180175781, d: 2.126455307006836
0 wait time: 2.288
228
cuda:2 process time:4.6672821044921875, a: 0.7288455963134766, b: 1.1472702026367188, c: 0.1049041748046875, d: 2.6862621307373047
2 wait time: 2.658
312
AG, 0.133065, 1.813504, 0 
perpare first forward gemm: 0.286,  fisrt gemm forward duration: 3.342
AG, 0.144531, 1.817600, 0 
perpare first forward gemm: 0.289,  fisrt gemm forward duration: 2.874
AG, 0.070175, 1.777664, 0 
perpare first forward gemm: 0.277,  fisrt gemm forward duration: 2.316
AG, 0.266026, 2.007040, 0 
perpare first forward gemm: 0.323,  fisrt gemm forward duration: 2.074
GA, 0.070175, 1.427456, 0 
GA, 0.133065, 1.617920, 0 
GA, 0.144531, 1.615872, 0 
GA, 0.266026, 2.216960, 0 
forward:  7.769
forward:  7.215
forward:  8.222
forward:  6.79
AG, 0.133065, 1.836032, 0 
AG, 0.144531, 1.819648, 0 
AG, 0.070175, 1.760256, 0 
AG, 0.266026, 2.030592, 0 
Linear 2 Backward: 3.273, second_gemm: 3.261
Linear 2 Backward: 3.273, second_gemm: 3.261
Linear 2 Backward: 3.275, second_gemm: 3.261
Linear 2 Backward: 3.665, second_gemm: 3.652
GA, 0.070175, 1.438720, 0 
GA, 0.133065, 1.563648, 0 
GA, 0.144531, 1.595392, 0 
GA, 0.266026, 2.169856, 0 
perpare first backward gemm: 0.033,  fisrt gemm backward duration: 2.683,  weight grad: 1.541,  other: 0.442
Linear 1 Backward:  4.757
perpare first backward gemm: 0.039,  fisrt gemm backward duration: 2.626,  weight grad: 1.554,  other: 0.445
Linear 1 Backward:  4.725
perpare first backward gemm: 0.03,  fisrt gemm backward duration: 2.689,  weight grad: 1.56,  other: 0.424
Linear 1 Backward:  4.751
perpare first backward gemm: 0.044,  fisrt gemm backward duration: 2.237,  weight grad: 1.796,  other: 0.441
Linear 1 Backward:  4.601
STEP-62: step_time = 21.538815 ms, foward_time = 10.496000, backward_time = 10.942464, perf = 38.29 tflops.
start
start
start
start
block_info 248 33
block_info 256 37
cuda:1 process time:3.2541751861572266, a: 0.5605220794677734, b: 1.3246536254882812, c: 0.051021575927734375, d: 1.3179779052734375
block_info 228 16
1 wait time: 1.195
248
cuda:3 process time:3.6263465881347656, a: 0.7109642028808594, b: 1.2183189392089844, c: 0.07939338684082031, d: 1.6176700592041016
3 wait time: 2.058
256
cuda:0 process time:4.070520401000977, a: 0.7863044738769531, b: 1.0905265808105469, c: 0.09584426879882812, d: 2.0978450775146484
block_info 312 83
0 wait time: 2.202
228
cuda:2 process time:4.822492599487305, a: 0.7343292236328125, b: 1.4100074768066406, c: 0.10514259338378906, d: 2.5730133056640625
2 wait time: 3.031
312
AG, 0.070175, 1.776640, 0 
perpare first forward gemm: 0.273,  fisrt gemm forward duration: 2.645
AG, 0.133065, 1.819648, 0 
perpare first forward gemm: 0.286,  fisrt gemm forward duration: 3.621
AG, 0.144531, 1.813504, 0 
perpare first forward gemm: 0.283,  fisrt gemm forward duration: 3.116
AG, 0.266026, 1.995776, 0 
perpare first forward gemm: 0.319,  fisrt gemm forward duration: 2.061
GA, 0.070175, 1.467392, 0 
GA, 0.133065, 1.600512, 0 
GA, 0.144531, 1.643520, 0 
GA, 0.266026, 2.239488, 0 
forward:  8.482
forward:  7.979
forward:  7.537
forward:  6.838
AG, 0.070175, 1.767424, 0 
AG, 0.133065, 1.830912, 0 
AG, 0.144531, 1.810432, 0 
AG, 0.266026, 2.014208, 0 
Linear 2 Backward: 3.349, second_gemm: 3.336
Linear 2 Backward: 3.279, second_gemm: 3.265
Linear 2 Backward: 3.374, second_gemm: 3.36
Linear 2 Backward: 3.754, second_gemm: 3.741
GA, 0.070175, 1.403904, 0 
GA, 0.133065, 1.582080, 0 
GA, 0.144531, 1.608704, 0 
GA, 0.266026, 2.177024, 0 
perpare first backward gemm: 0.038,  fisrt gemm backward duration: 2.609,  weight grad: 1.542,  other: 0.422
Linear 1 Backward:  4.659
perpare first backward gemm: 0.033,  fisrt gemm backward duration: 2.692,  weight grad: 1.547,  other: 0.454
Linear 1 Backward:  4.784
perpare first backward gemm: 0.035,  fisrt gemm backward duration: 2.619,  weight grad: 1.554,  other: 0.447
Linear 1 Backward:  4.716
perpare first backward gemm: 0.04,  fisrt gemm backward duration: 2.24,  weight grad: 1.808,  other: 0.442
Linear 1 Backward:  4.576
STEP-63: step_time = 21.643264 ms, foward_time = 10.711040, backward_time = 10.831872, perf = 38.10 tflops.
start
start
start
start
block_info 228 16
block_info 248 33
block_info 312 83
cuda:0 process time:3.0868053436279297, a: 0.7340908050537109, b: 0.9562969207763672, c: 0.08487701416015625, d: 1.3115406036376953
block_info 256 37
cuda:1 process time:3.123044967651367, a: 0.6208419799804688, b: 1.1909008026123047, c: 0.051975250244140625, d: 1.2593269348144531
cuda:2 process time:3.2918453216552734, a: 0.6740093231201172, b: 1.0173320770263672, c: 0.05817413330078125, d: 1.5423297882080078
0 wait time: 1.171
228
1 wait time: 1.177
248
cuda:3 process time:3.5560131072998047, a: 0.7212162017822266, b: 1.1484622955322266, c: 0.07748603820800781, d: 1.6088485717773438
2 wait time: 1.541
312
3 wait time: 2.096
256
AG, 0.070175, 1.766400, 0 
perpare first forward gemm: 0.271,  fisrt gemm forward duration: 2.407
AG, 0.144531, 1.808384, 0 
perpare first forward gemm: 0.279,  fisrt gemm forward duration: 1.869
AG, 0.133065, 1.826816, 0 
perpare first forward gemm: 0.276,  fisrt gemm forward duration: 2.367
AG, 0.266026, 2.007040, 0 
perpare first forward gemm: 0.312,  fisrt gemm forward duration: 2.395
GA, 0.070175, 1.440768, 0 
GA, 0.133065, 1.599488, 0 
GA, 0.144531, 1.673216, 0 
GA, 0.266026, 2.224128, 0 
forward:  7.196
forward:  7.292
forward:  7.078
forward:  6.746
AG, 0.070175, 1.758208, 0 
AG, 0.133065, 1.833984, 0 
AG, 0.144531, 1.810432, 0 
AG, 0.266026, 2.020352, 0 
Linear 2 Backward: 3.33, second_gemm: 3.318
Linear 2 Backward: 3.386, second_gemm: 3.371
Linear 2 Backward: 3.27, second_gemm: 3.257
Linear 2 Backward: 3.748, second_gemm: 3.736
GA, 0.070175, 1.432576, 0 
GA, 0.133065, 1.573888, 0 
GA, 0.144531, 1.602560, 0 
GA, 0.266026, 2.177024, 0 
perpare first backward gemm: 0.039,  fisrt gemm backward duration: 2.583,  weight grad: 1.576,  other: 0.452
Linear 1 Backward:  4.717
perpare first backward gemm: 0.034,  fisrt gemm backward duration: 2.6,  weight grad: 1.551,  other: 0.441
Linear 1 Backward:  4.683
perpare first backward gemm: 0.032,  fisrt gemm backward duration: 2.693,  weight grad: 1.544,  other: 0.438
Linear 1 Backward:  4.761
perpare first backward gemm: 0.039,  fisrt gemm backward duration: 2.238,  weight grad: 1.81,  other: 0.452
Linear 1 Backward:  4.596
STEP-64: step_time = 20.783104 ms, foward_time = 9.373696, backward_time = 11.310080, perf = 39.68 tflops.
start
start
start
start
block_info 248 33
block_info 256 37
cuda:1 process time:3.3910274505615234, a: 0.5600452423095703, b: 1.3980865478515625, c: 0.050067901611328125, d: 1.3828277587890625
block_info 228 16
1 wait time: 0.952
248
cuda:3 process time:3.925323486328125, a: 0.7023811340332031, b: 1.3680458068847656, c: 0.08535385131835938, d: 1.7695426940917969
block_info 312 83
3 wait time: 1.916
256
cuda:0 process time:3.991842269897461, a: 0.75531005859375, b: 1.2156963348388672, c: 0.11372566223144531, d: 1.9071102142333984
0 wait time: 2.353
228
cuda:2 process time:4.963397979736328, a: 0.7510185241699219, b: 1.3175010681152344, c: 0.10466575622558594, d: 2.790212631225586
2 wait time: 2.751
312
AG, 0.144531, 1.815552, 0 
perpare first forward gemm: 0.289,  fisrt gemm forward duration: 2.881
AG, 0.133065, 1.826816, 0 
perpare first forward gemm: 0.285,  fisrt gemm forward duration: 3.315
AG, 0.070175, 1.772544, 0 
perpare first forward gemm: 0.278,  fisrt gemm forward duration: 2.478
AG, 0.266026, 2.028544, 0 
perpare first forward gemm: 0.323,  fisrt gemm forward duration: 2.094
GA, 0.070175, 1.441792, 0 
GA, 0.144531, 1.635328, 0 
GA, 0.133065, 1.616896, 0 
GA, 0.266026, 2.200576, 0 
forward:  8.185
forward:  7.432
forward:  7.797
forward:  6.814
AG, 0.144531, 1.820672, 0 
AG, 0.133065, 1.840128, 0 
AG, 0.070175, 1.762304, 0 
AG, 0.266026, 2.031616, 0 
Linear 2 Backward: 3.417, second_gemm: 3.403
Linear 2 Backward: 3.26, second_gemm: 3.247
Linear 2 Backward: 3.479, second_gemm: 3.466
Linear 2 Backward: 3.815, second_gemm: 3.801
GA, 0.070175, 1.442816, 0 
GA, 0.144531, 1.616896, 0 
GA, 0.133065, 1.599488, 0 
GA, 0.266026, 2.197504, 0 
perpare first backward gemm: 0.037,  fisrt gemm backward duration: 2.72,  weight grad: 1.547,  other: 0.447
Linear 1 Backward:  4.812
perpare first backward gemm: 0.029,  fisrt gemm backward duration: 2.767,  weight grad: 1.555,  other: 0.42
Linear 1 Backward:  4.816
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 2.679,  weight grad: 1.555,  other: 0.445
Linear 1 Backward:  4.776
perpare first backward gemm: 0.045,  fisrt gemm backward duration: 2.284,  weight grad: 1.818,  other: 0.449
Linear 1 Backward:  4.66
STEP-65: step_time = 22.139680 ms, foward_time = 10.781471, backward_time = 11.255808, perf = 37.25 tflops.
start
start
start
start
block_info 248 33
cuda:1 process time:3.095865249633789, a: 0.6461143493652344, b: 1.0595321655273438, c: 0.04982948303222656, d: 1.3403892517089844
block_info 256 37
block_info 228 16
1 wait time: 1.144
248
cuda:3 process time:3.8039684295654297, a: 0.7045269012451172, b: 1.1882781982421875, c: 0.07605552673339844, d: 1.8351078033447266
cuda:0 process time:3.836393356323242, a: 0.7421970367431641, b: 0.9379386901855469, c: 0.07534027099609375, d: 2.0809173583984375
3 wait time: 1.925
256
block_info 312 83
0 wait time: 1.906
228
cuda:2 process time:4.865169525146484, a: 0.7357597351074219, b: 1.4548301696777344, c: 0.11754035949707031, d: 2.557039260864258
2 wait time: 3.018
312
AG, 0.070175, 1.775616, 0 
perpare first forward gemm: 0.275,  fisrt gemm forward duration: 2.83
AG, 0.133065, 1.831936, 0 
perpare first forward gemm: 0.282,  fisrt gemm forward duration: 3.599
AG, 0.144531, 1.807360, 0 
perpare first forward gemm: 0.282,  fisrt gemm forward duration: 3.049
AG, 0.266026, 2.025472, 0 
perpare first forward gemm: 0.321,  fisrt gemm forward duration: 2.092
GA, 0.070175, 1.436672, 0 
GA, 0.133065, 1.596416, 0 
GA, 0.144531, 1.672192, 0 
GA, 0.266026, 2.194432, 0 
forward:  8.437
forward:  7.908
forward:  7.711
forward:  6.804
AG, 0.070175, 1.766400, 0 
AG, 0.133065, 1.829888, 0 
AG, 0.144531, 1.811456, 0 
AG, 0.266026, 2.040832, 0 
Linear 2 Backward: 3.426, second_gemm: 3.414
Linear 2 Backward: 3.449, second_gemm: 3.437
Linear 2 Backward: 3.287, second_gemm: 3.273
Linear 2 Backward: 3.828, second_gemm: 3.816
GA, 0.070175, 1.424384, 0 
GA, 0.133065, 1.582080, 0 
GA, 0.144531, 1.644544, 0 
GA, 0.266026, 2.210816, 0 
perpare first backward gemm: 0.033,  fisrt gemm backward duration: 2.768,  weight grad: 1.545,  other: 0.464
Linear 1 Backward:  4.868
perpare first backward gemm: 0.034,  fisrt gemm backward duration: 2.72,  weight grad: 1.553,  other: 0.458
Linear 1 Backward:  4.822
perpare first backward gemm: 0.038,  fisrt gemm backward duration: 2.675,  weight grad: 1.577,  other: 0.478
Linear 1 Backward:  4.817
perpare first backward gemm: 0.041,  fisrt gemm backward duration: 2.279,  weight grad: 1.813,  other: 0.447
Linear 1 Backward:  4.626
STEP-66: step_time = 21.578752 ms, foward_time = 10.542080, backward_time = 10.936320, perf = 38.22 tflops.
start
start
start
start
block_info 248 33
block_info 256 37
cuda:1 process time:3.081083297729492, a: 0.5671977996826172, b: 1.1522769927978516, c: 0.051975250244140625, d: 1.3096332550048828
block_info 228 16
cuda:3 process time:3.347635269165039, a: 0.6923675537109375, b: 1.092672348022461, c: 0.07390975952148438, d: 1.4886856079101562
1 wait time: 1.17
248
3 wait time: 1.993
256
cuda:0 process time:4.166364669799805, a: 0.7379055023193359, b: 1.2760162353515625, c: 0.09655952453613281, d: 2.0558834075927734
block_info 312 83
0 wait time: 2.069
228
cuda:2 process time:5.356550216674805, a: 0.7393360137939453, b: 1.642465591430664, c: 0.12302398681640625, d: 2.851724624633789
2 wait time: 3.347
312
AG, 0.070175, 1.781760, 0 
perpare first forward gemm: 0.269,  fisrt gemm forward duration: 2.916
AG, 0.144531, 1.815552, 0 
perpare first forward gemm: 0.279,  fisrt gemm forward duration: 3.313
AG, 0.133065, 1.821696, 0 
perpare first forward gemm: 0.279,  fisrt gemm forward duration: 3.702
AG, 0.266026, 2.014208, 0 
perpare first forward gemm: 0.312,  fisrt gemm forward duration: 2.074
GA, 0.070175, 1.428480, 0 
GA, 0.133065, 1.604608, 0 
GA, 0.144531, 1.669120, 0 
GA, 0.266026, 2.222080, 0 
forward:  7.772
forward:  8.172
forward:  8.53
forward:  6.746
AG, 0.133065, 1.816576, 0 
AG, 0.070175, 1.753088, 0 
AG, 0.144531, 1.809408, 0 
AG, 0.266026, 2.015232, 0 
Linear 2 Backward: 3.253, second_gemm: 3.241
Linear 2 Backward: 3.378, second_gemm: 3.366
Linear 2 Backward: 3.275, second_gemm: 3.262
Linear 2 Backward: 3.762, second_gemm: 3.75
GA, 0.070175, 1.449984, 0 
GA, 0.133065, 1.567744, 0 
GA, 0.144531, 1.664000, 0 
GA, 0.266026, 2.164736, 0 
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 2.592,  weight grad: 1.549,  other: 0.412
perpare first backward gemm: 0.033,  fisrt gemm backward duration: 2.692,  weight grad: 1.548,  other: 0.41
Linear 1 Backward:  4.635
Linear 1 Backward:  4.726
perpare first backward gemm: 0.034,  fisrt gemm backward duration: 2.639,  weight grad: 1.562,  other: 0.449
Linear 1 Backward:  4.74
perpare first backward gemm: 0.041,  fisrt gemm backward duration: 2.226,  weight grad: 1.795,  other: 0.409
Linear 1 Backward:  4.516
STEP-67: step_time = 21.828608 ms, foward_time = 10.817536, backward_time = 10.911744, perf = 37.78 tflops.
start
start
start
start
block_info 248 33
block_info 312 83
cuda:1 process time:2.904176712036133, a: 0.6661415100097656, b: 0.9260177612304688, c: 0.05269050598144531, d: 1.2593269348144531
block_info 256 37
block_info 228 16
cuda:2 process time:3.154754638671875, a: 0.6008148193359375, b: 1.2383460998535156, c: 0.04839897155761719, d: 1.2671947479248047
2 wait time: 1.169
312
1 wait time: 1.251
248
cuda:0 process time:3.506183624267578, a: 0.7302761077880859, b: 1.2345314025878906, c: 0.09441375732421875, d: 1.4469623565673828
cuda:3 process time:3.3178329467773438, a: 0.6690025329589844, b: 1.087188720703125, c: 0.07414817810058594, d: 1.4874935150146484
0 wait time: 1.847
228
3 wait time: 1.957
256
AG, 0.133065, 1.831936, 0 
perpare first forward gemm: 0.275,  fisrt gemm forward duration: 2.34
AG, 0.070175, 1.779712, 0 
perpare first forward gemm: 0.265,  fisrt gemm forward duration: 1.84
AG, 0.144531, 1.816576, 0 
perpare first forward gemm: 0.274,  fisrt gemm forward duration: 1.887
AG, 0.266026, 2.016256, 0 
perpare first forward gemm: 0.309,  fisrt gemm forward duration: 2.545
GA, 0.070175, 1.434624, 0 
GA, 0.133065, 1.567744, 0 
GA, 0.144531, 1.688576, 0 
GA, 0.266026, 2.235392, 0 
forward:  7.167
forward:  6.726
forward:  7.209
forward:  6.722
AG, 0.070175, 1.766400, 0 
AG, 0.133065, 1.820672, 0 
AG, 0.144531, 1.850368, 0 
AG, 0.266026, 2.029568, 0 
Linear 2 Backward: 3.558, second_gemm: 3.547
Linear 2 Backward: 3.392, second_gemm: 3.38
Linear 2 Backward: 3.317, second_gemm: 3.303
Linear 2 Backward: 4.035, second_gemm: 4.026
GA, 0.070175, 1.421312, 0 
GA, 0.133065, 1.570816, 0 
GA, 0.144531, 1.698816, 0 
GA, 0.266026, 2.209792, 0 
perpare first backward gemm: 0.03,  fisrt gemm backward duration: 2.709,  weight grad: 1.541,  other: 0.447
Linear 1 Backward:  4.778
perpare first backward gemm: 0.038,  fisrt gemm backward duration: 2.547,  weight grad: 1.578,  other: 0.448
Linear 1 Backward:  4.675
perpare first backward gemm: 0.033,  fisrt gemm backward duration: 2.624,  weight grad: 1.542,  other: 0.436
Linear 1 Backward:  4.688
perpare first backward gemm: 0.035,  fisrt gemm backward duration: 2.263,  weight grad: 1.798,  other: 0.427
Linear 1 Backward:  4.569
STEP-68: step_time = 20.681727 ms, foward_time = 9.480192, backward_time = 11.101184, perf = 39.87 tflops.
start
start
start
start
block_info 312 83
block_info 248 33
block_info 228 16
cuda:2 process time:2.9540061950683594, a: 0.48089027404785156, b: 1.1169910430908203, c: 0.04792213439941406, d: 1.3082027435302734
cuda:1 process time:3.210783004760742, a: 0.6265640258789062, b: 1.2183189392089844, c: 0.0514984130859375, d: 1.314401626586914
block_info 256 37
2 wait time: 1.016
312
cuda:0 process time:3.5812854766845703, a: 0.7002353668212891, b: 1.163482666015625, c: 0.07510185241699219, d: 1.642465591430664
1 wait time: 1.173
248
cuda:3 process time:3.721952438354492, a: 0.7300376892089844, b: 1.0323524475097656, c: 0.07987022399902344, d: 1.8796920776367188
0 wait time: 1.834
228
3 wait time: 1.68
256
AG, 0.133065, 1.812480, 0 
perpare first forward gemm: 0.285,  fisrt gemm forward duration: 2.558
AG, 0.070175, 1.778688, 0 
perpare first forward gemm: 0.257,  fisrt gemm forward duration: 2.162
AG, 0.144531, 1.821696, 0 
perpare first forward gemm: 0.304,  fisrt gemm forward duration: 1.896
AG, 0.266026, 2.022400, 0 
perpare first forward gemm: 0.317,  fisrt gemm forward duration: 2.853
GA, 0.070175, 1.403904, 0 
GA, 0.133065, 1.571840, 0 
GA, 0.144531, 1.646592, 0 
GA, 0.266026, 2.301952, 0 
forward:  6.924
forward:  7.527
forward:  7.141
forward:  7.639
AG, 0.070175, 1.767424, 0 
AG, 0.144531, 1.816576, 0 
AG, 0.133065, 1.833984, 0 
AG, 0.266026, 2.032640, 0 
Linear 2 Backward: 3.234, second_gemm: 3.222
Linear 2 Backward: 3.411, second_gemm: 3.399
Linear 2 Backward: 3.516, second_gemm: 3.504
Linear 2 Backward: 3.852, second_gemm: 3.841
GA, 0.144531, 1.613824, 0 
GA, 0.070175, 1.477632, 0 
GA, 0.133065, 1.613824, 0 
GA, 0.266026, 2.193408, 0 
perpare first backward gemm: 0.035,  fisrt gemm backward duration: 2.554,  weight grad: 1.549,  other: 0.442
Linear 1 Backward:  4.636
perpare first backward gemm: 0.035,  fisrt gemm backward duration: 2.625,  weight grad: 1.549,  other: 0.438
Linear 1 Backward:  4.713
perpare first backward gemm: 0.028,  fisrt gemm backward duration: 2.667,  weight grad: 1.551,  other: 0.421
Linear 1 Backward:  4.71
perpare first backward gemm: 0.038,  fisrt gemm backward duration: 2.251,  weight grad: 1.802,  other: 0.443
Linear 1 Backward:  4.583
STEP-69: step_time = 21.111808 ms, foward_time = 9.963520, backward_time = 11.029504, perf = 39.06 tflops.
start
start
start
start
block_info 312 83
block_info 248 33
cuda:2 process time:3.4537315368652344, a: 0.5249977111816406, b: 1.5437602996826172, c: 0.04792213439941406, d: 1.3370513916015625
block_info 256 37
cuda:1 process time:3.5321712493896484, a: 0.5466938018798828, b: 1.5685558319091797, c: 0.05030632019042969, d: 1.3666152954101562
2 wait time: 1.06
312
cuda:3 process time:3.908395767211914, a: 0.7064342498779297, b: 1.3651847839355469, c: 0.08559226989746094, d: 1.7511844635009766
1 wait time: 0.956
248
block_info 228 16
3 wait time: 1.951
256
cuda:0 process time:4.261970520019531, a: 0.7660388946533203, b: 1.1959075927734375, c: 0.14472007751464844, d: 2.155303955078125
0 wait time: 1.956
228
AG, 0.144531, 1.803264, 0 
perpare first forward gemm: 0.289,  fisrt gemm forward duration: 2.448
AG, 0.070175, 1.775616, 0 
perpare first forward gemm: 0.297,  fisrt gemm forward duration: 1.85
AG, 0.133065, 1.822720, 0 
perpare first forward gemm: 0.289,  fisrt gemm forward duration: 2.868
AG, 0.266026, 2.006016, 0 
perpare first forward gemm: 0.321,  fisrt gemm forward duration: 3.216
GA, 0.133065, 1.652736, 0 
GA, 0.070175, 1.500160, 0 
GA, 0.144531, 1.640448, 0 
GA, 0.266026, 2.233344, 0 
forward:  7.355
forward:  7.761
forward:  6.826
forward:  7.954
AG, 0.070175, 1.767424, 0 
AG, 0.144531, 1.815552, 0 
AG, 0.133065, 1.826816, 0 
AG, 0.266026, 2.017280, 0 
Linear 2 Backward: 3.276, second_gemm: 3.263
Linear 2 Backward: 3.37, second_gemm: 3.355
Linear 2 Backward: 3.385, second_gemm: 3.373
Linear 2 Backward: 3.795, second_gemm: 3.785
GA, 0.070175, 1.482752, 0 
GA, 0.144531, 1.623040, 0 
GA, 0.133065, 1.667072, 0 
GA, 0.266026, 2.229248, 0 
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 2.585,  weight grad: 1.551,  other: 0.445
Linear 1 Backward:  4.678
perpare first backward gemm: 0.037,  fisrt gemm backward duration: 2.571,  weight grad: 1.551,  other: 0.443
Linear 1 Backward:  4.666
perpare first backward gemm: 0.039,  fisrt gemm backward duration: 2.539,  weight grad: 1.54,  other: 0.411
Linear 1 Backward:  4.578
perpare first backward gemm: 0.033,  fisrt gemm backward duration: 2.291,  weight grad: 1.793,  other: 0.413
Linear 1 Backward:  4.569
STEP-70: step_time = 21.061631 ms, foward_time = 9.927680, backward_time = 11.035648, perf = 39.15 tflops.
start
start
start
start
block_info 248 33
block_info 312 83
cuda:1 process time:2.9447078704833984, a: 0.4551410675048828, b: 1.0995864868164062, c: 0.05078315734863281, d: 1.3391971588134766
cuda:2 process time:3.4821033477783203, a: 0.5030632019042969, b: 1.580953598022461, c: 0.0476837158203125, d: 1.35040283203125
block_info 228 16
2 wait time: 0.923
312
block_info 256 37
1 wait time: 1.164
248
cuda:0 process time:4.1446685791015625, a: 0.7700920104980469, b: 1.2204647064208984, c: 0.09608268737792969, d: 2.0580291748046875
cuda:3 process time:4.259347915649414, a: 0.7300376892089844, b: 1.4276504516601562, c: 0.09775161743164062, d: 2.003908157348633
0 wait time: 2.077
228
3 wait time: 2.51
256
AG, 0.133065, 1.828864, 0 
perpare first forward gemm: 0.288,  fisrt gemm forward duration: 2.914
AG, 0.070175, 1.770496, 0 
perpare first forward gemm: 0.256,  fisrt gemm forward duration: 2.135
AG, 0.144531, 1.813504, 0 
perpare first forward gemm: 0.291,  fisrt gemm forward duration: 1.88
AG, 0.266026, 2.116608, 0 
perpare first forward gemm: 0.333,  fisrt gemm forward duration: 3.18
GA, 0.070175, 1.426432, 0 
GA, 0.133065, 1.561600, 0 
GA, 0.144531, 1.634304, 0 
GA, 0.266026, 2.188288, 0 
forward:  7.829
forward:  6.84
forward:  7.059
forward:  7.849
AG, 0.070175, 1.770496, 0 
AG, 0.133065, 1.835008, 0 
AG, 0.144531, 1.822720, 0 
AG, 0.266026, 2.007040, 0 
Linear 2 Backward: 3.452, second_gemm: 3.438
Linear 2 Backward: 3.304, second_gemm: 3.291
Linear 2 Backward: 3.289, second_gemm: 3.275
Linear 2 Backward: 3.871, second_gemm: 3.858
GA, 0.070175, 1.441792, 0 
GA, 0.133065, 1.610752, 0 
GA, 0.144531, 1.648640, 0 
GA, 0.266026, 2.168832, 0 
perpare first backward gemm: 0.034,  fisrt gemm backward duration: 2.626,  weight grad: 1.543,  other: 0.444
Linear 1 Backward:  4.704
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 2.587,  weight grad: 1.549,  other: 0.466
Linear 1 Backward:  4.7
perpare first backward gemm: 0.039,  fisrt gemm backward duration: 2.565,  weight grad: 1.578,  other: 0.47
Linear 1 Backward:  4.719
perpare first backward gemm: 0.041,  fisrt gemm backward duration: 2.231,  weight grad: 1.811,  other: 0.439
Linear 1 Backward:  4.579
STEP-71: step_time = 21.429248 ms, foward_time = 10.187776, backward_time = 11.125760, perf = 38.48 tflops.
start
start
start
start
block_info 256 37
block_info 312 83
block_info 248 33
cuda:3 process time:3.1194686889648438, a: 0.7245540618896484, b: 1.3244152069091797, c: 0.07104873657226562, d: 0.99945068359375
cuda:2 process time:3.251791000366211, a: 0.5357265472412109, b: 1.4045238494873047, c: 0.04744529724121094, d: 1.2640953063964844
cuda:1 process time:3.3142566680908203, a: 0.457763671875, b: 1.4379024505615234, c: 0.050067901611328125, d: 1.3685226440429688
3 wait time: 1.391
256
2 wait time: 1.192
312
1 wait time: 0.936
248
block_info 228 16
cuda:0 process time:4.246711730957031, a: 0.7722377777099609, b: 1.1615753173828125, c: 0.1456737518310547, d: 2.167224884033203
0 wait time: 1.95
228
AG, 0.144531, 1.805312, 0 
perpare first forward gemm: 0.288,  fisrt gemm forward duration: 3.161
AG, 0.133065, 1.826816, 0 
perpare first forward gemm: 0.287,  fisrt gemm forward duration: 3.015
AG, 0.070175, 1.790976, 0 
perpare first forward gemm: 0.297,  fisrt gemm forward duration: 1.866
AG, 0.266026, 2.027520, 0 
perpare first forward gemm: 0.304,  fisrt gemm forward duration: 3.37
GA, 0.133065, 1.646592, 0 
GA, 0.070175, 1.531904, 0 
GA, 0.144531, 1.726464, 0 
GA, 0.266026, 2.256896, 0 
forward:  8.052
forward:  7.894
forward:  6.82
forward:  8.034
AG, 0.070175, 1.755136, 0 
AG, 0.144531, 1.814528, 0 
AG, 0.133065, 1.842176, 0 
AG, 0.266026, 1.994752, 0 
Linear 2 Backward: 3.336, second_gemm: 3.323
Linear 2 Backward: 3.364, second_gemm: 3.351
Linear 2 Backward: 3.299, second_gemm: 3.286
Linear 2 Backward: 3.735, second_gemm: 3.727
GA, 0.070175, 1.436672, 0 
GA, 0.144531, 1.617920, 0 
GA, 0.133065, 1.573888, 0 
GA, 0.266026, 2.191360, 0 
perpare first backward gemm: 0.033,  fisrt gemm backward duration: 2.552,  weight grad: 1.548,  other: 0.447
Linear 1 Backward:  4.637
perpare first backward gemm: 0.029,  fisrt gemm backward duration: 2.536,  weight grad: 1.552,  other: 0.423
Linear 1 Backward:  4.586
perpare first backward gemm: 0.037,  fisrt gemm backward duration: 2.46,  weight grad: 1.559,  other: 0.446
Linear 1 Backward:  4.563
perpare first backward gemm: 0.031,  fisrt gemm backward duration: 2.238,  weight grad: 1.775,  other: 0.41
Linear 1 Backward:  4.491
STEP-72: step_time = 20.749311 ms, foward_time = 9.918464, backward_time = 10.730496, perf = 39.74 tflops.
start
start
start
start
block_info 312 83
block_info 248 33
cuda:2 process time:3.176450729370117, a: 0.4913806915283203, b: 1.3167858123779297, c: 0.0476837158203125, d: 1.3206005096435547
block_info 256 37
cuda:1 process time:3.0853748321533203, a: 0.6322860717773438, b: 1.093149185180664, c: 0.04982948303222656, d: 1.310110092163086
2 wait time: 1.032
312
1 wait time: 1.116
248
block_info 228 16
cuda:3 process time:3.4706592559814453, a: 0.6921291351318359, b: 0.9589195251464844, c: 0.07700920104980469, d: 1.7426013946533203
3 wait time: 1.99
256
cuda:0 process time:4.008293151855469, a: 0.7293224334716797, b: 1.275777816772461, c: 0.09632110595703125, d: 1.9068717956542969
0 wait time: 2.5
228
AG, 0.133065, 1.821696, 0 
perpare first forward gemm: 0.284,  fisrt gemm forward duration: 2.882
AG, 0.144531, 1.813504, 0 
perpare first forward gemm: 0.268,  fisrt gemm forward duration: 2.335
AG, 0.070175, 1.766400, 0 
perpare first forward gemm: 0.263,  fisrt gemm forward duration: 1.825
AG, 0.266026, 2.003968, 0 
perpare first forward gemm: 0.312,  fisrt gemm forward duration: 3.086
GA, 0.070175, 1.401856, 0 
GA, 0.133065, 1.565696, 0 
GA, 0.144531, 1.647616, 0 
GA, 0.266026, 2.171904, 0 
forward:  7.667
forward:  7.706
forward:  7.102
forward:  6.648
AG, 0.133065, 1.828864, 0 
AG, 0.144531, 1.820672, 0 
AG, 0.070175, 1.766400, 0 
AG, 0.266026, 2.011136, 0 
Linear 2 Backward: 3.232, second_gemm: 3.219
Linear 2 Backward: 3.305, second_gemm: 3.29
Linear 2 Backward: 3.508, second_gemm: 3.495
Linear 2 Backward: 3.884, second_gemm: 3.87
GA, 0.070175, 1.426432, 0 
GA, 0.133065, 1.592320, 0 
GA, 0.144531, 1.657856, 0 
GA, 0.266026, 2.176000, 0 
perpare first backward gemm: 0.039,  fisrt gemm backward duration: 2.578,  weight grad: 1.576,  other: 0.45
Linear 1 Backward:  4.708
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 2.601,  weight grad: 1.554,  other: 0.447
Linear 1 Backward:  4.699
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 2.671,  weight grad: 1.553,  other: 0.445
Linear 1 Backward:  4.767
perpare first backward gemm: 0.042,  fisrt gemm backward duration: 2.24,  weight grad: 1.801,  other: 0.445
Linear 1 Backward:  4.589
STEP-73: step_time = 21.515264 ms, foward_time = 10.139648, backward_time = 11.251712, perf = 38.33 tflops.
start
start
start
block_info 312 83
block_info 248 33
cuda:1 process time:3.0918121337890625, a: 0.5764961242675781, b: 1.09100341796875, c: 0.049591064453125, d: 1.3747215270996094
block_info 228 16
start
cuda:2 process time:3.5963058471679688, a: 0.5137920379638672, b: 1.6474723815917969, c: 0.04792213439941406, d: 1.3871192932128906
1 wait time: 0.967
248
block_info 256 37
2 wait time: 0.305
312
cuda:0 process time:3.693103790283203, a: 0.6656646728515625, b: 1.1892318725585938, c: 0.07796287536621094, d: 1.760244369506836
0 wait time: 1.643
228
cuda:3 process time:4.255533218383789, a: 0.7791519165039062, b: 1.1436939239501953, c: 0.10395050048828125, d: 2.2287368774414062
3 wait time: 2.163
256
AG, 0.133065, 1.835008, 0 
perpare first forward gemm: 0.293,  fisrt gemm forward duration: 2.929
AG, 0.070175, 1.775616, 0 
perpare first forward gemm: 0.296,  fisrt gemm forward duration: 2.311
AG, 0.144531, 1.815552, 0 
perpare first forward gemm: 0.3,  fisrt gemm forward duration: 1.893
AG, 0.266026, 2.022400, 0 
perpare first forward gemm: 0.334,  fisrt gemm forward duration: 2.947
GA, 0.070175, 1.507328, 0 
GA, 0.133065, 1.648640, 0 
GA, 0.144531, 1.721344, 0 
GA, 0.266026, 2.276352, 0 
forward:  7.9
forward:  6.904
forward:  7.378
forward:  7.774
AG, 0.070175, 1.770496, 0 
AG, 0.144531, 1.810432, 0 
AG, 0.133065, 1.838080, 0 
AG, 0.266026, 2.019328, 0 
Linear 2 Backward: 3.256, second_gemm: 3.242
Linear 2 Backward: 3.24, second_gemm: 3.227
Linear 2 Backward: 3.35, second_gemm: 3.336
Linear 2 Backward: 3.682, second_gemm: 3.674
GA, 0.070175, 1.464320, 0 
GA, 0.144531, 1.632256, 0 
GA, 0.133065, 1.623040, 0 
GA, 0.266026, 2.187264, 0 
perpare first backward gemm: 0.037,  fisrt gemm backward duration: 2.487,  weight grad: 1.549,  other: 0.446
Linear 1 Backward:  4.579
perpare first backward gemm: 0.027,  fisrt gemm backward duration: 2.655,  weight grad: 1.55,  other: 0.419
Linear 1 Backward:  4.694
perpare first backward gemm: 0.039,  fisrt gemm backward duration: 2.534,  weight grad: 1.566,  other: 0.444
Linear 1 Backward:  4.647
perpare first backward gemm: 0.034,  fisrt gemm backward duration: 2.243,  weight grad: 1.811,  other: 0.422
Linear 1 Backward:  4.553
STEP-74: step_time = 21.046271 ms, foward_time = 10.023936, backward_time = 10.921984, perf = 39.18 tflops.
start
start
start
start
block_info 248 33
block_info 312 83
block_info 228 16
block_info 256 37
cuda:1 process time:2.989053726196289, a: 0.5884170532226562, b: 1.0502338409423828, c: 0.05245208740234375, d: 1.2979507446289062
cuda:2 process time:3.2160282135009766, a: 0.4711151123046875, b: 1.3599395751953125, c: 0.048160552978515625, d: 1.336812973022461
cuda:0 process time:3.2820701599121094, a: 0.6566047668457031, b: 1.1532306671142578, c: 0.06127357482910156, d: 1.4109611511230469
1 wait time: 1.119
248
2 wait time: 0.635
312
cuda:3 process time:3.5369396209716797, a: 0.7512569427490234, b: 1.0504722595214844, c: 0.07724761962890625, d: 1.6579627990722656
0 wait time: 1.155
228
3 wait time: 1.742
256
AG, 0.070175, 1.772544, 0 
perpare first forward gemm: 0.269,  fisrt gemm forward duration: 2.219
AG, 0.133065, 1.837056, 0 
perpare first forward gemm: 0.287,  fisrt gemm forward duration: 2.354
AG, 0.144531, 1.807360, 0 
perpare first forward gemm: 0.288,  fisrt gemm forward duration: 1.872
AG, 0.266026, 2.030592, 0 
perpare first forward gemm: 0.322,  fisrt gemm forward duration: 2.437
GA, 0.070175, 1.408000, 0 
GA, 0.133065, 1.568768, 0 
GA, 0.144531, 1.662976, 0 
GA, 0.266026, 2.198528, 0 
forward:  7.138
forward:  7.214
forward:  6.831
forward:  7.277
AG, 0.070175, 1.767424, 0 
AG, 0.144531, 1.814528, 0 
AG, 0.133065, 1.822720, 0 
AG, 0.266026, 2.048000, 0 
Linear 2 Backward: 3.299, second_gemm: 3.285
Linear 2 Backward: 3.448, second_gemm: 3.435
Linear 2 Backward: 3.311, second_gemm: 3.298
Linear 2 Backward: 3.656, second_gemm: 3.647
GA, 0.070175, 1.483776, 0 
GA, 0.133065, 1.649664, 0 
GA, 0.144531, 1.656832, 0 
GA, 0.266026, 2.165760, 0 
perpare first backward gemm: 0.042,  fisrt gemm backward duration: 2.529,  weight grad: 1.573,  other: 0.451
Linear 1 Backward:  4.662
perpare first backward gemm: 0.037,  fisrt gemm backward duration: 2.557,  weight grad: 1.573,  other: 0.447
Linear 1 Backward:  4.674
perpare first backward gemm: 0.037,  fisrt gemm backward duration: 2.522,  weight grad: 1.549,  other: 0.446
Linear 1 Backward:  4.616
perpare first backward gemm: 0.034,  fisrt gemm backward duration: 2.214,  weight grad: 1.811,  other: 0.415
Linear 1 Backward:  4.513
STEP-75: step_time = 20.571137 ms, foward_time = 9.259008, backward_time = 11.210752, perf = 40.09 tflops.
start
start
start
start
block_info 312 83
block_info 248 33
block_info 256 37
cuda:2 process time:3.397703170776367, a: 0.4897117614746094, b: 1.4896392822265625, c: 0.047206878662109375, d: 1.371145248413086
cuda:1 process time:3.5271644592285156, a: 0.5698204040527344, b: 1.5180110931396484, c: 0.051021575927734375, d: 1.3883113861083984
block_info 228 16
cuda:3 process time:3.568410873413086, a: 0.7603168487548828, b: 1.0180473327636719, c: 0.07224082946777344, d: 1.7178058624267578
2 wait time: 0.669
312
1 wait time: 0.999
248
3 wait time: 1.696
256
cuda:0 process time:4.490852355957031, a: 0.7462501525878906, b: 1.5301704406738281, c: 0.09632110595703125, d: 2.1181106567382812
0 wait time: 2.142
228
AG, 0.144531, 1.818624, 0 
perpare first forward gemm: 0.298,  fisrt gemm forward duration: 2.374
AG, 0.133065, 1.833984, 0 
perpare first forward gemm: 0.294,  fisrt gemm forward duration: 2.668
AG, 0.070175, 1.776640, 0 
perpare first forward gemm: 0.29,  fisrt gemm forward duration: 1.848
AG, 0.266026, 2.030592, 0 
perpare first forward gemm: 0.325,  fisrt gemm forward duration: 2.94
GA, 0.070175, 1.461248, 0 
GA, 0.144531, 1.634304, 0 
GA, 0.133065, 1.625088, 0 
GA, 0.266026, 2.203648, 0 
forward:  7.187
forward:  7.448
forward:  6.694
forward:  7.563
AG, 0.070175, 1.761280, 0 
AG, 0.144531, 1.811456, 0 
AG, 0.133065, 1.853440, 0 
AG, 0.266026, 1.992704, 0 
Linear 2 Backward: 3.41, second_gemm: 3.4
Linear 2 Backward: 3.252, second_gemm: 3.239
Linear 2 Backward: 3.336, second_gemm: 3.322
Linear 2 Backward: 3.652, second_gemm: 3.638
GA, 0.070175, 1.457152, 0 
GA, 0.144531, 1.653760, 0 
GA, 0.133065, 1.619968, 0 
GA, 0.266026, 2.198528, 0 
perpare first backward gemm: 0.026,  fisrt gemm backward duration: 2.769,  weight grad: 1.546,  other: 0.413
Linear 1 Backward:  4.792
perpare first backward gemm: 0.038,  fisrt gemm backward duration: 2.619,  weight grad: 1.555,  other: 0.453
Linear 1 Backward:  4.73
perpare first backward gemm: 0.04,  fisrt gemm backward duration: 2.652,  weight grad: 1.573,  other: 0.447
Linear 1 Backward:  4.783
perpare first backward gemm: 0.046,  fisrt gemm backward duration: 2.268,  weight grad: 1.823,  other: 0.454
Linear 1 Backward:  4.658
STEP-76: step_time = 21.210112 ms, foward_time = 9.807872, backward_time = 11.302912, perf = 38.88 tflops.
start
start
start
start
block_info 312 83
block_info 248 33
cuda:2 process time:2.9783248901367188, a: 0.5540847778320312, b: 1.1172294616699219, c: 0.047206878662109375, d: 1.2598037719726562
block_info 228 16
block_info 256 37
cuda:1 process time:3.1850337982177734, a: 0.5691051483154297, b: 1.1429786682128906, c: 0.05269050598144531, d: 1.4202594757080078
2 wait time: 1.257
312
cuda:0 process time:3.4554004669189453, a: 0.7245540618896484, b: 1.2085437774658203, c: 0.07653236389160156, d: 1.445770263671875
cuda:3 process time:3.5500526428222656, a: 0.6678104400634766, b: 1.026153564453125, c: 0.07772445678710938, d: 1.7783641815185547
1 wait time: 1.28
248
0 wait time: 1.894
228
3 wait time: 1.753
256
AG, 0.133065, 1.819648, 0 
perpare first forward gemm: 0.299,  fisrt gemm forward duration: 2.248
AG, 0.070175, 1.767424, 0 
perpare first forward gemm: 0.255,  fisrt gemm forward duration: 2.137
AG, 0.144531, 1.813504, 0 
perpare first forward gemm: 0.299,  fisrt gemm forward duration: 1.884
AG, 0.266026, 2.015232, 0 
perpare first forward gemm: 0.304,  fisrt gemm forward duration: 2.74
GA, 0.070175, 1.438720, 0 
GA, 0.133065, 1.572864, 0 
GA, 0.144531, 1.747968, 0 
GA, 0.266026, 2.270208, 0 
forward:  6.814
forward:  7.164
forward:  7.025
forward:  7.442
AG, 0.070175, 1.760256, 0 
AG, 0.144531, 1.820672, 0 
AG, 0.133065, 1.831936, 0 
AG, 0.266026, 2.024448, 0 
Linear 2 Backward: 3.416, second_gemm: 3.403
Linear 2 Backward: 3.296, second_gemm: 3.281
Linear 2 Backward: 3.338, second_gemm: 3.323
Linear 2 Backward: 3.878, second_gemm: 3.868
GA, 0.070175, 1.455104, 0 
GA, 0.144531, 1.648640, 0 
GA, 0.133065, 1.618944, 0 
GA, 0.266026, 2.211840, 0 
perpare first backward gemm: 0.038,  fisrt gemm backward duration: 2.571,  weight grad: 1.559,  other: 0.452
Linear 1 Backward:  4.686
perpare first backward gemm: 0.042,  fisrt gemm backward duration: 2.581,  weight grad: 1.578,  other: 0.449
Linear 1 Backward:  4.717
perpare first backward gemm: 0.039,  fisrt gemm backward duration: 2.57,  weight grad: 1.577,  other: 0.452
Linear 1 Backward:  4.703
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 2.266,  weight grad: 1.798,  other: 0.43
Linear 1 Backward:  4.579
STEP-77: step_time = 21.114848 ms, foward_time = 9.770976, backward_time = 11.242496, perf = 39.05 tflops.
start
start
start
start
block_info 312 83
block_info 248 33
cuda:2 process time:3.1952857971191406, a: 0.5853176116943359, b: 1.2819766998291016, c: 0.04744529724121094, d: 1.2805461883544922
cuda:1 process time:3.031015396118164, a: 0.6759166717529297, b: 1.287221908569336, c: 0.054836273193359375, d: 1.013040542602539
block_info 228 16
block_info 256 37
2 wait time: 1.153
312
1 wait time: 1.482
248
cuda:0 process time:3.608226776123047, a: 0.7216930389404297, b: 1.36566162109375, c: 0.07748603820800781, d: 1.4433860778808594
cuda:3 process time:3.493785858154297, a: 0.6773471832275391, b: 0.9765625, c: 0.07796287536621094, d: 1.7619132995605469
0 wait time: 1.882
228
3 wait time: 1.925
256
AG, 0.070175, 1.772544, 0 
perpare first forward gemm: 0.255,  fisrt gemm forward duration: 2.066
AG, 0.133065, 1.810432, 0 
perpare first forward gemm: 0.274,  fisrt gemm forward duration: 2.434
AG, 0.144531, 1.810432, 0 
perpare first forward gemm: 0.271,  fisrt gemm forward duration: 1.869
AG, 0.266026, 1.999872, 0 
perpare first forward gemm: 0.321,  fisrt gemm forward duration: 2.721
GA, 0.070175, 1.410048, 0 
GA, 0.133065, 1.574912, 0 
GA, 0.144531, 1.659904, 0 
GA, 0.266026, 2.203648, 0 
forward:  7.307
forward:  6.921
forward:  6.715
forward:  7.482
AG, 0.144531, 1.807360, 0 
AG, 0.133065, 1.836032, 0 
AG, 0.070175, 1.748992, 0 
AG, 0.266026, 2.021376, 0 
Linear 2 Backward: 3.573, second_gemm: 3.565
Linear 2 Backward: 3.385, second_gemm: 3.37
Linear 2 Backward: 3.466, second_gemm: 3.451
Linear 2 Backward: 3.548, second_gemm: 3.538
GA, 0.070175, 1.424384, 0 
GA, 0.133065, 1.567744, 0 
GA, 0.144531, 1.590272, 0 
GA, 0.266026, 2.202624, 0 
perpare first backward gemm: 0.024,  fisrt gemm backward duration: 2.753,  weight grad: 1.52,  other: 0.415
Linear 1 Backward:  4.748
perpare first backward gemm: 0.038,  fisrt gemm backward duration: 2.533,  weight grad: 1.599,  other: 0.411
Linear 1 Backward:  4.63
perpare first backward gemm: 0.039,  fisrt gemm backward duration: 2.462,  weight grad: 1.585,  other: 0.414
Linear 1 Backward:  4.55
perpare first backward gemm: 0.032,  fisrt gemm backward duration: 2.254,  weight grad: 1.799,  other: 0.411
Linear 1 Backward:  4.536
STEP-78: step_time = 20.699327 ms, foward_time = 9.652416, backward_time = 10.945536, perf = 39.84 tflops.
start
start
block_info 312 83
block_info 248 33
block_info 256 37
cuda:2 process time:2.974271774291992, a: 0.4239082336425781, b: 1.2402534484863281, c: 0.04839897155761719, d: 1.2617111206054688
cuda:1 process time:3.234386444091797, a: 0.6239414215087891, b: 1.1279582977294922, c: 0.0514984130859375, d: 1.4309883117675781
cuda:3 process time:3.381013870239258, a: 0.8826255798339844, b: 0.8454322814941406, c: 0.07843971252441406, d: 1.5745162963867188
start
block_info 228 16
start
2 wait time: 0.011
312
3 wait time: 2.082
256
1 wait time: 0.312
248
cuda:0 process time:4.103183746337891, a: 0.7233619689941406, b: 1.3713836669921875, c: 0.10395050048828125, d: 1.9044876098632812
0 wait time: 2.421
228
AG, 0.144531, 1.809408, 0 
perpare first forward gemm: 0.275,  fisrt gemm forward duration: 2.516
AG, 0.133065, 1.830912, 0 
perpare first forward gemm: 0.31,  fisrt gemm forward duration: 2.406
AG, 0.070175, 1.782784, 0 
perpare first forward gemm: 0.264,  fisrt gemm forward duration: 1.844
AG, 0.266026, 2.004992, 0 
perpare first forward gemm: 0.34,  fisrt gemm forward duration: 2.767
GA, 0.070175, 1.434624, 0 
GA, 0.144531, 1.648640, 0 
GA, 0.133065, 1.560576, 0 
GA, 0.266026, 2.174976, 0 
forward:  7.346
forward:  7.379
forward:  6.757
forward:  7.547
AG, 0.070175, 1.764352, 0 
AG, 0.133065, 1.827840, 0 
AG, 0.144531, 1.817600, 0 
AG, 0.266026, 2.031616, 0 
Linear 2 Backward: 3.156, second_gemm: 3.146
Linear 2 Backward: 3.355, second_gemm: 3.344
Linear 2 Backward: 3.344, second_gemm: 3.333
Linear 2 Backward: 3.854, second_gemm: 3.846
GA, 0.070175, 1.402880, 0 
GA, 0.133065, 1.580032, 0 
GA, 0.144531, 1.606656, 0 
GA, 0.266026, 2.180096, 0 
perpare first backward gemm: 0.044,  fisrt gemm backward duration: 2.618,  weight grad: 1.563,  other: 0.436
perpare first backward gemm: 0.026,  fisrt gemm backward duration: 2.754,  weight grad: 1.525,  other: 0.424
Linear 1 Backward:  4.768
perpare first backward gemm: 0.033,  fisrt gemm backward duration: 2.605,  weight grad: 1.538,  other: 0.433
Linear 1 Backward:  4.666
Linear 1 Backward:  4.716
perpare first backward gemm: 0.038,  fisrt gemm backward duration: 2.238,  weight grad: 1.795,  other: 0.434
Linear 1 Backward:  4.557
STEP-79: step_time = 21.122465 ms, foward_time = 10.136992, backward_time = 10.855424, perf = 39.04 tflops.
start
start
start
start
block_info 312 83
block_info 248 33
cuda:2 process time:3.4627914428710938, a: 0.5064010620117188, b: 1.6646385192871094, c: 0.04696846008300781, d: 1.2447834014892578
block_info 256 37
cuda:1 process time:3.4401416778564453, a: 0.60272216796875, b: 1.4998912811279297, c: 0.05221366882324219, d: 1.2853145599365234
block_info 228 16
2 wait time: 1.197
312
1 wait time: 1.213
248
cuda:3 process time:3.728628158569336, a: 0.6623268127441406, b: 1.276254653930664, c: 0.07653236389160156, d: 1.7135143280029297
cuda:0 process time:3.7813186645507812, a: 0.8206367492675781, b: 1.3327598571777344, c: 0.08177757263183594, d: 1.5461444854736328
3 wait time: 1.897
256
0 wait time: 2.051
228
AG, 0.144531, 1.809408, 0 
perpare first forward gemm: 0.294,  fisrt gemm forward duration: 2.185
AG, 0.133065, 1.818624, 0 
perpare first forward gemm: 0.273,  fisrt gemm forward duration: 2.625
AG, 0.070175, 1.799168, 0 
perpare first forward gemm: 0.299,  fisrt gemm forward duration: 1.874
AG, 0.266026, 2.029568, 0 
perpare first forward gemm: 0.305,  fisrt gemm forward duration: 2.971
GA, 0.070175, 1.464320, 0 
GA, 0.144531, 1.640448, 0 
GA, 0.133065, 1.651712, 0 
GA, 0.266026, 2.266112, 0 
forward:  7.025
forward:  6.827
forward:  7.451
forward:  7.595
AG, 0.133065, 1.813504, 0 
AG, 0.144531, 1.822720, 0 
AG, 0.070175, 1.768448, 0 
AG, 0.266026, 2.031616, 0 
Linear 2 Backward: 3.363, second_gemm: 3.352
Linear 2 Backward: 3.311, second_gemm: 3.299
Linear 2 Backward: 3.294, second_gemm: 3.279
Linear 2 Backward: 3.726, second_gemm: 3.715
GA, 0.070175, 1.446912, 0 
GA, 0.133065, 1.622016, 0 
GA, 0.144531, 1.599488, 0 
GA, 0.266026, 2.185216, 0 
perpare first backward gemm: 0.038,  fisrt gemm backward duration: 2.558,  weight grad: 1.553,  other: 0.411
Linear 1 Backward:  4.608
perpare first backward gemm: 0.033,  fisrt gemm backward duration: 2.636,  weight grad: 1.571,  other: 0.441
Linear 1 Backward:  4.741
perpare first backward gemm: 0.031,  fisrt gemm backward duration: 2.669,  weight grad: 1.538,  other: 0.461
Linear 1 Backward:  4.765
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 2.241,  weight grad: 1.803,  other: 0.43
Linear 1 Backward:  4.551
STEP-80: step_time = 20.894209 ms, foward_time = 9.910784, backward_time = 10.884096, perf = 39.47 tflops.
start
start
start
block_info 312 83
block_info 248 33
block_info 256 37
cuda:2 process time:3.167867660522461, a: 0.4627704620361328, b: 1.2662410736083984, c: 0.04863739013671875, d: 1.390218734741211
block_info 228 16
cuda:1 process time:3.0226707458496094, a: 0.6313323974609375, b: 1.0118484497070312, c: 0.05698204040527344, d: 1.3225078582763672
start
cuda:3 process time:3.499269485473633, a: 0.6878376007080078, b: 1.256704330444336, c: 0.07367134094238281, d: 1.4810562133789062
2 wait time: 0.267
312
1 wait time: 1.169
248
cuda:0 process time:3.5619735717773438, a: 0.7200241088867188, b: 1.226186752319336, c: 0.07987022399902344, d: 1.5358924865722656
3 wait time: 1.953
256
0 wait time: 2.021
228
AG, 0.070175, 1.774592, 0 
perpare first forward gemm: 0.267,  fisrt gemm forward duration: 1.865
AG, 0.144531, 1.805312, 0 
perpare first forward gemm: 0.278,  fisrt gemm forward duration: 1.866
AG, 0.133065, 1.827840, 0 
perpare first forward gemm: 0.279,  fisrt gemm forward duration: 2.261
AG, 0.266026, 2.010112, 0 
perpare first forward gemm: 0.339,  fisrt gemm forward duration: 2.403
GA, 0.070175, 1.432576, 0 
GA, 0.133065, 1.584128, 0 
GA, 0.144531, 1.660928, 0 
GA, 0.266026, 2.189312, 0 
forward:  7.171
forward:  6.854
forward:  7.216
forward:  6.808
AG, 0.144531, 1.851392, 0 
AG, 0.133065, 1.842176, 0 
AG, 0.070175, 1.772544, 0 
AG, 0.266026, 2.031616, 0 
Linear 2 Backward: 3.225, second_gemm: 3.213
Linear 2 Backward: 3.417, second_gemm: 3.405
Linear 2 Backward: 3.345, second_gemm: 3.33
Linear 2 Backward: 3.63, second_gemm: 3.622
GA, 0.070175, 1.409024, 0 
GA, 0.133065, 1.585152, 0 
GA, 0.144531, 1.627136, 0 
GA, 0.266026, 2.176000, 0 
perpare first backward gemm: 0.029,  fisrt gemm backward duration: 2.587,  weight grad: 1.555,  other: 0.425
Linear 1 Backward:  4.642
perpare first backward gemm: 0.033,  fisrt gemm backward duration: 2.619,  weight grad: 1.543,  other: 0.441
Linear 1 Backward:  4.691
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 2.532,  weight grad: 1.551,  other: 0.462
Linear 1 Backward:  4.641
perpare first backward gemm: 0.033,  fisrt gemm backward duration: 2.231,  weight grad: 1.798,  other: 0.424
Linear 1 Backward:  4.53
STEP-81: step_time = 20.667392 ms, foward_time = 9.800704, backward_time = 10.735616, perf = 39.90 tflops.
start
start
start
start
block_info 248 33
block_info 256 37
cuda:1 process time:3.2110214233398438, a: 0.5559921264648438, b: 1.2874603271484375, c: 0.051975250244140625, d: 1.3155937194824219
block_info 228 16
1 wait time: 1.131
248
cuda:3 process time:3.5965442657470703, a: 0.6854534149169922, b: 1.178741455078125, c: 0.07271766662597656, d: 1.6596317291259766
cuda:0 process time:3.634214401245117, a: 0.6806850433349609, b: 1.0006427764892578, c: 0.07987022399902344, d: 1.873016357421875
block_info 312 83
3 wait time: 1.701
256
0 wait time: 1.575
228
cuda:2 process time:4.544973373413086, a: 0.7336139678955078, b: 1.0876655578613281, c: 0.07653236389160156, d: 2.6471614837646484
2 wait time: 2.715
312
AG, 0.144531, 1.810432, 0 
perpare first forward gemm: 0.283,  fisrt gemm forward duration: 2.901
AG, 0.070175, 1.764352, 0 
perpare first forward gemm: 0.296,  fisrt gemm forward duration: 2.674
AG, 0.133065, 1.816576, 0 
perpare first forward gemm: 0.265,  fisrt gemm forward duration: 3.282
AG, 0.266026, 2.021376, 0 
perpare first forward gemm: 0.322,  fisrt gemm forward duration: 2.086
GA, 0.133065, 1.645568, 0 
GA, 0.144531, 1.645568, 0 
GA, 0.070175, 1.499136, 0 
GA, 0.266026, 2.200576, 0 
forward:  7.634
forward:  7.768
forward:  6.791
forward:  8.132
AG, 0.144531, 1.812480, 0 
AG, 0.070175, 1.753088, 0 
AG, 0.133065, 1.827840, 0 
AG, 0.266026, 2.044928, 0 
Linear 2 Backward: 3.227, second_gemm: 3.213
Linear 2 Backward: 3.293, second_gemm: 3.28
Linear 2 Backward: 3.341, second_gemm: 3.328
Linear 2 Backward: 3.706, second_gemm: 3.693
GA, 0.070175, 1.433600, 0 
GA, 0.144531, 1.658880, 0 
GA, 0.133065, 1.575936, 0 
GA, 0.266026, 2.196480, 0 
perpare first backward gemm: 0.029,  fisrt gemm backward duration: 2.79,  weight grad: 1.552,  other: 0.42
Linear 1 Backward:  4.836
perpare first backward gemm: 0.035,  fisrt gemm backward duration: 2.763,  weight grad: 1.548,  other: 0.447
Linear 1 Backward:  4.855
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 2.696,  weight grad: 1.558,  other: 0.448
Linear 1 Backward:  4.799
perpare first backward gemm: 0.045,  fisrt gemm backward duration: 2.268,  weight grad: 1.823,  other: 0.448
Linear 1 Backward:  4.644
STEP-82: step_time = 21.536768 ms, foward_time = 10.223616, backward_time = 11.212800, perf = 38.29 tflops.
start
start
start
block_info 248 33
block_info 228 16
start
block_info 256 37
cuda:1 process time:3.446817398071289, a: 0.5626678466796875, b: 1.374959945678711, c: 0.05030632019042969, d: 1.458883285522461
block_info 312 83
cuda:0 process time:3.8347244262695312, a: 0.7481575012207031, b: 1.4646053314208984, c: 0.08225440979003906, d: 1.5397071838378906
cuda:3 process time:3.6919116973876953, a: 0.7715225219726562, b: 1.0421276092529297, c: 0.07653236389160156, d: 1.8017292022705078
1 wait time: 0.512
248
0 wait time: 2.101
228
3 wait time: 1.826
256
cuda:2 process time:4.43577766418457, a: 0.7238388061523438, b: 1.3108253479003906, c: 0.08797645568847656, d: 2.3131370544433594
2 wait time: 2.341
312
AG, 0.133065, 1.839104, 0 
AG, 0.070175, 1.772544, 0 
perpare first forward gemm: 0.261,  fisrt gemm forward duration: 2.353
AG, 0.144531, 1.832960, 0 
perpare first forward gemm: 0.301,  fisrt gemm forward duration: 2.319
perpare first forward gemm: 0.306,  fisrt gemm forward duration: 2.598
AG, 0.266026, 2.048000, 0 
perpare first forward gemm: 0.323,  fisrt gemm forward duration: 2.114
GA, 0.070175, 1.420288, 0 
GA, 0.133065, 1.572864, 0 
GA, 0.144531, 1.627136, 0 
GA, 0.266026, 2.257920, 0 
forward:  7.587
forward:  7.288
forward:  6.882
forward:  7.358
AG, 0.144531, 1.802240, 0 
AG, 0.133065, 1.823744, 0 
AG, 0.070175, 1.774592, 0 
AG, 0.266026, 2.025472, 0 
Linear 2 Backward: 3.251, second_gemm: 3.238
Linear 2 Backward: 3.482, second_gemm: 3.467
Linear 2 Backward: 3.471, second_gemm: 3.458
Linear 2 Backward: 3.854, second_gemm: 3.842
GA, 0.070175, 1.423360, 0 
GA, 0.133065, 1.583104, 0 
GA, 0.144531, 1.644544, 0 
GA, 0.266026, 2.210816, 0 
perpare first backward gemm: 0.035,  fisrt gemm backward duration: 2.696,  weight grad: 1.543,  other: 0.447
Linear 1 Backward:  4.781
perpare first backward gemm: 0.037,  fisrt gemm backward duration: 2.63,  weight grad: 1.553,  other: 0.448
Linear 1 Backward:  4.728
perpare first backward gemm: 0.038,  fisrt gemm backward duration: 2.648,  weight grad: 1.542,  other: 0.41
Linear 1 Backward:  4.686
perpare first backward gemm: 0.04,  fisrt gemm backward duration: 2.272,  weight grad: 1.811,  other: 0.442
Linear 1 Backward:  4.623
STEP-83: step_time = 21.506241 ms, foward_time = 10.463424, backward_time = 10.915840, perf = 38.34 tflops.
start
start
start
start
block_info 248 33
block_info 256 37
block_info 312 83
cuda:1 process time:3.2935142517089844, a: 0.5583763122558594, b: 1.3890266418457031, c: 0.05125999450683594, d: 1.294851303100586
block_info 228 16
1 wait time: 1.131
248
cuda:3 process time:3.7970542907714844, a: 0.6859302520751953, b: 1.279592514038086, c: 0.07724761962890625, d: 1.7542839050292969
cuda:2 process time:3.8826465606689453, a: 0.6928443908691406, b: 1.2509822845458984, c: 0.06413459777832031, d: 1.874685287475586
cuda:0 process time:3.742694854736328, a: 0.8611679077148438, b: 1.0192394256591797, c: 0.14543533325195312, d: 1.7168521881103516
3 wait time: 1.864
256
2 wait time: 1.827
312
0 wait time: 1.711
228
AG, 0.144531, 1.814528, 0 
perpare first forward gemm: 0.285,  fisrt gemm forward duration: 2.01
AG, 0.133065, 1.827840, 0 
perpare first forward gemm: 0.283,  fisrt gemm forward duration: 2.518
AG, 0.070175, 1.772544, 0 
perpare first forward gemm: 0.298,  fisrt gemm forward duration: 1.846
AG, 0.266026, 2.024448, 0 
perpare first forward gemm: 0.318,  fisrt gemm forward duration: 2.145
GA, 0.070175, 1.487872, 0 
GA, 0.144531, 1.638400, 0 
GA, 0.133065, 1.650688, 0 
GA, 0.266026, 2.220032, 0 
forward:  6.892
forward:  7.385
forward:  6.816
forward:  6.851
AG, 0.070175, 1.754112, 0 
AG, 0.144531, 1.820672, 0 
AG, 0.133065, 1.830912, 0 
AG, 0.266026, 2.030592, 0 
Linear 2 Backward: 3.217, second_gemm: 3.205
Linear 2 Backward: 3.496, second_gemm: 3.486
Linear 2 Backward: 3.291, second_gemm: 3.277
Linear 2 Backward: 3.793, second_gemm: 3.781
GA, 0.070175, 1.464320, 0 
GA, 0.133065, 1.639424, 0 
GA, 0.144531, 1.657856, 0 
GA, 0.266026, 2.186240, 0 
perpare first backward gemm: 0.038,  fisrt gemm backward duration: 2.59,  weight grad: 1.575,  other: 0.452
Linear 1 Backward:  4.72
perpare first backward gemm: 0.029,  fisrt gemm backward duration: 2.675,  weight grad: 1.526,  other: 0.409
Linear 1 Backward:  4.678
perpare first backward gemm: 0.033,  fisrt gemm backward duration: 2.701,  weight grad: 1.54,  other: 0.445
Linear 1 Backward:  4.776
perpare first backward gemm: 0.039,  fisrt gemm backward duration: 2.246,  weight grad: 1.811,  other: 0.437
Linear 1 Backward:  4.586
STEP-84: step_time = 20.842496 ms, foward_time = 9.572352, backward_time = 11.169792, perf = 39.57 tflops.
start
start
start
start
block_info 248 33
block_info 228 16
cuda:1 process time:3.2584667205810547, a: 0.5674362182617188, b: 1.2745857238769531, c: 0.051975250244140625, d: 1.3644695281982422
block_info 312 83
1 wait time: 1.023
248
cuda:0 process time:3.500699996948242, a: 0.6208419799804688, b: 1.16729736328125, c: 0.06580352783203125, d: 1.6467571258544922
block_info 256 37
cuda:2 process time:3.90625, a: 0.70953369140625, b: 1.0771751403808594, c: 0.07772445678710938, d: 2.0418167114257812
0 wait time: 1.512
228
cuda:3 process time:4.004716873168945, a: 0.7166862487792969, b: 1.180410385131836, c: 0.09489059448242188, d: 2.0127296447753906
2 wait time: 2.039
312
3 wait time: 2.545
256
AG, 0.070175, 1.774592, 0 
perpare first forward gemm: 0.278,  fisrt gemm forward duration: 2.321
AG, 0.133065, 1.835008, 0 
perpare first forward gemm: 0.288,  fisrt gemm forward duration: 2.83
AG, 0.144531, 1.796096, 0 
perpare first forward gemm: 0.267,  fisrt gemm forward duration: 1.851
AG, 0.266026, 1.991680, 0 
perpare first forward gemm: 0.323,  fisrt gemm forward duration: 2.286
GA, 0.070175, 1.422336, 0 
GA, 0.144531, 1.662976, 0 
GA, 0.133065, 1.596416, 0 
GA, 0.266026, 2.172928, 0 
forward:  7.24
forward:  6.681
forward:  7.672
forward:  7.038
AG, 0.133065, 1.827840, 0 
AG, 0.070175, 1.767424, 0 
AG, 0.144531, 1.816576, 0 
AG, 0.266026, 2.002944, 0 
Linear 2 Backward: 3.406, second_gemm: 3.396
Linear 2 Backward: 3.38, second_gemm: 3.367
Linear 2 Backward: 3.331, second_gemm: 3.317
Linear 2 Backward: 3.752, second_gemm: 3.74
GA, 0.070175, 1.510400, 0 
GA, 0.133065, 1.667072, 0 
GA, 0.144531, 1.648640, 0 
GA, 0.266026, 2.210816, 0 
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 2.552,  weight grad: 1.542,  other: 0.408
Linear 1 Backward:  4.586
perpare first backward gemm: 0.028,  fisrt gemm backward duration: 2.716,  weight grad: 1.549,  other: 0.424
Linear 1 Backward:  4.763
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 2.671,  weight grad: 1.554,  other: 0.451
Linear 1 Backward:  4.771
perpare first backward gemm: 0.04,  fisrt gemm backward duration: 2.272,  weight grad: 1.793,  other: 0.441
Linear 1 Backward:  4.603
STEP-85: step_time = 21.113855 ms, foward_time = 9.787392, backward_time = 11.222016, perf = 39.06 tflops.
start
start
start
start
block_info 248 33
block_info 256 37
cuda:1 process time:3.3936500549316406, a: 0.5438327789306641, b: 1.4183521270751953, c: 0.04982948303222656, d: 1.3816356658935547
block_info 228 16
block_info 312 83
cuda:3 process time:3.653287887573242, a: 0.8115768432617188, b: 1.0390281677246094, c: 0.07271766662597656, d: 1.7299652099609375
1 wait time: 0.912
248
cuda:0 process time:3.988981246948242, a: 0.7460117340087891, b: 1.3768672943115234, c: 0.09131431579589844, d: 1.7747879028320312
3 wait time: 1.752
256
cuda:2 process time:4.314661026000977, a: 0.7455348968505859, b: 1.2428760528564453, c: 0.09036064147949219, d: 2.235889434814453
0 wait time: 2.244
228
2 wait time: 2.329
312
AG, 0.070175, 1.772544, 0 
perpare first forward gemm: 0.264,  fisrt gemm forward duration: 2.131
AG, 0.133065, 1.823744, 0 
perpare first forward gemm: 0.287,  fisrt gemm forward duration: 2.758
AG, 0.144531, 1.823744, 0 
perpare first forward gemm: 0.305,  fisrt gemm forward duration: 2.318
AG, 0.266026, 2.050048, 0 
perpare first forward gemm: 0.328,  fisrt gemm forward duration: 2.117
GA, 0.070175, 1.424384, 0 
GA, 0.133065, 1.568768, 0 
GA, 0.144531, 1.671168, 0 
GA, 0.266026, 2.239488, 0 
forward:  7.717
forward:  7.312
forward:  7.158
forward:  6.938
AG, 0.070175, 1.760256, 0 
AG, 0.133065, 1.838080, 0 
AG, 0.144531, 1.813504, 0 
AG, 0.266026, 2.053120, 0 
Linear 2 Backward: 3.237, second_gemm: 3.224
Linear 2 Backward: 3.587, second_gemm: 3.575
Linear 2 Backward: 3.476, second_gemm: 3.462
Linear 2 Backward: 3.789, second_gemm: 3.776
GA, 0.070175, 1.494016, 0 
GA, 0.133065, 1.639424, 0 
GA, 0.144531, 1.642496, 0 
GA, 0.266026, 2.226176, 0 
perpare first backward gemm: 0.035,  fisrt gemm backward duration: 2.774,  weight grad: 1.544,  other: 0.445
Linear 1 Backward:  4.856
perpare first backward gemm: 0.032,  fisrt gemm backward duration: 2.755,  weight grad: 1.528,  other: 0.414
Linear 1 Backward:  4.772
perpare first backward gemm: 0.037,  fisrt gemm backward duration: 2.669,  weight grad: 1.575,  other: 0.45
Linear 1 Backward:  4.797
perpare first backward gemm: 0.04,  fisrt gemm backward duration: 2.289,  weight grad: 1.848,  other: 0.446
Linear 1 Backward:  4.683
STEP-86: step_time = 21.875327 ms, foward_time = 10.450560, backward_time = 11.301888, perf = 37.70 tflops.
start
start
start
start
block_info 248 33
cuda:1 process time:3.2927989959716797, a: 0.6301403045654297, b: 1.3053417205810547, c: 0.05269050598144531, d: 1.30462646484375
block_info 312 83
block_info 256 37
block_info 228 16
1 wait time: 1.351
248
cuda:2 process time:3.9916038513183594, a: 0.6000995635986328, b: 1.3928413391113281, c: 0.07271766662597656, d: 1.9259452819824219
cuda:0 process time:4.022359848022461, a: 0.812530517578125, b: 1.0216236114501953, c: 0.08988380432128906, d: 2.0983219146728516
cuda:3 process time:4.195451736450195, a: 0.6043910980224609, b: 1.3921260833740234, c: 0.0934600830078125, d: 2.1054744720458984
2 wait time: 1.731
312
3 wait time: 2.256
256
0 wait time: 1.925
228
AG, 0.144531, 1.803264, 0 
perpare first forward gemm: 0.267,  fisrt gemm forward duration: 2.013
AG, 0.133065, 1.825792, 0 
perpare first forward gemm: 0.265,  fisrt gemm forward duration: 2.806
AG, 0.070175, 1.781760, 0 
perpare first forward gemm: 0.297,  fisrt gemm forward duration: 1.858
AG, 0.266026, 2.052096, 0 
perpare first forward gemm: 0.324,  fisrt gemm forward duration: 2.461
GA, 0.070175, 1.495040, 0 
GA, 0.133065, 1.668096, 0 
GA, 0.144531, 1.664000, 0 
GA, 0.266026, 2.193408, 0 
forward:  6.844
forward:  7.674
forward:  7.18
forward:  6.934
AG, 0.133065, 1.832960, 0 
AG, 0.070175, 1.770496, 0 
AG, 0.144531, 1.815552, 0 
AG, 0.266026, 2.046976, 0 
Linear 2 Backward: 3.224, second_gemm: 3.212
Linear 2 Backward: 3.476, second_gemm: 3.464
Linear 2 Backward: 3.396, second_gemm: 3.382
Linear 2 Backward: 3.865, second_gemm: 3.852
GA, 0.070175, 1.421312, 0 
GA, 0.144531, 1.611776, 0 
GA, 0.133065, 1.579008, 0 
GA, 0.266026, 2.177024, 0 
perpare first backward gemm: 0.029,  fisrt gemm backward duration: 2.743,  weight grad: 1.554,  other: 0.425
Linear 1 Backward:  4.799
perpare first backward gemm: 0.034,  fisrt gemm backward duration: 2.731,  weight grad: 1.543,  other: 0.443
Linear 1 Backward:  4.808
perpare first backward gemm: 0.039,  fisrt gemm backward duration: 2.606,  weight grad: 1.559,  other: 0.451
Linear 1 Backward:  4.718
perpare first backward gemm: 0.044,  fisrt gemm backward duration: 2.245,  weight grad: 1.813,  other: 0.443
Linear 1 Backward:  4.603
STEP-87: step_time = 20.961280 ms, foward_time = 9.808896, backward_time = 11.051008, perf = 39.34 tflops.
start
start
start
start
block_info 248 33
block_info 228 16
cuda:1 process time:3.417491912841797, a: 0.5931854248046875, b: 1.3675689697265625, c: 0.050067901611328125, d: 1.4066696166992188
block_info 256 37
cuda:0 process time:3.6852359771728516, a: 0.7357597351074219, b: 1.2085437774658203, c: 0.07414817810058594, d: 1.6667842864990234
block_info 312 83
1 wait time: 0.694
248
0 wait time: 1.788
228
cuda:3 process time:4.033327102661133, a: 0.7586479187011719, b: 1.0390281677246094, c: 0.09417533874511719, d: 2.1414756774902344
cuda:2 process time:4.528522491455078, a: 0.7386207580566406, b: 1.3580322265625, c: 0.0934600830078125, d: 2.338409423828125
3 wait time: 2.263
256
2 wait time: 2.33
312
AG, 0.070175, 1.770496, 0 
perpare first forward gemm: 0.274,  fisrt gemm forward duration: 2.425
AG, 0.133065, 1.843200, 0 
perpare first forward gemm: 0.306,  fisrt gemm forward duration: 2.65
AG, 0.144531, 1.808384, 0 
perpare first forward gemm: 0.293,  fisrt gemm forward duration: 1.943
AG, 0.266026, 2.019328, 0 
perpare first forward gemm: 0.319,  fisrt gemm forward duration: 2.084
GA, 0.070175, 1.419264, 0 
GA, 0.144531, 1.631232, 0 
GA, 0.133065, 1.570816, 0 
GA, 0.266026, 2.251776, 0 
forward:  7.366
forward:  7.576
forward:  6.868
forward:  6.818
AG, 0.144531, 1.826816, 0 
AG, 0.070175, 1.777664, 0 
AG, 0.133065, 1.843200, 0 
AG, 0.266026, 2.042880, 0 
Linear 2 Backward: 3.262, second_gemm: 3.249
Linear 2 Backward: 3.353, second_gemm: 3.341
Linear 2 Backward: 3.312, second_gemm: 3.297
Linear 2 Backward: 3.669, second_gemm: 3.656
GA, 0.070175, 1.431552, 0 
GA, 0.133065, 1.577984, 0 
GA, 0.144531, 1.623040, 0 
GA, 0.266026, 2.216960, 0 
perpare first backward gemm: 0.038,  fisrt gemm backward duration: 2.621,  weight grad: 1.542,  other: 0.406
Linear 1 Backward:  4.655
perpare first backward gemm: 0.034,  fisrt gemm backward duration: 2.718,  weight grad: 1.544,  other: 0.441
Linear 1 Backward:  4.794
perpare first backward gemm: 0.034,  fisrt gemm backward duration: 2.639,  weight grad: 1.547,  other: 0.44
Linear 1 Backward:  4.718
perpare first backward gemm: 0.04,  fisrt gemm backward duration: 2.278,  weight grad: 1.813,  other: 0.463
Linear 1 Backward:  4.653
STEP-88: step_time = 21.254144 ms, foward_time = 10.126336, backward_time = 11.026432, perf = 38.80 tflops.
start
start
start
start
block_info 248 33
cuda:1 process time:3.0791759490966797, a: 0.5636215209960938, b: 1.1289119720458984, c: 0.091552734375, d: 1.2950897216796875
block_info 228 16
1 wait time: 1.141
248
block_info 256 37
cuda:0 process time:3.460407257080078, a: 0.743865966796875, b: 1.1887550354003906, c: 0.07653236389160156, d: 1.451253890991211
block_info 312 83
0 wait time: 1.96
228
cuda:3 process time:4.0378570556640625, a: 0.7331371307373047, b: 1.1012554168701172, c: 0.09393692016601562, d: 2.109527587890625
cuda:2 process time:4.39000129699707, a: 0.5779266357421875, b: 1.4278888702392578, c: 0.09250640869140625, d: 2.2916793823242188
3 wait time: 2.311
256
2 wait time: 2.306
312
AG, 0.144531, 1.820672, 0 
perpare first forward gemm: 0.28,  fisrt gemm forward duration: 2.004
AG, 0.070175, 1.780736, 0 
perpare first forward gemm: 0.275,  fisrt gemm forward duration: 2.335
AG, 0.133065, 1.819648, 0 
perpare first forward gemm: 0.282,  fisrt gemm forward duration: 3.001
AG, 0.266026, 2.010112, 0 
perpare first forward gemm: 0.319,  fisrt gemm forward duration: 2.074
GA, 0.070175, 1.422336, 0 
GA, 0.133065, 1.617920, 0 
GA, 0.144531, 1.625088, 0 
GA, 0.266026, 2.226176, 0 
forward:  7.874
forward:  6.865
forward:  6.794
forward:  7.311
AG, 0.144531, 1.815552, 0 
AG, 0.133065, 1.848320, 0 
AG, 0.070175, 1.768448, 0 
AG, 0.266026, 2.001920, 0 
Linear 2 Backward: 3.244, second_gemm: 3.232
Linear 2 Backward: 3.556, second_gemm: 3.546
Linear 2 Backward: 3.488, second_gemm: 3.475
Linear 2 Backward: 3.814, second_gemm: 3.801
GA, 0.070175, 1.444864, 0 
GA, 0.144531, 1.626112, 0 
GA, 0.133065, 1.600512, 0 
GA, 0.266026, 2.167808, 0 
perpare first backward gemm: 0.03,  fisrt gemm backward duration: 2.644,  weight grad: 1.554,  other: 0.423
Linear 1 Backward:  4.699
perpare first backward gemm: 0.033,  fisrt gemm backward duration: 2.642,  weight grad: 1.541,  other: 0.441
Linear 1 Backward:  4.714
perpare first backward gemm: 0.034,  fisrt gemm backward duration: 2.59,  weight grad: 1.548,  other: 0.442
Linear 1 Backward:  4.67
perpare first backward gemm: 0.042,  fisrt gemm backward duration: 2.233,  weight grad: 1.813,  other: 0.46
Linear 1 Backward:  4.606
STEP-89: step_time = 21.373568 ms, foward_time = 10.260096, backward_time = 11.011072, perf = 38.58 tflops.
start
start
start
start
block_info 248 33
block_info 228 16
cuda:1 process time:3.1430721282958984, a: 0.5660057067871094, b: 1.1806488037109375, c: 0.04935264587402344, d: 1.3470649719238281
block_info 256 37
1 wait time: 1.017
248
block_info 312 83
cuda:0 process time:3.509521484375, a: 0.7081031799316406, b: 1.1293888092041016, c: 0.09799003601074219, d: 1.5740394592285156
0 wait time: 2.053
228
cuda:3 process time:4.082441329956055, a: 0.7236003875732422, b: 1.1091232299804688, c: 0.09560585021972656, d: 2.154111862182617
cuda:2 process time:4.236936569213867, a: 0.7221698760986328, b: 1.1057853698730469, c: 0.09298324584960938, d: 2.315998077392578
3 wait time: 2.293
256
2 wait time: 2.308
312
AG, 0.070175, 1.780736, 0 
perpare first forward gemm: 0.262,  fisrt gemm forward duration: 2.381
AG, 0.144531, 1.819648, 0 
perpare first forward gemm: 0.28,  fisrt gemm forward duration: 1.957
AG, 0.133065, 1.829888, 0 
perpare first forward gemm: 0.283,  fisrt gemm forward duration: 2.913
AG, 0.266026, 2.016256, 0 
perpare first forward gemm: 0.318,  fisrt gemm forward duration: 2.079
GA, 0.070175, 1.427456, 0 
GA, 0.133065, 1.577984, 0 
GA, 0.144531, 1.642496, 0 
GA, 0.266026, 2.222080, 0 
forward:  7.769
forward:  6.809
forward:  6.786
forward:  7.279
AG, 0.144531, 1.807360, 0 
AG, 0.133065, 1.836032, 0 
AG, 0.070175, 1.772544, 0 
AG, 0.266026, 2.027520, 0 
Linear 2 Backward: 3.41, second_gemm: 3.397
Linear 2 Backward: 3.478, second_gemm: 3.465
Linear 2 Backward: 3.28, second_gemm: 3.267
Linear 2 Backward: 3.841, second_gemm: 3.828
GA, 0.070175, 1.460224, 0 
GA, 0.144531, 1.643520, 0 
GA, 0.133065, 1.634304, 0 
GA, 0.266026, 2.171904, 0 
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 2.651,  weight grad: 1.546,  other: 0.449
Linear 1 Backward:  4.742
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 2.632,  weight grad: 1.549,  other: 0.469
Linear 1 Backward:  4.748
perpare first backward gemm: 0.028,  fisrt gemm backward duration: 2.73,  weight grad: 1.551,  other: 0.419
Linear 1 Backward:  4.773
perpare first backward gemm: 0.043,  fisrt gemm backward duration: 2.256,  weight grad: 1.811,  other: 0.448
Linear 1 Backward:  4.614
STEP-90: step_time = 21.623039 ms, foward_time = 10.352896, backward_time = 11.144192, perf = 38.14 tflops.
start
start
start
start
block_info 248 33
cuda:1 process time:3.2944679260253906, a: 0.5955696105957031, b: 1.3418197631835938, c: 0.04982948303222656, d: 1.3072490692138672
block_info 312 83
block_info 256 37
block_info 228 16
1 wait time: 1.186
248
cuda:3 process time:3.7488937377929688, a: 0.7455348968505859, b: 1.3427734375, c: 0.09560585021972656, d: 1.5649795532226562
cuda:2 process time:3.8657188415527344, a: 0.7197856903076172, b: 1.1510848999023438, c: 0.07224082946777344, d: 1.922607421875
cuda:0 process time:3.689289093017578, a: 0.7030963897705078, b: 0.9973049163818359, c: 0.080108642578125, d: 1.9087791442871094
2 wait time: 1.738
312
3 wait time: 2.073
256
0 wait time: 1.544
228
AG, 0.070175, 1.764352, 0 
perpare first forward gemm: 0.266,  fisrt gemm forward duration: 1.825
AG, 0.144531, 1.815552, 0 
perpare first forward gemm: 0.279,  fisrt gemm forward duration: 1.963
AG, 0.133065, 1.821696, 0 
perpare first forward gemm: 0.286,  fisrt gemm forward duration: 2.577
AG, 0.266026, 2.021376, 0 
perpare first forward gemm: 0.306,  fisrt gemm forward duration: 2.188
GA, 0.070175, 1.422336, 0 
GA, 0.133065, 1.587200, 0 
GA, 0.144531, 1.728512, 0 
GA, 0.266026, 2.351104, 0 
forward:  6.932
forward:  7.564
forward:  6.846
forward:  7.001
AG, 0.070175, 1.763328, 0 
AG, 0.144531, 1.810432, 0 
AG, 0.133065, 1.831936, 0 
AG, 0.266026, 2.048000, 0 
Linear 2 Backward: 3.461, second_gemm: 3.447
Linear 2 Backward: 3.399, second_gemm: 3.385
Linear 2 Backward: 3.508, second_gemm: 3.495
Linear 2 Backward: 3.656, second_gemm: 3.643
GA, 0.070175, 1.431552, 0 
GA, 0.133065, 1.612800, 0 
GA, 0.144531, 1.652736, 0 
GA, 0.266026, 2.196480, 0 
perpare first backward gemm: 0.037,  fisrt gemm backward duration: 2.669,  weight grad: 1.567,  other: 0.459
Linear 1 Backward:  4.794
perpare first backward gemm: 0.035,  fisrt gemm backward duration: 2.724,  weight grad: 1.548,  other: 0.447
Linear 1 Backward:  4.816
perpare first backward gemm: 0.039,  fisrt gemm backward duration: 2.659,  weight grad: 1.54,  other: 0.407
Linear 1 Backward:  4.693
perpare first backward gemm: 0.041,  fisrt gemm backward duration: 2.278,  weight grad: 1.835,  other: 0.447
Linear 1 Backward:  4.659
STEP-91: step_time = 20.801536 ms, foward_time = 9.521152, backward_time = 11.175936, perf = 39.64 tflops.
start
start
start
start
block_info 256 37
block_info 248 33
cuda:1 process time:3.458261489868164, a: 0.5478858947753906, b: 1.4917850494384766, c: 0.05054473876953125, d: 1.3680458068847656
cuda:3 process time:3.469705581665039, a: 0.6823539733886719, b: 1.38092041015625, c: 0.06556510925292969, d: 1.3408660888671875
block_info 312 83
block_info 228 16
1 wait time: 0.968
248
3 wait time: 1.77
256
cuda:2 process time:4.315853118896484, a: 0.6592273712158203, b: 1.5876293182373047, c: 0.07081031799316406, d: 1.9981861114501953
cuda:0 process time:4.004955291748047, a: 0.7636547088623047, b: 1.2392997741699219, c: 0.09822845458984375, d: 1.9037723541259766
2 wait time: 1.842
312
0 wait time: 2.436
228
AG, 0.144531, 1.803264, 0 
perpare first forward gemm: 0.269,  fisrt gemm forward duration: 2.726
AG, 0.070175, 1.787904, 0 
perpare first forward gemm: 0.279,  fisrt gemm forward duration: 1.882
AG, 0.133065, 1.837056, 0 
perpare first forward gemm: 0.286,  fisrt gemm forward duration: 2.836
AG, 0.266026, 2.017280, 0 
perpare first forward gemm: 0.344,  fisrt gemm forward duration: 2.093
GA, 0.070175, 1.441792, 0 
GA, 0.133065, 1.589248, 0 
GA, 0.144531, 1.616896, 0 
GA, 0.266026, 2.200576, 0 
forward:  6.864
forward:  7.774
forward:  6.98
forward:  7.675
AG, 0.133065, 1.836032, 0 
AG, 0.070175, 1.766400, 0 
AG, 0.144531, 1.812480, 0 
AG, 0.266026, 2.036736, 0 
Linear 2 Backward: 3.381, second_gemm: 3.368
Linear 2 Backward: 3.297, second_gemm: 3.282
Linear 2 Backward: 3.407, second_gemm: 3.394
Linear 2 Backward: 3.664, second_gemm: 3.651
GA, 0.070175, 1.427456, 0 
GA, 0.133065, 1.601536, 0 
GA, 0.144531, 1.645568, 0 
GA, 0.266026, 2.204672, 0 
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 2.731,  weight grad: 1.545,  other: 0.447
Linear 1 Backward:  4.818
perpare first backward gemm: 0.038,  fisrt gemm backward duration: 2.652,  weight grad: 1.572,  other: 0.449
Linear 1 Backward:  4.775
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 2.677,  weight grad: 1.553,  other: 0.447
Linear 1 Backward:  4.772
perpare first backward gemm: 0.04,  fisrt gemm backward duration: 2.268,  weight grad: 1.819,  other: 0.443
Linear 1 Backward:  4.628
STEP-92: step_time = 21.618945 ms, foward_time = 10.285312, backward_time = 11.232256, perf = 38.14 tflops.
start
start
start
start
block_info 248 33
cuda:1 process time:3.4766197204589844, a: 0.5729198455810547, b: 1.4722347259521484, c: 0.059604644775390625, d: 1.3718605041503906
block_info 256 37
1 wait time: 0.92
248
block_info 228 16
block_info 312 83
cuda:3 process time:3.742218017578125, a: 0.7939338684082031, b: 0.9648799896240234, c: 0.07915496826171875, d: 1.9042491912841797
cuda:0 process time:4.164695739746094, a: 0.7579326629638672, b: 1.3854503631591797, c: 0.11014938354492188, d: 1.911163330078125
3 wait time: 1.697
256
cuda:2 process time:4.38690185546875, a: 0.667572021484375, b: 1.451253890991211, c: 0.09822845458984375, d: 2.1698474884033203
2 wait time: 2.165
312
0 wait time: 2.514
228
AG, 0.144531, 1.814528, 0 
perpare first forward gemm: 0.305,  fisrt gemm forward duration: 2.273
AG, 0.133065, 1.836032, 0 
perpare first forward gemm: 0.287,  fisrt gemm forward duration: 2.938
AG, 0.070175, 1.771520, 0 
perpare first forward gemm: 0.263,  fisrt gemm forward duration: 1.847
AG, 0.266026, 2.015232, 0 
perpare first forward gemm: 0.322,  fisrt gemm forward duration: 2.081
GA, 0.070175, 1.432576, 0 
GA, 0.133065, 1.567744, 0 
GA, 0.144531, 1.699840, 0 
GA, 0.266026, 2.267136, 0 
forward:  7.854
forward:  7.246
forward:  6.858
forward:  6.843
AG, 0.144531, 1.814528, 0 
AG, 0.133065, 1.829888, 0 
AG, 0.070175, 1.755136, 0 
AG, 0.266026, 2.012160, 0 
Linear 2 Backward: 3.586, second_gemm: 3.573
Linear 2 Backward: 3.231, second_gemm: 3.216
Linear 2 Backward: 3.612, second_gemm: 3.598
Linear 2 Backward: 3.738, second_gemm: 3.725
GA, 0.070175, 1.427456, 0 
GA, 0.144531, 1.660928, 0 
GA, 0.133065, 1.596416, 0 
GA, 0.266026, 2.204672, 0 
perpare first backward gemm: 0.035,  fisrt gemm backward duration: 2.721,  weight grad: 1.546,  other: 0.448
Linear 1 Backward:  4.851
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 2.653,  weight grad: 1.554,  other: 0.451
Linear 1 Backward:  4.797
perpare first backward gemm: 0.029,  fisrt gemm backward duration: 2.762,  weight grad: 1.551,  other: 0.421
Linear 1 Backward:  4.807
perpare first backward gemm: 0.044,  fisrt gemm backward duration: 2.271,  weight grad: 1.816,  other: 0.448
Linear 1 Backward:  4.637
STEP-93: step_time = 21.606465 ms, foward_time = 10.464320, backward_time = 11.017216, perf = 38.17 tflops.
start
start
start
start
block_info 248 33
block_info 228 16
cuda:1 process time:3.051280975341797, a: 0.5629062652587891, b: 1.161813735961914, c: 0.05030632019042969, d: 1.276254653930664
block_info 312 83
cuda:0 process time:3.087759017944336, a: 0.5731582641601562, b: 1.104593276977539, c: 0.05269050598144531, d: 1.3573169708251953
1 wait time: 1.166
248
block_info 256 37
0 wait time: 0.861
228
cuda:2 process time:3.7162303924560547, a: 0.7216930389404297, b: 1.1529922485351562, c: 0.09441375732421875, d: 1.74713134765625
2 wait time: 1.789
312
cuda:3 process time:3.9739608764648438, a: 0.7581710815429688, b: 1.13677978515625, c: 0.09489059448242188, d: 1.9841194152832031
3 wait time: 2.514
256
AG, 0.070175, 1.789952, 0 
perpare first forward gemm: 0.3,  fisrt gemm forward duration: 2.599
AG, 0.133065, 1.822720, 0 
perpare first forward gemm: 0.283,  fisrt gemm forward duration: 2.88
AG, 0.144531, 1.815552, 0 
perpare first forward gemm: 0.28,  fisrt gemm forward duration: 1.877
AG, 0.266026, 2.031616, 0 
perpare first forward gemm: 0.318,  fisrt gemm forward duration: 2.58
GA, 0.133065, 1.654784, 0 
GA, 0.070175, 1.501184, 0 
GA, 0.144531, 1.704960, 0 
GA, 0.266026, 2.214912, 0 
forward:  6.747
forward:  7.753
forward:  7.551
forward:  7.281
AG, 0.070175, 1.762304, 0 
AG, 0.144531, 1.809408, 0 
AG, 0.133065, 1.830912, 0 
AG, 0.266026, 1.997824, 0 
Linear 2 Backward: 3.353, second_gemm: 3.341
Linear 2 Backward: 3.273, second_gemm: 3.258
Linear 2 Backward: 3.37, second_gemm: 3.357
Linear 2 Backward: 3.724, second_gemm: 3.712
GA, 0.070175, 1.442816, 0 
GA, 0.133065, 1.615872, 0 
GA, 0.144531, 1.678336, 0 
GA, 0.266026, 2.190336, 0 
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 2.645,  weight grad: 1.55,  other: 0.442
Linear 1 Backward:  4.73
perpare first backward gemm: 0.033,  fisrt gemm backward duration: 2.71,  weight grad: 1.55,  other: 0.445
Linear 1 Backward:  4.796
perpare first backward gemm: 0.039,  fisrt gemm backward duration: 2.624,  weight grad: 1.543,  other: 0.423
Linear 1 Backward:  4.679
perpare first backward gemm: 0.041,  fisrt gemm backward duration: 2.253,  weight grad: 1.813,  other: 0.443
Linear 1 Backward:  4.607
STEP-94: step_time = 20.525056 ms, foward_time = 9.493504, backward_time = 10.931200, perf = 40.18 tflops.
start
start
start
start
block_info 248 33
block_info 312 83
block_info 256 37
cuda:1 process time:3.264188766479492, a: 0.5605220794677734, b: 1.3396739959716797, c: 0.0514984130859375, d: 1.3124942779541016
cuda:2 process time:3.564596176147461, a: 0.49686431884765625, b: 1.695871353149414, c: 0.047206878662109375, d: 1.3246536254882812
1 wait time: 1.183
248
cuda:3 process time:3.558635711669922, a: 0.7481575012207031, b: 1.2156963348388672, c: 0.07319450378417969, d: 1.5215873718261719
2 wait time: 1.113
312
block_info 228 16
3 wait time: 1.969
256
cuda:0 process time:4.199743270874023, a: 0.7693767547607422, b: 1.3823509216308594, c: 0.11944770812988281, d: 1.928567886352539
0 wait time: 2.455
228
AG, 0.144531, 1.808384, 0 
perpare first forward gemm: 0.268,  fisrt gemm forward duration: 2.646
AG, 0.133065, 1.839104, 0 
perpare first forward gemm: 0.283,  fisrt gemm forward duration: 3.012
AG, 0.070175, 1.771520, 0 
perpare first forward gemm: 0.271,  fisrt gemm forward duration: 1.837
AG, 0.266026, 2.010112, 0 
perpare first forward gemm: 0.317,  fisrt gemm forward duration: 3.041
GA, 0.070175, 1.459200, 0 
GA, 0.133065, 1.603584, 0 
GA, 0.144531, 1.661952, 0 
GA, 0.266026, 2.167808, 0 
forward:  6.685
forward:  7.801
forward:  7.689
forward:  7.454
AG, 0.133065, 1.841152, 0 
AG, 0.070175, 1.770496, 0 
AG, 0.144531, 1.833984, 0 
AG, 0.266026, 2.039808, 0 
Linear 2 Backward: 3.392, second_gemm: 3.379
Linear 2 Backward: 3.299, second_gemm: 3.285
Linear 2 Backward: 3.601, second_gemm: 3.587
Linear 2 Backward: 3.97, second_gemm: 3.962
GA, 0.070175, 1.448960, 0 
GA, 0.133065, 1.631232, 0 
GA, 0.144531, 1.639424, 0 
GA, 0.266026, 2.240512, 0 
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 2.628,  weight grad: 1.549,  other: 0.445
Linear 1 Backward:  4.719
perpare first backward gemm: 0.038,  fisrt gemm backward duration: 2.573,  weight grad: 1.572,  other: 0.454
Linear 1 Backward:  4.702
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 2.593,  weight grad: 1.547,  other: 0.446
Linear 1 Backward:  4.683
perpare first backward gemm: 0.033,  fisrt gemm backward duration: 2.298,  weight grad: 1.799,  other: 0.423
Linear 1 Backward:  4.596
STEP-95: step_time = 21.367137 ms, foward_time = 10.103136, backward_time = 11.162624, perf = 38.59 tflops.
start
start
start
start
block_info 228 16
block_info 248 33
block_info 312 83
cuda:1 process time:3.5223960876464844, a: 0.5779266357421875, b: 1.4982223510742188, c: 0.051021575927734375, d: 1.3952255249023438
cuda:0 process time:3.4286975860595703, a: 0.5860328674316406, b: 1.2750625610351562, c: 0.06270408630371094, d: 1.5048980712890625
cuda:2 process time:3.5355091094970703, a: 0.4925727844238281, b: 1.64794921875, c: 0.048160552978515625, d: 1.3468265533447266
block_info 256 37
0 wait time: 1.255
228
1 wait time: 1.049
248
2 wait time: 1.013
312
cuda:3 process time:4.096746444702148, a: 0.797271728515625, b: 1.0478496551513672, c: 0.09489059448242188, d: 2.1567344665527344
3 wait time: 2.285
256
AG, 0.070175, 1.774592, 0 
perpare first forward gemm: 0.259,  fisrt gemm forward duration: 2.794
AG, 0.133065, 1.820672, 0 
perpare first forward gemm: 0.285,  fisrt gemm forward duration: 2.866
AG, 0.144531, 1.823744, 0 
perpare first forward gemm: 0.304,  fisrt gemm forward duration: 1.895
AG, 0.266026, 2.001920, 0 
perpare first forward gemm: 0.32,  fisrt gemm forward duration: 3.025
GA, 0.070175, 1.433600, 0 
GA, 0.133065, 1.547264, 0 
GA, 0.144531, 1.670144, 0 
GA, 0.266026, 2.282496, 0 
forward:  7.818
forward:  7.826
forward:  6.868
forward:  7.805
AG, 0.144531, 1.827840, 0 
AG, 0.133065, 1.842176, 0 
AG, 0.070175, 1.776640, 0 
AG, 0.266026, 1.992704, 0 
Linear 2 Backward: 3.278, second_gemm: 3.264
Linear 2 Backward: 3.529, second_gemm: 3.519
Linear 2 Backward: 3.4, second_gemm: 3.386
Linear 2 Backward: 3.683, second_gemm: 3.674
GA, 0.070175, 1.443840, 0 
GA, 0.133065, 1.636352, 0 
GA, 0.144531, 1.645568, 0 
GA, 0.266026, 2.198528, 0 
perpare first backward gemm: 0.035,  fisrt gemm backward duration: 2.552,  weight grad: 1.547,  other: 0.447
Linear 1 Backward:  4.641
perpare first backward gemm: 0.038,  fisrt gemm backward duration: 2.556,  weight grad: 1.543,  other: 0.415
Linear 1 Backward:  4.594
perpare first backward gemm: 0.037,  fisrt gemm backward duration: 2.521,  weight grad: 1.554,  other: 0.447
Linear 1 Backward:  4.618
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 2.268,  weight grad: 1.786,  other: 0.428
Linear 1 Backward:  4.565
STEP-96: step_time = 21.046272 ms, foward_time = 10.156032, backward_time = 10.771456, perf = 39.18 tflops.
start
start
start
start
block_info 248 33
block_info 312 83
cuda:1 process time:3.3829212188720703, a: 0.6473064422607422, b: 1.3842582702636719, c: 0.050067901611328125, d: 1.3012886047363281
cuda:2 process time:3.5707950592041016, a: 0.49114227294921875, b: 1.7058849334716797, c: 0.048160552978515625, d: 1.3256072998046875
1 wait time: 1.095
248
2 wait time: 1.026
312
block_info 228 16
cuda:0 process time:4.260063171386719, a: 0.7236003875732422, b: 1.3113021850585938, c: 0.09894371032714844, d: 2.1262168884277344
block_info 256 37
0 wait time: 2.153
228
cuda:3 process time:5.481243133544922, a: 0.7379055023193359, b: 2.155780792236328, c: 0.10538101196289062, d: 2.482175827026367
3 wait time: 3.872
256
AG, 0.070175, 1.796096, 0 
perpare first forward gemm: 0.294,  fisrt gemm forward duration: 2.838
AG, 0.133065, 1.814528, 0 
perpare first forward gemm: 0.282,  fisrt gemm forward duration: 4.143
AG, 0.144531, 1.815552, 0 
perpare first forward gemm: 0.284,  fisrt gemm forward duration: 1.876
AG, 0.266026, 2.010112, 0 
perpare first forward gemm: 0.317,  fisrt gemm forward duration: 4.181
GA, 0.144531, 1.655808, 0 
GA, 0.070175, 1.499136, 0 
GA, 0.133065, 1.665024, 0 
GA, 0.266026, 2.176000, 0 
forward:  7.719
forward:  8.965
forward:  8.843
forward:  6.736
AG, 0.133065, 1.824768, 0 
AG, 0.070175, 1.780736, 0 
AG, 0.144531, 1.825792, 0 
AG, 0.266026, 2.024448, 0 
Linear 2 Backward: 3.274, second_gemm: 3.26
Linear 2 Backward: 3.324, second_gemm: 3.308
Linear 2 Backward: 3.468, second_gemm: 3.439
Linear 2 Backward: 3.901, second_gemm: 3.892
GA, 0.144531, 1.599488, 0 
GA, 0.070175, 1.488896, 0 
GA, 0.133065, 1.657856, 0 
GA, 0.266026, 2.183168, 0 
perpare first backward gemm: 0.035,  fisrt gemm backward duration: 2.612,  weight grad: 1.552,  other: 0.449
Linear 1 Backward:  4.695
perpare first backward gemm: 0.035,  fisrt gemm backward duration: 2.603,  weight grad: 1.569,  other: 0.446
Linear 1 Backward:  4.7
perpare first backward gemm: 0.034,  fisrt gemm backward duration: 2.617,  weight grad: 1.55,  other: 0.447
Linear 1 Backward:  4.695
perpare first backward gemm: 0.037,  fisrt gemm backward duration: 2.241,  weight grad: 1.805,  other: 0.437
Linear 1 Backward:  4.572
STEP-97: step_time = 22.328320 ms, foward_time = 11.016192, backward_time = 11.210752, perf = 36.93 tflops.
start
start
start
start
block_info 312 83
block_info 248 33
cuda:2 process time:3.4821033477783203, a: 0.5664825439453125, b: 1.5866756439208984, c: 0.048160552978515625, d: 1.2807846069335938
cuda:1 process time:3.5359859466552734, a: 0.5726814270019531, b: 1.6129016876220703, c: 0.052928924560546875, d: 1.2974739074707031
block_info 256 37
2 wait time: 1.22
312
1 wait time: 1.225
248
block_info 228 16
cuda:3 process time:3.671884536743164, a: 0.7903575897216797, b: 1.054525375366211, c: 0.09679794311523438, d: 1.730203628540039
3 wait time: 1.874
256
cuda:0 process time:4.151344299316406, a: 0.7634162902832031, b: 1.3742446899414062, c: 0.10061264038085938, d: 1.9130706787109375
0 wait time: 2.47
228
AG, 0.144531, 1.817600, 0 
perpare first forward gemm: 0.308,  fisrt gemm forward duration: 2.257
AG, 0.133065, 1.839104, 0 
perpare first forward gemm: 0.277,  fisrt gemm forward duration: 2.87
AG, 0.070175, 1.763328, 0 
perpare first forward gemm: 0.269,  fisrt gemm forward duration: 1.826
AG, 0.266026, 2.038784, 0 
perpare first forward gemm: 0.314,  fisrt gemm forward duration: 3.115
GA, 0.070175, 1.415168, 0 
GA, 0.133065, 1.579008, 0 
GA, 0.144531, 1.649664, 0 
GA, 0.266026, 2.306048, 0 
forward:  7.264
forward:  6.828
forward:  7.808
forward:  7.88
AG, 0.133065, 1.819648, 0 
AG, 0.144531, 1.841152, 0 
AG, 0.070175, 1.756160, 0 
AG, 0.266026, 2.040832, 0 
Linear 2 Backward: 3.364, second_gemm: 3.352
Linear 2 Backward: 3.381, second_gemm: 3.369
Linear 2 Backward: 3.282, second_gemm: 3.27
Linear 2 Backward: 3.806, second_gemm: 3.795
GA, 0.070175, 1.437696, 0 
GA, 0.133065, 1.593344, 0 
GA, 0.144531, 1.600512, 0 
GA, 0.266026, 2.166784, 0 
perpare first backward gemm: 0.035,  fisrt gemm backward duration: 2.617,  weight grad: 1.545,  other: 0.436
Linear 1 Backward:  4.688
perpare first backward gemm: 0.041,  fisrt gemm backward duration: 2.541,  weight grad: 1.568,  other: 0.439
Linear 1 Backward:  4.65
perpare first backward gemm: 0.032,  fisrt gemm backward duration: 2.678,  weight grad: 1.54,  other: 0.439
Linear 1 Backward:  4.733
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 2.222,  weight grad: 1.807,  other: 0.412
Linear 1 Backward:  4.521
STEP-98: step_time = 21.201151 ms, foward_time = 10.239232, backward_time = 10.860544, perf = 38.90 tflops.
start
start
start
start
block_info 312 83
block_info 248 33
cuda:2 process time:3.1557083129882812, a: 0.5528926849365234, b: 1.3022422790527344, c: 0.04744529724121094, d: 1.2531280517578125
block_info 228 16
cuda:1 process time:3.172636032104492, a: 0.6160736083984375, b: 1.2247562408447266, c: 0.05125999450683594, d: 1.2805461883544922
2 wait time: 1.222
312
1 wait time: 1.196
248
cuda:0 process time:3.4508705139160156, a: 0.7357597351074219, b: 1.150369644165039, c: 0.09608268737792969, d: 1.468658447265625
block_info 256 37
0 wait time: 1.935
228
cuda:3 process time:4.188060760498047, a: 0.6303787231445312, b: 1.3911724090576172, c: 0.09465217590332031, d: 2.071857452392578
3 wait time: 2.22
256
AG, 0.070175, 1.768448, 0 
perpare first forward gemm: 0.268,  fisrt gemm forward duration: 2.456
AG, 0.133065, 1.832960, 0 
perpare first forward gemm: 0.279,  fisrt gemm forward duration: 2.977
AG, 0.144531, 1.812480, 0 
perpare first forward gemm: 0.277,  fisrt gemm forward duration: 1.872
AG, 0.266026, 2.001920, 0 
perpare first forward gemm: 0.311,  fisrt gemm forward duration: 3.158
GA, 0.070175, 1.434624, 0 
GA, 0.133065, 1.575936, 0 
GA, 0.144531, 1.626112, 0 
GA, 0.266026, 2.259968, 0 
forward:  7.816
forward:  7.352
forward:  6.722
forward:  7.859
AG, 0.144531, 1.811456, 0 
AG, 0.133065, 1.833984, 0 
AG, 0.070175, 1.757184, 0 
AG, 0.266026, 2.029568, 0 
Linear 2 Backward: 3.424, second_gemm: 3.413
Linear 2 Backward: 3.44, second_gemm: 3.429
Linear 2 Backward: 3.257, second_gemm: 3.245
Linear 2 Backward: 3.783, second_gemm: 3.773
GA, 0.070175, 1.417216, 0 
GA, 0.144531, 1.619968, 0 
GA, 0.133065, 1.584128, 0 
GA, 0.266026, 2.127872, 0 
perpare first backward gemm: 0.03,  fisrt gemm backward duration: 2.594,  weight grad: 1.547,  other: 0.424
Linear 1 Backward:  4.637
perpare first backward gemm: 0.033,  fisrt gemm backward duration: 2.54,  weight grad: 1.543,  other: 0.435
Linear 1 Backward:  4.607
perpare first backward gemm: 0.032,  fisrt gemm backward duration: 2.604,  weight grad: 1.558,  other: 0.439
Linear 1 Backward:  4.687
perpare first backward gemm: 0.044,  fisrt gemm backward duration: 2.185,  weight grad: 1.822,  other: 0.429
Linear 1 Backward:  4.525
STEP-99: step_time = 21.256224 ms, foward_time = 10.199072, backward_time = 10.958848, perf = 38.79 tflops.

[Summary] Average synchronized step_time = 21.337414455413818 ms, forward = 10.183084774017335, backward = 11.046502304077148.

 end end end
cuda:2
cuda:1
cuda:0
cuda:3
rank: 2, nranks: 4
rank: 1, nranks: 4
rank: 0, nranks: 4
rank: 3, nranks: 4
DistributedDataParallel(
  (module): ExampleModel(
    (attn): MultiHeadSelfAttention(
      (linear_q): Linear(in_features=1024, out_features=1024, bias=False)
      (linear_k): Linear(in_features=1024, out_features=1024, bias=False)
      (linear_v): Linear(in_features=1024, out_features=1024, bias=False)
      (linear_o): Linear(in_features=1024, out_features=1024, bias=False)
    )
    (_moe_layer): MixMOETransformerMLP(
      (gate): NaiveGate(
        (gate): Linear(in_features=1024, out_features=64, bias=True)
      )
      (experts): _Expert(
        (htoh4): FMoELinear(num_expert=22, in_features=1024,         out_features=4096, bias=True, rank=0)
        (h4toh): FMoELinear(num_expert=22, in_features=4096,         out_features=1024, bias=True, rank=0)
        (activation): GELU(approximate='none')
      )
    )
  )
)
[Benchmark] world_size = 4, dtype = float16, model_dim = 1024, hidden_size = 4096, samples = 8192, num_local_experts = 16, topK = 2, a2a_ffn_overlap_degree = 1, device = `cuda:0`
start
start
block_info 288 77
start
block_info 268 60
start
cuda:0 process time:1088.4082317352295, a: 11.076211929321289, b: 1074.2995738983154, c: 0.5576610565185547, d: 2.4747848510742188
cuda:2 process time:1088.8440608978271, a: 10.14089584350586, b: 1075.7639408111572, c: 0.5190372467041016, d: 2.420186996459961
0 wait time: 3.197
288
2 wait time: 2.959
268
block_info 244 41
cuda:3 process time:1090.2256965637207, a: 11.109352111816406, b: 1076.1866569519043, c: 0.24962425231933594, d: 2.680063247680664
block_info 264 58
3 wait time: 2.704
244
cuda:1 process time:1091.1483764648438, a: 10.052204132080078, b: 1077.8911113739014, c: 0.6992816925048828, d: 2.505779266357422
1 wait time: 3.189
264
AG, 0.223881, 1.835008, 0 
AG, 0.219697, 1.833984, 0 
perpare first forward gemm: 8.745,  fisrt gemm forward duration: 3.196
perpare first forward gemm: 1.651,  fisrt gemm forward duration: 12.345
AG, 0.168033, 1.802240, 0 
AG, 0.267361, 1.915904, 0 
perpare first forward gemm: 1.863,  fisrt gemm forward duration: 11.004
perpare first forward gemm: 2.266,  fisrt gemm forward duration: 12.024
GA, 0.223881, 1.900544, 0 
GA, 0.219697, 2.164736, 0 
GA, 0.168033, 1.704960, 0 
GA, 0.267361, 2.370560, 0 
forward:  28.933
forward:  29.327
forward:  27.53
forward:  26.94
AG, 0.219697, 1.826816, 0 
AG, 0.267361, 1.975296, 0 
AG, 0.223881, 1.797120, 0 
AG, 0.168033, 1.803264, 0 
Linear 2 Backward: 19.769, second_gemm: 19.753
Linear 2 Backward: 20.219, second_gemm: 20.203
Linear 2 Backward: 19.497, second_gemm: 19.478
Linear 2 Backward: 21.232, second_gemm: 21.212
GA, 0.168033, 1.700864, 0 
GA, 0.223881, 1.878016, 0 
GA, 0.219697, 1.817600, 0 
GA, 0.267361, 2.037760, 0 
perpare first backward gemm: 0.029,  fisrt gemm backward duration: 3.916,  weight grad: 1.518,  other: 2.248
Linear 1 Backward:  7.761
perpare first backward gemm: 0.03,  fisrt gemm backward duration: 3.414,  weight grad: 1.745,  other: 2.219
Linear 1 Backward:  7.456
perpare first backward gemm: 0.034,  fisrt gemm backward duration: 3.483,  weight grad: 1.713,  other: 2.281
Linear 1 Backward:  7.562
perpare first backward gemm: 0.04,  fisrt gemm backward duration: 2.103,  weight grad: 1.914,  other: 2.361
Linear 1 Backward:  6.478
STEP-0: step_time = 71.260254 ms, foward_time = 34.748535, backward_time = 36.149246, perf = 11.57 tflops.
start
start
start
start
block_info 264 58
block_info 268 60
cuda:1 process time:3.3638477325439453, a: 0.7288455963134766, b: 1.4481544494628906, c: 0.07224082946777344, d: 1.1146068572998047
cuda:2 process time:3.441333770751953, a: 0.7531642913818359, b: 1.485586166381836, c: 0.07081031799316406, d: 1.1317729949951172
block_info 244 41
1 wait time: 1.483
264
2 wait time: 1.537
268
block_info 288 77
cuda:3 process time:3.9577484130859375, a: 0.751495361328125, b: 1.1091232299804688, c: 0.10943412780761719, d: 1.9876956939697266
3 wait time: 2.179
244
cuda:0 process time:4.456043243408203, a: 0.8420944213867188, b: 1.2059211730957031, c: 0.13017654418945312, d: 2.277851104736328
0 wait time: 2.8
288
AG, 0.219697, 1.804288, 0 
perpare first forward gemm: 0.271,  fisrt gemm forward duration: 3.368
AG, 0.168033, 1.790976, 0 
perpare first forward gemm: 0.287,  fisrt gemm forward duration: 2.33
AG, 0.223881, 1.801216, 0 
perpare first forward gemm: 0.273,  fisrt gemm forward duration: 3.292
AG, 0.267361, 1.954816, 0 
perpare first forward gemm: 0.297,  fisrt gemm forward duration: 2.008
GA, 0.219697, 2.040832, 0 
GA, 0.168033, 1.990656, 0 
GA, 0.223881, 2.195456, 0 
GA, 0.267361, 2.286592, 0 
forward:  8.762
forward:  8.823
forward:  7.354
forward:  7.845
AG, 0.219697, 1.811456, 0 
AG, 0.223881, 1.821696, 0 
AG, 0.168033, 1.811456, 0 
AG, 0.267361, 1.966080, 0 
Linear 2 Backward: 3.225, second_gemm: 3.213
Linear 2 Backward: 3.399, second_gemm: 3.389
Linear 2 Backward: 3.502, second_gemm: 3.493
Linear 2 Backward: 3.757, second_gemm: 3.744
GA, 0.168033, 1.904640, 0 
GA, 0.219697, 1.914880, 0 
GA, 0.223881, 2.097152, 0 
GA, 0.267361, 2.140160, 0 
perpare first backward gemm: 0.033,  fisrt gemm backward duration: 2.683,  weight grad: 1.527,  other: 0.432
Linear 1 Backward:  4.726
perpare first backward gemm: 0.03,  fisrt gemm backward duration: 2.578,  weight grad: 1.709,  other: 0.422
Linear 1 Backward:  4.783
perpare first backward gemm: 0.03,  fisrt gemm backward duration: 2.529,  weight grad: 1.745,  other: 0.421
Linear 1 Backward:  4.768
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 2.198,  weight grad: 1.899,  other: 0.434
Linear 1 Backward:  4.619
STEP-1: step_time = 22.552545 ms, foward_time = 11.231200, backward_time = 11.190272, perf = 36.56 tflops.
start
start
start
start
block_info 288 77
block_info 264 58
cuda:0 process time:3.755807876586914, a: 0.7255077362060547, b: 1.62506103515625, c: 0.06127357482910156, d: 1.3439655303955078
cuda:1 process time:3.6597251892089844, a: 0.6763935089111328, b: 1.4576911926269531, c: 0.07724761962890625, d: 1.4483928680419922
0 wait time: 1.257
288
1 wait time: 1.351
264
block_info 268 60
block_info 244 41
cuda:2 process time:4.942893981933594, a: 0.8463859558105469, b: 1.852273941040039, c: 0.11467933654785156, d: 2.1295547485351562
cuda:3 process time:4.676580429077148, a: 0.8678436279296875, b: 1.3136863708496094, c: 0.15544891357421875, d: 2.339601516723633
2 wait time: 2.578
268
3 wait time: 2.197
244
AG, 0.219697, 1.802240, 0 
perpare first forward gemm: 0.28,  fisrt gemm forward duration: 3.453
AG, 0.223881, 1.823744, 0 
perpare first forward gemm: 0.282,  fisrt gemm forward duration: 2.445
AG, 0.267361, 1.960960, 0 
perpare first forward gemm: 0.316,  fisrt gemm forward duration: 3.594
AG, 0.168033, 1.795072, 0 
perpare first forward gemm: 0.348,  fisrt gemm forward duration: 1.884
GA, 0.219697, 1.955840, 0 
GA, 0.223881, 2.122752, 0 
GA, 0.168033, 2.007040, 0 
GA, 0.267361, 2.205696, 0 
forward:  7.956
forward:  8.975
forward:  9.014
forward:  7.553
AG, 0.267361, 1.965056, 0 
AG, 0.219697, 1.811456, 0 
AG, 0.223881, 1.807360, 0 
AG, 0.168033, 1.795072, 0 
Linear 2 Backward: 3.286, second_gemm: 3.272
Linear 2 Backward: 3.478, second_gemm: 3.464
Linear 2 Backward: 3.552, second_gemm: 3.538
Linear 2 Backward: 3.745, second_gemm: 3.731
GA, 0.168033, 1.789952, 0 
GA, 0.219697, 1.945600, 0 
GA, 0.223881, 2.022400, 0 
GA, 0.267361, 2.181120, 0 
perpare first backward gemm: 0.057,  fisrt gemm backward duration: 2.739,  weight grad: 1.54,  other: 0.41
Linear 1 Backward:  4.795
perpare first backward gemm: 0.042,  fisrt gemm backward duration: 2.59,  weight grad: 1.735,  other: 0.412
Linear 1 Backward:  4.827
perpare first backward gemm: 0.04,  fisrt gemm backward duration: 2.556,  weight grad: 1.761,  other: 0.409
Linear 1 Backward:  4.812
perpare first backward gemm: 0.043,  fisrt gemm backward duration: 2.247,  weight grad: 1.915,  other: 0.409
Linear 1 Backward:  4.664
STEP-2: step_time = 22.606849 ms, foward_time = 11.261952, backward_time = 11.245568, perf = 36.48 tflops.
start
start
start
start
block_info 268 60
block_info 264 58
block_info 244 41
cuda:2 process time:3.9908885955810547, a: 0.7772445678710938, b: 1.3496875762939453, c: 0.08487701416015625, d: 1.7790794372558594
block_info 288 77
2 wait time: 1.529
268
cuda:3 process time:4.231929779052734, a: 0.8041858673095703, b: 1.1150836944580078, c: 0.11181831359863281, d: 2.2008419036865234
cuda:1 process time:4.519939422607422, a: 0.6537437438964844, b: 1.5523433685302734, c: 0.11229515075683594, d: 2.201557159423828
cuda:0 process time:4.612445831298828, a: 0.7815361022949219, b: 1.5227794647216797, c: 0.11324882507324219, d: 2.1948814392089844
1 wait time: 2.276
264
3 wait time: 2.304
244
0 wait time: 2.725
288
AG, 0.223881, 1.812480, 0 
perpare first forward gemm: 0.299,  fisrt gemm forward duration: 2.656
AG, 0.168033, 1.800192, 0 
perpare first forward gemm: 0.307,  fisrt gemm forward duration: 1.904
AG, 0.219697, 1.807360, 0 
perpare first forward gemm: 0.29,  fisrt gemm forward duration: 1.996
AG, 0.267361, 1.959936, 0 
perpare first forward gemm: 0.288,  fisrt gemm forward duration: 2.015
GA, 0.219697, 2.094080, 0 
GA, 0.223881, 2.150400, 0 
GA, 0.168033, 1.987584, 0 
GA, 0.267361, 2.321408, 0 
forward:  7.555
forward:  8.232
forward:  7.423
forward:  7.528
AG, 0.267361, 1.953792, 0 
AG, 0.223881, 1.800192, 0 
AG, 0.219697, 1.809408, 0 
AG, 0.168033, 1.794048, 0 
Linear 2 Backward: 3.207, second_gemm: 3.196
Linear 2 Backward: 3.393, second_gemm: 3.382
Linear 2 Backward: 3.534, second_gemm: 3.523
Linear 2 Backward: 3.685, second_gemm: 3.672
GA, 0.168033, 1.822720, 0 
GA, 0.219697, 1.873920, 0 
GA, 0.223881, 2.055168, 0 
GA, 0.267361, 2.075648, 0 
perpare first backward gemm: 0.034,  fisrt gemm backward duration: 2.644,  weight grad: 1.53,  other: 0.451
Linear 1 Backward:  4.712
perpare first backward gemm: 0.027,  fisrt gemm backward duration: 2.502,  weight grad: 1.727,  other: 0.419
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 2.489,  weight grad: 1.722,  other: 0.438
Linear 1 Backward:  4.711
Linear 1 Backward:  4.739
perpare first backward gemm: 0.039,  fisrt gemm backward duration: 2.134,  weight grad: 1.9,  other: 0.445
Linear 1 Backward:  4.575
STEP-3: step_time = 22.565856 ms, foward_time = 11.191264, backward_time = 11.233280, perf = 36.54 tflops.
start
start
start
start
block_info 268 60
block_info 288 77
cuda:0 process time:3.171682357788086, a: 0.5977153778076172, b: 0.9865760803222656, c: 0.06079673767089844, d: 1.5265941619873047
cuda:2 process time:3.608226776123047, a: 0.6225109100341797, b: 1.2385845184326172, c: 0.08416175842285156, d: 1.6629695892333984
block_info 264 58
0 wait time: 1.045
288
block_info 244 41
2 wait time: 1.751
268
cuda:1 process time:4.319906234741211, a: 0.7841587066650391, b: 1.293182373046875, c: 0.110626220703125, d: 2.131938934326172
cuda:3 process time:4.433155059814453, a: 0.6697177886962891, b: 1.6434192657470703, c: 0.11372566223144531, d: 2.0062923431396484
1 wait time: 2.777
264
3 wait time: 2.58
244
AG, 0.219697, 1.816576, 0 
perpare first forward gemm: 0.277,  fisrt gemm forward duration: 2.008
AG, 0.168033, 1.796096, 0 
perpare first forward gemm: 0.287,  fisrt gemm forward duration: 1.856
AG, 0.223881, 1.816576, 0 
perpare first forward gemm: 0.325,  fisrt gemm forward duration: 2.684
AG, 0.267361, 1.983488, 0 
perpare first forward gemm: 0.298,  fisrt gemm forward duration: 3.187
GA, 0.168033, 1.840128, 0 
GA, 0.219697, 2.046976, 0 
GA, 0.223881, 1.988608, 0 
GA, 0.267361, 2.306048, 0 
forward:  8.61
forward:  7.552
forward:  7.457
forward:  8.411
AG, 0.168033, 1.798144, 0 
AG, 0.219697, 1.815552, 0 
AG, 0.223881, 1.816576, 0 
AG, 0.267361, 2.008064, 0 
Linear 2 Backward: 3.275, second_gemm: 3.261
Linear 2 Backward: 3.614, second_gemm: 3.6
Linear 2 Backward: 3.481, second_gemm: 3.467
Linear 2 Backward: 3.915, second_gemm: 3.9
GA, 0.168033, 1.773568, 0 
GA, 0.219697, 1.872896, 0 
GA, 0.223881, 1.997824, 0 
GA, 0.267361, 2.158592, 0 
perpare first backward gemm: 0.042,  fisrt gemm backward duration: 2.791,  weight grad: 1.511,  other: 0.41
Linear 1 Backward:  4.803
perpare first backward gemm: 0.042,  fisrt gemm backward duration: 2.595,  weight grad: 1.735,  other: 0.457
perpare first backward gemm: 0.04,  fisrt gemm backward duration: 2.576,  weight grad: 1.768,  other: 0.45
Linear 1 Backward:  4.895
Linear 1 Backward:  4.899
perpare first backward gemm: 0.044,  fisrt gemm backward duration: 2.226,  weight grad: 1.938,  other: 0.452
Linear 1 Backward:  4.723
STEP-4: step_time = 22.708223 ms, foward_time = 10.775552, backward_time = 11.834368, perf = 36.31 tflops.
start
start
start
block_info 244 41
block_info 268 60
start
block_info 264 58
block_info 288 77
cuda:2 process time:3.9031505584716797, a: 0.6651878356933594, b: 1.67083740234375, c: 0.07462501525878906, d: 1.4925003051757812
cuda:3 process time:3.9491653442382812, a: 0.5700588226318359, b: 1.8205642700195312, c: 0.06079673767089844, d: 1.4977455139160156
cuda:1 process time:3.8704872131347656, a: 0.8261203765869141, b: 1.0273456573486328, c: 0.08654594421386719, d: 1.9304752349853516
2 wait time: 1.359
268
cuda:0 process time:4.446744918823242, a: 0.7307529449462891, b: 1.86920166015625, c: 0.09632110595703125, d: 1.7504692077636719
3 wait time: 0.442
244
1 wait time: 1.767
264
0 wait time: 2.268
288
AG, 0.219697, 1.813504, 0 
perpare first forward gemm: 0.33,  fisrt gemm forward duration: 1.959
AG, 0.223881, 1.826816, 0 
perpare first forward gemm: 0.308,  fisrt gemm forward duration: 2.4
AG, 0.168033, 1.808384, 0 
perpare first forward gemm: 0.347,  fisrt gemm forward duration: 2.178
AG, 0.267361, 1.969152, 0 
perpare first forward gemm: 0.292,  fisrt gemm forward duration: 2.024
GA, 0.168033, 2.003968, 0 
GA, 0.219697, 2.157568, 0 
GA, 0.223881, 2.262016, 0 
GA, 0.267361, 2.444288, 0 
forward:  8.121
forward:  7.726
forward:  7.645
forward:  8.01
AG, 0.219697, 1.801216, 0 
AG, 0.267361, 1.964032, 0 
AG, 0.223881, 1.820672, 0 
AG, 0.168033, 1.797120, 0 
Linear 2 Backward: 3.343, second_gemm: 3.334
Linear 2 Backward: 3.452, second_gemm: 3.438
Linear 2 Backward: 3.526, second_gemm: 3.513
Linear 2 Backward: 3.737, second_gemm: 3.723
GA, 0.168033, 1.712128, 0 
GA, 0.223881, 1.953792, 0 
GA, 0.219697, 1.973248, 0 
GA, 0.267361, 2.216960, 0 
perpare first backward gemm: 0.03,  fisrt gemm backward duration: 2.9,  weight grad: 1.518,  other: 0.411
Linear 1 Backward:  4.897
perpare first backward gemm: 0.039,  fisrt gemm backward duration: 2.636,  weight grad: 1.735,  other: 0.412
perpare first backward gemm: 0.046,  fisrt gemm backward duration: 2.563,  weight grad: 1.763,  other: 0.41
Linear 1 Backward:  4.834
Linear 1 Backward:  4.869
perpare first backward gemm: 0.041,  fisrt gemm backward duration: 2.28,  weight grad: 1.927,  other: 0.418
Linear 1 Backward:  4.713
STEP-5: step_time = 22.249759 ms, foward_time = 10.880288, backward_time = 11.268096, perf = 37.06 tflops.
start
start
start
start
block_info 268 60
block_info 264 58
block_info 244 41
cuda:1 process time:3.8788318634033203, a: 0.7274150848388672, b: 1.2142658233642578, c: 0.08654594421386719, d: 1.8506050109863281
block_info 288 77
cuda:2 process time:3.99017333984375, a: 0.6365776062011719, b: 1.421213150024414, c: 0.09274482727050781, d: 1.8396377563476562
1 wait time: 1.727
264
cuda:3 process time:4.189252853393555, a: 0.8137226104736328, b: 1.0900497436523438, c: 0.11181831359863281, d: 2.1736621856689453
2 wait time: 2.064
268
cuda:0 process time:4.64630126953125, a: 0.8027553558349609, b: 1.5377998352050781, c: 0.11754035949707031, d: 2.1882057189941406
3 wait time: 2.314
244
0 wait time: 2.679
288
AG, 0.219697, 1.813504, 0 
perpare first forward gemm: 0.288,  fisrt gemm forward duration: 2.615
AG, 0.168033, 1.794048, 0 
perpare first forward gemm: 0.305,  fisrt gemm forward duration: 2.049
AG, 0.223881, 1.795072, 0 
perpare first forward gemm: 0.293,  fisrt gemm forward duration: 2.38
AG, 0.267361, 1.976320, 0 
perpare first forward gemm: 0.305,  fisrt gemm forward duration: 2.037
GA, 0.219697, 2.036736, 0 
GA, 0.168033, 1.984512, 0 
GA, 0.223881, 2.211840, 0 
GA, 0.267361, 2.255872, 0 
forward:  8.002
forward:  8.156
forward:  7.483
forward:  7.675
AG, 0.267361, 1.969152, 0 
AG, 0.219697, 1.807360, 0 
AG, 0.223881, 1.803264, 0 
AG, 0.168033, 1.794048, 0 
Linear 2 Backward: 3.206, second_gemm: 3.194
Linear 2 Backward: 3.501, second_gemm: 3.49
Linear 2 Backward: 3.572, second_gemm: 3.56
Linear 2 Backward: 3.837, second_gemm: 3.825
GA, 0.168033, 1.822720, 0 
GA, 0.219697, 1.934336, 0 
GA, 0.223881, 2.033664, 0 
GA, 0.267361, 2.171904, 0 
perpare first backward gemm: 0.034,  fisrt gemm backward duration: 2.745,  weight grad: 1.53,  other: 0.434
Linear 1 Backward:  4.797
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 2.588,  weight grad: 1.734,  other: 0.437
Linear 1 Backward:  4.849
perpare first backward gemm: 0.035,  fisrt gemm backward duration: 2.53,  weight grad: 1.758,  other: 0.444
Linear 1 Backward:  4.821
perpare first backward gemm: 0.038,  fisrt gemm backward duration: 2.231,  weight grad: 1.916,  other: 0.44
Linear 1 Backward:  4.679
STEP-6: step_time = 22.691265 ms, foward_time = 11.181504, backward_time = 11.400192, perf = 36.34 tflops.
start
start
start
start
block_info 268 60
block_info 244 41
block_info 264 58
cuda:2 process time:3.4334659576416016, a: 0.6601810455322266, b: 1.3225078582763672, c: 0.0667572021484375, d: 1.3840198516845703
cuda:3 process time:3.34930419921875, a: 0.6496906280517578, b: 1.1837482452392578, c: 0.06198883056640625, d: 1.4538764953613281
2 wait time: 1.407
268
cuda:1 process time:3.699064254760742, a: 0.8077621459960938, b: 1.0957717895507812, c: 0.09369850158691406, d: 1.7018318176269531
block_info 288 77
3 wait time: 1.021
244
1 wait time: 2.241
264
cuda:0 process time:4.6844482421875, a: 0.6804466247558594, b: 1.5745162963867188, c: 0.11420249938964844, d: 2.3152828216552734
0 wait time: 2.424
288
AG, 0.168033, 1.807360, 0 
perpare first forward gemm: 0.325,  fisrt gemm forward duration: 2.683
AG, 0.223881, 1.803264, 0 
perpare first forward gemm: 0.29,  fisrt gemm forward duration: 2.966
AG, 0.219697, 1.816576, 0 
perpare first forward gemm: 0.298,  fisrt gemm forward duration: 2.462
AG, 0.267361, 1.974272, 0 
perpare first forward gemm: 0.293,  fisrt gemm forward duration: 2.029
GA, 0.168033, 1.924096, 0 
GA, 0.223881, 2.085888, 0 
GA, 0.219697, 2.147328, 0 
GA, 0.267361, 2.383872, 0 
forward:  8.578
forward:  8.088
forward:  8.401
forward:  7.472
AG, 0.168033, 1.792000, 0 
AG, 0.223881, 1.820672, 0 
AG, 0.219697, 1.818624, 0 
AG, 0.267361, 2.015232, 0 
Linear 2 Backward: 3.254, second_gemm: 3.24
Linear 2 Backward: 3.51, second_gemm: 3.495
Linear 2 Backward: 3.514, second_gemm: 3.5
Linear 2 Backward: 3.896, second_gemm: 3.881
GA, 0.168033, 1.753088, 0 
GA, 0.219697, 1.952768, 0 
GA, 0.223881, 2.034688, 0 
GA, 0.267361, 2.174976, 0 
perpare first backward gemm: 0.038,  fisrt gemm backward duration: 2.792,  weight grad: 1.56,  other: 0.45
Linear 1 Backward:  4.903
perpare first backward gemm: 0.041,  fisrt gemm backward duration: 2.59,  weight grad: 1.734,  other: 0.452
Linear 1 Backward:  4.881
perpare first backward gemm: 0.042,  fisrt gemm backward duration: 2.541,  weight grad: 1.783,  other: 0.45
Linear 1 Backward:  4.881
perpare first backward gemm: 0.042,  fisrt gemm backward duration: 2.239,  weight grad: 1.945,  other: 0.447
Linear 1 Backward:  4.735
STEP-7: step_time = 22.412289 ms, foward_time = 10.854400, backward_time = 11.460608, perf = 36.79 tflops.
start
start
start
start
block_info 264 58
block_info 268 60
block_info 244 41
block_info 288 77
cuda:3 process time:4.44483757019043, a: 0.6463527679443359, b: 1.474618911743164, c: 0.11873245239257812, d: 2.2051334381103516
cuda:1 process time:4.411935806274414, a: 0.6692409515380859, b: 1.3575553894042969, c: 0.11706352233886719, d: 2.268075942993164
cuda:2 process time:4.507780075073242, a: 0.7407665252685547, b: 1.3561248779296875, c: 0.14662742614746094, d: 2.264261245727539
cuda:0 process time:4.511356353759766, a: 0.8409023284912109, b: 1.329183578491211, c: 0.1773834228515625, d: 2.1638870239257812
1 wait time: 2.348
264
3 wait time: 2.312
244
2 wait time: 2.527
268
0 wait time: 2.677
288
AG, 0.223881, 1.803264, 0 
perpare first forward gemm: 0.314,  fisrt gemm forward duration: 1.956
AG, 0.219697, 1.806336, 0 
perpare first forward gemm: 0.298,  fisrt gemm forward duration: 2.167
AG, 0.168033, 1.800192, 0 
perpare first forward gemm: 0.292,  fisrt gemm forward duration: 2.208
AG, 0.267361, 1.971200, 0 
perpare first forward gemm: 0.334,  fisrt gemm forward duration: 2.049
GA, 0.168033, 1.945600, 0 
GA, 0.219697, 1.961984, 0 
GA, 0.223881, 2.147328, 0 
GA, 0.267361, 2.201600, 0 
forward:  7.653
forward:  7.788
forward:  7.615
forward:  7.832
AG, 0.219697, 1.816576, 0 
AG, 0.223881, 1.806336, 0 
AG, 0.267361, 1.975296, 0 
AG, 0.168033, 1.807360, 0 
Linear 2 Backward: 3.359, second_gemm: 3.346
Linear 2 Backward: 3.577, second_gemm: 3.564
Linear 2 Backward: 3.651, second_gemm: 3.637
Linear 2 Backward: 3.752, second_gemm: 3.738
GA, 0.168033, 1.812480, 0 
GA, 0.219697, 1.980416, 0 
GA, 0.223881, 2.048000, 0 
GA, 0.267361, 2.224128, 0 
perpare first backward gemm: 0.037,  fisrt gemm backward duration: 2.793,  weight grad: 1.537,  other: 0.411
Linear 1 Backward:  4.824
perpare first backward gemm: 0.04,  fisrt gemm backward duration: 2.626,  weight grad: 1.728,  other: 0.414
Linear 1 Backward:  4.855
perpare first backward gemm: 0.039,  fisrt gemm backward duration: 2.564,  weight grad: 1.757,  other: 0.411
Linear 1 Backward:  4.817
perpare first backward gemm: 0.041,  fisrt gemm backward duration: 2.289,  weight grad: 1.923,  other: 0.412
Linear 1 Backward:  4.711
STEP-8: step_time = 22.816512 ms, foward_time = 11.450112, backward_time = 11.268096, perf = 36.14 tflops.
start
start
start
start
block_info 244 41
block_info 264 58
block_info 268 60
block_info 288 77
cuda:1 process time:4.141807556152344, a: 0.6361007690429688, b: 1.1775493621826172, c: 0.11110305786132812, d: 2.2170543670654297
cuda:2 process time:4.240751266479492, a: 0.6532669067382812, b: 1.1937618255615234, c: 0.1308917999267578, d: 2.2628307342529297
cuda:3 process time:4.208564758300781, a: 0.675201416015625, b: 1.1868476867675781, c: 0.270843505859375, d: 2.075672149658203
cuda:0 process time:4.58216667175293, a: 0.7534027099609375, b: 1.5604496002197266, c: 0.1201629638671875, d: 2.148151397705078
1 wait time: 2.423
264
2 wait time: 2.501
268
3 wait time: 2.497
244
0 wait time: 2.631
288
AG, 0.168033, 1.792000, 0 
perpare first forward gemm: 0.303,  fisrt gemm forward duration: 1.888
AG, 0.219697, 1.813504, 0 
perpare first forward gemm: 0.29,  fisrt gemm forward duration: 2.098
AG, 0.223881, 1.799168, 0 
perpare first forward gemm: 0.293,  fisrt gemm forward duration: 1.984
AG, 0.267361, 1.982464, 0 
perpare first forward gemm: 0.3,  fisrt gemm forward duration: 2.042
GA, 0.168033, 1.969152, 0 
GA, 0.219697, 2.024448, 0 
GA, 0.223881, 2.219008, 0 
GA, 0.267361, 2.269184, 0 
forward:  7.664
forward:  7.562
forward:  7.448
forward:  7.522
AG, 0.223881, 1.807360, 0 
AG, 0.219697, 1.842176, 0 
AG, 0.267361, 1.988608, 0 
AG, 0.168033, 1.793024, 0 
Linear 2 Backward: 3.364, second_gemm: 3.356
Linear 2 Backward: 3.463, second_gemm: 3.451
Linear 2 Backward: 3.566, second_gemm: 3.555
Linear 2 Backward: 3.728, second_gemm: 3.716
GA, 0.168033, 1.769472, 0 
GA, 0.223881, 1.895424, 0 
GA, 0.219697, 1.959936, 0 
GA, 0.267361, 2.196480, 0 
perpare first backward gemm: 0.029,  fisrt gemm backward duration: 2.863,  weight grad: 1.518,  other: 0.418
Linear 1 Backward:  4.868
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 2.64,  weight grad: 1.723,  other: 0.45
Linear 1 Backward:  4.903
perpare first backward gemm: 0.035,  fisrt gemm backward duration: 2.524,  weight grad: 1.751,  other: 0.435
Linear 1 Backward:  4.799
perpare first backward gemm: 0.037,  fisrt gemm backward duration: 2.255,  weight grad: 1.921,  other: 0.436
Linear 1 Backward:  4.703
STEP-9: step_time = 22.625792 ms, foward_time = 11.005440, backward_time = 11.520000, perf = 36.45 tflops.
start
start
start
start
block_info 264 58
block_info 268 60
cuda:2 process time:3.172636032104492, a: 0.7207393646240234, b: 1.255035400390625, c: 0.06747245788574219, d: 1.1293888092041016
cuda:1 process time:3.208160400390625, a: 0.7481575012207031, b: 1.039266586303711, c: 0.06222724914550781, d: 1.3585090637207031
block_info 288 77
2 wait time: 1.515
268
block_info 244 41
1 wait time: 1.367
264
cuda:0 process time:3.9510726928710938, a: 0.7479190826416016, b: 1.4476776123046875, c: 0.09059906005859375, d: 1.664876937866211
cuda:3 process time:3.9777755737304688, a: 0.7538795471191406, b: 1.2769699096679688, c: 0.09226799011230469, d: 1.8546581268310547
0 wait time: 2.15
288
3 wait time: 1.942
244
AG, 0.223881, 1.803264, 0 
perpare first forward gemm: 0.31,  fisrt gemm forward duration: 2.666
AG, 0.219697, 1.810432, 0 
perpare first forward gemm: 0.304,  fisrt gemm forward duration: 2.52
AG, 0.168033, 1.795072, 0 
perpare first forward gemm: 0.274,  fisrt gemm forward duration: 1.855
AG, 0.267361, 1.974272, 0 
perpare first forward gemm: 0.316,  fisrt gemm forward duration: 2.093
GA, 0.168033, 1.878016, 0 
GA, 0.219697, 2.074624, 0 
GA, 0.223881, 2.193408, 0 
GA, 0.267361, 2.330624, 0 
forward:  7.653
forward:  7.54
forward:  8.291
forward:  8.465
AG, 0.168033, 1.782784, 0 
AG, 0.219697, 1.812480, 0 
AG, 0.223881, 1.812480, 0 
AG, 0.267361, 1.977344, 0 
Linear 2 Backward: 3.487, second_gemm: 3.479
Linear 2 Backward: 3.43, second_gemm: 3.415
Linear 2 Backward: 3.616, second_gemm: 3.602
Linear 2 Backward: 3.862, second_gemm: 3.847
GA, 0.168033, 1.730560, 0 
GA, 0.219697, 1.795072, 0 
GA, 0.223881, 1.902592, 0 
GA, 0.267361, 2.027520, 0 
perpare first backward gemm: 0.028,  fisrt gemm backward duration: 2.77,  weight grad: 1.52,  other: 0.416
Linear 1 Backward:  4.773
perpare first backward gemm: 0.03,  fisrt gemm backward duration: 2.539,  weight grad: 1.738,  other: 0.416
Linear 1 Backward:  4.763
perpare first backward gemm: 0.041,  fisrt gemm backward duration: 2.441,  weight grad: 1.733,  other: 0.47
Linear 1 Backward:  4.751
perpare first backward gemm: 0.046,  fisrt gemm backward duration: 2.099,  weight grad: 1.931,  other: 0.475
Linear 1 Backward:  4.618
STEP-10: step_time = 22.465151 ms, foward_time = 10.710656, backward_time = 11.655168, perf = 36.71 tflops.
start
start
start
start
block_info 288 77
block_info 244 41
block_info 264 58
block_info 268 60
cuda:0 process time:4.08482551574707, a: 0.7278919219970703, b: 1.499176025390625, c: 0.08869171142578125, d: 1.7690658569335938
cuda:3 process time:3.941059112548828, a: 0.7598400115966797, b: 1.4646053314208984, c: 0.09393692016601562, d: 1.6226768493652344
cuda:1 process time:3.818988800048828, a: 0.7617473602294922, b: 1.1017322540283203, c: 0.09799003601074219, d: 1.8575191497802734
cuda:2 process time:4.329204559326172, a: 0.6742477416992188, b: 1.5730857849121094, c: 0.09441375732421875, d: 1.987457275390625
0 wait time: 1.918
288
3 wait time: 2.157
244
1 wait time: 2.0
264
2 wait time: 1.722
268
AG, 0.219697, 1.813504, 0 
perpare first forward gemm: 0.301,  fisrt gemm forward duration: 1.953
AG, 0.168033, 1.807360, 0 
perpare first forward gemm: 0.27,  fisrt gemm forward duration: 1.988
AG, 0.223881, 1.811456, 0 
perpare first forward gemm: 0.305,  fisrt gemm forward duration: 1.88
AG, 0.267361, 1.965056, 0 
perpare first forward gemm: 0.29,  fisrt gemm forward duration: 2.308
GA, 0.168033, 1.886208, 0 
GA, 0.223881, 2.126848, 0 
GA, 0.219697, 2.122752, 0 
GA, 0.267361, 2.406400, 0 
forward:  7.623
forward:  7.551
forward:  7.79
forward:  7.662
AG, 0.223881, 1.820672, 0 
AG, 0.219697, 1.831936, 0 
AG, 0.168033, 1.804288, 0 
AG, 0.267361, 1.994752, 0 
Linear 2 Backward: 3.212, second_gemm: 3.2
Linear 2 Backward: 3.508, second_gemm: 3.495
Linear 2 Backward: 3.581, second_gemm: 3.566
Linear 2 Backward: 3.845, second_gemm: 3.831
GA, 0.168033, 1.786880, 0 
GA, 0.223881, 2.015232, 0 
GA, 0.219697, 1.975296, 0 
GA, 0.267361, 2.233344, 0 
perpare first backward gemm: 0.033,  fisrt gemm backward duration: 2.865,  weight grad: 1.521,  other: 0.409
Linear 1 Backward:  4.877
perpare first backward gemm: 0.038,  fisrt gemm backward duration: 2.655,  weight grad: 1.729,  other: 0.447
perpare first backward gemm: 0.04,  fisrt gemm backward duration: 2.559,  weight grad: 1.761,  other: 0.451
Linear 1 Backward:  4.931
Linear 1 Backward:  4.874
perpare first backward gemm: 0.041,  fisrt gemm backward duration: 2.297,  weight grad: 1.906,  other: 0.474
Linear 1 Backward:  4.782
STEP-11: step_time = 22.065151 ms, foward_time = 10.637312, backward_time = 11.327488, perf = 37.37 tflops.
start
start
start
start
block_info 268 60
block_info 288 77
block_info 244 41
block_info 264 58
cuda:0 process time:3.9186477661132812, a: 0.7367134094238281, b: 1.2929439544677734, c: 0.08869171142578125, d: 1.8002986907958984
cuda:3 process time:3.648042678833008, a: 0.6847381591796875, b: 1.0173320770263672, c: 0.08916854858398438, d: 1.8568038940429688
cuda:2 process time:3.9849281311035156, a: 0.7631778717041016, b: 1.4672279357910156, c: 0.0934600830078125, d: 1.661062240600586
0 wait time: 1.816
288
3 wait time: 1.628
244
2 wait time: 2.255
268
cuda:1 process time:4.3125152587890625, a: 0.7665157318115234, b: 1.3737678527832031, c: 0.11205673217773438, d: 2.0601749420166016
1 wait time: 2.634
264
AG, 0.223881, 1.808384, 0 
perpare first forward gemm: 0.338,  fisrt gemm forward duration: 2.271
AG, 0.267361, 1.963008, 0 
perpare first forward gemm: 0.302,  fisrt gemm forward duration: 2.743
AG, 0.168033, 1.798144, 0 
perpare first forward gemm: 0.306,  fisrt gemm forward duration: 2.407
AG, 0.219697, 1.806336, 0 
perpare first forward gemm: 0.292,  fisrt gemm forward duration: 1.871
GA, 0.168033, 1.996800, 0 
GA, 0.223881, 2.170880, 0 
GA, 0.219697, 2.034688, 0 
GA, 0.267361, 2.278400, 0 
forward:  7.932
forward:  8.035
forward:  7.483
forward:  8.169
AG, 0.219697, 1.807360, 0 
AG, 0.223881, 1.806336, 0 
AG, 0.168033, 1.794048, 0 
AG, 0.267361, 1.963008, 0 
Linear 2 Backward: 3.387, second_gemm: 3.378
Linear 2 Backward: 3.452, second_gemm: 3.439
Linear 2 Backward: 3.527, second_gemm: 3.515
Linear 2 Backward: 3.686, second_gemm: 3.672
GA, 0.168033, 1.761280, 0 
GA, 0.219697, 1.958912, 0 
GA, 0.223881, 2.020352, 0 
GA, 0.267361, 2.193408, 0 
perpare first backward gemm: 0.03,  fisrt gemm backward duration: 2.811,  weight grad: 1.519,  other: 0.41
Linear 1 Backward:  4.81
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 2.591,  weight grad: 1.722,  other: 0.411
Linear 1 Backward:  4.808
perpare first backward gemm: 0.037,  fisrt gemm backward duration: 2.534,  weight grad: 1.751,  other: 0.409
Linear 1 Backward:  4.775
perpare first backward gemm: 0.04,  fisrt gemm backward duration: 2.254,  weight grad: 1.93,  other: 0.408
Linear 1 Backward:  4.676
STEP-12: step_time = 22.178816 ms, foward_time = 10.979328, backward_time = 11.098112, perf = 37.18 tflops.
start
start
start
start
block_info 244 41
block_info 264 58
block_info 268 60
block_info 288 77
cuda:1 process time:3.7403106689453125, a: 0.7700920104980469, b: 1.3041496276855469, c: 0.10561943054199219, d: 1.5604496002197266
cuda:2 process time:3.609180450439453, a: 0.7486343383789062, b: 1.0287761688232422, c: 0.08654594421386719, d: 1.7452239990234375
cuda:3 process time:3.7546157836914062, a: 0.7219314575195312, b: 1.3413429260253906, c: 0.10323524475097656, d: 1.5881061553955078
cuda:0 process time:4.04047966003418, a: 0.7176399230957031, b: 1.5671253204345703, c: 0.09036064147949219, d: 1.665353775024414
3 wait time: 2.101
1 wait time: 2.025
264
2 wait time: 1.878
268
244
0 wait time: 2.2
288
AG, 0.168033, 1.788928, 0 
perpare first forward gemm: 0.27,  fisrt gemm forward duration: 2.068
AG, 0.223881, 1.793024, 0 
perpare first forward gemm: 0.291,  fisrt gemm forward duration: 2.065
AG, 0.219697, 1.813504, 0 
perpare first forward gemm: 0.286,  fisrt gemm forward duration: 2.139
AG, 0.267361, 1.976320, 0 
perpare first forward gemm: 0.302,  fisrt gemm forward duration: 2.037
GA, 0.168033, 1.940480, 0 
GA, 0.219697, 2.027520, 0 
GA, 0.223881, 2.186240, 0 
GA, 0.267361, 2.257920, 0 
forward:  7.622
forward:  7.645
forward:  7.693
forward:  7.502
AG, 0.219697, 1.814528, 0 
AG, 0.168033, 1.798144, 0 
AG, 0.223881, 1.828864, 0 
AG, 0.267361, 2.013184, 0 
Linear 2 Backward: 3.492, second_gemm: 3.481
Linear 2 Backward: 3.371, second_gemm: 3.359
Linear 2 Backward: 3.416, second_gemm: 3.405
Linear 2 Backward: 3.778, second_gemm: 3.77
GA, 0.168033, 1.797120, 0 
GA, 0.219697, 1.927168, 0 
GA, 0.223881, 2.085888, 0 
GA, 0.267361, 2.243584, 0 
perpare first backward gemm: 0.032,  fisrt gemm backward duration: 2.723,  weight grad: 1.521,  other: 0.408
Linear 1 Backward:  4.725
perpare first backward gemm: 0.034,  fisrt gemm backward duration: 2.563,  weight grad: 1.711,  other: 0.411
Linear 1 Backward:  4.763
perpare first backward gemm: 0.034,  fisrt gemm backward duration: 2.531,  weight grad: 1.744,  other: 0.41
Linear 1 Backward:  4.76
perpare first backward gemm: 0.03,  fisrt gemm backward duration: 2.289,  weight grad: 1.898,  other: 0.413
Linear 1 Backward:  4.666
STEP-13: step_time = 21.838592 ms, foward_time = 10.722048, backward_time = 10.981376, perf = 37.76 tflops.
start
start
start
start
block_info 264 58
block_info 268 60
block_info 244 41
block_info 288 77
cuda:2 process time:3.6487579345703125, a: 0.8704662322998047, b: 1.1317729949951172, c: 0.08916854858398438, d: 1.5573501586914062
cuda:1 process time:3.6318302154541016, a: 0.8625984191894531, b: 1.1162757873535156, c: 0.08726119995117188, d: 1.565694808959961
cuda:3 process time:4.048347473144531, a: 0.7143020629882812, b: 1.6014575958251953, c: 0.11706352233886719, d: 1.6155242919921875
cuda:0 process time:3.840923309326172, a: 0.7848739624023438, b: 1.0035037994384766, c: 0.08893013000488281, d: 1.9636154174804688
1 wait time: 2.061
264
2 wait time: 2.091
268
3 wait time: 2.162
244
0 wait time: 1.835
288
AG, 0.168033, 1.799168, 0 
perpare first forward gemm: 0.278,  fisrt gemm forward duration: 2.076
AG, 0.223881, 1.802240, 0 
perpare first forward gemm: 0.296,  fisrt gemm forward duration: 2.305
AG, 0.219697, 1.805312, 0 
perpare first forward gemm: 0.288,  fisrt gemm forward duration: 2.364
AG, 0.267361, 1.974272, 0 
perpare first forward gemm: 0.323,  fisrt gemm forward duration: 2.045
GA, 0.219697, 1.932288, 0 
GA, 0.168033, 1.938432, 0 
GA, 0.223881, 2.161664, 0 
GA, 0.267361, 2.173952, 0 
forward:  7.518
forward:  7.927
forward:  7.965
forward:  7.682
AG, 0.267361, 1.969152, 0 
AG, 0.223881, 1.808384, 0 
AG, 0.219697, 1.810432, 0 
AG, 0.168033, 1.808384, 0 
Linear 2 Backward: 3.312, second_gemm: 3.302
Linear 2 Backward: 3.344, second_gemm: 3.332
Linear 2 Backward: 3.495, second_gemm: 3.484
Linear 2 Backward: 3.977, second_gemm: 3.965
GA, 0.168033, 1.786880, 0 
GA, 0.223881, 2.010112, 0 
GA, 0.219697, 1.949696, 0 
GA, 0.267361, 2.170880, 0 
perpare first backward gemm: 0.026,  fisrt gemm backward duration: 2.812,  weight grad: 1.513,  other: 0.412
Linear 1 Backward:  4.799
perpare first backward gemm: 0.034,  fisrt gemm backward duration: 2.612,  weight grad: 1.719,  other: 0.445
perpare first backward gemm: 0.035,  fisrt gemm backward duration: 2.55,  weight grad: 1.755,  other: 0.431
Linear 1 Backward:  4.867
Linear 1 Backward:  4.821
perpare first backward gemm: 0.037,  fisrt gemm backward duration: 2.226,  weight grad: 1.913,  other: 0.43
Linear 1 Backward:  4.656
STEP-14: step_time = 21.916672 ms, foward_time = 10.398720, backward_time = 11.416576, perf = 37.63 tflops.
start
start
start
start
block_info 244 41
block_info 288 77
block_info 268 60
block_info 264 58
cuda:3 process time:3.9930343627929688, a: 0.7305145263671875, b: 1.5411376953125, c: 0.09107589721679688, d: 1.6303062438964844
cuda:0 process time:4.041433334350586, a: 0.7221698760986328, b: 1.592874526977539, c: 0.08821487426757812, d: 1.638174057006836
cuda:2 process time:4.026651382446289, a: 0.7801055908203125, b: 1.1718273162841797, c: 0.09369850158691406, d: 1.9810199737548828
cuda:1 process time:3.9153099060058594, a: 0.7808208465576172, b: 1.0142326354980469, c: 0.091552734375, d: 2.0287036895751953
3 wait time: 2.119
244
0 wait time: 2.157
288
2 wait time: 1.801
268
1 wait time: 1.816
264
AG, 0.223881, 1.795072, 0 
perpare first forward gemm: 0.311,  fisrt gemm forward duration: 1.917
AG, 0.168033, 1.799168, 0 
perpare first forward gemm: 0.257,  fisrt gemm forward duration: 2.244
AG, 0.219697, 1.808384, 0 
perpare first forward gemm: 0.308,  fisrt gemm forward duration: 1.872
AG, 0.267361, 1.970176, 0 
perpare first forward gemm: 0.291,  fisrt gemm forward duration: 2.301
GA, 0.168033, 1.969152, 0 
GA, 0.223881, 2.086912, 0 
GA, 0.219697, 2.004992, 0 
GA, 0.267361, 2.238464, 0 
forward:  7.437
forward:  7.703
forward:  7.494
forward:  7.664
AG, 0.223881, 1.817600, 0 
AG, 0.219697, 1.814528, 0 
AG, 0.168033, 1.797120, 0 
AG, 0.267361, 1.974272, 0 
Linear 2 Backward: 3.535, second_gemm: 3.521
Linear 2 Backward: 3.753, second_gemm: 3.739
Linear 2 Backward: 3.574, second_gemm: 3.555
Linear 2 Backward: 3.896, second_gemm: 3.877
GA, 0.168033, 1.693696, 0 
GA, 0.219697, 1.818624, 0 
GA, 0.223881, 1.937408, 0 
GA, 0.267361, 2.046976, 0 
perpare first backward gemm: 0.039,  fisrt gemm backward duration: 2.816,  weight grad: 1.544,  other: 0.471
Linear 1 Backward:  4.933
perpare first backward gemm: 0.041,  fisrt gemm backward duration: 2.593,  weight grad: 1.764,  other: 0.45
Linear 1 Backward:  4.913
perpare first backward gemm: 0.06,  fisrt gemm backward duration: 2.466,  weight grad: 1.772,  other: 0.493
Linear 1 Backward:  4.883
perpare first backward gemm: 0.063,  fisrt gemm backward duration: 2.133,  weight grad: 1.972,  other: 0.496
Linear 1 Backward:  4.752
STEP-15: step_time = 22.765569 ms, foward_time = 10.773504, backward_time = 11.873280, perf = 36.22 tflops.
start
start
start
start
block_info 264 58
block_info 268 60
block_info 288 77
cuda:1 process time:3.908395767211914, a: 0.7274150848388672, b: 1.424551010131836, c: 0.10704994201660156, d: 1.6493797302246094
block_info 244 41
cuda:2 process time:3.756284713745117, a: 0.7336139678955078, b: 1.2156963348388672, c: 0.10538101196289062, d: 1.7015933990478516
1 wait time: 2.162
264
2 wait time: 2.235
268
cuda:3 process time:4.524707794189453, a: 0.7259845733642578, b: 1.390218734741211, c: 0.12969970703125, d: 2.2788047790527344
cuda:0 process time:4.25267219543457, a: 0.6597042083740234, b: 1.0259151458740234, c: 0.11920928955078125, d: 2.447843551635742
3 wait time: 2.108
244
0 wait time: 2.315
288
AG, 0.223881, 1.800192, 0 
perpare first forward gemm: 0.278,  fisrt gemm forward duration: 2.618
AG, 0.219697, 1.801216, 0 
perpare first forward gemm: 0.28,  fisrt gemm forward duration: 2.64
AG, 0.168033, 1.799168, 0 
perpare first forward gemm: 0.317,  fisrt gemm forward duration: 1.956
AG, 0.267361, 1.978368, 0 
perpare first forward gemm: 0.342,  fisrt gemm forward duration: 2.052
GA, 0.219697, 1.849344, 0 
GA, 0.168033, 1.980416, 0 
GA, 0.223881, 2.200576, 0 
GA, 0.267361, 2.143232, 0 
forward:  8.197
forward:  7.574
forward:  8.151
forward:  7.543
AG, 0.223881, 1.819648, 0 
AG, 0.219697, 1.811456, 0 
AG, 0.168033, 1.803264, 0 
AG, 0.267361, 1.979392, 0 
Linear 2 Backward: 3.665, second_gemm: 3.653
Linear 2 Backward: 3.513, second_gemm: 3.496
Linear 2 Backward: 3.759, second_gemm: 3.746
Linear 2 Backward: 3.838, second_gemm: 3.822
GA, 0.168033, 1.681408, 0 
GA, 0.219697, 1.813504, 0 
GA, 0.223881, 1.914880, 0 
GA, 0.267361, 2.057216, 0 
perpare first backward gemm: 0.035,  fisrt gemm backward duration: 2.784,  weight grad: 1.534,  other: 0.409
Linear 1 Backward:  4.807
perpare first backward gemm: 0.037,  fisrt gemm backward duration: 2.565,  weight grad: 1.759,  other: 0.411
perpare first backward gemm: 0.052,  fisrt gemm backward duration: 2.476,  weight grad: 1.759,  other: 0.43
Linear 1 Backward:  4.816
Linear 1 Backward:  4.783
perpare first backward gemm: 0.056,  fisrt gemm backward duration: 2.137,  weight grad: 1.957,  other: 0.431
Linear 1 Backward:  4.641
STEP-16: step_time = 22.794240 ms, foward_time = 11.002880, backward_time = 11.692032, perf = 36.18 tflops.
start
start
start
start
block_info 288 77
block_info 268 60
block_info 244 41
cuda:0 process time:3.5600662231445312, a: 0.6270408630371094, b: 1.157999038696289, c: 0.08344650268554688, d: 1.691579818725586
block_info 264 58
cuda:2 process time:3.7314891815185547, a: 0.7257461547851562, b: 1.0271072387695312, c: 0.09131431579589844, d: 1.8873214721679688
0 wait time: 1.844
288
cuda:3 process time:3.9739608764648438, a: 0.6105899810791016, b: 1.0769367218017578, c: 0.11324882507324219, d: 2.173185348510742
2 wait time: 2.054
268
cuda:1 process time:4.396915435791016, a: 0.7419586181640625, b: 1.3298988342285156, c: 0.10037422180175781, d: 2.2246837615966797
3 wait time: 2.315
244
1 wait time: 2.796
264
AG, 0.168033, 1.788928, 0 
perpare first forward gemm: 0.277,  fisrt gemm forward duration: 2.063
AG, 0.223881, 1.798144, 0 
perpare first forward gemm: 0.293,  fisrt gemm forward duration: 2.446
AG, 0.219697, 1.809408, 0 
perpare first forward gemm: 0.286,  fisrt gemm forward duration: 1.87
AG, 0.267361, 1.974272, 0 
perpare first forward gemm: 0.305,  fisrt gemm forward duration: 2.783
GA, 0.219697, 1.997824, 0 
GA, 0.168033, 1.969152, 0 
GA, 0.223881, 2.163712, 0 
GA, 0.267361, 2.227200, 0 
forward:  7.605
forward:  8.005
forward:  7.394
forward:  8.179
AG, 0.219697, 1.824768, 0 
AG, 0.168033, 1.802240, 0 
AG, 0.223881, 1.812480, 0 
AG, 0.267361, 1.993728, 0 
Linear 2 Backward: 3.496, second_gemm: 3.485
Linear 2 Backward: 3.505, second_gemm: 3.49
Linear 2 Backward: 3.681, second_gemm: 3.671
Linear 2 Backward: 3.826, second_gemm: 3.811
GA, 0.168033, 1.705984, 0 
GA, 0.219697, 1.805312, 0 
GA, 0.223881, 1.948672, 0 
GA, 0.267361, 2.080768, 0 
perpare first backward gemm: 0.032,  fisrt gemm backward duration: 2.787,  weight grad: 1.525,  other: 0.429
Linear 1 Backward:  4.823
perpare first backward gemm: 0.037,  fisrt gemm backward duration: 2.568,  weight grad: 1.748,  other: 0.43
Linear 1 Backward:  4.833
perpare first backward gemm: 0.049,  fisrt gemm backward duration: 2.486,  weight grad: 1.746,  other: 0.463
Linear 1 Backward:  4.816
perpare first backward gemm: 0.048,  fisrt gemm backward duration: 2.157,  weight grad: 1.969,  other: 0.484
Linear 1 Backward:  4.727
STEP-17: step_time = 22.948864 ms, foward_time = 11.001856, backward_time = 11.845632, perf = 35.93 tflops.
start
start
start
start
block_info 288 77
block_info 268 60
block_info 264 58
block_info 244 41
cuda:0 process time:3.574848175048828, a: 0.81634521484375, b: 0.9911060333251953, c: 0.07319450378417969, d: 1.6942024230957031
cuda:2 process time:3.927946090698242, a: 0.7569789886474609, b: 1.3973712921142578, c: 0.0934600830078125, d: 1.680135726928711
0 wait time: 1.41
288
cuda:3 process time:4.199743270874023, a: 0.7724761962890625, b: 1.4507770538330078, c: 0.10395050048828125, d: 1.8725395202636719
2 wait time: 2.2
268
cuda:1 process time:4.39000129699707, a: 0.6792545318603516, b: 1.3158321380615234, c: 0.0896453857421875, d: 2.305269241333008
3 wait time: 2.455
244
1 wait time: 2.524
264
AG, 0.168033, 1.799168, 0 
perpare first forward gemm: 0.27,  fisrt gemm forward duration: 2.051
AG, 0.223881, 1.808384, 0 
perpare first forward gemm: 0.282,  fisrt gemm forward duration: 2.333
AG, 0.219697, 1.811456, 0 
perpare first forward gemm: 0.279,  fisrt gemm forward duration: 1.87
AG, 0.267361, 1.973248, 0 
perpare first forward gemm: 0.331,  fisrt gemm forward duration: 2.737
GA, 0.219697, 1.936384, 0 
GA, 0.168033, 1.940480, 0 
GA, 0.223881, 2.135040, 0 
GA, 0.267361, 2.205696, 0 
forward:  7.647
forward:  7.478
forward:  8.271
forward:  7.948
AG, 0.267361, 1.970176, 0 
AG, 0.219697, 1.807360, 0 
AG, 0.168033, 1.805312, 0 
AG, 0.223881, 1.826816, 0 
Linear 2 Backward: 3.527, second_gemm: 3.513
Linear 2 Backward: 3.582, second_gemm: 3.564
Linear 2 Backward: 3.826, second_gemm: 3.813
Linear 2 Backward: 3.992, second_gemm: 3.973
GA, 0.168033, 1.687552, 0 
GA, 0.219697, 1.819648, 0 
GA, 0.223881, 1.849344, 0 
GA, 0.267361, 2.057216, 0 
perpare first backward gemm: 0.039,  fisrt gemm backward duration: 2.833,  weight grad: 1.542,  other: 0.446
Linear 1 Backward:  4.907
perpare first backward gemm: 0.039,  fisrt gemm backward duration: 2.635,  weight grad: 1.763,  other: 0.465
Linear 1 Backward:  4.949
perpare first backward gemm: 0.06,  fisrt gemm backward duration: 2.463,  weight grad: 1.776,  other: 0.528
Linear 1 Backward:  4.896
perpare first backward gemm: 0.063,  fisrt gemm backward duration: 2.178,  weight grad: 1.956,  other: 0.452
Linear 1 Backward:  4.712
STEP-18: step_time = 22.587391 ms, foward_time = 10.692608, backward_time = 11.792384, perf = 36.51 tflops.
start
start
start
start
block_info 244 41
block_info 268 60
block_info 264 58
cuda:3 process time:3.590822219848633, a: 0.6265640258789062, b: 1.1823177337646484, c: 0.08821487426757812, d: 1.6937255859375
block_info 288 77
cuda:2 process time:3.8831233978271484, a: 0.7998943328857422, b: 1.04522705078125, c: 0.09369850158691406, d: 1.9443035125732422
3 wait time: 1.789
244
cuda:1 process time:4.379510879516602, a: 0.6284713745117188, b: 1.4238357543945312, c: 0.13875961303710938, d: 2.188444137573242
2 wait time: 1.766
268
cuda:0 process time:4.42194938659668, a: 0.7460117340087891, b: 1.260995864868164, c: 0.11372566223144531, d: 2.3012161254882812
1 wait time: 2.26
264
0 wait time: 2.379
288
AG, 0.168033, 1.788928, 0 
perpare first forward gemm: 0.288,  fisrt gemm forward duration: 2.484
AG, 0.219697, 1.808384, 0 
perpare first forward gemm: 0.288,  fisrt gemm forward duration: 2.075
AG, 0.223881, 1.813504, 0 
perpare first forward gemm: 0.349,  fisrt gemm forward duration: 2.24
AG, 0.267361, 1.966080, 0 
perpare first forward gemm: 0.306,  fisrt gemm forward duration: 2.03
GA, 0.168033, 1.906688, 0 
GA, 0.223881, 2.056192, 0 
GA, 0.219697, 2.080768, 0 
GA, 0.267361, 2.306048, 0 
forward:  8.092
forward:  7.668
forward:  7.92
forward:  7.481
AG, 0.223881, 1.821696, 0 
AG, 0.168033, 1.783808, 0 
AG, 0.219697, 1.822720, 0 
AG, 0.267361, 1.972224, 0 
Linear 2 Backward: 3.537, second_gemm: 3.525
Linear 2 Backward: 3.755, second_gemm: 3.743
Linear 2 Backward: 3.52, second_gemm: 3.503
Linear 2 Backward: 3.837, second_gemm: 3.822
GA, 0.168033, 1.696768, 0 
GA, 0.219697, 1.803264, 0 
GA, 0.223881, 1.938432, 0 
GA, 0.267361, 2.051072, 0 
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 2.813,  weight grad: 1.533,  other: 0.416
Linear 1 Backward:  4.842
perpare first backward gemm: 0.037,  fisrt gemm backward duration: 2.57,  weight grad: 1.747,  other: 0.416
Linear 1 Backward:  4.814
perpare first backward gemm: 0.054,  fisrt gemm backward duration: 2.467,  weight grad: 1.746,  other: 0.441
Linear 1 Backward:  4.772
perpare first backward gemm: 0.057,  fisrt gemm backward duration: 2.133,  weight grad: 1.93,  other: 0.43
Linear 1 Backward:  4.611
STEP-19: step_time = 22.609921 ms, foward_time = 10.872832, backward_time = 11.635712, perf = 36.47 tflops.
start
start
start
start
block_info 268 60
block_info 288 77
block_info 244 41
block_info 264 58
cuda:3 process time:3.638744354248047, a: 0.7147789001464844, b: 1.1708736419677734, c: 0.08511543273925781, d: 1.6679763793945312
cuda:2 process time:3.556966781616211, a: 0.7765293121337891, b: 1.0113716125488281, c: 0.10824203491210938, d: 1.6608238220214844
cuda:0 process time:3.7293434143066406, a: 0.7405281066894531, b: 1.1162757873535156, c: 0.087738037109375, d: 1.7848014831542969
cuda:1 process time:4.397869110107422, a: 0.7245540618896484, b: 1.5251636505126953, c: 0.10609626770019531, d: 2.042055130004883
3 wait time: 1.795
244
0 wait time: 1.902
288
2 wait time: 2.149
268
1 wait time: 2.186
264
AG, 0.168033, 1.795072, 0 
perpare first forward gemm: 0.273,  fisrt gemm forward duration: 2.248
AG, 0.223881, 1.799168, 0 
perpare first forward gemm: 0.288,  fisrt gemm forward duration: 2.181
AG, 0.219697, 1.814528, 0 
perpare first forward gemm: 0.283,  fisrt gemm forward duration: 1.874
AG, 0.267361, 1.964032, 0 
perpare first forward gemm: 0.297,  fisrt gemm forward duration: 2.323
GA, 0.219697, 2.054144, 0 
GA, 0.168033, 1.942528, 0 
GA, 0.223881, 2.186240, 0 
GA, 0.267361, 2.325504, 0 
forward:  7.771
forward:  7.833
forward:  7.472
forward:  7.757
AG, 0.219697, 1.803264, 0 
AG, 0.223881, 1.805312, 0 
AG, 0.168033, 1.812480, 0 
AG, 0.267361, 1.949696, 0 
Linear 2 Backward: 3.461, second_gemm: 3.451
Linear 2 Backward: 3.402, second_gemm: 3.391
Linear 2 Backward: 3.466, second_gemm: 3.451
Linear 2 Backward: 3.789, second_gemm: 3.774
GA, 0.168033, 1.708032, 0 
GA, 0.219697, 1.836032, 0 
GA, 0.223881, 1.991680, 0 
GA, 0.267361, 2.062336, 0 
perpare first backward gemm: 0.032,  fisrt gemm backward duration: 2.753,  weight grad: 1.515,  other: 0.407
Linear 1 Backward:  4.749
perpare first backward gemm: 0.033,  fisrt gemm backward duration: 2.563,  weight grad: 1.751,  other: 0.433
Linear 1 Backward:  4.831
perpare first backward gemm: 0.049,  fisrt gemm backward duration: 2.476,  weight grad: 1.754,  other: 0.467
Linear 1 Backward:  4.819
perpare first backward gemm: 0.049,  fisrt gemm backward duration: 2.139,  weight grad: 1.932,  other: 0.468
Linear 1 Backward:  4.656
STEP-20: step_time = 22.565887 ms, foward_time = 10.661888, backward_time = 11.802624, perf = 36.54 tflops.
start
start
start
start
block_info 268 60
block_info 264 58
block_info 244 41
block_info 288 77
cuda:2 process time:3.832101821899414, a: 0.7433891296386719, b: 1.3010501861572266, c: 0.09369850158691406, d: 1.6939640045166016
2 wait time: 2.224
268
cuda:1 process time:4.229068756103516, a: 0.7503032684326172, b: 1.2691020965576172, c: 0.11110305786132812, d: 2.098560333251953
cuda:3 process time:4.364013671875, a: 0.8409023284912109, b: 1.0313987731933594, c: 0.11491775512695312, d: 2.3767948150634766
cuda:0 process time:4.373311996459961, a: 0.7338523864746094, b: 1.329660415649414, c: 0.1163482666015625, d: 2.193450927734375
1 wait time: 2.593
264
3 wait time: 2.177
244
0 wait time: 2.825
288
AG, 0.168033, 1.792000, 0 
perpare first forward gemm: 0.305,  fisrt gemm forward duration: 1.967
AG, 0.223881, 1.794048, 0 
perpare first forward gemm: 0.27,  fisrt gemm forward duration: 2.684
AG, 0.219697, 1.808384, 0 
perpare first forward gemm: 0.274,  fisrt gemm forward duration: 2.258
AG, 0.267361, 1.968128, 0 
perpare first forward gemm: 0.314,  fisrt gemm forward duration: 2.038
GA, 0.219697, 1.956864, 0 
GA, 0.168033, 1.990656, 0 
GA, 0.223881, 2.214912, 0 
GA, 0.267361, 2.202624, 0 
forward:  8.186
forward:  7.769
forward:  7.616
forward:  7.458
AG, 0.168033, 1.805312, 0 
AG, 0.223881, 1.811456, 0 
AG, 0.219697, 1.836032, 0 
AG, 0.267361, 1.954816, 0 
Linear 2 Backward: 3.527, second_gemm: 3.517
Linear 2 Backward: 3.471, second_gemm: 3.457
Linear 2 Backward: 3.756, second_gemm: 3.742
Linear 2 Backward: 4.075, second_gemm: 4.067
GA, 0.168033, 1.694720, 0 
GA, 0.223881, 1.871872, 0 
GA, 0.219697, 2.159616, 0 
GA, 0.267361, 2.405376, 0 
perpare first backward gemm: 0.03,  fisrt gemm backward duration: 2.881,  weight grad: 1.522,  other: 0.422
Linear 1 Backward:  4.9
perpare first backward gemm: 0.041,  fisrt gemm backward duration: 2.559,  weight grad: 1.736,  other: 0.48
perpare first backward gemm: 0.043,  fisrt gemm backward duration: 2.512,  weight grad: 1.761,  other: 0.475
Linear 1 Backward:  4.865
Linear 1 Backward:  4.839
perpare first backward gemm: 0.03,  fisrt gemm backward duration: 2.452,  weight grad: 1.882,  other: 0.422
Linear 1 Backward:  4.822
STEP-21: step_time = 22.620159 ms, foward_time = 11.155456, backward_time = 11.364352, perf = 36.46 tflops.
start
start
start
start
block_info 268 60
block_info 244 41
block_info 264 58
cuda:3 process time:3.6127567291259766, a: 0.7462501525878906, b: 1.2538433074951172, c: 0.09059906005859375, d: 1.522064208984375
cuda:2 process time:3.8857460021972656, a: 0.7290840148925781, b: 1.3866424560546875, c: 0.09274482727050781, d: 1.6772747039794922
block_info 288 77
cuda:1 process time:4.101276397705078, a: 0.7791519165039062, b: 1.0995864868164062, c: 0.11897087097167969, d: 2.103567123413086
3 wait time: 2.037
244
2 wait time: 2.185
268
cuda:0 process time:4.343748092651367, a: 0.7114410400390625, b: 1.1432170867919922, c: 0.15115737915039062, d: 2.337932586669922
1 wait time: 2.314
264
0 wait time: 2.402
288
AG, 0.168033, 1.795072, 0 
perpare first forward gemm: 0.282,  fisrt gemm forward duration: 2.642
AG, 0.223881, 1.798144, 0 
perpare first forward gemm: 0.268,  fisrt gemm forward duration: 2.624
AG, 0.219697, 1.809408, 0 
perpare first forward gemm: 0.29,  fisrt gemm forward duration: 2.206
AG, 0.267361, 1.965056, 0 
perpare first forward gemm: 0.311,  fisrt gemm forward duration: 2.029
GA, 0.219697, 2.025472, 0 
GA, 0.168033, 1.966080, 0 
GA, 0.223881, 2.179072, 0 
GA, 0.267361, 2.278400, 0 
forward:  8.155
forward:  7.784
forward:  8.234
forward:  7.486
AG, 0.168033, 1.810432, 0 
AG, 0.223881, 1.807360, 0 
AG, 0.219697, 1.799168, 0 
AG, 0.267361, 1.971200, 0 
Linear 2 Backward: 3.51, second_gemm: 3.503
Linear 2 Backward: 3.4, second_gemm: 3.387
Linear 2 Backward: 3.513, second_gemm: 3.501
Linear 2 Backward: 3.793, second_gemm: 3.78
GA, 0.168033, 1.676288, 0 
GA, 0.223881, 1.819648, 0 
GA, 0.219697, 1.970176, 0 
GA, 0.267361, 2.194432, 0 
perpare first backward gemm: 0.025,  fisrt gemm backward duration: 2.899,  weight grad: 1.508,  other: 0.411
Linear 1 Backward:  4.877
perpare first backward gemm: 0.039,  fisrt gemm backward duration: 2.562,  weight grad: 1.728,  other: 0.411
perpare first backward gemm: 0.037,  fisrt gemm backward duration: 2.529,  weight grad: 1.753,  other: 0.408
Linear 1 Backward:  4.786
Linear 1 Backward:  4.771
perpare first backward gemm: 0.04,  fisrt gemm backward duration: 2.27,  weight grad: 1.903,  other: 0.409
Linear 1 Backward:  4.668
STEP-22: step_time = 22.115329 ms, foward_time = 10.908672, backward_time = 11.107328, perf = 37.29 tflops.
start
start
start
start
block_info 268 60
block_info 244 41
cuda:2 process time:3.8204193115234375, a: 0.7274150848388672, b: 1.397848129272461, c: 0.08678436279296875, d: 1.6083717346191406
block_info 264 58
block_info 288 77
2 wait time: 2.114
268
cuda:3 process time:3.9963722229003906, a: 0.782012939453125, b: 1.2347698211669922, c: 0.10585784912109375, d: 1.8737316131591797
cuda:1 process time:4.271745681762695, a: 0.789642333984375, b: 1.27410888671875, c: 0.11086463928222656, d: 2.0971298217773438
cuda:0 process time:4.348516464233398, a: 0.6792545318603516, b: 1.1856555938720703, c: 0.11491775512695312, d: 2.3686885833740234
3 wait time: 2.416
244
1 wait time: 2.67
264
0 wait time: 2.448
288
AG, 0.219697, 1.809408, 0 
perpare first forward gemm: 0.281,  fisrt gemm forward duration: 1.965
AG, 0.168033, 1.798144, 0 
perpare first forward gemm: 0.272,  fisrt gemm forward duration: 2.224
AG, 0.223881, 1.794048, 0 
perpare first forward gemm: 0.271,  fisrt gemm forward duration: 2.634
AG, 0.267361, 1.961984, 0 
perpare first forward gemm: 0.299,  fisrt gemm forward duration: 2.024
GA, 0.223881, 2.188288, 0 
GA, 0.219697, 2.008064, 0 
GA, 0.168033, 1.984512, 0 
GA, 0.267361, 2.291712, 0 
forward:  7.779
forward:  8.168
forward:  7.516
forward:  7.488
AG, 0.219697, 1.813504, 0 
AG, 0.168033, 1.804288, 0 
AG, 0.223881, 1.819648, 0 
AG, 0.267361, 1.959936, 0 
Linear 2 Backward: 3.288, second_gemm: 3.275
Linear 2 Backward: 3.63, second_gemm: 3.618
Linear 2 Backward: 3.645, second_gemm: 3.633
Linear 2 Backward: 3.884, second_gemm: 3.876
GA, 0.168033, 1.905664, 0 
GA, 0.219697, 2.043904, 0 
GA, 0.223881, 2.146304, 0 
GA, 0.267361, 2.271232, 0 
perpare first backward gemm: 0.042,  fisrt gemm backward duration: 2.668,  weight grad: 1.559,  other: 0.463
Linear 1 Backward:  4.791
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 2.578,  weight grad: 1.723,  other: 0.454
perpare first backward gemm: 0.034,  fisrt gemm backward duration: 2.535,  weight grad: 1.748,  other: 0.438
Linear 1 Backward:  4.809
Linear 1 Backward:  4.845
perpare first backward gemm: 0.033,  fisrt gemm backward duration: 2.323,  weight grad: 1.888,  other: 0.416
Linear 1 Backward:  4.703
STEP-23: step_time = 22.312959 ms, foward_time = 10.973184, backward_time = 11.228160, perf = 36.96 tflops.
start
start
start
start
block_info 268 60
block_info 244 41
block_info 264 58
block_info 288 77
cuda:2 process time:3.902912139892578, a: 0.7624626159667969, b: 1.4688968658447266, c: 0.09012222290039062, d: 1.581430435180664
cuda:3 process time:3.9284229278564453, a: 0.8890628814697266, b: 1.0750293731689453, c: 0.10704994201660156, d: 1.8572807312011719
cuda:1 process time:4.207134246826172, a: 0.7727146148681641, b: 1.2392997741699219, c: 0.11467933654785156, d: 2.0804405212402344
2 wait time: 2.112
268
3 wait time: 2.371
244
cuda:0 process time:4.538059234619141, a: 0.6117820739746094, b: 1.4414787292480469, c: 0.11420249938964844, d: 2.370595932006836
1 wait time: 2.602
264
0 wait time: 2.43
288
AG, 0.223881, 1.800192, 0 
perpare first forward gemm: 0.305,  fisrt gemm forward duration: 2.531
AG, 0.168033, 1.829888, 0 
perpare first forward gemm: 0.29,  fisrt gemm forward duration: 2.44
AG, 0.219697, 1.816576, 0 
perpare first forward gemm: 0.305,  fisrt gemm forward duration: 2.14
AG, 0.267361, 1.967104, 0 
perpare first forward gemm: 0.311,  fisrt gemm forward duration: 2.034
GA, 0.219697, 1.896448, 0 
GA, 0.168033, 1.942528, 0 
GA, 0.223881, 2.221056, 0 
GA, 0.267361, 2.159616, 0 
forward:  8.124
forward:  7.723
forward:  8.015
forward:  7.538
AG, 0.168033, 1.809408, 0 
AG, 0.219697, 1.818624, 0 
AG, 0.223881, 1.820672, 0 
AG, 0.267361, 1.954816, 0 
Linear 2 Backward: 3.477, second_gemm: 3.461
Linear 2 Backward: 3.511, second_gemm: 3.494
Linear 2 Backward: 3.787, second_gemm: 3.773
Linear 2 Backward: 3.922, second_gemm: 3.913
GA, 0.168033, 1.700864, 0 
GA, 0.223881, 1.981440, 0 
GA, 0.219697, 2.108416, 0 
GA, 0.267361, 2.341888, 0 
perpare first backward gemm: 0.046,  fisrt gemm backward duration: 2.674,  weight grad: 1.556,  other: 0.479
Linear 1 Backward:  4.822
perpare first backward gemm: 0.05,  fisrt gemm backward duration: 2.459,  weight grad: 1.761,  other: 0.416
Linear 1 Backward:  4.745
perpare first backward gemm: 0.039,  fisrt gemm backward duration: 2.526,  weight grad: 1.777,  other: 0.449
Linear 1 Backward:  4.857
perpare first backward gemm: 0.031,  fisrt gemm backward duration: 2.391,  weight grad: 1.885,  other: 0.416
Linear 1 Backward:  4.764
STEP-24: step_time = 22.517760 ms, foward_time = 11.021312, backward_time = 11.393024, perf = 36.62 tflops.
start
start
start
start
block_info 268 60
block_info 288 77
cuda:2 process time:3.400564193725586, a: 0.6606578826904297, b: 1.3380050659179688, c: 0.07224082946777344, d: 1.329660415649414
block_info 244 41
cuda:0 process time:3.445148468017578, a: 0.6339550018310547, b: 1.3375282287597656, c: 0.06127357482910156, d: 1.4123916625976562
block_info 264 58
2 wait time: 1.346
268
0 wait time: 1.304
288
cuda:3 process time:3.633260726928711, a: 0.7817745208740234, b: 1.2195110321044922, c: 0.08893013000488281, d: 1.5430450439453125
3 wait time: 2.035
244
cuda:1 process time:4.166841506958008, a: 0.7436275482177734, b: 1.3742446899414062, c: 0.10418891906738281, d: 1.9447803497314453
1 wait time: 2.478
264
AG, 0.223881, 1.803264, 0 
perpare first forward gemm: 0.279,  fisrt gemm forward duration: 2.796
AG, 0.267361, 1.963008, 0 
perpare first forward gemm: 0.31,  fisrt gemm forward duration: 2.767
AG, 0.168033, 1.796096, 0 
perpare first forward gemm: 0.286,  fisrt gemm forward duration: 2.143
AG, 0.219697, 1.810432, 0 
perpare first forward gemm: 0.276,  fisrt gemm forward duration: 1.867
GA, 0.168033, 1.989632, 0 
GA, 0.219697, 1.960960, 0 
GA, 0.223881, 2.291712, 0 
GA, 0.267361, 2.188288, 0 
forward:  7.767
forward:  7.376
forward:  8.311
forward:  8.228
AG, 0.223881, 1.818624, 0 
AG, 0.168033, 1.793024, 0 
AG, 0.219697, 1.808384, 0 
AG, 0.267361, 1.965056, 0 
Linear 2 Backward: 3.293, second_gemm: 3.279
Linear 2 Backward: 3.546, second_gemm: 3.533
Linear 2 Backward: 3.605, second_gemm: 3.592
Linear 2 Backward: 3.771, second_gemm: 3.757
GA, 0.168033, 1.838080, 0 
GA, 0.219697, 1.980416, 0 
GA, 0.223881, 2.062336, 0 
GA, 0.267361, 2.211840, 0 
perpare first backward gemm: 0.044,  fisrt gemm backward duration: 2.731,  weight grad: 1.55,  other: 0.472
Linear 1 Backward:  4.862
perpare first backward gemm: 0.041,  fisrt gemm backward duration: 2.537,  weight grad: 1.759,  other: 0.48
Linear 1 Backward:  4.864
perpare first backward gemm: 0.039,  fisrt gemm backward duration: 2.577,  weight grad: 1.733,  other: 0.498
Linear 1 Backward:  4.897
perpare first backward gemm: 0.041,  fisrt gemm backward duration: 2.276,  weight grad: 1.909,  other: 0.461
Linear 1 Backward:  4.735
STEP-25: step_time = 21.807104 ms, foward_time = 10.539008, backward_time = 11.167744, perf = 37.81 tflops.
start
start
start
start
block_info 244 41
block_info 288 77
cuda:3 process time:3.5729408264160156, a: 0.6418228149414062, b: 1.1584758758544922, c: 0.08821487426757812, d: 1.684427261352539
block_info 264 58
block_info 268 60
cuda:0 process time:3.9319992065429688, a: 0.7414817810058594, b: 1.3451576232910156, c: 0.09417533874511719, d: 1.7511844635009766
3 wait time: 1.862
244
0 wait time: 2.296
288
cuda:1 process time:4.219293594360352, a: 0.75531005859375, b: 1.2981891632080078, c: 0.11324882507324219, d: 2.0525455474853516
cuda:2 process time:4.4765472412109375, a: 0.7593631744384766, b: 1.5091896057128906, c: 0.11897087097167969, d: 2.0890235900878906
1 wait time: 2.608
264
2 wait time: 2.595
268
AG, 0.168033, 1.800192, 0 
perpare first forward gemm: 0.281,  fisrt gemm forward duration: 2.69
AG, 0.219697, 1.820672, 0 
perpare first forward gemm: 0.293,  fisrt gemm forward duration: 2.002
AG, 0.267361, 1.961984, 0 
perpare first forward gemm: 0.282,  fisrt gemm forward duration: 2.652
AG, 0.223881, 1.797120, 0 
perpare first forward gemm: 0.295,  fisrt gemm forward duration: 1.862
GA, 0.168033, 1.979392, 0 
GA, 0.219697, 2.104320, 0 
GA, 0.223881, 2.193408, 0 
GA, 0.267361, 2.347008, 0 
forward:  7.441
forward:  7.558
forward:  8.252
forward:  8.014
AG, 0.168033, 1.802240, 0 
AG, 0.223881, 1.806336, 0 
AG, 0.219697, 1.820672, 0 
AG, 0.267361, 1.971200, 0 
Linear 2 Backward: 3.291, second_gemm: 3.278
Linear 2 Backward: 3.621, second_gemm: 3.61
Linear 2 Backward: 3.749, second_gemm: 3.736
Linear 2 Backward: 3.92, second_gemm: 3.909
GA, 0.168033, 1.715200, 0 
GA, 0.219697, 1.814528, 0 
GA, 0.223881, 1.965056, 0 
GA, 0.267361, 2.030592, 0 
perpare first backward gemm: 0.041,  fisrt gemm backward duration: 2.716,  weight grad: 1.553,  other: 0.424
Linear 1 Backward:  4.783
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 2.536,  weight grad: 1.755,  other: 0.408
perpare first backward gemm: 0.041,  fisrt gemm backward duration: 2.426,  weight grad: 1.727,  other: 0.434
Linear 1 Backward:  4.78
Linear 1 Backward:  4.681
perpare first backward gemm: 0.043,  fisrt gemm backward duration: 2.106,  weight grad: 1.907,  other: 0.429
Linear 1 Backward:  4.536
STEP-26: step_time = 22.801409 ms, foward_time = 11.137024, backward_time = 11.564032, perf = 36.17 tflops.
start
start
start
start
block_info 264 58
block_info 244 41
block_info 288 77
block_info 268 60
cuda:3 process time:3.880739212036133, a: 0.7817745208740234, b: 1.3790130615234375, c: 0.09417533874511719, d: 1.6257762908935547
cuda:1 process time:3.9958953857421875, a: 0.7762908935546875, b: 1.3058185577392578, c: 0.09226799011230469, d: 1.8215179443359375
cuda:0 process time:4.082441329956055, a: 0.8561611175537109, b: 1.0633468627929688, c: 0.09512901306152344, d: 2.0678043365478516
cuda:2 process time:4.325389862060547, a: 0.9095668792724609, b: 1.2469291687011719, c: 0.11157989501953125, d: 2.057313919067383
3 wait time: 2.169
244
1 wait time: 1.983
264
0 wait time: 1.898
288
2 wait time: 2.639
268
AG, 0.219697, 1.807360, 0 
perpare first forward gemm: 0.283,  fisrt gemm forward duration: 2.221
AG, 0.267361, 1.966080, 0 
perpare first forward gemm: 0.33,  fisrt gemm forward duration: 2.077
AG, 0.168033, 1.789952, 0 
perpare first forward gemm: 0.271,  fisrt gemm forward duration: 2.267
AG, 0.223881, 1.796096, 0 
perpare first forward gemm: 0.287,  fisrt gemm forward duration: 1.856
GA, 0.168033, 1.967104, 0 
GA, 0.219697, 1.961984, 0 
GA, 0.223881, 2.091008, 0 
GA, 0.267361, 2.229248, 0 
forward:  7.783
forward:  7.834
forward:  7.433
forward:  7.58
AG, 0.223881, 1.817600, 0 
AG, 0.219697, 1.807360, 0 
AG, 0.168033, 1.793024, 0 
AG, 0.267361, 1.947648, 0 
Linear 2 Backward: 3.376, second_gemm: 3.365
Linear 2 Backward: 3.477, second_gemm: 3.462
Linear 2 Backward: 3.633, second_gemm: 3.622
Linear 2 Backward: 3.783, second_gemm: 3.768
GA, 0.168033, 1.735680, 0 
GA, 0.219697, 1.839104, 0 
GA, 0.223881, 1.963008, 0 
GA, 0.267361, 2.055168, 0 
perpare first backward gemm: 0.038,  fisrt gemm backward duration: 2.718,  weight grad: 1.54,  other: 0.45
Linear 1 Backward:  4.798
perpare first backward gemm: 0.034,  fisrt gemm backward duration: 2.54,  weight grad: 1.75,  other: 0.429
Linear 1 Backward:  4.803
perpare first backward gemm: 0.048,  fisrt gemm backward duration: 2.444,  weight grad: 1.744,  other: 0.476
Linear 1 Backward:  4.784
perpare first backward gemm: 0.048,  fisrt gemm backward duration: 2.13,  weight grad: 1.926,  other: 0.46
Linear 1 Backward:  4.632
STEP-27: step_time = 22.424577 ms, foward_time = 10.551296, backward_time = 11.772928, perf = 36.77 tflops.
start
start
start
start
block_info 244 41
block_info 268 60
block_info 288 77
cuda:3 process time:3.9217472076416016, a: 0.7128715515136719, b: 1.3170242309570312, c: 0.09369850158691406, d: 1.7981529235839844
block_info 264 58
cuda:2 process time:4.090785980224609, a: 0.7998943328857422, b: 1.382589340209961, c: 0.08606910705566406, d: 1.8222332000732422
cuda:0 process time:4.12440299987793, a: 0.8301734924316406, b: 1.0135173797607422, c: 0.09489059448242188, d: 2.185821533203125
3 wait time: 1.86
244
2 wait time: 1.794
268
cuda:1 process time:4.424810409545898, a: 0.8511543273925781, b: 1.1677742004394531, c: 0.11157989501953125, d: 2.294301986694336
0 wait time: 1.934
288
1 wait time: 2.385
264
AG, 0.223881, 1.798144, 0 
perpare first forward gemm: 0.32,  fisrt gemm forward duration: 2.336
AG, 0.168033, 1.799168, 0 
perpare first forward gemm: 0.27,  fisrt gemm forward duration: 2.632
AG, 0.267361, 1.967104, 0 
perpare first forward gemm: 0.33,  fisrt gemm forward duration: 2.256
AG, 0.219697, 1.820672, 0 
perpare first forward gemm: 0.313,  fisrt gemm forward duration: 1.895
GA, 0.168033, 1.821696, 0 
GA, 0.223881, 2.031616, 0 
GA, 0.219697, 2.011136, 0 
GA, 0.267361, 2.245632, 0 
forward:  7.575
forward:  8.249
forward:  8.079
forward:  7.805
AG, 0.223881, 1.815552, 0 
AG, 0.219697, 1.806336, 0 
AG, 0.168033, 1.803264, 0 
AG, 0.267361, 1.956864, 0 
Linear 2 Backward: 3.556, second_gemm: 3.541
Linear 2 Backward: 3.794, second_gemm: 3.779
Linear 2 Backward: 3.591, second_gemm: 3.575
Linear 2 Backward: 3.906, second_gemm: 3.887
GA, 0.168033, 1.694720, 0 
GA, 0.219697, 1.815552, 0 
GA, 0.223881, 1.911808, 0 
GA, 0.267361, 2.035712, 0 
perpare first backward gemm: 0.045,  fisrt gemm backward duration: 2.743,  weight grad: 1.559,  other: 0.465
Linear 1 Backward:  4.865
perpare first backward gemm: 0.048,  fisrt gemm backward duration: 2.587,  weight grad: 1.78,  other: 0.409
perpare first backward gemm: 0.06,  fisrt gemm backward duration: 2.447,  weight grad: 1.772,  other: 0.431
Linear 1 Backward:  4.871
Linear 1 Backward:  4.778
perpare first backward gemm: 0.065,  fisrt gemm backward duration: 2.127,  weight grad: 1.95,  other: 0.427
Linear 1 Backward:  4.635
STEP-28: step_time = 22.630401 ms, foward_time = 10.847232, backward_time = 11.679744, perf = 36.44 tflops.
start
start
start
start
block_info 264 58
block_info 244 41
cuda:1 process time:3.337383270263672, a: 0.7014274597167969, b: 1.146078109741211, c: 0.06556510925292969, d: 1.4243125915527344
block_info 268 60
1 wait time: 1.149
264
block_info 288 77
cuda:2 process time:3.7147998809814453, a: 0.5381107330322266, b: 1.3713836669921875, c: 0.07843971252441406, d: 1.7268657684326172
cuda:3 process time:3.658771514892578, a: 0.7524490356445312, b: 1.2850761413574219, c: 0.08893013000488281, d: 1.5323162078857422
3 wait time: 1.936
244
2 wait time: 1.521
268
cuda:0 process time:4.062175750732422, a: 0.7672309875488281, b: 1.093149185180664, c: 0.10013580322265625, d: 2.1016597747802734
0 wait time: 2.221
288
AG, 0.168033, 1.795072, 0 
perpare first forward gemm: 0.29,  fisrt gemm forward duration: 2.378
AG, 0.223881, 1.802240, 0 
perpare first forward gemm: 0.296,  fisrt gemm forward duration: 2.337
AG, 0.219697, 1.816576, 0 
perpare first forward gemm: 0.291,  fisrt gemm forward duration: 2.907
AG, 0.267361, 1.964032, 0 
perpare first forward gemm: 0.313,  fisrt gemm forward duration: 2.03
GA, 0.168033, 1.900544, 0 
GA, 0.219697, 2.073600, 0 
GA, 0.223881, 2.199552, 0 
GA, 0.267361, 2.316288, 0 
forward:  8.034
forward:  7.963
forward:  8.514
forward:  7.514
AG, 0.219697, 1.804288, 0 
AG, 0.168033, 1.781760, 0 
AG, 0.223881, 1.817600, 0 
AG, 0.267361, 1.976320, 0 
Linear 2 Backward: 3.336, second_gemm: 3.323
Linear 2 Backward: 3.507, second_gemm: 3.491
Linear 2 Backward: 3.618, second_gemm: 3.606
Linear 2 Backward: 3.807, second_gemm: 3.791
GA, 0.168033, 1.676288, 0 
GA, 0.219697, 1.803264, 0 
GA, 0.223881, 1.957888, 0 
GA, 0.267361, 2.063360, 0 
perpare first backward gemm: 0.039,  fisrt gemm backward duration: 2.749,  weight grad: 1.556,  other: 0.426
Linear 1 Backward:  4.817
perpare first backward gemm: 0.037,  fisrt gemm backward duration: 2.552,  weight grad: 1.752,  other: 0.408
Linear 1 Backward:  4.792
perpare first backward gemm: 0.051,  fisrt gemm backward duration: 2.451,  weight grad: 1.76,  other: 0.429
Linear 1 Backward:  4.753
perpare first backward gemm: 0.051,  fisrt gemm backward duration: 2.141,  weight grad: 1.945,  other: 0.44
Linear 1 Backward:  4.635
STEP-29: step_time = 22.261760 ms, foward_time = 10.676224, backward_time = 11.487232, perf = 37.04 tflops.
start
start
start
start
block_info 244 41
block_info 264 58
cuda:3 process time:3.816366195678711, a: 0.7205009460449219, b: 1.2612342834472656, c: 0.08726119995117188, d: 1.7473697662353516
block_info 268 60
block_info 288 77
3 wait time: 1.643
244
cuda:1 process time:4.189491271972656, a: 0.7410049438476562, b: 1.2500286102294922, c: 0.10061264038085938, d: 2.0978450775146484
cuda:0 process time:4.352331161499023, a: 0.6597042083740234, b: 1.3265609741210938, c: 0.133514404296875, d: 2.2325515747070312
cuda:2 process time:4.24504280090332, a: 0.7822513580322266, b: 1.2557506561279297, c: 0.11301040649414062, d: 2.0940303802490234
1 wait time: 2.248
264
0 wait time: 2.286
288
2 wait time: 2.719
268
AG, 0.168033, 1.790976, 0 
perpare first forward gemm: 0.274,  fisrt gemm forward duration: 2.662
AG, 0.219697, 1.808384, 0 
perpare first forward gemm: 0.281,  fisrt gemm forward duration: 2.103
AG, 0.223881, 1.803264, 0 
perpare first forward gemm: 0.286,  fisrt gemm forward duration: 1.863
AG, 0.267361, 1.959936, 0 
perpare first forward gemm: 0.298,  fisrt gemm forward duration: 2.077
GA, 0.219697, 2.042880, 0 
GA, 0.168033, 1.961984, 0 
GA, 0.223881, 2.173952, 0 
GA, 0.267361, 2.251776, 0 
forward:  8.183
forward:  7.379
forward:  7.608
forward:  7.427
AG, 0.219697, 1.824768, 0 
AG, 0.168033, 1.822720, 0 
AG, 0.223881, 1.817600, 0 
AG, 0.267361, 2.010112, 0 
Linear 2 Backward: 3.421, second_gemm: 3.41
Linear 2 Backward: 3.487, second_gemm: 3.472
Linear 2 Backward: 3.692, second_gemm: 3.681
Linear 2 Backward: 3.822, second_gemm: 3.807
GA, 0.168033, 1.787904, 0 
GA, 0.219697, 1.821696, 0 
GA, 0.223881, 1.985536, 0 
GA, 0.267361, 2.009088, 0 
perpare first backward gemm: 0.037,  fisrt gemm backward duration: 2.712,  weight grad: 1.544,  other: 0.451
Linear 1 Backward:  4.798
perpare first backward gemm: 0.033,  fisrt gemm backward duration: 2.545,  weight grad: 1.749,  other: 0.428
Linear 1 Backward:  4.806
perpare first backward gemm: 0.048,  fisrt gemm backward duration: 2.464,  weight grad: 1.749,  other: 0.465
Linear 1 Backward:  4.798
perpare first backward gemm: 0.053,  fisrt gemm backward duration: 2.106,  weight grad: 1.93,  other: 0.461
Linear 1 Backward:  4.618
STEP-30: step_time = 22.686720 ms, foward_time = 10.696704, backward_time = 11.889664, perf = 36.35 tflops.
start
start
start
start
block_info 288 77
cuda:0 process time:3.557443618774414, a: 0.6535053253173828, b: 1.458883285522461, c: 0.06341934204101562, d: 1.3816356658935547
block_info 244 41
0 wait time: 1.534
288
cuda:3 process time:3.7751197814941406, a: 0.6971359252929688, b: 1.0085105895996094, c: 0.095367431640625, d: 1.9741058349609375
block_info 268 60
block_info 264 58
3 wait time: 1.634
244
cuda:2 process time:4.708051681518555, a: 0.8556842803955078, b: 1.5218257904052734, c: 0.11491775512695312, d: 2.2156238555908203
cuda:1 process time:4.5223236083984375, a: 0.7326602935791016, b: 1.2621879577636719, c: 0.1068115234375, d: 2.420663833618164
1 wait time: 2.216
264
2 wait time: 2.834
268
AG, 0.267361, 1.965056, 0 
perpare first forward gemm: 0.283,  fisrt gemm forward duration: 3.543
AG, 0.168033, 1.814528, 0 
perpare first forward gemm: 0.309,  fisrt gemm forward duration: 2.692
AG, 0.219697, 1.815552, 0 
perpare first forward gemm: 0.316,  fisrt gemm forward duration: 2.009
AG, 0.223881, 1.810432, 0 
perpare first forward gemm: 0.327,  fisrt gemm forward duration: 1.887
GA, 0.168033, 1.969152, 0 
GA, 0.223881, 2.203648, 0 
GA, 0.219697, 2.226176, 0 
GA, 0.267361, 2.428928, 0 
forward:  7.626
forward:  7.702
forward:  8.378
forward:  8.981
AG, 0.168033, 1.794048, 0 
AG, 0.223881, 1.811456, 0 
AG, 0.219697, 1.829888, 0 
AG, 0.267361, 1.965056, 0 
Linear 2 Backward: 3.317, second_gemm: 3.303
Linear 2 Backward: 3.627, second_gemm: 3.595
Linear 2 Backward: 3.646, second_gemm: 3.632
Linear 2 Backward: 3.936, second_gemm: 3.927
GA, 0.168033, 1.958912, 0 
GA, 0.223881, 2.138112, 0 
GA, 0.219697, 2.070528, 0 
GA, 0.267361, 2.296832, 0 
perpare first backward gemm: 0.045,  fisrt gemm backward duration: 2.702,  weight grad: 1.551,  other: 0.424
Linear 1 Backward:  4.773
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 2.696,  weight grad: 1.722,  other: 0.44
perpare first backward gemm: 0.043,  fisrt gemm backward duration: 2.531,  weight grad: 1.762,  other: 0.41
Linear 1 Backward:  4.946
Linear 1 Backward:  4.792
perpare first backward gemm: 0.037,  fisrt gemm backward duration: 2.352,  weight grad: 1.903,  other: 0.429
Linear 1 Backward:  4.768
STEP-31: step_time = 22.967296 ms, foward_time = 11.382784, backward_time = 11.485184, perf = 35.90 tflops.
start
start
start
start
block_info 244 41
block_info 264 58
cuda:3 process time:3.6547183990478516, a: 0.7839202880859375, b: 1.154184341430664, c: 0.10967254638671875, d: 1.6069412231445312
block_info 288 77
block_info 268 60
cuda:1 process time:3.753185272216797, a: 0.7028579711914062, b: 0.9438991546630859, c: 0.09036064147949219, d: 2.0160675048828125
3 wait time: 2.123
244
cuda:0 process time:4.136323928833008, a: 0.6988048553466797, b: 1.1324882507324219, c: 0.10395050048828125, d: 2.201080322265625
1 wait time: 1.886
264
cuda:2 process time:4.536628723144531, a: 0.6480216979980469, b: 1.3904571533203125, c: 0.11610984802246094, d: 2.382040023803711
0 wait time: 2.083
288
2 wait time: 2.255
268
AG, 0.168033, 1.799168, 0 
perpare first forward gemm: 0.277,  fisrt gemm forward duration: 2.83
AG, 0.219697, 1.813504, 0 
perpare first forward gemm: 0.289,  fisrt gemm forward duration: 2.594
AG, 0.223881, 1.802240, 0 
perpare first forward gemm: 0.317,  fisrt gemm forward duration: 1.878
AG, 0.267361, 1.963008, 0 
perpare first forward gemm: 0.296,  fisrt gemm forward duration: 2.447
GA, 0.168033, 1.883136, 0 
GA, 0.219697, 2.007040, 0 
GA, 0.223881, 2.046976, 0 
GA, 0.267361, 2.293760, 0 
forward:  8.396
forward:  7.525
forward:  8.165
forward:  7.88
AG, 0.219697, 1.824768, 0 
AG, 0.168033, 1.794048, 0 
AG, 0.223881, 1.814528, 0 
AG, 0.267361, 1.950720, 0 
Linear 2 Backward: 3.491, second_gemm: 3.479
Linear 2 Backward: 3.581, second_gemm: 3.565
Linear 2 Backward: 3.737, second_gemm: 3.725
Linear 2 Backward: 3.792, second_gemm: 3.778
GA, 0.168033, 1.738752, 0 
GA, 0.219697, 1.855488, 0 
GA, 0.223881, 1.987584, 0 
GA, 0.267361, 2.084864, 0 
perpare first backward gemm: 0.039,  fisrt gemm backward duration: 2.733,  weight grad: 1.543,  other: 0.46
Linear 1 Backward:  4.832
perpare first backward gemm: 0.051,  fisrt gemm backward duration: 2.489,  weight grad: 1.752,  other: 0.468
perpare first backward gemm: 0.035,  fisrt gemm backward duration: 2.565,  weight grad: 1.783,  other: 0.437
Linear 1 Backward:  4.873
Linear 1 Backward:  4.837
perpare first backward gemm: 0.053,  fisrt gemm backward duration: 2.164,  weight grad: 1.935,  other: 0.466
Linear 1 Backward:  4.691
STEP-32: step_time = 23.076863 ms, foward_time = 11.166720, backward_time = 11.806720, perf = 35.73 tflops.
start
start
start
start
block_info 244 41
block_info 264 58
block_info 288 77
block_info 268 60
cuda:3 process time:4.1751861572265625, a: 0.7991790771484375, b: 1.2416839599609375, c: 0.0934600830078125, d: 2.040863037109375
cuda:1 process time:4.408597946166992, a: 0.6465911865234375, b: 1.5485286712646484, c: 0.09083747863769531, d: 2.122640609741211
3 wait time: 1.802
244
cuda:0 process time:4.639387130737305, a: 0.6923675537109375, b: 1.6324520111083984, c: 0.10061264038085938, d: 2.2139549255371094
cuda:2 process time:4.422187805175781, a: 0.8463859558105469, b: 1.341104507446289, c: 0.11587142944335938, d: 2.118825912475586
1 wait time: 1.875
264
0 wait time: 2.283
288
2 wait time: 2.714
268
AG, 0.267361, 1.978368, 0 
perpare first forward gemm: 0.32,  fisrt gemm forward duration: 2.211
AG, 0.219697, 1.818624, 0 
perpare first forward gemm: 0.317,  fisrt gemm forward duration: 2.251
AG, 0.168033, 1.798144, 0 
perpare first forward gemm: 0.305,  fisrt gemm forward duration: 2.507
AG, 0.223881, 1.808384, 0 
perpare first forward gemm: 0.319,  fisrt gemm forward duration: 1.883
GA, 0.168033, 1.955840, 0 
GA, 0.219697, 2.017280, 0 
GA, 0.223881, 2.229248, 0 
GA, 0.267361, 2.288640, 0 
forward:  7.85
forward:  7.521
forward:  8.103
forward:  7.651
AG, 0.168033, 1.803264, 0 
AG, 0.219697, 1.816576, 0 
AG, 0.223881, 1.826816, 0 
AG, 0.267361, 1.974272, 0 
Linear 2 Backward: 3.504, second_gemm: 3.49
Linear 2 Backward: 3.772, second_gemm: 3.758
Linear 2 Backward: 3.6, second_gemm: 3.581
Linear 2 Backward: 3.9, second_gemm: 3.881
GA, 0.168033, 1.695744, 0 
GA, 0.219697, 1.820672, 0 
GA, 0.223881, 1.931264, 0 
GA, 0.267361, 2.053120, 0 
perpare first backward gemm: 0.046,  fisrt gemm backward duration: 2.762,  weight grad: 1.562,  other: 0.504
Linear 1 Backward:  4.925
perpare first backward gemm: 0.04,  fisrt gemm backward duration: 2.582,  weight grad: 1.763,  other: 0.459
Linear 1 Backward:  4.894
perpare first backward gemm: 0.059,  fisrt gemm backward duration: 2.457,  weight grad: 1.776,  other: 0.469
Linear 1 Backward:  4.829
perpare first backward gemm: 0.063,  fisrt gemm backward duration: 2.142,  weight grad: 1.97,  other: 0.433
Linear 1 Backward:  4.673
STEP-33: step_time = 22.769664 ms, foward_time = 10.959872, backward_time = 11.711488, perf = 36.22 tflops.
start
start
start
start
block_info 264 58
block_info 244 41
block_info 268 60
block_info 288 77
cuda:2 process time:3.733396530151367, a: 0.7693767547607422, b: 1.1210441589355469, c: 0.08726119995117188, d: 1.7557144165039062
cuda:3 process time:4.019975662231445, a: 0.7474422454833984, b: 1.5475749969482422, c: 0.09441375732421875, d: 1.630544662475586
cuda:1 process time:3.8399696350097656, a: 0.713348388671875, b: 1.1997222900390625, c: 0.09751319885253906, d: 1.829385757446289
cuda:0 process time:4.055023193359375, a: 0.7016658782958984, b: 1.1730194091796875, c: 0.10275840759277344, d: 2.0775794982910156
1 wait time: 2.016
264
2 wait time: 1.894
268
3 wait time: 2.106
244
0 wait time: 2.285
288
AG, 0.168033, 1.787904, 0 
perpare first forward gemm: 0.283,  fisrt gemm forward duration: 2.143
AG, 0.219697, 1.805312, 0 
perpare first forward gemm: 0.277,  fisrt gemm forward duration: 2.176
AG, 0.223881, 1.799168, 0 
perpare first forward gemm: 0.293,  fisrt gemm forward duration: 2.171
AG, 0.267361, 1.969152, 0 
perpare first forward gemm: 0.288,  fisrt gemm forward duration: 2.024
GA, 0.168033, 1.964032, 0 
GA, 0.219697, 2.028544, 0 
GA, 0.223881, 2.196480, 0 
GA, 0.267361, 2.272256, 0 
forward:  7.684
forward:  7.734
forward:  7.73
forward:  7.397
AG, 0.168033, 1.807360, 0 
AG, 0.219697, 1.819648, 0 
AG, 0.223881, 1.811456, 0 
AG, 0.267361, 1.985536, 0 
Linear 2 Backward: 3.452, second_gemm: 3.439
Linear 2 Backward: 3.503, second_gemm: 3.487
Linear 2 Backward: 3.742, second_gemm: 3.73
Linear 2 Backward: 3.827, second_gemm: 3.811
GA, 0.168033, 1.719296, 0 
GA, 0.219697, 1.830912, 0 
GA, 0.223881, 1.977344, 0 
GA, 0.267361, 2.078720, 0 
perpare first backward gemm: 0.039,  fisrt gemm backward duration: 2.761,  weight grad: 1.538,  other: 0.432
Linear 1 Backward:  4.817
perpare first backward gemm: 0.05,  fisrt gemm backward duration: 2.49,  weight grad: 1.744,  other: 0.429
Linear 1 Backward:  4.775
perpare first backward gemm: 0.035,  fisrt gemm backward duration: 2.578,  weight grad: 1.749,  other: 0.409
Linear 1 Backward:  4.813
perpare first backward gemm: 0.052,  fisrt gemm backward duration: 2.157,  weight grad: 1.96,  other: 0.432
Linear 1 Backward:  4.66
STEP-34: step_time = 22.343681 ms, foward_time = 10.636288, backward_time = 11.606016, perf = 36.91 tflops.
start
start
start
start
block_info 244 41
block_info 264 58
cuda:3 process time:3.7250518798828125, a: 0.7824897766113281, b: 1.3039112091064453, c: 0.09012222290039062, d: 1.5485286712646484
block_info 268 60
block_info 288 77
cuda:1 process time:4.0531158447265625, a: 0.728607177734375, b: 1.3344287872314453, c: 0.09250640869140625, d: 1.897573471069336
3 wait time: 2.028
244
1 wait time: 1.997
264
cuda:2 process time:4.261016845703125, a: 0.7948875427246094, b: 1.2454986572265625, c: 0.11301040649414062, d: 2.1076202392578125
cuda:0 process time:4.539012908935547, a: 0.6301403045654297, b: 1.4846324920654297, c: 0.10824203491210938, d: 2.315998077392578
2 wait time: 2.706
268
0 wait time: 2.497
288
AG, 0.223881, 1.803264, 0 
perpare first forward gemm: 0.283,  fisrt gemm forward duration: 1.99
AG, 0.168033, 1.800192, 0 
perpare first forward gemm: 0.276,  fisrt gemm forward duration: 2.62
AG, 0.219697, 1.809408, 0 
perpare first forward gemm: 0.286,  fisrt gemm forward duration: 2.506
AG, 0.267361, 1.973248, 0 
perpare first forward gemm: 0.292,  fisrt gemm forward duration: 2.029
GA, 0.219697, 2.006016, 0 
GA, 0.168033, 1.946624, 0 
GA, 0.223881, 2.203648, 0 
GA, 0.267361, 2.297856, 0 
forward:  7.553
forward:  8.245
forward:  8.062
forward:  7.454
AG, 0.219697, 1.807360, 0 
AG, 0.223881, 1.818624, 0 
AG, 0.168033, 1.789952, 0 
AG, 0.267361, 2.031616, 0 
Linear 2 Backward: 3.34, second_gemm: 3.329
Linear 2 Backward: 3.588, second_gemm: 3.577
Linear 2 Backward: 3.52, second_gemm: 3.505
Linear 2 Backward: 3.86, second_gemm: 3.847
GA, 0.168033, 1.743872, 0 
GA, 0.219697, 1.807360, 0 
GA, 0.223881, 1.943552, 0 
GA, 0.267361, 2.031616, 0 
perpare first backward gemm: 0.038,  fisrt gemm backward duration: 2.78,  weight grad: 1.554,  other: 0.45
Linear 1 Backward:  4.878
perpare first backward gemm: 0.034,  fisrt gemm backward duration: 2.612,  weight grad: 1.746,  other: 0.431
Linear 1 Backward:  4.873
perpare first backward gemm: 0.052,  fisrt gemm backward duration: 2.515,  weight grad: 1.747,  other: 0.478
Linear 1 Backward:  4.864
perpare first backward gemm: 0.051,  fisrt gemm backward duration: 2.106,  weight grad: 1.952,  other: 0.464
Linear 1 Backward:  4.643
STEP-35: step_time = 22.758400 ms, foward_time = 10.960896, backward_time = 11.678720, perf = 36.23 tflops.
start
start
start
start
block_info 288 77
block_info 244 41
cuda:0 process time:3.5572052001953125, a: 0.5774497985839844, b: 1.3909339904785156, c: 0.06866455078125, d: 1.5201568603515625
cuda:3 process time:3.754138946533203, a: 0.7457733154296875, b: 1.3730525970458984, c: 0.0896453857421875, d: 1.5456676483154297
block_info 264 58
block_info 268 60
0 wait time: 1.348
288
3 wait time: 2.023
244
cuda:1 process time:4.607200622558594, a: 0.7786750793457031, b: 1.5211105346679688, c: 0.10561943054199219, d: 2.2017955780029297
cuda:2 process time:4.372835159301758, a: 0.8287429809570312, b: 1.0454654693603516, c: 0.12040138244628906, d: 2.378225326538086
1 wait time: 1.948
264
2 wait time: 2.213
268
AG, 0.219697, 1.827840, 0 
perpare first forward gemm: 0.316,  fisrt gemm forward duration: 2.108
AG, 0.168033, 1.800192, 0 
perpare first forward gemm: 0.269,  fisrt gemm forward duration: 2.727
AG, 0.223881, 1.799168, 0 
perpare first forward gemm: 0.336,  fisrt gemm forward duration: 1.874
AG, 0.267361, 1.992704, 0 
perpare first forward gemm: 0.331,  fisrt gemm forward duration: 3.02
GA, 0.168033, 1.850368, 0 
GA, 0.219697, 2.029568, 0 
GA, 0.223881, 2.062336, 0 
GA, 0.267361, 2.280448, 0 
forward:  7.665
forward:  8.424
forward:  7.844
forward:  8.582
AG, 0.219697, 1.806336, 0 
AG, 0.223881, 1.824768, 0 
AG, 0.168033, 1.804288, 0 
AG, 0.267361, 1.951744, 0 
Linear 2 Backward: 3.321, second_gemm: 3.307
Linear 2 Backward: 3.859, second_gemm: 3.846
Linear 2 Backward: 3.611, second_gemm: 3.593
Linear 2 Backward: 3.904, second_gemm: 3.886
GA, 0.168033, 1.674240, 0 
GA, 0.219697, 1.818624, 0 
GA, 0.223881, 1.953792, 0 
GA, 0.267361, 2.035712, 0 
perpare first backward gemm: 0.044,  fisrt gemm backward duration: 2.697,  weight grad: 1.561,  other: 0.422
Linear 1 Backward:  4.775
perpare first backward gemm: 0.038,  fisrt gemm backward duration: 2.553,  weight grad: 1.778,  other: 0.41
perpare first backward gemm: 0.059,  fisrt gemm backward duration: 2.405,  weight grad: 1.759,  other: 0.431
Linear 1 Backward:  4.827
Linear 1 Backward:  4.721
perpare first backward gemm: 0.059,  fisrt gemm backward duration: 2.12,  weight grad: 1.946,  other: 0.431
Linear 1 Backward:  4.619
STEP-36: step_time = 22.688767 ms, foward_time = 10.978304, backward_time = 11.609088, perf = 36.35 tflops.
start
start
start
start
block_info 268 60
block_info 244 41
block_info 288 77
block_info 264 58
cuda:3 process time:3.9381980895996094, a: 0.7560253143310547, b: 1.4495849609375, c: 0.09322166442871094, d: 1.6393661499023438
cuda:2 process time:3.797292709350586, a: 0.7555484771728516, b: 1.0986328125, c: 0.10704994201660156, d: 1.8360614776611328
cuda:0 process time:4.220008850097656, a: 0.7262229919433594, b: 1.3096332550048828, c: 0.10609626770019531, d: 2.0780563354492188
cuda:1 process time:4.379510879516602, a: 0.7143020629882812, b: 1.461029052734375, c: 0.10657310485839844, d: 2.097606658935547
3 wait time: 2.122
244
2 wait time: 2.06
268
1 wait time: 2.083
264
0 wait time: 2.194
288
AG, 0.168033, 1.797120, 0 
perpare first forward gemm: 0.278,  fisrt gemm forward duration: 2.135
AG, 0.219697, 1.804288, 0 
perpare first forward gemm: 0.287,  fisrt gemm forward duration: 1.974
AG, 0.223881, 1.795072, 0 
perpare first forward gemm: 0.288,  fisrt gemm forward duration: 2.089
AG, 0.267361, 1.958912, 0 
perpare first forward gemm: 0.3,  fisrt gemm forward duration: 2.021
GA, 0.168033, 1.960960, 0 
GA, 0.219697, 1.996800, 0 
GA, 0.223881, 2.174976, 0 
GA, 0.267361, 2.289664, 0 
forward:  7.545
forward:  7.676
forward:  7.759
forward:  7.471
AG, 0.168033, 1.800192, 0 
AG, 0.219697, 1.807360, 0 
AG, 0.223881, 1.816576, 0 
AG, 0.267361, 1.976320, 0 
Linear 2 Backward: 3.51, second_gemm: 3.499
Linear 2 Backward: 3.725, second_gemm: 3.714
Linear 2 Backward: 3.621, second_gemm: 3.606
Linear 2 Backward: 3.778, second_gemm: 3.765
GA, 0.168033, 1.767424, 0 
GA, 0.219697, 1.831936, 0 
GA, 0.223881, 1.942528, 0 
GA, 0.267361, 2.076672, 0 
perpare first backward gemm: 0.038,  fisrt gemm backward duration: 2.7,  weight grad: 1.549,  other: 0.451
Linear 1 Backward:  4.791
perpare first backward gemm: 0.035,  fisrt gemm backward duration: 2.56,  weight grad: 1.756,  other: 0.431
Linear 1 Backward:  4.833
perpare first backward gemm: 0.049,  fisrt gemm backward duration: 2.45,  weight grad: 1.76,  other: 0.461
Linear 1 Backward:  4.793
perpare first backward gemm: 0.049,  fisrt gemm backward duration: 2.151,  weight grad: 1.946,  other: 0.474
Linear 1 Backward:  4.688
STEP-37: step_time = 22.643711 ms, foward_time = 10.787840, backward_time = 11.724800, perf = 36.42 tflops.
start
start
start
start
block_info 288 77
block_info 268 60
block_info 264 58
block_info 244 41
cuda:1 process time:4.150867462158203, a: 0.7867813110351562, b: 1.201629638671875, c: 0.10824203491210938, d: 2.0542144775390625
cuda:0 process time:4.181146621704102, a: 0.7250308990478516, b: 1.2874603271484375, c: 0.10085105895996094, d: 2.0678043365478516
cuda:2 process time:4.325389862060547, a: 0.8172988891601562, b: 1.0986328125, c: 0.11372566223144531, d: 2.2957324981689453
cuda:3 process time:4.45556640625, a: 0.7693767547607422, b: 1.5423297882080078, c: 0.11730194091796875, d: 2.0265579223632812
1 wait time: 1.875
264
0 wait time: 2.307
288
2 wait time: 2.403
268
3 wait time: 2.554
244
AG, 0.219697, 1.812480, 0 
perpare first forward gemm: 0.309,  fisrt gemm forward duration: 2.243
AG, 0.223881, 1.799168, 0 
perpare first forward gemm: 0.308,  fisrt gemm forward duration: 1.867
AG, 0.168033, 1.800192, 0 
perpare first forward gemm: 0.27,  fisrt gemm forward duration: 1.965
AG, 0.267361, 1.960960, 0 
perpare first forward gemm: 0.279,  fisrt gemm forward duration: 2.3
GA, 0.168033, 1.952768, 0 
GA, 0.219697, 2.043904, 0 
GA, 0.223881, 2.225152, 0 
GA, 0.267361, 2.305024, 0 
forward:  7.801
forward:  7.438
forward:  7.455
forward:  7.614
AG, 0.168033, 1.804288, 0 
AG, 0.219697, 1.824768, 0 
AG, 0.223881, 1.813504, 0 
AG, 0.267361, 1.991680, 0 
Linear 2 Backward: 3.496, second_gemm: 3.481
Linear 2 Backward: 3.572, second_gemm: 3.553
Linear 2 Backward: 3.784, second_gemm: 3.77
Linear 2 Backward: 3.899, second_gemm: 3.88
GA, 0.168033, 1.727488, 0 
GA, 0.219697, 1.781760, 0 
GA, 0.223881, 1.958912, 0 
GA, 0.267361, 2.041856, 0 
perpare first backward gemm: 0.045,  fisrt gemm backward duration: 2.767,  weight grad: 1.559,  other: 0.493
Linear 1 Backward:  4.934
perpare first backward gemm: 0.041,  fisrt gemm backward duration: 2.567,  weight grad: 1.764,  other: 0.453
Linear 1 Backward:  4.888
perpare first backward gemm: 0.059,  fisrt gemm backward duration: 2.484,  weight grad: 1.781,  other: 0.545
Linear 1 Backward:  4.964
perpare first backward gemm: 0.059,  fisrt gemm backward duration: 2.151,  weight grad: 1.956,  other: 0.496
Linear 1 Backward:  4.749
STEP-38: step_time = 22.628353 ms, foward_time = 10.793984, backward_time = 11.731968, perf = 36.44 tflops.
start
start
start
start
block_info 244 41
block_info 264 58
cuda:3 process time:3.2651424407958984, a: 0.6892681121826172, b: 0.9710788726806641, c: 0.07152557373046875, d: 1.5332698822021484
cuda:1 process time:3.5953521728515625, a: 0.6735324859619141, b: 1.3709068298339844, c: 0.08654594421386719, d: 1.4643669128417969
1 wait time: 1.36
264
block_info 268 60
3 wait time: 1.286
244
block_info 288 77
cuda:2 process time:4.31060791015625, a: 0.7925033569335938, b: 1.1420249938964844, c: 0.1404285430908203, d: 2.2356510162353516
cuda:0 process time:4.411220550537109, a: 0.6666183471679688, b: 1.300811767578125, c: 0.11134147644042969, d: 2.332448959350586
2 wait time: 2.527
0 wait time: 2.027
288
268
AG, 0.168033, 1.806336, 0 
perpare first forward gemm: 0.304,  fisrt gemm forward duration: 2.942
AG, 0.267361, 1.961984, 0 
perpare first forward gemm: 0.328,  fisrt gemm forward duration: 2.067
AG, 0.219697, 1.801216, 0 
perpare first forward gemm: 0.279,  fisrt gemm forward duration: 3.119
AG, 0.223881, 1.818624, 0 
perpare first forward gemm: 0.311,  fisrt gemm forward duration: 1.889
GA, 0.219697, 1.879040, 0 
GA, 0.168033, 1.971200, 0 
GA, 0.223881, 2.159616, 0 
GA, 0.267361, 2.130944, 0 
forward:  8.536
forward:  8.639
forward:  7.499
forward:  7.521
AG, 0.223881, 1.815552, 0 
AG, 0.168033, 1.789952, 0 
AG, 0.219697, 1.810432, 0 
AG, 0.267361, 1.967104, 0 
Linear 2 Backward: 3.435, second_gemm: 3.422
Linear 2 Backward: 3.691, second_gemm: 3.678
Linear 2 Backward: 3.512, second_gemm: 3.496
Linear 2 Backward: 3.83, second_gemm: 3.815
GA, 0.168033, 1.707008, 0 
GA, 0.219697, 1.814528, 0 
GA, 0.223881, 1.986560, 0 
GA, 0.267361, 2.064384, 0 
perpare first backward gemm: 0.041,  fisrt gemm backward duration: 2.76,  weight grad: 1.546,  other: 0.423
Linear 1 Backward:  4.818
perpare first backward gemm: 0.037,  fisrt gemm backward duration: 2.595,  weight grad: 1.753,  other: 0.411
Linear 1 Backward:  4.84
perpare first backward gemm: 0.054,  fisrt gemm backward duration: 2.486,  weight grad: 1.778,  other: 0.429
Linear 1 Backward:  4.81
perpare first backward gemm: 0.058,  fisrt gemm backward duration: 2.144,  weight grad: 1.944,  other: 0.43
Linear 1 Backward:  4.636
STEP-39: step_time = 22.181888 ms, foward_time = 10.596352, backward_time = 11.486208, perf = 37.18 tflops.
start
start
start
start
block_info 268 60
block_info 244 41
block_info 288 77
block_info 264 58
cuda:2 process time:3.7164688110351562, a: 0.7381439208984375, b: 1.2640953063964844, c: 0.09012222290039062, d: 1.6241073608398438
cuda:3 process time:3.8170814514160156, a: 0.7643699645996094, b: 1.3356208801269531, c: 0.095367431640625, d: 1.6217231750488281
cuda:0 process time:4.167079925537109, a: 0.7452964782714844, b: 1.3103485107421875, c: 0.09560585021972656, d: 2.015829086303711
2 wait time: 2.208
268
3 wait time: 2.119
244
cuda:1 process time:4.380464553833008, a: 0.7374286651611328, b: 1.6846656799316406, c: 0.10323524475097656, d: 1.8551349639892578
0 wait time: 2.138
1 wait time: 2.259
288
264
AG, 0.168033, 1.799168, 0 
perpare first forward gemm: 0.277,  fisrt gemm forward duration: 2.196
AG, 0.223881, 1.799168, 0 
perpare first forward gemm: 0.289,  fisrt gemm forward duration: 2.296
AG, 0.267361, 1.967104, 0 
perpare first forward gemm: 0.303,  fisrt gemm forward duration: 2.061
AG, 0.219697, 1.804288, 0 
perpare first forward gemm: 0.288,  fisrt gemm forward duration: 1.865
GA, 0.168033, 1.953792, 0 
GA, 0.219697, 2.035712, 0 
GA, 0.223881, 2.223104, 0 
GA, 0.267361, 2.264064, 0 
forward:  7.862
forward:  7.75
forward:  7.467
forward:  7.496
AG, 0.219697, 1.811456, 0 
AG, 0.223881, 1.824768, 0 
AG, 0.168033, 1.793024, 0 
AG, 0.267361, 1.956864, 0 
Linear 2 Backward: 3.547, second_gemm: 3.533
Linear 2 Backward: 3.809, second_gemm: 3.798
Linear 2 Backward: 3.774, second_gemm: 3.761
Linear 2 Backward: 3.758, second_gemm: 3.745
GA, 0.168033, 1.729536, 0 
GA, 0.219697, 1.848320, 0 
GA, 0.223881, 1.954816, 0 
GA, 0.267361, 2.085888, 0 
perpare first backward gemm: 0.037,  fisrt gemm backward duration: 2.709,  weight grad: 1.541,  other: 0.444
Linear 1 Backward:  4.794
perpare first backward gemm: 0.034,  fisrt gemm backward duration: 2.566,  weight grad: 1.76,  other: 0.432
perpare first backward gemm: 0.048,  fisrt gemm backward duration: 2.441,  weight grad: 1.752,  other: 0.462
Linear 1 Backward:  4.841
Linear 1 Backward:  4.774
perpare first backward gemm: 0.049,  fisrt gemm backward duration: 2.16,  weight grad: 1.935,  other: 0.462
Linear 1 Backward:  4.675
STEP-40: step_time = 22.696960 ms, foward_time = 10.734592, backward_time = 11.822080, perf = 36.33 tflops.
start
start
start
start
block_info 244 41
block_info 268 60
block_info 264 58
block_info 288 77
cuda:3 process time:3.827810287475586, a: 0.7083415985107422, b: 1.0683536529541016, c: 0.09560585021972656, d: 1.9555091857910156
cuda:2 process time:3.936767578125, a: 0.7908344268798828, b: 1.0094642639160156, c: 0.09632110595703125, d: 2.0401477813720703
cuda:0 process time:4.262208938598633, a: 0.6670951843261719, b: 1.4028549194335938, c: 0.09894371032714844, d: 2.0933151245117188
cuda:1 process time:4.216909408569336, a: 0.7026195526123047, b: 1.5516281127929688, c: 0.10204315185546875, d: 1.8606185913085938
3 wait time: 1.673
244
2 wait time: 1.823
268
0 wait time: 1.927
288
1 wait time: 2.401
264
AG, 0.168033, 1.800192, 0 
perpare first forward gemm: 0.305,  fisrt gemm forward duration: 2.179
AG, 0.223881, 1.804288, 0 
perpare first forward gemm: 0.31,  fisrt gemm forward duration: 2.04
AG, 0.219697, 1.800192, 0 
perpare first forward gemm: 0.282,  fisrt gemm forward duration: 1.893
AG, 0.267361, 1.956864, 0 
perpare first forward gemm: 0.321,  fisrt gemm forward duration: 2.021
GA, 0.219697, 1.965056, 0 
GA, 0.168033, 1.973248, 0 
GA, 0.223881, 2.211840, 0 
GA, 0.267361, 2.267136, 0 
forward:  7.567
forward:  7.71
forward:  7.384
forward:  7.412
AG, 0.219697, 1.808384, 0 
AG, 0.223881, 1.823744, 0 
AG, 0.168033, 1.799168, 0 
AG, 0.267361, 1.999872, 0 
Linear 2 Backward: 3.354, second_gemm: 3.34
Linear 2 Backward: 3.711, second_gemm: 3.697
Linear 2 Backward: 3.577, second_gemm: 3.559
Linear 2 Backward: 3.908, second_gemm: 3.89
GA, 0.168033, 1.687552, 0 
GA, 0.219697, 1.825792, 0 
GA, 0.223881, 1.907712, 0 
GA, 0.267361, 2.039808, 0 
perpare first backward gemm: 0.037,  fisrt gemm backward duration: 2.849,  weight grad: 1.539,  other: 0.445
Linear 1 Backward:  4.931
perpare first backward gemm: 0.041,  fisrt gemm backward duration: 2.587,  weight grad: 1.762,  other: 0.452
Linear 1 Backward:  4.905
perpare first backward gemm: 0.059,  fisrt gemm backward duration: 2.473,  weight grad: 1.774,  other: 0.492
Linear 1 Backward:  4.892
perpare first backward gemm: 0.064,  fisrt gemm backward duration: 2.13,  weight grad: 1.957,  other: 0.553
Linear 1 Backward:  4.792
STEP-41: step_time = 22.506497 ms, foward_time = 10.270720, backward_time = 12.134400, perf = 36.64 tflops.
start
start
start
start
block_info 264 58
cuda:1 process time:3.5791397094726562, a: 0.6775856018066406, b: 1.4438629150390625, c: 0.06985664367675781, d: 1.3878345489501953
block_info 268 60
block_info 244 41
1 wait time: 1.519
264
block_info 288 77
cuda:3 process time:4.06336784362793, a: 0.7443428039550781, b: 1.4085769653320312, c: 0.10085105895996094, d: 1.8095970153808594
cuda:2 process time:4.051446914672852, a: 0.7586479187011719, b: 1.4996528625488281, c: 0.10132789611816406, d: 1.6918182373046875
3 wait time: 1.889
244
cuda:0 process time:4.170894622802734, a: 0.7545948028564453, b: 1.1801719665527344, c: 0.09679794311523438, d: 2.1393299102783203
2 wait time: 2.184
268
0 wait time: 1.96
288
AG, 0.168033, 1.787904, 0 
perpare first forward gemm: 0.286,  fisrt gemm forward duration: 2.449
AG, 0.223881, 1.802240, 0 
perpare first forward gemm: 0.278,  fisrt gemm forward duration: 2.409
AG, 0.219697, 1.805312, 0 
perpare first forward gemm: 0.277,  fisrt gemm forward duration: 2.988
AG, 0.267361, 1.961984, 0 
perpare first forward gemm: 0.328,  fisrt gemm forward duration: 2.037
GA, 0.219697, 1.884160, 0 
GA, 0.168033, 1.999872, 0 
GA, 0.223881, 2.231296, 0 
GA, 0.267361, 2.142208, 0 
forward:  7.918
forward:  8.503
forward:  8.007
forward:  7.491
AG, 0.168033, 1.807360, 0 
AG, 0.223881, 1.817600, 0 
AG, 0.219697, 1.816576, 0 
AG, 0.267361, 1.967104, 0 
Linear 2 Backward: 3.57, second_gemm: 3.558
Linear 2 Backward: 3.759, second_gemm: 3.746
Linear 2 Backward: 3.524, second_gemm: 3.507
Linear 2 Backward: 3.81, second_gemm: 3.796
GA, 0.168033, 1.679360, 0 
GA, 0.219697, 1.841152, 0 
GA, 0.223881, 1.913856, 0 
GA, 0.267361, 2.091008, 0 
perpare first backward gemm: 0.034,  fisrt gemm backward duration: 2.812,  weight grad: 1.532,  other: 0.424
Linear 1 Backward:  4.847
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 2.575,  weight grad: 1.749,  other: 0.411
Linear 1 Backward:  4.816
perpare first backward gemm: 0.053,  fisrt gemm backward duration: 2.488,  weight grad: 1.753,  other: 0.442
Linear 1 Backward:  4.799
perpare first backward gemm: 0.054,  fisrt gemm backward duration: 2.188,  weight grad: 1.934,  other: 0.433
Linear 1 Backward:  4.668
STEP-42: step_time = 22.279168 ms, foward_time = 10.512384, backward_time = 11.664384, perf = 37.01 tflops.
start
start
start
start
block_info 268 60
block_info 288 77
cuda:2 process time:3.626108169555664, a: 0.7297992706298828, b: 1.2116432189941406, c: 0.09107589721679688, d: 1.5935897827148438
cuda:0 process time:3.9954185485839844, a: 0.7541179656982422, b: 1.3685226440429688, c: 0.08797645568847656, d: 1.7848014831542969
block_info 244 41
block_info 264 58
0 wait time: 1.83
288
2 wait time: 2.133
268
cuda:3 process time:4.600048065185547, a: 0.6387233734130859, b: 1.8453598022460938, c: 0.11467933654785156, d: 2.0012855529785156
cuda:1 process time:4.397392272949219, a: 0.7679462432861328, b: 1.344442367553711, c: 0.12159347534179688, d: 2.163410186767578
3 wait time: 2.54
244
1 wait time: 2.654
264
AG, 0.168033, 1.806336, 0 
perpare first forward gemm: 0.275,  fisrt gemm forward duration: 2.008
AG, 0.267361, 1.964032, 0 
AG, 0.223881, 1.807360, 0 
perpare first forward gemm: 0.289,  fisrt gemm forward duration: 2.565
AG, 0.219697, 1.808384, 0 
perpare first forward gemm: 0.285,  fisrt gemm forward duration: 1.87
perpare first forward gemm: 0.292,  fisrt gemm forward duration: 2.859
GA, 0.223881, 2.128896, 0 
GA, 0.168033, 1.970176, 0 
GA, 0.219697, 2.025472, 0 
GA, 0.267361, 2.281472, 0 
forward:  7.409
forward:  8.099
forward:  7.532
forward:  8.233
AG, 0.168033, 1.790976, 0 
AG, 0.219697, 1.819648, 0 
AG, 0.223881, 1.810432, 0 
AG, 0.267361, 1.961984, 0 
Linear 2 Backward: 3.342, second_gemm: 3.332
Linear 2 Backward: 3.483, second_gemm: 3.469
Linear 2 Backward: 3.572, second_gemm: 3.561
Linear 2 Backward: 3.777, second_gemm: 3.763
GA, 0.168033, 1.684480, 0 
GA, 0.219697, 1.842176, 0 
GA, 0.223881, 1.933312, 0 
GA, 0.267361, 2.077696, 0 
perpare first backward gemm: 0.033,  fisrt gemm backward duration: 2.787,  weight grad: 1.533,  other: 0.431
Linear 1 Backward:  4.836
perpare first backward gemm: 0.034,  fisrt gemm backward duration: 2.552,  weight grad: 1.751,  other: 0.43
perpare first backward gemm: 0.048,  fisrt gemm backward duration: 2.46,  weight grad: 1.746,  other: 0.46
Linear 1 Backward:  4.817
Linear 1 Backward:  4.786
perpare first backward gemm: 0.05,  fisrt gemm backward duration: 2.15,  weight grad: 1.929,  other: 0.46
Linear 1 Backward:  4.656
STEP-43: step_time = 22.924289 ms, foward_time = 11.019264, backward_time = 11.804672, perf = 35.97 tflops.
start
start
start
block_info 244 41
block_info 268 60
cuda:3 process time:3.5049915313720703, a: 0.4947185516357422, b: 1.501321792602539, c: 0.06222724914550781, d: 1.4467239379882812
block_info 288 77
start
block_info 264 58
cuda:2 process time:3.8628578186035156, a: 0.8115768432617188, b: 0.9860992431640625, c: 0.08845329284667969, d: 1.9767284393310547
3 wait time: 0.201
244
cuda:0 process time:4.124641418457031, a: 0.8387565612792969, b: 1.0776519775390625, c: 0.09679794311523438, d: 2.1114349365234375
2 wait time: 1.784
268
0 wait time: 1.819
288
cuda:1 process time:4.602193832397461, a: 0.8311271667480469, b: 1.3206005096435547, c: 0.11229515075683594, d: 2.3381710052490234
1 wait time: 2.441
264
AG, 0.267361, 1.966080, 0 
perpare first forward gemm: 0.329,  fisrt gemm forward duration: 2.544
AG, 0.223881, 1.813504, 0 
perpare first forward gemm: 0.316,  fisrt gemm forward duration: 2.448
AG, 0.168033, 1.815552, 0 
perpare first forward gemm: 0.311,  fisrt gemm forward duration: 2.833
AG, 0.219697, 1.819648, 0 
perpare first forward gemm: 0.317,  fisrt gemm forward duration: 1.895
GA, 0.168033, 1.942528, 0 
GA, 0.219697, 2.045952, 0 
GA, 0.223881, 2.169856, 0 
GA, 0.267361, 2.272256, 0 
forward:  8.178
forward:  7.627
forward:  8.13
forward:  8.561
AG, 0.267361, 1.969152, 0 
AG, 0.219697, 1.811456, 0 
AG, 0.223881, 1.814528, 0 
AG, 0.168033, 1.808384, 0 
Linear 2 Backward: 3.589, second_gemm: 3.575
Linear 2 Backward: 3.674, second_gemm: 3.659
Linear 2 Backward: 3.576, second_gemm: 3.558
Linear 2 Backward: 3.865, second_gemm: 3.847
GA, 0.168033, 1.697792, 0 
GA, 0.219697, 1.824768, 0 
GA, 0.223881, 1.887232, 0 
GA, 0.267361, 2.064384, 0 
perpare first backward gemm: 0.039,  fisrt gemm backward duration: 2.76,  weight grad: 1.538,  other: 0.411
Linear 1 Backward:  4.809
perpare first backward gemm: 0.041,  fisrt gemm backward duration: 2.571,  weight grad: 1.769,  other: 0.41
Linear 1 Backward:  4.84
perpare first backward gemm: 0.056,  fisrt gemm backward duration: 2.447,  weight grad: 1.761,  other: 0.432
Linear 1 Backward:  4.762
perpare first backward gemm: 0.056,  fisrt gemm backward duration: 2.149,  weight grad: 1.945,  other: 0.428
Linear 1 Backward:  4.64
STEP-44: step_time = 22.808577 ms, foward_time = 10.989568, backward_time = 11.717632, perf = 36.15 tflops.
start
start
start
start
block_info 268 60
block_info 288 77
block_info 244 41
block_info 264 58
cuda:3 process time:3.9703845977783203, a: 0.7915496826171875, b: 1.2881755828857422, c: 0.09179115295410156, d: 1.798868179321289
cuda:2 process time:4.353761672973633, a: 0.7460117340087891, b: 1.766204833984375, c: 0.10442733764648438, d: 1.7371177673339844
cuda:0 process time:4.206180572509766, a: 0.7777214050292969, b: 1.4109611511230469, c: 0.09298324584960938, d: 1.9245147705078125
cuda:1 process time:4.482507705688477, a: 0.75531005859375, b: 1.4150142669677734, c: 0.11181831359863281, d: 2.2003650665283203
3 wait time: 1.921
244
2 wait time: 2.277
268
0 wait time: 1.968
288
1 wait time: 2.325
264
AG, 0.223881, 1.799168, 0 
perpare first forward gemm: 0.292,  fisrt gemm forward duration: 2.268
AG, 0.267361, 1.960960, 0 
perpare first forward gemm: 0.331,  fisrt gemm forward duration: 2.249
AG, 0.168033, 1.800192, 0 
perpare first forward gemm: 0.305,  fisrt gemm forward duration: 2.228
AG, 0.219697, 1.807360, 0 
perpare first forward gemm: 0.288,  fisrt gemm forward duration: 1.87
GA, 0.219697, 1.807360, 0 
GA, 0.168033, 1.990656, 0 
GA, 0.223881, 2.110464, 0 
GA, 0.267361, 2.042880, 0 
forward:  7.437
forward:  7.847
forward:  7.909
forward:  7.927
AG, 0.168033, 1.792000, 0 
AG, 0.223881, 1.826816, 0 
AG, 0.219697, 1.824768, 0 
AG, 0.267361, 1.966080, 0 
Linear 2 Backward: 4.042, second_gemm: 4.031
Linear 2 Backward: 4.298, second_gemm: 4.29
Linear 2 Backward: 4.212, second_gemm: 4.197
Linear 2 Backward: 3.799, second_gemm: 3.779
GA, 0.168033, 1.682432, 0 
GA, 0.219697, 1.805312, 0 
GA, 0.223881, 1.862656, 0 
GA, 0.267361, 2.035712, 0 
perpare first backward gemm: 0.032,  fisrt gemm backward duration: 2.76,  weight grad: 1.527,  other: 0.43
Linear 1 Backward:  4.8
perpare first backward gemm: 0.031,  fisrt gemm backward duration: 2.589,  weight grad: 1.74,  other: 0.422
Linear 1 Backward:  4.82
perpare first backward gemm: 0.051,  fisrt gemm backward duration: 2.42,  weight grad: 1.754,  other: 0.488
Linear 1 Backward:  4.79
perpare first backward gemm: 0.055,  fisrt gemm backward duration: 2.113,  weight grad: 1.935,  other: 0.484
Linear 1 Backward:  4.666
STEP-45: step_time = 23.447552 ms, foward_time = 11.368448, backward_time = 11.934720, perf = 35.17 tflops.
start
start
start
start
block_info 268 60
block_info 244 41
cuda:3 process time:5.051374435424805, a: 0.7231235504150391, b: 2.6254653930664062, c: 0.09322166442871094, d: 1.6095638275146484
cuda:2 process time:5.046844482421875, a: 0.7836818695068359, b: 2.489328384399414, c: 0.09608268737792969, d: 1.6777515411376953
block_info 288 77
3 wait time: 2.1
244
2 wait time: 2.221
268
block_info 264 58
cuda:0 process time:4.778623580932617, a: 0.9002685546875, b: 1.4307498931884766, c: 0.11730194091796875, d: 2.330303192138672
cuda:1 process time:6.119489669799805, a: 0.7429122924804688, b: 2.6237964630126953, c: 0.16307830810546875, d: 2.589702606201172
0 wait time: 2.919
288
1 wait time: 3.185
264
AG, 0.168033, 1.795072, 0 
perpare first forward gemm: 0.254,  fisrt gemm forward duration: 3.167
AG, 0.223881, 1.801216, 0 
perpare first forward gemm: 0.29,  fisrt gemm forward duration: 2.953
AG, 0.267361, 1.950720, 0 
perpare first forward gemm: 0.33,  fisrt gemm forward duration: 2.199
AG, 0.219697, 1.806336, 0 
perpare first forward gemm: 0.285,  fisrt gemm forward duration: 1.868
GA, 0.168033, 1.883136, 0 
GA, 0.219697, 1.928192, 0 
GA, 0.223881, 2.138112, 0 
GA, 0.267361, 2.174976, 0 
forward:  8.683
forward:  7.733
forward:  8.541
forward:  7.447
AG, 0.267361, 1.955840, 0 
AG, 0.168033, 1.799168, 0 
AG, 0.223881, 1.802240, 0 
AG, 0.219697, 1.807360, 0 
Linear 2 Backward: 3.45, second_gemm: 3.438
Linear 2 Backward: 3.463, second_gemm: 3.455
Linear 2 Backward: 3.397, second_gemm: 3.389
Linear 2 Backward: 3.963, second_gemm: 3.955
GA, 0.168033, 1.946624, 0 
GA, 0.223881, 2.136064, 0 
GA, 0.219697, 2.019328, 0 
GA, 0.267361, 2.252800, 0 
perpare first backward gemm: 0.026,  fisrt gemm backward duration: 2.653,  weight grad: 1.703,  other: 0.412
Linear 1 Backward:  4.83
perpare first backward gemm: 0.034,  fisrt gemm backward duration: 2.682,  weight grad: 1.531,  other: 0.452
Linear 1 Backward:  4.756
perpare first backward gemm: 0.034,  fisrt gemm backward duration: 2.514,  weight grad: 1.75,  other: 0.433
Linear 1 Backward:  4.775
perpare first backward gemm: 0.029,  fisrt gemm backward duration: 2.314,  weight grad: 1.884,  other: 0.408
Linear 1 Backward:  4.671
STEP-46: step_time = 23.171488 ms, foward_time = 12.015008, backward_time = 11.052032, perf = 35.59 tflops.
start
start
start
start
block_info 244 41
block_info 268 60
block_info 288 77
block_info 264 58
cuda:2 process time:3.774404525756836, a: 0.75531005859375, b: 1.0781288146972656, c: 0.09202957153320312, d: 1.8489360809326172
cuda:3 process time:4.230737686157227, a: 0.6768703460693359, b: 1.7209053039550781, c: 0.09965896606445312, d: 1.7333030700683594
cuda:0 process time:4.312753677368164, a: 0.8792877197265625, b: 1.1928081512451172, c: 0.09965896606445312, d: 2.1409988403320312
cuda:1 process time:4.295587539672852, a: 0.8008480072021484, b: 1.2311935424804688, c: 0.10371208190917969, d: 2.1598339080810547
2 wait time: 1.764
268
3 wait time: 2.262
244
1 wait time: 2.177
264
0 wait time: 2.289
288
AG, 0.168033, 1.810432, 0 
perpare first forward gemm: 0.253,  fisrt gemm forward duration: 2.295
AG, 0.223881, 1.792000, 0 
perpare first forward gemm: 0.292,  fisrt gemm forward duration: 2.281
AG, 0.219697, 1.819648, 0 
perpare first forward gemm: 0.31,  fisrt gemm forward duration: 1.924
AG, 0.267361, 1.974272, 0 
perpare first forward gemm: 0.324,  fisrt gemm forward duration: 2.038
GA, 0.168033, 1.902592, 0 
GA, 0.219697, 2.040832, 0 
GA, 0.223881, 2.102272, 0 
GA, 0.267361, 2.280448, 0 
forward:  7.734
forward:  7.498
forward:  7.453
forward:  7.836
AG, 0.219697, 1.804288, 0 
AG, 0.168033, 1.801216, 0 
AG, 0.223881, 1.805312, 0 
AG, 0.267361, 1.944576, 0 
Linear 2 Backward: 3.318, second_gemm: 3.304
Linear 2 Backward: 3.584, second_gemm: 3.576
Linear 2 Backward: 3.461, second_gemm: 3.452
Linear 2 Backward: 3.737, second_gemm: 3.722
GA, 0.219697, 1.850368, 0 
GA, 0.168033, 1.987584, 0 
GA, 0.223881, 2.166784, 0 
GA, 0.267361, 2.107392, 0 
perpare first backward gemm: 0.037,  fisrt gemm backward duration: 2.706,  weight grad: 1.538,  other: 0.445
Linear 1 Backward:  4.787
perpare first backward gemm: 0.027,  fisrt gemm backward duration: 2.68,  weight grad: 1.697,  other: 0.411
Linear 1 Backward:  4.85
perpare first backward gemm: 0.033,  fisrt gemm backward duration: 2.573,  weight grad: 1.744,  other: 0.433
Linear 1 Backward:  4.828
perpare first backward gemm: 0.043,  fisrt gemm backward duration: 2.177,  weight grad: 1.915,  other: 0.452
Linear 1 Backward:  4.652
STEP-47: step_time = 22.517761 ms, foward_time = 10.783744, backward_time = 11.632640, perf = 36.62 tflops.
start
start
start
start
block_info 268 60
cuda:2 process time:3.466367721557617, a: 0.5970001220703125, b: 1.3737678527832031, c: 0.0591278076171875, d: 1.436471939086914
block_info 244 41
2 wait time: 1.068
268
block_info 264 58
cuda:3 process time:4.158973693847656, a: 0.7269382476806641, b: 1.5969276428222656, c: 0.09965896606445312, d: 1.7354488372802734
block_info 288 77
3 wait time: 2.201
244
cuda:1 process time:4.379749298095703, a: 0.8339881896972656, b: 1.1365413665771484, c: 0.11110305786132812, d: 2.298116683959961
cuda:0 process time:4.801750183105469, a: 0.7982254028320312, b: 1.6446113586425781, c: 0.11682510375976562, d: 2.2420883178710938
1 wait time: 2.394
264
0 wait time: 2.743
288
AG, 0.168033, 1.806336, 0 
perpare first forward gemm: 0.253,  fisrt gemm forward duration: 2.645
AG, 0.219697, 1.813504, 0 
perpare first forward gemm: 0.318,  fisrt gemm forward duration: 1.929
AG, 0.223881, 1.802240, 0 
perpare first forward gemm: 0.304,  fisrt gemm forward duration: 3.02
AG, 0.267361, 1.963008, 0 
perpare first forward gemm: 0.291,  fisrt gemm forward duration: 2.021
GA, 0.168033, 1.840128, 0 
GA, 0.223881, 2.042880, 0 
GA, 0.219697, 2.166784, 0 
GA, 0.267361, 2.430976, 0 
forward:  8.249
forward:  7.662
forward:  8.73
forward:  7.549
AG, 0.223881, 1.801216, 0 
AG, 0.168033, 1.792000, 0 
AG, 0.219697, 1.817600, 0 
AG, 0.267361, 1.952768, 0 
Linear 2 Backward: 3.498, second_gemm: 3.485
Linear 2 Backward: 3.708, second_gemm: 3.7
Linear 2 Backward: 3.628, second_gemm: 3.613
Linear 2 Backward: 3.728, second_gemm: 3.714
GA, 0.168033, 1.987584, 0 
GA, 0.223881, 2.152448, 0 
GA, 0.219697, 2.034688, 0 
GA, 0.267361, 2.265088, 0 
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 2.83,  weight grad: 1.541,  other: 0.434
Linear 1 Backward:  4.887
perpare first backward gemm: 0.027,  fisrt gemm backward duration: 2.827,  weight grad: 1.701,  other: 0.408
Linear 1 Backward:  5.0
perpare first backward gemm: 0.046,  fisrt gemm backward duration: 2.557,  weight grad: 1.782,  other: 0.428
Linear 1 Backward:  4.867
perpare first backward gemm: 0.044,  fisrt gemm backward duration: 2.321,  weight grad: 1.879,  other: 0.412
Linear 1 Backward:  4.704
STEP-48: step_time = 22.572736 ms, foward_time = 11.195072, backward_time = 11.274240, perf = 36.53 tflops.
start
start
start
start
block_info 264 58
block_info 244 41
block_info 288 77
block_info 268 60
cuda:1 process time:3.7088394165039062, a: 0.7379055023193359, b: 1.407623291015625, c: 0.08487701416015625, d: 1.478433609008789
cuda:3 process time:3.96728515625, a: 0.7040500640869141, b: 1.3208389282226562, c: 0.08726119995117188, d: 1.8551349639892578
cuda:0 process time:4.209280014038086, a: 0.7443428039550781, b: 1.3475418090820312, c: 0.08845329284667969, d: 2.028942108154297
1 wait time: 1.984
264
3 wait time: 1.466
244
cuda:2 process time:4.543304443359375, a: 0.7922649383544922, b: 1.5680789947509766, c: 0.11420249938964844, d: 2.068758010864258
0 wait time: 1.649
288
2 wait time: 2.654
268
AG, 0.219697, 1.801216, 0 
perpare first forward gemm: 0.287,  fisrt gemm forward duration: 2.423
AG, 0.168033, 1.796096, 0 
perpare first forward gemm: 0.315,  fisrt gemm forward duration: 2.252
AG, 0.223881, 1.797120, 0 
perpare first forward gemm: 0.291,  fisrt gemm forward duration: 1.862
AG, 0.267361, 1.964032, 0 
perpare first forward gemm: 0.334,  fisrt gemm forward duration: 2.321
GA, 0.168033, 1.989632, 0 
GA, 0.219697, 1.956864, 0 
GA, 0.223881, 2.057216, 0 
GA, 0.267361, 2.188288, 0 
forward:  7.439
forward:  7.996
forward:  7.844
forward:  7.938
AG, 0.219697, 1.822720, 0 
AG, 0.267361, 1.971200, 0 
AG, 0.223881, 1.806336, 0 
AG, 0.168033, 1.798144, 0 
Linear 2 Backward: 3.52, second_gemm: 3.508
Linear 2 Backward: 3.696, second_gemm: 3.681
Linear 2 Backward: 3.828, second_gemm: 3.815
Linear 2 Backward: 3.739, second_gemm: 3.724
GA, 0.168033, 1.733632, 0 
GA, 0.223881, 1.963008, 0 
GA, 0.219697, 1.941504, 0 
GA, 0.267361, 2.166784, 0 
perpare first backward gemm: 0.035,  fisrt gemm backward duration: 2.8,  weight grad: 1.531,  other: 0.433
Linear 1 Backward:  4.852
perpare first backward gemm: 0.041,  fisrt gemm backward duration: 2.597,  weight grad: 1.731,  other: 0.423
Linear 1 Backward:  4.84
perpare first backward gemm: 0.041,  fisrt gemm backward duration: 2.525,  weight grad: 1.756,  other: 0.425
Linear 1 Backward:  4.794
perpare first backward gemm: 0.045,  fisrt gemm backward duration: 2.237,  weight grad: 1.957,  other: 0.411
Linear 1 Backward:  4.701
STEP-49: step_time = 22.198272 ms, foward_time = 10.688512, backward_time = 11.365376, perf = 37.15 tflops.
start
start
start
start
block_info 244 41
block_info 268 60
cuda:3 process time:3.365039825439453, a: 0.5316734313964844, b: 1.2738704681396484, c: 0.06628036499023438, d: 1.493215560913086
block_info 264 58
cuda:2 process time:3.851175308227539, a: 0.7624626159667969, b: 1.3968944549560547, c: 0.08940696716308594, d: 1.6024112701416016
3 wait time: 1.049
244
block_info 288 77
2 wait time: 2.139
268
cuda:1 process time:4.4269561767578125, a: 0.7665157318115234, b: 1.2843608856201172, c: 0.13113021850585938, d: 2.2449493408203125
cuda:0 process time:4.575967788696289, a: 0.8678436279296875, b: 1.1491775512695312, c: 0.1163482666015625, d: 2.442598342895508
1 wait time: 2.435
264
0 wait time: 2.382
288
AG, 0.219697, 1.797120, 0 
perpare first forward gemm: 0.284,  fisrt gemm forward duration: 2.096
AG, 0.168033, 1.790976, 0 
perpare first forward gemm: 0.299,  fisrt gemm forward duration: 2.937
AG, 0.223881, 1.822720, 0 
perpare first forward gemm: 0.289,  fisrt gemm forward duration: 2.632
AG, 0.267361, 1.966080, 0 
perpare first forward gemm: 0.317,  fisrt gemm forward duration: 2.031
GA, 0.168033, 1.986560, 0 
GA, 0.219697, 1.968128, 0 
GA, 0.223881, 2.214912, 0 
GA, 0.267361, 2.233344, 0 
forward:  7.618
forward:  8.135
forward:  7.48
forward:  8.542
AG, 0.223881, 1.806336, 0 
AG, 0.219697, 1.815552, 0 
AG, 0.168033, 1.803264, 0 
AG, 0.267361, 1.960960, 0 
Linear 2 Backward: 3.387, second_gemm: 3.374
Linear 2 Backward: 3.821, second_gemm: 3.806
Linear 2 Backward: 3.659, second_gemm: 3.647
Linear 2 Backward: 3.736, second_gemm: 3.722
GA, 0.168033, 1.743872, 0 
GA, 0.219697, 1.937408, 0 
GA, 0.223881, 2.011136, 0 
GA, 0.267361, 2.150400, 0 
perpare first backward gemm: 0.037,  fisrt gemm backward duration: 2.746,  weight grad: 1.512,  other: 0.406
Linear 1 Backward:  4.748
perpare first backward gemm: 0.041,  fisrt gemm backward duration: 2.557,  weight grad: 1.733,  other: 0.455
perpare first backward gemm: 0.039,  fisrt gemm backward duration: 2.531,  weight grad: 1.758,  other: 0.452
Linear 1 Backward:  4.85
Linear 1 Backward:  4.835
perpare first backward gemm: 0.043,  fisrt gemm backward duration: 2.219,  weight grad: 1.912,  other: 0.45
Linear 1 Backward:  4.689
STEP-50: step_time = 22.730751 ms, foward_time = 11.066368, backward_time = 11.521024, perf = 36.28 tflops.
start
start
block_info 288 77
cuda:0 process time:3.4296512603759766, a: 0.5247592926025391, b: 1.4469623565673828, c: 0.06031990051269531, d: 1.3976097106933594
start
block_info 268 60
block_info 244 41
block_info 264 58
cuda:2 process time:4.294157028198242, a: 0.7925033569335938, b: 1.47247314453125, c: 0.09012222290039062, d: 1.9390583038330078
start
0 wait time: 0.01
288
cuda:3 process time:4.534721374511719, a: 0.6966590881347656, b: 1.6484260559082031, c: 0.10347366333007812, d: 2.086162567138672
2 wait time: 1.746
268
3 wait time: 1.311
cuda:1 process time:4.545927047729492, a: 0.8158683776855469, b: 1.0504722595214844, c: 0.16164779663085938, d: 2.5179386138916016
244
1 wait time: 2.458
264
AG, 0.223881, 1.810432, 0 
perpare first forward gemm: 0.317,  fisrt gemm forward duration: 2.581
AG, 0.168033, 1.800192, 0 
perpare first forward gemm: 0.344,  fisrt gemm forward duration: 2.091
AG, 0.219697, 1.804288, 0 
perpare first forward gemm: 0.318,  fisrt gemm forward duration: 1.882
AG, 0.267361, 1.970176, 0 
perpare first forward gemm: 0.368,  fisrt gemm forward duration: 2.969
GA, 0.219697, 1.924096, 0 
GA, 0.168033, 1.993728, 0 
GA, 0.223881, 2.273280, 0 
GA, 0.267361, 2.163712, 0 
forward:  8.305
forward:  7.618
forward:  8.639
forward:  7.959
AG, 0.219697, 1.816576, 0 
AG, 0.223881, 1.814528, 0 
AG, 0.267361, 1.963008, 0 
AG, 0.168033, 1.798144, 0 
Linear 2 Backward: 3.388, second_gemm: 3.374
Linear 2 Backward: 3.761, second_gemm: 3.747
Linear 2 Backward: 3.712, second_gemm: 3.698
Linear 2 Backward: 3.69, second_gemm: 3.677
GA, 0.168033, 1.862656, 0 
GA, 0.223881, 2.023424, 0 
GA, 0.219697, 2.103296, 0 
GA, 0.267361, 2.300928, 0 
perpare first backward gemm: 0.038,  fisrt gemm backward duration: 2.733,  weight grad: 1.565,  other: 0.41
Linear 1 Backward:  4.795
perpare first backward gemm: 0.04,  fisrt gemm backward duration: 2.59,  weight grad: 1.734,  other: 0.41
Linear 1 Backward:  4.82
perpare first backward gemm: 0.046,  fisrt gemm backward duration: 2.477,  weight grad: 1.769,  other: 0.423
Linear 1 Backward:  4.764
perpare first backward gemm: 0.031,  fisrt gemm backward duration: 2.35,  weight grad: 1.89,  other: 0.418
Linear 1 Backward:  4.729
STEP-51: step_time = 20.912127 ms, foward_time = 9.698304, backward_time = 11.069440, perf = 39.43 tflops.
start
start
start
start
block_info 268 60
block_info 244 41
block_info 264 58
cuda:2 process time:3.7925243377685547, a: 0.7574558258056641, b: 1.352548599243164, c: 0.08869171142578125, d: 1.5938282012939453
cuda:3 process time:3.865480422973633, a: 0.6928443908691406, b: 1.1501312255859375, c: 0.09441375732421875, d: 1.928091049194336
block_info 288 77
2 wait time: 2.109
268
3 wait time: 1.734
244
cuda:1 process time:4.163980484008789, a: 0.7903575897216797, b: 1.0557174682617188, c: 0.11181831359863281, d: 2.206087112426758
cuda:0 process time:4.747867584228516, a: 0.7500648498535156, b: 1.4324188232421875, c: 0.11754035949707031, d: 2.447843551635742
1 wait time: 2.327
264
0 wait time: 2.23
288
AG, 0.219697, 1.805312, 0 
perpare first forward gemm: 0.285,  fisrt gemm forward duration: 2.187
AG, 0.223881, 1.796096, 0 
perpare first forward gemm: 0.288,  fisrt gemm forward duration: 2.699
AG, 0.168033, 1.798144, 0 
perpare first forward gemm: 0.28,  fisrt gemm forward duration: 2.602
AG, 0.267361, 1.968128, 0 
perpare first forward gemm: 0.305,  fisrt gemm forward duration: 2.03
GA, 0.168033, 1.979392, 0 
GA, 0.219697, 1.989632, 0 
GA, 0.223881, 2.211840, 0 
GA, 0.267361, 2.239488, 0 
forward:  8.259
forward:  7.74
forward:  7.498
forward:  8.203
AG, 0.219697, 1.812480, 0 
AG, 0.223881, 1.810432, 0 
AG, 0.168033, 1.789952, 0 
AG, 0.267361, 1.965056, 0 
Linear 2 Backward: 3.228, second_gemm: 3.215
Linear 2 Backward: 3.803, second_gemm: 3.791
Linear 2 Backward: 3.729, second_gemm: 3.717
Linear 2 Backward: 3.735, second_gemm: 3.72
GA, 0.168033, 1.903616, 0 
GA, 0.219697, 1.931264, 0 
GA, 0.223881, 2.155520, 0 
GA, 0.267361, 2.136064, 0 
perpare first backward gemm: 0.037,  fisrt gemm backward duration: 2.728,  weight grad: 1.539,  other: 0.445
Linear 1 Backward:  4.81
perpare first backward gemm: 0.035,  fisrt gemm backward duration: 2.618,  weight grad: 1.718,  other: 0.433
Linear 1 Backward:  4.853
perpare first backward gemm: 0.039,  fisrt gemm backward duration: 2.514,  weight grad: 1.764,  other: 0.451
Linear 1 Backward:  4.824
perpare first backward gemm: 0.044,  fisrt gemm backward duration: 2.191,  weight grad: 1.881,  other: 0.411
Linear 1 Backward:  4.574
STEP-52: step_time = 22.379520 ms, foward_time = 10.916864, backward_time = 11.318272, perf = 36.85 tflops.
start
start
block_info 244 41
block_info 288 77
cuda:0 process time:3.5338401794433594, a: 0.6735324859619141, b: 1.5032291412353516, c: 0.062465667724609375, d: 1.2946128845214844
cuda:3 process time:3.5979747772216797, a: 0.6394386291503906, b: 1.4579296112060547, c: 0.080108642578125, d: 1.4204978942871094
block_info 268 60
block_info 264 58
cuda:2 process time:3.9479732513427734, a: 0.8227825164794922, b: 1.1620521545410156, c: 0.08845329284667969, d: 1.874685287475586
start
0 wait time: 0.014
288
start
3 wait time: 0.017
244
2 wait time: 1.811
cuda:1 process time:4.764318466186523, a: 0.7615089416503906, b: 1.5833377838134766, c: 0.11563301086425781, d: 2.3038387298583984
268
1 wait time: 2.394
264
AG, 0.267361, 1.961984, 0 
perpare first forward gemm: 0.385,  fisrt gemm forward duration: 2.568
AG, 0.168033, 1.803264, 0 
perpare first forward gemm: 0.358,  fisrt gemm forward duration: 2.373
AG, 0.223881, 1.818624, 0 
perpare first forward gemm: 0.318,  fisrt gemm forward duration: 2.234
AG, 0.219697, 1.803264, 0 
perpare first forward gemm: 0.301,  fisrt gemm forward duration: 1.872
GA, 0.168033, 1.897472, 0 
GA, 0.219697, 2.019328, 0 
GA, 0.223881, 2.132992, 0 
GA, 0.267361, 2.295808, 0 
forward:  7.497
forward:  7.876
forward:  8.172
forward:  8.241
AG, 0.168033, 1.811456, 0 
AG, 0.219697, 1.815552, 0 
AG, 0.223881, 1.807360, 0 
AG, 0.267361, 1.971200, 0 
Linear 2 Backward: 3.346, second_gemm: 3.333
Linear 2 Backward: 3.526, second_gemm: 3.511
Linear 2 Backward: 3.639, second_gemm: 3.624
Linear 2 Backward: 3.773, second_gemm: 3.759
GA, 0.168033, 1.828864, 0 
GA, 0.219697, 2.001920, 0 
GA, 0.223881, 2.098176, 0 
GA, 0.267361, 2.226176, 0 
perpare first backward gemm: 0.037,  fisrt gemm backward duration: 2.821,  weight grad: 1.539,  other: 0.442
Linear 1 Backward:  4.886
perpare first backward gemm: 0.041,  fisrt gemm backward duration: 2.661,  weight grad: 1.731,  other: 0.468
Linear 1 Backward:  4.948
perpare first backward gemm: 0.047,  fisrt gemm backward duration: 2.554,  weight grad: 1.779,  other: 0.457
Linear 1 Backward:  4.89
perpare first backward gemm: 0.045,  fisrt gemm backward duration: 2.295,  weight grad: 1.915,  other: 0.411
Linear 1 Backward:  4.717
STEP-53: step_time = 20.568063 ms, foward_time = 9.374720, backward_time = 11.049984, perf = 40.09 tflops.
start
start
start
start
block_info 244 41
block_info 288 77
block_info 264 58
block_info 268 60
cuda:0 process time:3.8967132568359375, a: 0.7474422454833984, b: 1.520395278930664, c: 0.11348724365234375, d: 1.5153884887695312
cuda:3 process time:3.9446353912353516, a: 0.9670257568359375, b: 0.8625984191894531, c: 0.12636184692382812, d: 1.9886493682861328
0 wait time: 2.17
288
3 wait time: 2.749
244
cuda:1 process time:4.255533218383789, a: 0.7414817810058594, b: 1.4426708221435547, c: 0.14257431030273438, d: 1.9288063049316406
cuda:2 process time:4.256725311279297, a: 0.7612705230712891, b: 1.3034343719482422, c: 0.11682510375976562, d: 2.0751953125
1 wait time: 2.445
264
2 wait time: 2.652
268
AG, 0.219697, 1.811456, 0 
perpare first forward gemm: 0.289,  fisrt gemm forward duration: 1.934
AG, 0.168033, 1.802240, 0 
perpare first forward gemm: 0.254,  fisrt gemm forward duration: 2.403
AG, 0.223881, 1.810432, 0 
perpare first forward gemm: 0.295,  fisrt gemm forward duration: 1.874
AG, 0.267361, 1.965056, 0 
perpare first forward gemm: 0.291,  fisrt gemm forward duration: 2.715
GA, 0.168033, 1.813504, 0 
GA, 0.219697, 2.091008, 0 
GA, 0.223881, 2.173952, 0 
GA, 0.267361, 2.328576, 0 
forward:  7.472
forward:  7.961
forward:  7.54
forward:  8.153
AG, 0.219697, 1.805312, 0 
AG, 0.223881, 1.818624, 0 
AG, 0.168033, 1.801216, 0 
AG, 0.267361, 2.010112, 0 
Linear 2 Backward: 3.282, second_gemm: 3.269
Linear 2 Backward: 3.709, second_gemm: 3.701
Linear 2 Backward: 3.604, second_gemm: 3.592
Linear 2 Backward: 3.71, second_gemm: 3.699
GA, 0.168033, 1.871872, 0 
GA, 0.219697, 1.889280, 0 
GA, 0.223881, 2.105344, 0 
GA, 0.267361, 2.148352, 0 
perpare first backward gemm: 0.041,  fisrt gemm backward duration: 2.607,  weight grad: 1.544,  other: 0.432
Linear 1 Backward:  4.673
perpare first backward gemm: 0.027,  fisrt gemm backward duration: 2.567,  weight grad: 1.731,  other: 0.409
perpare first backward gemm: 0.037,  fisrt gemm backward duration: 2.482,  weight grad: 1.72,  other: 0.411
Linear 1 Backward:  4.696
Linear 1 Backward:  4.77
perpare first backward gemm: 0.031,  fisrt gemm backward duration: 2.199,  weight grad: 1.888,  other: 0.414
Linear 1 Backward:  4.573
STEP-54: step_time = 22.405152 ms, foward_time = 11.232288, backward_time = 11.049984, perf = 36.81 tflops.
start
start
start
start
block_info 268 60
cuda:2 process time:3.0879974365234375, a: 0.5681514739990234, b: 1.190185546875, c: 0.062465667724609375, d: 1.2671947479248047
block_info 288 77
2 wait time: 1.255
268
block_info 244 41
block_info 264 58
cuda:0 process time:3.6084651947021484, a: 0.7083415985107422, b: 0.9999275207519531, c: 0.08106231689453125, d: 1.8191337585449219
0 wait time: 1.67
288
cuda:3 process time:4.213809967041016, a: 0.7302761077880859, b: 1.3997554779052734, c: 0.11277198791503906, d: 1.9710063934326172
cuda:1 process time:4.153966903686523, a: 0.7572174072265625, b: 1.0671615600585938, c: 0.11277198791503906, d: 2.216815948486328
3 wait time: 2.489
244
1 wait time: 2.303
264
AG, 0.223881, 1.800192, 0 
perpare first forward gemm: 0.285,  fisrt gemm forward duration: 3.03
AG, 0.168033, 1.798144, 0 
perpare first forward gemm: 0.255,  fisrt gemm forward duration: 2.058
AG, 0.219697, 1.817600, 0 
perpare first forward gemm: 0.284,  fisrt gemm forward duration: 1.877
AG, 0.267361, 1.960960, 0 
perpare first forward gemm: 0.328,  fisrt gemm forward duration: 2.46
GA, 0.168033, 1.900544, 0 
GA, 0.219697, 1.961984, 0 
GA, 0.223881, 2.091008, 0 
GA, 0.267361, 2.237440, 0 
forward:  7.596
forward:  8.61
forward:  7.449
forward:  7.961
AG, 0.219697, 1.797120, 0 
AG, 0.168033, 1.800192, 0 
AG, 0.223881, 1.810432, 0 
AG, 0.267361, 1.951744, 0 
Linear 2 Backward: 3.322, second_gemm: 3.31
Linear 2 Backward: 3.532, second_gemm: 3.521
Linear 2 Backward: 3.678, second_gemm: 3.671
Linear 2 Backward: 3.723, second_gemm: 3.708
GA, 0.168033, 1.913856, 0 
GA, 0.219697, 1.812480, 0 
GA, 0.223881, 2.122752, 0 
GA, 0.267361, 2.046976, 0 
perpare first backward gemm: 0.039,  fisrt gemm backward duration: 2.633,  weight grad: 1.534,  other: 0.423
Linear 1 Backward:  4.676
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 2.52,  weight grad: 1.716,  other: 0.412
Linear 1 Backward:  4.728
perpare first backward gemm: 0.026,  fisrt gemm backward duration: 2.583,  weight grad: 1.732,  other: 0.411
Linear 1 Backward:  4.787
perpare first backward gemm: 0.047,  fisrt gemm backward duration: 2.119,  weight grad: 1.905,  other: 0.411
Linear 1 Backward:  4.531
STEP-55: step_time = 21.701633 ms, foward_time = 10.535936, backward_time = 11.064320, perf = 38.00 tflops.
start
start
start
start
block_info 244 41
cuda:3 process time:3.281116485595703, a: 0.6458759307861328, b: 1.3937950134277344, c: 0.06604194641113281, d: 1.1754035949707031
block_info 264 58
block_info 268 60
3 wait time: 1.28
244
block_info 288 77
cuda:1 process time:3.7772655487060547, a: 0.7843971252441406, b: 1.3473033905029297, c: 0.08869171142578125, d: 1.5568733215332031
cuda:2 process time:3.904581069946289, a: 0.7672309875488281, b: 1.3699531555175781, c: 0.09655952453613281, d: 1.67083740234375
cuda:0 process time:4.084587097167969, a: 0.8931159973144531, b: 1.2049674987792969, c: 0.10251998901367188, d: 1.8839836120605469
1 wait time: 2.086
264
2 wait time: 2.199
268
0 wait time: 2.451
288
AG, 0.223881, 1.798144, 0 
perpare first forward gemm: 0.282,  fisrt gemm forward duration: 2.146
AG, 0.168033, 1.786880, 0 
perpare first forward gemm: 0.254,  fisrt gemm forward duration: 3.018
AG, 0.219697, 1.804288, 0 
perpare first forward gemm: 0.282,  fisrt gemm forward duration: 2.247
AG, 0.267361, 1.954816, 0 
perpare first forward gemm: 0.293,  fisrt gemm forward duration: 2.013
GA, 0.168033, 1.892352, 0 
GA, 0.219697, 2.025472, 0 
GA, 0.223881, 2.143232, 0 
GA, 0.267361, 2.289664, 0 
forward:  8.51
forward:  7.764
forward:  7.665
forward:  7.38
AG, 0.223881, 1.811456, 0 
AG, 0.168033, 1.797120, 0 
AG, 0.219697, 1.811456, 0 
AG, 0.267361, 1.961984, 0 
Linear 2 Backward: 3.324, second_gemm: 3.313
Linear 2 Backward: 3.652, second_gemm: 3.644
Linear 2 Backward: 3.354, second_gemm: 3.343
Linear 2 Backward: 3.896, second_gemm: 3.887
GA, 0.168033, 1.874944, 0 
GA, 0.219697, 1.894400, 0 
GA, 0.223881, 2.089984, 0 
GA, 0.267361, 2.141184, 0 
perpare first backward gemm: 0.038,  fisrt gemm backward duration: 2.6,  weight grad: 1.555,  other: 0.449
Linear 1 Backward:  4.697
perpare first backward gemm: 0.027,  fisrt gemm backward duration: 2.537,  weight grad: 1.738,  other: 0.408
Linear 1 Backward:  4.746
perpare first backward gemm: 0.034,  fisrt gemm backward duration: 2.495,  weight grad: 1.724,  other: 0.433
Linear 1 Backward:  4.737
perpare first backward gemm: 0.033,  fisrt gemm backward duration: 2.193,  weight grad: 1.904,  other: 0.421
Linear 1 Backward:  4.595
STEP-56: step_time = 22.000673 ms, foward_time = 10.738720, backward_time = 11.160576, perf = 37.48 tflops.
start
start
start
start
block_info 288 77
block_info 244 41
block_info 268 60
block_info 264 58
cuda:2 process time:3.7910938262939453, a: 0.7402896881103516, b: 1.2359619140625, c: 0.11134147644042969, d: 1.703500747680664
cuda:0 process time:3.917694091796875, a: 0.7390975952148438, b: 1.19781494140625, c: 0.10180473327636719, d: 1.878976821899414
cuda:3 process time:4.045724868774414, a: 0.759124755859375, b: 1.1210441589355469, c: 0.1456737518310547, d: 2.0198822021484375
2 wait time: 2.245
268
cuda:1 process time:4.368066787719727, a: 0.7257461547851562, b: 1.4238357543945312, c: 0.11277198791503906, d: 2.105712890625
3 wait time: 2.77
244
0 wait time: 2.43
288
1 wait time: 2.7
264
AG, 0.223881, 1.802240, 0 
perpare first forward gemm: 0.296,  fisrt gemm forward duration: 2.353
AG, 0.168033, 1.796096, 0 
perpare first forward gemm: 0.252,  fisrt gemm forward duration: 2.308
AG, 0.219697, 1.811456, 0 
perpare first forward gemm: 0.295,  fisrt gemm forward duration: 1.876
AG, 0.267361, 1.966080, 0 
perpare first forward gemm: 0.279,  fisrt gemm forward duration: 2.387
GA, 0.168033, 1.885184, 0 
GA, 0.223881, 2.059264, 0 
GA, 0.219697, 2.128896, 0 
GA, 0.267361, 2.365440, 0 
forward:  7.833
forward:  7.794
forward:  7.502
forward:  7.986
AG, 0.219697, 1.803264, 0 
AG, 0.223881, 1.819648, 0 
AG, 0.168033, 1.809408, 0 
AG, 0.267361, 1.986560, 0 
Linear 2 Backward: 3.434, second_gemm: 3.419
Linear 2 Backward: 3.607, second_gemm: 3.6
Linear 2 Backward: 3.463, second_gemm: 3.449
Linear 2 Backward: 3.759, second_gemm: 3.744
GA, 0.219697, 1.799168, 0 
GA, 0.168033, 1.942528, 0 
GA, 0.223881, 2.196480, 0 
GA, 0.267361, 2.023424, 0 
perpare first backward gemm: 0.046,  fisrt gemm backward duration: 2.497,  weight grad: 1.566,  other: 0.479
Linear 1 Backward:  4.658
perpare first backward gemm: 0.026,  fisrt gemm backward duration: 2.576,  weight grad: 1.731,  other: 0.408
Linear 1 Backward:  4.776
perpare first backward gemm: 0.041,  fisrt gemm backward duration: 2.439,  weight grad: 1.732,  other: 0.452
Linear 1 Backward:  4.729
perpare first backward gemm: 0.047,  fisrt gemm backward duration: 2.087,  weight grad: 1.878,  other: 0.409
Linear 1 Backward:  4.469
STEP-57: step_time = 22.432961 ms, foward_time = 11.077824, backward_time = 11.251712, perf = 36.76 tflops.
start
start
start
start
block_info 244 41
block_info 268 60
cuda:3 process time:3.0984878540039062, a: 0.5614757537841797, b: 1.3895034790039062, c: 0.08058547973632812, d: 1.0669231414794922
cuda:2 process time:3.2668113708496094, a: 0.7741451263427734, b: 1.0178089141845703, c: 0.06365776062011719, d: 1.4111995697021484
3 wait time: 1.451
244
2 wait time: 1.298
268
block_info 264 58
block_info 288 77
cuda:1 process time:4.282712936401367, a: 0.8120536804199219, b: 1.2755393981933594, c: 0.11467933654785156, d: 2.0804405212402344
cuda:0 process time:4.5528411865234375, a: 0.7519721984863281, b: 1.4467239379882812, c: 0.11706352233886719, d: 2.237081527709961
1 wait time: 2.627
264
0 wait time: 2.853
288
AG, 0.223881, 1.814528, 0 
perpare first forward gemm: 0.307,  fisrt gemm forward duration: 2.991
AG, 0.168033, 1.807360, 0 
perpare first forward gemm: 0.257,  fisrt gemm forward duration: 3.368
AG, 0.219697, 1.813504, 0 
perpare first forward gemm: 0.304,  fisrt gemm forward duration: 1.972
AG, 0.267361, 1.973248, 0 
perpare first forward gemm: 0.297,  fisrt gemm forward duration: 2.034
GA, 0.168033, 1.835008, 0 
GA, 0.223881, 1.981440, 0 
GA, 0.219697, 2.041856, 0 
GA, 0.267361, 2.357248, 0 
forward:  8.667
forward:  8.957
forward:  7.643
forward:  7.52
AG, 0.219697, 1.809408, 0 
AG, 0.223881, 1.829888, 0 
AG, 0.168033, 1.817600, 0 
AG, 0.267361, 1.959936, 0 
Linear 2 Backward: 3.565, second_gemm: 3.552
Linear 2 Backward: 3.959, second_gemm: 3.952
Linear 2 Backward: 3.793, second_gemm: 3.779
Linear 2 Backward: 3.754, second_gemm: 3.74
GA, 0.168033, 1.886208, 0 
GA, 0.219697, 1.804288, 0 
GA, 0.223881, 2.082816, 0 
GA, 0.267361, 2.035712, 0 
perpare first backward gemm: 0.043,  fisrt gemm backward duration: 2.576,  weight grad: 1.564,  other: 0.519
perpare first backward gemm: 0.027,  fisrt gemm backward duration: 2.583,  weight grad: 1.732,  other: 0.413
Linear 1 Backward:  4.774
Linear 1 Backward:  4.789
perpare first backward gemm: 0.039,  fisrt gemm backward duration: 2.45,  weight grad: 1.738,  other: 0.452
Linear 1 Backward:  4.741
perpare first backward gemm: 0.049,  fisrt gemm backward duration: 2.109,  weight grad: 1.918,  other: 0.458
Linear 1 Backward:  4.586
STEP-58: step_time = 22.699553 ms, foward_time = 11.335200, backward_time = 11.231232, perf = 36.33 tflops.
start
start
start
start
block_info 268 60
block_info 288 77
block_info 244 41
block_info 264 58
cuda:3 process time:4.230737686157227, a: 0.5753040313720703, b: 1.9299983978271484, c: 0.11658668518066406, d: 1.6088485717773438
cuda:2 process time:4.025459289550781, a: 0.72479248046875, b: 1.3651847839355469, c: 0.09250640869140625, d: 1.8429756164550781
cuda:0 process time:3.9064884185791016, a: 0.8289813995361328, b: 1.1212825775146484, c: 0.08940696716308594, d: 1.8668174743652344
3 wait time: 2.062
244
2 wait time: 2.037
268
cuda:1 process time:4.475831985473633, a: 0.7417201995849609, b: 1.4226436614990234, c: 0.11324882507324219, d: 2.1982192993164062
0 wait time: 1.997
288
1 wait time: 2.405
264
AG, 0.223881, 1.817600, 0 
perpare first forward gemm: 0.296,  fisrt gemm forward duration: 2.28
AG, 0.267361, 1.958912, 0 
perpare first forward gemm: 0.329,  fisrt gemm forward duration: 2.315
AG, 0.168033, 1.821696, 0 
perpare first forward gemm: 0.259,  fisrt gemm forward duration: 2.45
AG, 0.219697, 1.816576, 0 
perpare first forward gemm: 0.293,  fisrt gemm forward duration: 1.882
GA, 0.168033, 1.887232, 0 
GA, 0.219697, 1.974272, 0 
GA, 0.223881, 2.106368, 0 
GA, 0.267361, 2.216960, 0 
forward:  7.984
forward:  7.482
forward:  7.907
forward:  7.837
AG, 0.223881, 1.827840, 0 
AG, 0.168033, 1.812480, 0 
AG, 0.219697, 1.807360, 0 
AG, 0.267361, 1.963008, 0 
Linear 2 Backward: 3.332, second_gemm: 3.319
Linear 2 Backward: 3.384, second_gemm: 3.373
Linear 2 Backward: 3.537, second_gemm: 3.525
Linear 2 Backward: 3.707, second_gemm: 3.695
GA, 0.168033, 1.882112, 0 
GA, 0.219697, 1.976320, 0 
GA, 0.223881, 2.083840, 0 
GA, 0.267361, 2.203648, 0 
perpare first backward gemm: 0.041,  fisrt gemm backward duration: 2.617,  weight grad: 1.573,  other: 0.422
Linear 1 Backward:  4.702
perpare first backward gemm: 0.038,  fisrt gemm backward duration: 2.485,  weight grad: 1.736,  other: 0.413
perpare first backward gemm: 0.033,  fisrt gemm backward duration: 2.514,  weight grad: 1.746,  other: 0.41
Linear 1 Backward:  4.717
Linear 1 Backward:  4.744
perpare first backward gemm: 0.031,  fisrt gemm backward duration: 2.255,  weight grad: 1.89,  other: 0.415
Linear 1 Backward:  4.632
STEP-59: step_time = 22.031360 ms, foward_time = 10.890240, backward_time = 11.039744, perf = 37.43 tflops.
start
start
start
start
block_info 244 41
block_info 288 77
block_info 268 60
block_info 264 58
cuda:3 process time:3.695249557495117, a: 0.8642673492431641, b: 1.1358261108398438, c: 0.09369850158691406, d: 1.6014575958251953
cuda:2 process time:3.8857460021972656, a: 0.7777214050292969, b: 1.2788772583007812, c: 0.08749961853027344, d: 1.741647720336914
cuda:0 process time:3.802776336669922, a: 0.7402896881103516, b: 1.3022422790527344, c: 0.10347366333007812, d: 1.6567707061767578
2 wait time: 1.865
268
3 wait time: 2.079
244
0 wait time: 2.149
288
cuda:1 process time:4.375219345092773, a: 0.7748603820800781, b: 1.2066364288330078, c: 0.11181831359863281, d: 2.2819042205810547
1 wait time: 2.472
264
AG, 0.168033, 1.808384, 0 
perpare first forward gemm: 0.307,  fisrt gemm forward duration: 2.403
AG, 0.267361, 1.971200, 0 
perpare first forward gemm: 0.288,  fisrt gemm forward duration: 2.544
AG, 0.223881, 1.815552, 0 
perpare first forward gemm: 0.288,  fisrt gemm forward duration: 2.426
AG, 0.219697, 1.810432, 0 
perpare first forward gemm: 0.284,  fisrt gemm forward duration: 1.871
GA, 0.168033, 1.930240, 0 
GA, 0.219697, 2.062336, 0 
GA, 0.223881, 2.251776, 0 
GA, 0.267361, 2.292736, 0 
forward:  7.403
forward:  8.009
forward:  7.963
forward:  7.914
AG, 0.223881, 1.820672, 0 
AG, 0.219697, 1.813504, 0 
AG, 0.168033, 1.788928, 0 
AG, 0.267361, 1.968128, 0 
Linear 2 Backward: 3.248, second_gemm: 3.236
Linear 2 Backward: 3.467, second_gemm: 3.456
Linear 2 Backward: 3.475, second_gemm: 3.463
Linear 2 Backward: 3.786, second_gemm: 3.771
GA, 0.168033, 1.855488, 0 
GA, 0.219697, 1.889280, 0 
GA, 0.223881, 2.087936, 0 
GA, 0.267361, 2.120704, 0 
perpare first backward gemm: 0.037,  fisrt gemm backward duration: 2.723,  weight grad: 1.548,  other: 0.45
Linear 1 Backward:  4.811
perpare first backward gemm: 0.035,  fisrt gemm backward duration: 2.588,  weight grad: 1.745,  other: 0.434
perpare first backward gemm: 0.033,  fisrt gemm backward duration: 2.557,  weight grad: 1.755,  other: 0.431
Linear 1 Backward:  4.852
Linear 1 Backward:  4.828
perpare first backward gemm: 0.043,  fisrt gemm backward duration: 2.187,  weight grad: 1.929,  other: 0.451
Linear 1 Backward:  4.677
STEP-60: step_time = 22.618849 ms, foward_time = 10.974944, backward_time = 11.542528, perf = 36.46 tflops.
start
start
start
start
block_info 288 77
block_info 268 60
block_info 264 58
block_info 244 41
cuda:0 process time:4.042625427246094, a: 0.7054805755615234, b: 1.209259033203125, c: 0.09369850158691406, d: 2.0341873168945312
cuda:1 process time:4.239082336425781, a: 0.7958412170410156, b: 1.3623237609863281, c: 0.10585784912109375, d: 1.9750595092773438
cuda:2 process time:4.484653472900391, a: 1.071929931640625, b: 1.2819766998291016, c: 0.1087188720703125, d: 2.0220279693603516
cuda:3 process time:4.472970962524414, a: 0.7855892181396484, b: 1.5060901641845703, c: 0.12373924255371094, d: 2.0575523376464844
0 wait time: 1.911
288
1 wait time: 2.495
264
2 wait time: 2.601
268
3 wait time: 2.58
244
AG, 0.219697, 1.812480, 0 
perpare first forward gemm: 0.308,  fisrt gemm forward duration: 1.991
AG, 0.223881, 1.808384, 0 
perpare first forward gemm: 0.313,  fisrt gemm forward duration: 1.873
AG, 0.168033, 1.813504, 0 
perpare first forward gemm: 0.282,  fisrt gemm forward duration: 1.933
AG, 0.267361, 1.963008, 0 
perpare first forward gemm: 0.315,  fisrt gemm forward duration: 2.278
GA, 0.168033, 1.947648, 0 
GA, 0.219697, 2.039808, 0 
GA, 0.223881, 2.180096, 0 
GA, 0.267361, 2.287616, 0 
forward:  7.541
forward:  7.438
forward:  7.435
forward:  7.676
AG, 0.168033, 1.803264, 0 
AG, 0.219697, 1.827840, 0 
AG, 0.223881, 1.829888, 0 
AG, 0.267361, 1.973248, 0 
Linear 2 Backward: 3.364, second_gemm: 3.349
Linear 2 Backward: 3.442, second_gemm: 3.428
Linear 2 Backward: 3.624, second_gemm: 3.61
Linear 2 Backward: 3.851, second_gemm: 3.837
GA, 0.168033, 1.869824, 0 
GA, 0.219697, 1.966080, 0 
GA, 0.223881, 2.118656, 0 
GA, 0.267361, 2.203648, 0 
perpare first backward gemm: 0.046,  fisrt gemm backward duration: 2.73,  weight grad: 1.558,  other: 0.477
Linear 1 Backward:  4.881
perpare first backward gemm: 0.041,  fisrt gemm backward duration: 2.605,  weight grad: 1.747,  other: 0.456
perpare first backward gemm: 0.04,  fisrt gemm backward duration: 2.562,  weight grad: 1.764,  other: 0.451
Linear 1 Backward:  4.914
Linear 1 Backward:  4.881
perpare first backward gemm: 0.044,  fisrt gemm backward duration: 2.273,  weight grad: 1.911,  other: 0.449
Linear 1 Backward:  4.743
STEP-61: step_time = 22.188032 ms, foward_time = 10.659840, backward_time = 11.426816, perf = 37.17 tflops.
start
start
start
start
block_info 244 41
cuda:3 process time:2.8498172760009766, a: 0.5731582641601562, b: 1.1887550354003906, c: 0.061511993408203125, d: 1.0263919830322266
block_info 264 58
block_info 288 77
3 wait time: 1.443
244
cuda:1 process time:3.576517105102539, a: 0.7255077362060547, b: 1.1706352233886719, c: 0.08797645568847656, d: 1.592397689819336
block_info 268 60
cuda:0 process time:3.72314453125, a: 0.7386207580566406, b: 1.2066364288330078, c: 0.09107589721679688, d: 1.6868114471435547
1 wait time: 2.112
264
0 wait time: 2.212
288
cuda:2 process time:4.377126693725586, a: 0.7481575012207031, b: 1.3964176177978516, c: 0.11968612670898438, d: 2.112865447998047
2 wait time: 2.625
268
AG, 0.219697, 1.808384, 0 
perpare first forward gemm: 0.277,  fisrt gemm forward duration: 2.536
AG, 0.168033, 1.803264, 0 
perpare first forward gemm: 0.268,  fisrt gemm forward duration: 3.251
AG, 0.267361, 1.963008, 0 
perpare first forward gemm: 0.293,  fisrt gemm forward duration: 2.599
AG, 0.223881, 1.818624, 0 
perpare first forward gemm: 0.28,  fisrt gemm forward duration: 1.875
GA, 0.168033, 1.936384, 0 
GA, 0.219697, 2.066432, 0 
GA, 0.223881, 2.149376, 0 
GA, 0.267361, 2.291712, 0 
forward:  7.399
forward:  8.761
forward:  8.051
forward:  7.978
AG, 0.219697, 1.809408, 0 
AG, 0.223881, 1.829888, 0 
AG, 0.168033, 1.794048, 0 
AG, 0.267361, 1.983488, 0 
Linear 2 Backward: 3.406, second_gemm: 3.392
Linear 2 Backward: 3.696, second_gemm: 3.682
Linear 2 Backward: 3.658, second_gemm: 3.646
Linear 2 Backward: 3.78, second_gemm: 3.766
GA, 0.168033, 1.843200, 0 
GA, 0.219697, 1.879040, 0 
GA, 0.223881, 1.996800, 0 
GA, 0.267361, 2.122752, 0 
perpare first backward gemm: 0.043,  fisrt gemm backward duration: 2.705,  weight grad: 1.579,  other: 0.472
Linear 1 Backward:  4.849
perpare first backward gemm: 0.037,  fisrt gemm backward duration: 2.549,  weight grad: 1.755,  other: 0.42
Linear 1 Backward:  4.807
perpare first backward gemm: 0.039,  fisrt gemm backward duration: 2.563,  weight grad: 1.744,  other: 0.433
Linear 1 Backward:  4.827
perpare first backward gemm: 0.043,  fisrt gemm backward duration: 2.187,  weight grad: 1.917,  other: 0.416
Linear 1 Backward:  4.612
STEP-62: step_time = 22.412703 ms, foward_time = 11.034016, backward_time = 11.275264, perf = 36.79 tflops.
start
start
start
start
block_info 264 58
block_info 288 77
cuda:1 process time:3.551959991455078, a: 0.7278919219970703, b: 1.0139942169189453, c: 0.08916854858398438, d: 1.7209053039550781
block_info 244 41
cuda:0 process time:3.7689208984375, a: 0.7154941558837891, b: 1.1529922485351562, c: 0.0896453857421875, d: 1.8107891082763672
block_info 268 60
1 wait time: 1.918
264
0 wait time: 1.962
288
cuda:3 process time:4.132270812988281, a: 0.644683837890625, b: 1.3799667358398438, c: 0.11897087097167969, d: 1.9886493682861328
cuda:2 process time:4.431962966918945, a: 0.7710456848144531, b: 1.483917236328125, c: 0.11372566223144531, d: 2.063274383544922
3 wait time: 2.508
244
2 wait time: 2.64
268
AG, 0.267361, 1.961984, 0 
perpare first forward gemm: 0.302,  fisrt gemm forward duration: 2.767
AG, 0.219697, 1.804288, 0 
perpare first forward gemm: 0.29,  fisrt gemm forward duration: 2.73
AG, 0.168033, 1.798144, 0 
perpare first forward gemm: 0.277,  fisrt gemm forward duration: 2.073
AG, 0.223881, 1.820672, 0 
perpare first forward gemm: 0.289,  fisrt gemm forward duration: 1.882
GA, 0.168033, 1.940480, 0 
GA, 0.219697, 2.053120, 0 
GA, 0.223881, 2.111488, 0 
GA, 0.267361, 2.310144, 0 
forward:  8.319
forward:  7.527
forward:  7.658
forward:  8.215
AG, 0.168033, 1.798144, 0 
AG, 0.219697, 1.815552, 0 
AG, 0.223881, 1.816576, 0 
AG, 0.267361, 1.969152, 0 
Linear 2 Backward: 3.281, second_gemm: 3.267
Linear 2 Backward: 3.477, second_gemm: 3.464
Linear 2 Backward: 3.533, second_gemm: 3.52
Linear 2 Backward: 3.78, second_gemm: 3.767
GA, 0.168033, 1.855488, 0 
GA, 0.219697, 1.994752, 0 
GA, 0.223881, 2.127872, 0 
GA, 0.267361, 2.219008, 0 
perpare first backward gemm: 0.042,  fisrt gemm backward duration: 2.728,  weight grad: 1.555,  other: 0.424
Linear 1 Backward:  4.797
perpare first backward gemm: 0.037,  fisrt gemm backward duration: 2.604,  weight grad: 1.735,  other: 0.41
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 2.558,  weight grad: 1.761,  other: 0.411
Linear 1 Backward:  4.832
Linear 1 Backward:  4.811
perpare first backward gemm: 0.039,  fisrt gemm backward duration: 2.281,  weight grad: 1.908,  other: 0.409
Linear 1 Backward:  4.682
STEP-63: step_time = 22.380545 ms, foward_time = 11.129856, backward_time = 11.149312, perf = 36.85 tflops.
start
start
start
start
block_info 244 41
block_info 264 58
cuda:3 process time:3.568410873413086, a: 0.7796287536621094, b: 1.1551380157470703, c: 0.10347366333007812, d: 1.5301704406738281
block_info 268 60
block_info 288 77
3 wait time: 2.021
244
cuda:1 process time:4.071950912475586, a: 0.7760524749755859, b: 1.2319087982177734, c: 0.0934600830078125, d: 1.970529556274414
cuda:0 process time:4.115819931030273, a: 0.6377696990966797, b: 1.0783672332763672, c: 0.11396408081054688, d: 2.2857189178466797
cuda:2 process time:4.229068756103516, a: 0.7717609405517578, b: 1.2755393981933594, c: 0.11444091796875, d: 2.0673274993896484
1 wait time: 1.821
264
2 wait time: 2.597
268
0 wait time: 2.461
288
AG, 0.219697, 1.819648, 0 
perpare first forward gemm: 0.315,  fisrt gemm forward duration: 2.142
AG, 0.223881, 1.805312, 0 
perpare first forward gemm: 0.286,  fisrt gemm forward duration: 2.004
AG, 0.168033, 1.795072, 0 
perpare first forward gemm: 0.273,  fisrt gemm forward duration: 2.718
AG, 0.267361, 1.983488, 0 
perpare first forward gemm: 0.298,  fisrt gemm forward duration: 2.044
GA, 0.168033, 1.937408, 0 
GA, 0.223881, 2.197504, 0 
GA, 0.219697, 2.145280, 0 
GA, 0.267361, 2.386944, 0 
forward:  7.885
forward:  7.684
forward:  8.394
forward:  7.581
AG, 0.168033, 1.790976, 0 
AG, 0.219697, 1.815552, 0 
AG, 0.223881, 1.802240, 0 
AG, 0.267361, 1.981440, 0 
Linear 2 Backward: 6.963, second_gemm: 6.952
Linear 2 Backward: 3.241, second_gemm: 3.223
Linear 2 Backward: 7.033, second_gemm: 7.021
Linear 2 Backward: 7.31, second_gemm: 7.299
GA, 0.168033, 1.837056, 0 
GA, 0.219697, 1.947648, 0 
GA, 0.223881, 2.031616, 0 
GA, 0.267361, 2.212864, 0 
perpare first backward gemm: 0.028,  fisrt gemm backward duration: 2.818,  weight grad: 1.516,  other: 0.43
Linear 1 Backward:  4.835
perpare first backward gemm: 0.034,  fisrt gemm backward duration: 2.58,  weight grad: 1.745,  other: 0.41
Linear 1 Backward:  4.811
perpare first backward gemm: 0.035,  fisrt gemm backward duration: 2.641,  weight grad: 1.717,  other: 0.424
Linear 1 Backward:  4.861
perpare first backward gemm: 0.037,  fisrt gemm backward duration: 2.27,  weight grad: 1.913,  other: 0.413
Linear 1 Backward:  4.675
STEP-64: step_time = 25.831425 ms, foward_time = 11.080704, backward_time = 14.648320, perf = 31.92 tflops.
start
start
start
start
block_info 288 77
block_info 268 60
cuda:0 process time:3.1533241271972656, a: 0.6020069122314453, b: 1.0161399841308594, c: 0.07510185241699219, d: 1.4600753784179688
block_info 264 58
cuda:2 process time:3.3233165740966797, a: 0.6959438323974609, b: 0.9617805480957031, c: 0.06818771362304688, d: 1.5974044799804688
block_info 244 41
2 wait time: 1.275
268
0 wait time: 1.325
288
cuda:1 process time:3.8518905639648438, a: 0.7359981536865234, b: 1.3251304626464844, c: 0.09369850158691406, d: 1.6970634460449219
cuda:3 process time:3.8063526153564453, a: 0.6895065307617188, b: 1.0421276092529297, c: 0.08535385131835938, d: 1.9893646240234375
1 wait time: 2.262
264
3 wait time: 1.716
244
AG, 0.223881, 1.803264, 0 
perpare first forward gemm: 0.32,  fisrt gemm forward duration: 2.521
AG, 0.219697, 1.810432, 0 
perpare first forward gemm: 0.298,  fisrt gemm forward duration: 2.011
AG, 0.267361, 1.971200, 0 
perpare first forward gemm: 0.33,  fisrt gemm forward duration: 2.576
AG, 0.168033, 1.808384, 0 
perpare first forward gemm: 0.309,  fisrt gemm forward duration: 1.884
GA, 0.219697, 1.969152, 0 
GA, 0.168033, 1.972224, 0 
GA, 0.223881, 2.180096, 0 
GA, 0.267361, 2.283520, 0 
forward:  8.227
forward:  7.584
forward:  8.173
forward:  7.713
AG, 0.168033, 1.809408, 0 
AG, 0.223881, 1.812480, 0 
AG, 0.219697, 1.811456, 0 
AG, 0.267361, 1.978368, 0 
Linear 2 Backward: 3.358, second_gemm: 3.341
Linear 2 Backward: 3.534, second_gemm: 3.523
Linear 2 Backward: 3.42, second_gemm: 3.409
Linear 2 Backward: 3.819, second_gemm: 3.807
GA, 0.168033, 1.893376, 0 
GA, 0.219697, 1.961984, 0 
GA, 0.223881, 2.103296, 0 
GA, 0.267361, 2.195456, 0 
perpare first backward gemm: 0.038,  fisrt gemm backward duration: 2.697,  weight grad: 1.538,  other: 0.446
Linear 1 Backward:  4.78
perpare first backward gemm: 0.033,  fisrt gemm backward duration: 2.624,  weight grad: 1.718,  other: 0.429
Linear 1 Backward:  4.853
perpare first backward gemm: 0.034,  fisrt gemm backward duration: 2.537,  weight grad: 1.745,  other: 0.428
Linear 1 Backward:  4.794
perpare first backward gemm: 0.037,  fisrt gemm backward duration: 2.253,  weight grad: 1.917,  other: 0.433
Linear 1 Backward:  4.691
STEP-65: step_time = 21.970944 ms, foward_time = 10.510336, backward_time = 11.357184, perf = 37.53 tflops.
start
start
start
start
block_info 288 77
block_info 264 58
block_info 268 60
block_info 244 41
cuda:0 process time:4.188776016235352, a: 0.591278076171875, b: 1.5676021575927734, c: 0.09393692016601562, d: 1.9359588623046875
cuda:1 process time:4.333972930908203, a: 0.7674694061279297, b: 1.4591217041015625, c: 0.09202957153320312, d: 2.015352249145508
cuda:2 process time:3.9987564086914062, a: 0.8063316345214844, b: 1.0221004486083984, c: 0.09369850158691406, d: 2.0766258239746094
1 wait time: 1.728
264
0 wait time: 2.11
288
cuda:3 process time:4.542350769042969, a: 0.7770061492919922, b: 1.4922618865966797, c: 0.11134147644042969, d: 2.161741256713867
2 wait time: 1.911
268
3 wait time: 2.729
244
AG, 0.223881, 1.797120, 0 
perpare first forward gemm: 0.312,  fisrt gemm forward duration: 2.111
AG, 0.168033, 1.786880, 0 
perpare first forward gemm: 0.268,  fisrt gemm forward duration: 1.844
AG, 0.219697, 1.817600, 0 
perpare first forward gemm: 0.302,  fisrt gemm forward duration: 2.35
AG, 0.267361, 1.970176, 0 
perpare first forward gemm: 0.291,  fisrt gemm forward duration: 2.479
GA, 0.168033, 1.959936, 0 
GA, 0.219697, 2.051072, 0 
GA, 0.223881, 2.197504, 0 
GA, 0.267361, 2.282496, 0 
forward:  7.886
forward:  7.682
forward:  7.345
forward:  7.826
AG, 0.168033, 1.798144, 0 
AG, 0.219697, 1.823744, 0 
AG, 0.223881, 1.800192, 0 
AG, 0.267361, 1.977344, 0 
Linear 2 Backward: 3.497, second_gemm: 3.48
Linear 2 Backward: 3.646, second_gemm: 3.632
Linear 2 Backward: 3.752, second_gemm: 3.737
Linear 2 Backward: 3.754, second_gemm: 3.739
GA, 0.168033, 1.785856, 0 
GA, 0.223881, 2.015232, 0 
GA, 0.219697, 1.985536, 0 
GA, 0.267361, 2.217984, 0 
perpare first backward gemm: 0.037,  fisrt gemm backward duration: 2.828,  weight grad: 1.537,  other: 0.446
Linear 1 Backward:  4.909
perpare first backward gemm: 0.041,  fisrt gemm backward duration: 2.548,  weight grad: 1.763,  other: 0.471
perpare first backward gemm: 0.041,  fisrt gemm backward duration: 2.652,  weight grad: 1.733,  other: 0.451
Linear 1 Backward:  4.972
Linear 1 Backward:  4.888
perpare first backward gemm: 0.044,  fisrt gemm backward duration: 2.285,  weight grad: 1.928,  other: 0.457
Linear 1 Backward:  4.78
STEP-66: step_time = 22.422529 ms, foward_time = 10.831872, backward_time = 11.487232, perf = 36.78 tflops.
start
start
start
start
block_info 264 58
block_info 244 41
block_info 288 77
block_info 268 60
cuda:3 process time:3.763914108276367, a: 0.6902217864990234, b: 1.1758804321289062, c: 0.08654594421386719, d: 1.8112659454345703
cuda:1 process time:3.945589065551758, a: 0.7250308990478516, b: 1.4426708221435547, c: 0.10633468627929688, d: 1.6715526580810547
cuda:0 process time:4.017114639282227, a: 0.8423328399658203, b: 1.3158321380615234, c: 0.09560585021972656, d: 1.7633438110351562
1 wait time: 2.093
264
3 wait time: 1.806
244
cuda:2 process time:4.399299621582031, a: 0.6260871887207031, b: 1.5804767608642578, c: 0.12040138244628906, d: 2.0723342895507812
0 wait time: 2.307
288
2 wait time: 2.626
268
AG, 0.168033, 1.794048, 0 
perpare first forward gemm: 0.306,  fisrt gemm forward duration: 2.334
AG, 0.219697, 1.801216, 0 
perpare first forward gemm: 0.275,  fisrt gemm forward duration: 2.517
AG, 0.223881, 1.803264, 0 
perpare first forward gemm: 0.278,  fisrt gemm forward duration: 1.86
AG, 0.267361, 1.968128, 0 
perpare first forward gemm: 0.329,  fisrt gemm forward duration: 2.193
GA, 0.219697, 1.882112, 0 
GA, 0.168033, 1.994752, 0 
GA, 0.223881, 2.245632, 0 
GA, 0.267361, 2.159616, 0 
forward:  7.394
forward:  8.055
forward:  7.963
forward:  7.715
AG, 0.168033, 1.796096, 0 
AG, 0.223881, 1.819648, 0 
AG, 0.219697, 1.822720, 0 
AG, 0.267361, 1.983488, 0 
Linear 2 Backward: 3.397, second_gemm: 3.381
Linear 2 Backward: 3.558, second_gemm: 3.545
Linear 2 Backward: 3.459, second_gemm: 3.447
Linear 2 Backward: 3.865, second_gemm: 3.852
GA, 0.168033, 1.828864, 0 
GA, 0.219697, 1.909760, 0 
GA, 0.223881, 2.037760, 0 
GA, 0.267361, 2.185216, 0 
perpare first backward gemm: 0.035,  fisrt gemm backward duration: 2.78,  weight grad: 1.532,  other: 0.412
Linear 1 Backward:  4.805
perpare first backward gemm: 0.037,  fisrt gemm backward duration: 2.527,  weight grad: 1.749,  other: 0.41
Linear 1 Backward:  4.768
perpare first backward gemm: 0.038,  fisrt gemm backward duration: 2.581,  weight grad: 1.732,  other: 0.412
Linear 1 Backward:  4.808
perpare first backward gemm: 0.04,  fisrt gemm backward duration: 2.246,  weight grad: 1.921,  other: 0.411
Linear 1 Backward:  4.663
STEP-67: step_time = 22.267072 ms, foward_time = 10.945728, backward_time = 11.218944, perf = 37.03 tflops.
start
start
start
start
block_info 244 41
block_info 288 77
cuda:3 process time:3.587484359741211, a: 0.7607936859130859, b: 1.1966228485107422, c: 0.08821487426757812, d: 1.5418529510498047
block_info 264 58
cuda:0 process time:3.926515579223633, a: 0.7224082946777344, b: 1.2116432189941406, c: 0.09465217590332031, d: 1.8978118896484375
block_info 268 60
3 wait time: 2.082
244
0 wait time: 2.021
288
cuda:1 process time:4.451513290405273, a: 0.7462501525878906, b: 1.5172958374023438, c: 0.11539459228515625, d: 2.072572708129883
cuda:2 process time:4.764556884765625, a: 0.6577968597412109, b: 1.9276142120361328, c: 0.11968612670898438, d: 2.059459686279297
1 wait time: 2.522
264
2 wait time: 2.588
268
AG, 0.219697, 1.809408, 0 
perpare first forward gemm: 0.289,  fisrt gemm forward duration: 2.131
AG, 0.267361, 1.972224, 0 
perpare first forward gemm: 0.301,  fisrt gemm forward duration: 2.73
AG, 0.168033, 1.795072, 0 
perpare first forward gemm: 0.28,  fisrt gemm forward duration: 2.692
AG, 0.223881, 1.794048, 0 
perpare first forward gemm: 0.29,  fisrt gemm forward duration: 1.858
GA, 0.168033, 1.969152, 0 
GA, 0.219697, 1.998848, 0 
GA, 0.223881, 2.107392, 0 
GA, 0.267361, 2.264064, 0 
forward:  7.684
forward:  8.286
forward:  7.432
forward:  8.136
AG, 0.223881, 1.798144, 0 
AG, 0.219697, 1.810432, 0 
AG, 0.168033, 1.799168, 0 
AG, 0.267361, 1.972224, 0 
Linear 2 Backward: 3.23, second_gemm: 3.215
Linear 2 Backward: 3.381, second_gemm: 3.369
Linear 2 Backward: 3.429, second_gemm: 3.417
Linear 2 Backward: 3.703, second_gemm: 3.691
GA, 0.168033, 1.812480, 0 
GA, 0.219697, 1.941504, 0 
GA, 0.223881, 1.973248, 0 
GA, 0.267361, 2.182144, 0 
perpare first backward gemm: 0.032,  fisrt gemm backward duration: 2.766,  weight grad: 1.525,  other: 0.43
Linear 1 Backward:  4.805
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 2.583,  weight grad: 1.722,  other: 0.438
Linear 1 Backward:  4.831
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 2.538,  weight grad: 1.754,  other: 0.434
Linear 1 Backward:  4.815
perpare first backward gemm: 0.038,  fisrt gemm backward duration: 2.24,  weight grad: 1.921,  other: 0.453
Linear 1 Backward:  4.708
STEP-68: step_time = 22.553599 ms, foward_time = 11.134975, backward_time = 11.310080, perf = 36.56 tflops.
start
start
start
start
block_info 268 60
block_info 264 58
block_info 244 41
block_info 288 77
cuda:1 process time:3.648996353149414, a: 0.7328987121582031, b: 1.260995864868164, c: 0.08821487426757812, d: 1.5668869018554688
cuda:3 process time:3.62396240234375, a: 0.7700920104980469, b: 1.1434555053710938, c: 0.10752677917480469, d: 1.6028881072998047
cuda:2 process time:3.600597381591797, a: 0.7278919219970703, b: 1.2164115905761719, c: 0.0896453857421875, d: 1.5666484832763672
cuda:0 process time:3.9064884185791016, a: 0.7419586181640625, b: 1.3167858123779297, c: 0.09608268737792969, d: 1.7516613006591797
1 wait time: 1.986
264
3 wait time: 2.103
244
2 wait time: 2.113
268
0 wait time: 2.325
288
AG, 0.223881, 1.801216, 0 
perpare first forward gemm: 0.298,  fisrt gemm forward duration: 2.181
AG, 0.219697, 1.800192, 0 
perpare first forward gemm: 0.282,  fisrt gemm forward duration: 2.309
AG, 0.168033, 1.794048, 0 
perpare first forward gemm: 0.271,  fisrt gemm forward duration: 2.217
AG, 0.267361, 1.964032, 0 
perpare first forward gemm: 0.315,  fisrt gemm forward duration: 2.032
GA, 0.168033, 1.846272, 0 
GA, 0.219697, 1.991680, 0 
GA, 0.223881, 2.155520, 0 
GA, 0.267361, 2.256896, 0 
forward:  7.898
forward:  7.779
forward:  7.495
forward:  7.795
AG, 0.168033, 1.802240, 0 
AG, 0.219697, 1.816576, 0 
AG, 0.223881, 1.816576, 0 
AG, 0.267361, 1.975296, 0 
Linear 2 Backward: 3.253, second_gemm: 3.236
Linear 2 Backward: 3.442, second_gemm: 3.428
Linear 2 Backward: 3.638, second_gemm: 3.624
Linear 2 Backward: 3.756, second_gemm: 3.742
GA, 0.168033, 1.827840, 0 
GA, 0.223881, 2.078720, 0 
GA, 0.219697, 1.948672, 0 
GA, 0.267361, 2.148352, 0 
perpare first backward gemm: 0.037,  fisrt gemm backward duration: 2.771,  weight grad: 1.537,  other: 0.443
Linear 1 Backward:  4.849
perpare first backward gemm: 0.04,  fisrt gemm backward duration: 2.534,  weight grad: 1.757,  other: 0.45
Linear 1 Backward:  4.845
perpare first backward gemm: 0.041,  fisrt gemm backward duration: 2.588,  weight grad: 1.73,  other: 0.449
Linear 1 Backward:  4.873
perpare first backward gemm: 0.043,  fisrt gemm backward duration: 2.233,  weight grad: 1.93,  other: 0.455
Linear 1 Backward:  4.727
STEP-69: step_time = 22.617504 ms, foward_time = 10.697120, backward_time = 11.820032, perf = 36.46 tflops.
start
start
start
start
block_info 288 77
block_info 264 58
cuda:0 process time:3.1418800354003906, a: 0.5810260772705078, b: 1.0612010955810547, c: 0.06461143493652344, d: 1.4350414276123047
block_info 268 60
block_info 244 41
0 wait time: 1.557
288
cuda:1 process time:3.634929656982422, a: 0.7333755493164062, b: 1.1882781982421875, c: 0.09441375732421875, d: 1.6188621520996094
cuda:2 process time:3.6046504974365234, a: 0.6358623504638672, b: 0.9934902191162109, c: 0.08749961853027344, d: 1.8877983093261719
1 wait time: 2.01
264
cuda:3 process time:4.05120849609375, a: 0.7374286651611328, b: 1.3346672058105469, c: 0.10895729064941406, d: 1.8701553344726562
2 wait time: 1.755
268
3 wait time: 2.4
244
AG, 0.219697, 1.807360, 0 
perpare first forward gemm: 0.281,  fisrt gemm forward duration: 2.329
AG, 0.223881, 1.799168, 0 
perpare first forward gemm: 0.276,  fisrt gemm forward duration: 2.222
AG, 0.168033, 1.786880, 0 
perpare first forward gemm: 0.294,  fisrt gemm forward duration: 1.856
AG, 0.267361, 1.969152, 0 
perpare first forward gemm: 0.294,  fisrt gemm forward duration: 2.847
GA, 0.168033, 1.993728, 0 
GA, 0.223881, 2.145280, 0 
GA, 0.219697, 2.029568, 0 
GA, 0.267361, 2.281472, 0 
forward:  7.913
forward:  7.46
forward:  7.761
forward:  8.242
AG, 0.223881, 1.812480, 0 
AG, 0.219697, 1.817600, 0 
AG, 0.168033, 1.800192, 0 
AG, 0.267361, 1.964032, 0 
Linear 2 Backward: 3.3, second_gemm: 3.283
Linear 2 Backward: 3.554, second_gemm: 3.541
Linear 2 Backward: 3.46, second_gemm: 3.447
Linear 2 Backward: 3.73, second_gemm: 3.716
GA, 0.168033, 1.796096, 0 
GA, 0.219697, 1.933312, 0 
GA, 0.223881, 2.040832, 0 
GA, 0.267361, 2.179072, 0 
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 2.761,  weight grad: 1.51,  other: 0.408
Linear 1 Backward:  4.761
perpare first backward gemm: 0.039,  fisrt gemm backward duration: 2.594,  weight grad: 1.724,  other: 0.448
Linear 1 Backward:  4.867
perpare first backward gemm: 0.039,  fisrt gemm backward duration: 2.54,  weight grad: 1.76,  other: 0.465
Linear 1 Backward:  4.864
perpare first backward gemm: 0.041,  fisrt gemm backward duration: 2.242,  weight grad: 1.907,  other: 0.474
Linear 1 Backward:  4.727
STEP-70: step_time = 22.206464 ms, foward_time = 10.719232, backward_time = 11.383808, perf = 37.13 tflops.
start
start
start
start
block_info 264 58
block_info 268 60
block_info 244 41
block_info 288 77
cuda:1 process time:3.8537979125976562, a: 0.7290840148925781, b: 1.1792182922363281, c: 0.09131431579589844, d: 1.8541812896728516
cuda:2 process time:4.039764404296875, a: 0.8337497711181641, b: 1.4491081237792969, c: 0.09417533874511719, d: 1.6627311706542969
cuda:3 process time:3.993511199951172, a: 0.7648468017578125, b: 1.0838508605957031, c: 0.10704994201660156, d: 2.0377635955810547
1 wait time: 1.861
264
2 wait time: 2.236
268
3 wait time: 2.099
244
cuda:0 process time:4.384756088256836, a: 0.8230209350585938, b: 1.287221908569336, c: 0.11849403381347656, d: 2.1560192108154297
0 wait time: 2.731
288
AG, 0.219697, 1.809408, 0 
perpare first forward gemm: 0.297,  fisrt gemm forward duration: 2.554
AG, 0.223881, 1.812480, 0 
perpare first forward gemm: 0.314,  fisrt gemm forward duration: 2.267
AG, 0.168033, 1.803264, 0 
perpare first forward gemm: 0.286,  fisrt gemm forward duration: 2.306
AG, 0.267361, 1.961984, 0 
perpare first forward gemm: 0.31,  fisrt gemm forward duration: 2.031
GA, 0.168033, 1.929216, 0 
GA, 0.219697, 2.044928, 0 
GA, 0.223881, 2.081792, 0 
GA, 0.267361, 2.283520, 0 
forward:  7.936
forward:  7.916
forward:  8.194
forward:  7.503
AG, 0.219697, 1.809408, 0 
AG, 0.223881, 1.807360, 0 
AG, 0.168033, 1.793024, 0 
AG, 0.267361, 1.958912, 0 
Linear 2 Backward: 3.244, second_gemm: 3.227
Linear 2 Backward: 3.516, second_gemm: 3.504
Linear 2 Backward: 3.575, second_gemm: 3.563
Linear 2 Backward: 3.845, second_gemm: 3.832
GA, 0.168033, 1.788928, 0 
GA, 0.219697, 1.966080, 0 
GA, 0.223881, 2.041856, 0 
GA, 0.267361, 2.231296, 0 
perpare first backward gemm: 0.038,  fisrt gemm backward duration: 2.781,  weight grad: 1.535,  other: 0.41
Linear 1 Backward:  4.812
perpare first backward gemm: 0.037,  fisrt gemm backward duration: 2.591,  weight grad: 1.752,  other: 0.411
Linear 1 Backward:  4.835
perpare first backward gemm: 0.038,  fisrt gemm backward duration: 2.645,  weight grad: 1.727,  other: 0.424
Linear 1 Backward:  4.879
perpare first backward gemm: 0.039,  fisrt gemm backward duration: 2.293,  weight grad: 1.9,  other: 0.408
Linear 1 Backward:  4.686
STEP-71: step_time = 22.497407 ms, foward_time = 11.190400, backward_time = 11.208704, perf = 36.65 tflops.
start
start
start
start
block_info 288 77
block_info 268 60
block_info 264 58
block_info 244 41
cuda:1 process time:3.8754940032958984, a: 0.7212162017822266, b: 1.1510848999023438, c: 0.091552734375, d: 1.9116401672363281
cuda:2 process time:3.8530826568603516, a: 0.7419586181640625, b: 1.177072525024414, c: 0.09226799011230469, d: 1.8417835235595703
cuda:0 process time:3.7240982055664062, a: 0.7762908935546875, b: 1.1637210845947266, c: 0.10776519775390625, d: 1.676321029663086
1 wait time: 1.701
264
cuda:3 process time:4.147768020629883, a: 0.7913112640380859, b: 1.1012554168701172, c: 0.11157989501953125, d: 2.1436214447021484
2 wait time: 2.0
268
0 wait time: 2.196
288
3 wait time: 2.207
244
AG, 0.223881, 1.808384, 0 
perpare first forward gemm: 0.291,  fisrt gemm forward duration: 2.198
AG, 0.267361, 1.964032, 0 
perpare first forward gemm: 0.3,  fisrt gemm forward duration: 2.299
AG, 0.219697, 1.810432, 0 
perpare first forward gemm: 0.286,  fisrt gemm forward duration: 2.345
AG, 0.168033, 1.798144, 0 
perpare first forward gemm: 0.277,  fisrt gemm forward duration: 1.863
GA, 0.219697, 2.057216, 0 
GA, 0.223881, 2.101248, 0 
GA, 0.168033, 1.980416, 0 
GA, 0.267361, 2.309120, 0 
forward:  7.789
forward:  7.932
forward:  7.468
forward:  7.748
AG, 0.168033, 1.790976, 0 
AG, 0.223881, 1.806336, 0 
AG, 0.219697, 1.810432, 0 
AG, 0.267361, 1.954816, 0 
Linear 2 Backward: 3.353, second_gemm: 3.338
Linear 2 Backward: 3.357, second_gemm: 3.346
Linear 2 Backward: 3.649, second_gemm: 3.637
Linear 2 Backward: 3.885, second_gemm: 3.872
GA, 0.168033, 1.815552, 0 
GA, 0.223881, 1.999872, 0 
GA, 0.219697, 1.979392, 0 
GA, 0.267361, 2.204672, 0 
perpare first backward gemm: 0.032,  fisrt gemm backward duration: 2.771,  weight grad: 1.529,  other: 0.41
Linear 1 Backward:  4.786
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 2.606,  weight grad: 1.716,  other: 0.411
Linear 1 Backward:  4.813
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 2.521,  weight grad: 1.761,  other: 0.425
Linear 1 Backward:  4.789
perpare first backward gemm: 0.038,  fisrt gemm backward duration: 2.262,  weight grad: 1.903,  other: 0.408
Linear 1 Backward:  4.655
STEP-72: step_time = 22.135584 ms, foward_time = 10.879776, backward_time = 11.151360, perf = 37.25 tflops.
start
start
start
start
block_info 268 60
block_info 264 58
block_info 244 41
block_info 288 77
cuda:3 process time:3.683328628540039, a: 0.7488727569580078, b: 1.2583732604980469, c: 0.09131431579589844, d: 1.584768295288086
cuda:2 process time:3.8373470306396484, a: 0.6976127624511719, b: 1.4886856079101562, c: 0.08893013000488281, d: 1.5621185302734375
cuda:1 process time:3.8709640502929688, a: 0.7338523864746094, b: 1.4841556549072266, c: 0.08749961853027344, d: 1.5654563903808594
cuda:0 process time:3.7970542907714844, a: 0.7119178771972656, b: 1.321554183959961, c: 0.10704994201660156, d: 1.6565322875976562
1 wait time: 1.964
264
3 wait time: 2.108
244
2 wait time: 2.097
268
0 wait time: 2.179
288
AG, 0.223881, 1.798144, 0 
perpare first forward gemm: 0.291,  fisrt gemm forward duration: 1.969
AG, 0.219697, 1.804288, 0 
perpare first forward gemm: 0.291,  fisrt gemm forward duration: 2.008
AG, 0.168033, 1.786880, 0 
perpare first forward gemm: 0.259,  fisrt gemm forward duration: 2.108
AG, 0.267361, 1.961984, 0 
perpare first forward gemm: 0.299,  fisrt gemm forward duration: 2.022
GA, 0.168033, 1.874944, 0 
GA, 0.219697, 2.038784, 0 
GA, 0.223881, 2.132992, 0 
GA, 0.267361, 2.282496, 0 
forward:  7.639
forward:  7.566
forward:  7.668
forward:  7.464
AG, 0.168033, 1.788928, 0 
AG, 0.223881, 1.806336, 0 
AG, 0.219697, 1.810432, 0 
AG, 0.267361, 1.958912, 0 
Linear 2 Backward: 3.328, second_gemm: 3.311
Linear 2 Backward: 3.433, second_gemm: 3.425
Linear 2 Backward: 3.396, second_gemm: 3.389
Linear 2 Backward: 3.666, second_gemm: 3.658
GA, 0.219697, 1.924096, 0 
GA, 0.168033, 1.993728, 0 
GA, 0.223881, 2.180096, 0 
GA, 0.267361, 2.198528, 0 
perpare first backward gemm: 0.039,  fisrt gemm backward duration: 2.541,  weight grad: 1.539,  other: 0.452
Linear 1 Backward:  4.638
perpare first backward gemm: 0.028,  fisrt gemm backward duration: 2.6,  weight grad: 1.702,  other: 0.41
Linear 1 Backward:  4.776
perpare first backward gemm: 0.031,  fisrt gemm backward duration: 2.515,  weight grad: 1.739,  other: 0.416
Linear 1 Backward:  4.743
perpare first backward gemm: 0.033,  fisrt gemm backward duration: 2.25,  weight grad: 1.893,  other: 0.429
Linear 1 Backward:  4.649
STEP-73: step_time = 21.802273 ms, foward_time = 10.659104, backward_time = 10.977280, perf = 37.82 tflops.
start
start
start
start
block_info 268 60
block_info 264 58
block_info 288 77
block_info 244 41
cuda:2 process time:3.8003921508789062, a: 0.6365776062011719, b: 1.2955665588378906, c: 0.09059906005859375, d: 1.77764892578125
cuda:1 process time:3.8254261016845703, a: 0.7486343383789062, b: 1.1396408081054688, c: 0.0896453857421875, d: 1.8475055694580078
cuda:0 process time:3.743886947631836, a: 0.6780624389648438, b: 1.1014938354492188, c: 0.08893013000488281, d: 1.8754005432128906
cuda:3 process time:4.241228103637695, a: 0.7207393646240234, b: 1.4150142669677734, c: 0.11301040649414062, d: 1.9924640655517578
1 wait time: 1.636
264
2 wait time: 1.924
268
0 wait time: 1.964
288
3 wait time: 2.542
244
AG, 0.219697, 1.817600, 0 
perpare first forward gemm: 0.306,  fisrt gemm forward duration: 2.155
AG, 0.223881, 1.798144, 0 
perpare first forward gemm: 0.31,  fisrt gemm forward duration: 2.097
AG, 0.267361, 1.972224, 0 
perpare first forward gemm: 0.32,  fisrt gemm forward duration: 2.095
AG, 0.168033, 1.805312, 0 
perpare first forward gemm: 0.257,  fisrt gemm forward duration: 1.859
GA, 0.168033, 1.825792, 0 
GA, 0.219697, 2.048000, 0 
GA, 0.223881, 2.046976, 0 
GA, 0.267361, 2.296832, 0 
forward:  7.783
forward:  7.438
forward:  7.822
forward:  7.618
AG, 0.219697, 1.803264, 0 
AG, 0.223881, 1.817600, 0 
AG, 0.168033, 1.806336, 0 
AG, 0.267361, 1.967104, 0 
Linear 2 Backward: 3.264, second_gemm: 3.248
Linear 2 Backward: 3.509, second_gemm: 3.502
Linear 2 Backward: 3.5, second_gemm: 3.492
Linear 2 Backward: 3.662, second_gemm: 3.653
GA, 0.219697, 1.932288, 0 
GA, 0.168033, 1.964032, 0 
GA, 0.223881, 2.149376, 0 
GA, 0.267361, 2.149376, 0 
perpare first backward gemm: 0.027,  fisrt gemm backward duration: 2.532,  weight grad: 1.706,  other: 0.413
Linear 1 Backward:  4.713
perpare first backward gemm: 0.038,  fisrt gemm backward duration: 2.567,  weight grad: 1.541,  other: 0.444
Linear 1 Backward:  4.65
perpare first backward gemm: 0.028,  fisrt gemm backward duration: 2.51,  weight grad: 1.734,  other: 0.42
Linear 1 Backward:  4.729
perpare first backward gemm: 0.03,  fisrt gemm backward duration: 2.211,  weight grad: 1.888,  other: 0.416
Linear 1 Backward:  4.586
STEP-74: step_time = 21.574656 ms, foward_time = 10.638336, backward_time = 10.838016, perf = 38.22 tflops.
start
start
start
start
block_info 264 58
block_info 268 60
cuda:1 process time:3.3082962036132812, a: 0.5805492401123047, b: 1.2650489807128906, c: 0.06580352783203125, d: 1.3968944549560547
block_info 288 77
cuda:2 process time:3.10516357421875, a: 0.6103515625, b: 1.1734962463378906, c: 0.06771087646484375, d: 1.2536048889160156
1 wait time: 1.217
264
block_info 244 41
2 wait time: 1.737
268
cuda:0 process time:3.854513168334961, a: 0.7240772247314453, b: 1.384735107421875, c: 0.0896453857421875, d: 1.6560554504394531
0 wait time: 2.197
288
cuda:3 process time:4.103183746337891, a: 0.7665157318115234, b: 1.234292984008789, c: 0.11301040649414062, d: 1.9893646240234375
3 wait time: 2.554
244
AG, 0.219697, 1.812480, 0 
perpare first forward gemm: 0.279,  fisrt gemm forward duration: 2.986
AG, 0.223881, 1.818624, 0 
perpare first forward gemm: 0.299,  fisrt gemm forward duration: 2.644
AG, 0.168033, 1.788928, 0 
perpare first forward gemm: 0.269,  fisrt gemm forward duration: 1.847
AG, 0.267361, 1.957888, 0 
perpare first forward gemm: 0.276,  fisrt gemm forward duration: 2.46
GA, 0.168033, 1.894400, 0 
GA, 0.219697, 2.089984, 0 
GA, 0.223881, 2.134016, 0 
GA, 0.267361, 2.330624, 0 
forward:  8.49
forward:  7.364
forward:  7.796
forward:  8.227
AG, 0.168033, 1.820672, 0 
AG, 0.219697, 1.814528, 0 
AG, 0.223881, 1.814528, 0 
AG, 0.267361, 2.007040, 0 
Linear 2 Backward: 3.528, second_gemm: 3.511
Linear 2 Backward: 3.545, second_gemm: 3.528
Linear 2 Backward: 3.793, second_gemm: 3.779
Linear 2 Backward: 4.049, second_gemm: 4.03
GA, 0.168033, 1.696768, 0 
GA, 0.219697, 1.810432, 0 
GA, 0.223881, 1.947648, 0 
GA, 0.267361, 2.021376, 0 
perpare first backward gemm: 0.037,  fisrt gemm backward duration: 2.8,  weight grad: 1.539,  other: 0.443
Linear 1 Backward:  4.881
perpare first backward gemm: 0.059,  fisrt gemm backward duration: 2.488,  weight grad: 1.771,  other: 0.494
perpare first backward gemm: 0.04,  fisrt gemm backward duration: 2.605,  weight grad: 1.763,  other: 0.451
Linear 1 Backward:  4.925
Linear 1 Backward:  4.904
perpare first backward gemm: 0.062,  fisrt gemm backward duration: 2.109,  weight grad: 1.956,  other: 0.491
Linear 1 Backward:  4.707
STEP-75: step_time = 23.105761 ms, foward_time = 10.809568, backward_time = 12.190720, perf = 35.69 tflops.
start
start
start
start
block_info 264 58
block_info 268 60
block_info 244 41
block_info 288 77
cuda:2 process time:3.843545913696289, a: 0.7660388946533203, b: 1.2857913970947266, c: 0.10466575622558594, d: 1.6870498657226562
cuda:3 process time:3.921031951904297, a: 0.8168220520019531, b: 1.03759765625, c: 0.11348724365234375, d: 1.953125
cuda:1 process time:4.175424575805664, a: 0.8628368377685547, b: 1.241445541381836, c: 0.08940696716308594, d: 1.9817352294921875
cuda:0 process time:4.138946533203125, a: 0.7550716400146484, b: 1.1899471282958984, c: 0.09751319885253906, d: 2.096414566040039
2 wait time: 2.225
268
3 wait time: 1.738
244
1 wait time: 2.069
264
0 wait time: 1.829
288
AG, 0.219697, 1.809408, 0 
perpare first forward gemm: 0.316,  fisrt gemm forward duration: 1.959
AG, 0.223881, 1.809408, 0 
perpare first forward gemm: 0.278,  fisrt gemm forward duration: 2.237
AG, 0.168033, 1.795072, 0 
perpare first forward gemm: 0.307,  fisrt gemm forward duration: 2.107
AG, 0.267361, 1.968128, 0 
perpare first forward gemm: 0.327,  fisrt gemm forward duration: 2.054
GA, 0.168033, 2.003968, 0 
GA, 0.219697, 2.067456, 0 
GA, 0.223881, 2.269184, 0 
GA, 0.267361, 2.331648, 0 
forward:  7.873
forward:  7.75
forward:  7.665
forward:  7.93
AG, 0.219697, 1.806336, 0 
AG, 0.168033, 1.799168, 0 
AG, 0.223881, 1.811456, 0 
AG, 0.267361, 1.952768, 0 
Linear 2 Backward: 3.304, second_gemm: 3.288
Linear 2 Backward: 3.513, second_gemm: 3.496
Linear 2 Backward: 3.569, second_gemm: 3.558
Linear 2 Backward: 3.824, second_gemm: 3.807
GA, 0.168033, 1.713152, 0 
GA, 0.219697, 1.818624, 0 
GA, 0.223881, 1.907712, 0 
GA, 0.267361, 2.050048, 0 
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 2.737,  weight grad: 1.535,  other: 0.429
Linear 1 Backward:  4.784
perpare first backward gemm: 0.054,  fisrt gemm backward duration: 2.454,  weight grad: 1.753,  other: 0.445
perpare first backward gemm: 0.039,  fisrt gemm backward duration: 2.555,  weight grad: 1.734,  other: 0.415
Linear 1 Backward:  4.789
Linear 1 Backward:  4.77
perpare first backward gemm: 0.054,  fisrt gemm backward duration: 2.132,  weight grad: 1.94,  other: 0.428
Linear 1 Backward:  4.615
STEP-76: step_time = 22.260735 ms, foward_time = 10.556416, backward_time = 11.602944, perf = 37.04 tflops.
start
start
start
start
block_info 264 58
block_info 268 60
block_info 244 41
block_info 288 77
cuda:1 process time:4.35328483581543, a: 0.7731914520263672, b: 1.8227100372314453, c: 0.09274482727050781, d: 1.6646385192871094
cuda:2 process time:3.889799118041992, a: 0.8378028869628906, b: 1.295328140258789, c: 0.09489059448242188, d: 1.6617774963378906
1 wait time: 2.109
264
cuda:3 process time:4.599332809448242, a: 0.7364749908447266, b: 1.7733573913574219, c: 0.11277198791503906, d: 1.9767284393310547
2 wait time: 2.198
cuda:0 process time:4.374027252197266, a: 0.6592273712158203, b: 1.2874603271484375, c: 0.11467933654785156, d: 2.3126602172851562
268
3 wait time: 2.429
244
0 wait time: 2.479
288
AG, 0.219697, 1.810432, 0 
perpare first forward gemm: 0.288,  fisrt gemm forward duration: 2.441
AG, 0.223881, 1.809408, 0 
perpare first forward gemm: 0.324,  fisrt gemm forward duration: 2.187
AG, 0.168033, 1.795072, 0 
perpare first forward gemm: 0.258,  fisrt gemm forward duration: 2.136
AG, 0.267361, 1.968128, 0 
perpare first forward gemm: 0.299,  fisrt gemm forward duration: 2.029
GA, 0.168033, 1.816576, 0 
GA, 0.219697, 2.035712, 0 
GA, 0.223881, 2.042880, 0 
GA, 0.267361, 2.269184, 0 
forward:  7.847
forward:  7.679
forward:  8.031
forward:  7.434
AG, 0.223881, 1.801216, 0 
AG, 0.168033, 1.792000, 0 
AG, 0.219697, 1.835008, 0 
AG, 0.267361, 1.988608, 0 
Linear 2 Backward: 3.656, second_gemm: 3.642
Linear 2 Backward: 3.884, second_gemm: 3.876
Linear 2 Backward: 3.647, second_gemm: 3.629
Linear 2 Backward: 3.861, second_gemm: 3.844
GA, 0.168033, 1.942528, 0 
GA, 0.223881, 2.156544, 0 
GA, 0.219697, 2.021376, 0 
GA, 0.267361, 2.226176, 0 
perpare first backward gemm: 0.032,  fisrt gemm backward duration: 3.008,  weight grad: 1.527,  other: 0.43
Linear 1 Backward:  5.049
perpare first backward gemm: 0.027,  fisrt gemm backward duration: 2.96,  weight grad: 1.704,  other: 0.421
Linear 1 Backward:  5.15
perpare first backward gemm: 0.056,  fisrt gemm backward duration: 2.519,  weight grad: 1.752,  other: 0.426
Linear 1 Backward:  4.818
perpare first backward gemm: 0.057,  fisrt gemm backward duration: 2.289,  weight grad: 1.901,  other: 0.429
Linear 1 Backward:  4.737
STEP-77: step_time = 22.757376 ms, foward_time = 10.910720, backward_time = 11.746304, perf = 36.24 tflops.
start
start
start
start
block_info 288 77
cuda:0 process time:2.994060516357422, a: 0.6554126739501953, b: 1.155853271484375, c: 0.0629425048828125, d: 1.119852066040039
block_info 264 58
block_info 268 60
0 wait time: 1.611
288
cuda:1 process time:3.5943984985351562, a: 0.7288455963134766, b: 1.0600090026855469, c: 0.08606910705566406, d: 1.7194747924804688
block_info 244 41
cuda:2 process time:3.792285919189453, a: 0.7314682006835938, b: 1.280069351196289, c: 0.09393692016601562, d: 1.6868114471435547
1 wait time: 1.746
264
cuda:3 process time:4.069805145263672, a: 0.7410049438476562, b: 1.1942386627197266, c: 0.11110305786132812, d: 2.023458480834961
2 wait time: 2.237
268
3 wait time: 2.629
244
AG, 0.219697, 1.814528, 0 
perpare first forward gemm: 0.281,  fisrt gemm forward duration: 2.497
AG, 0.223881, 1.805312, 0 
perpare first forward gemm: 0.305,  fisrt gemm forward duration: 2.048
AG, 0.168033, 1.794048, 0 
perpare first forward gemm: 0.258,  fisrt gemm forward duration: 1.848
AG, 0.267361, 1.966080, 0 
perpare first forward gemm: 0.287,  fisrt gemm forward duration: 3.021
GA, 0.168033, 1.840128, 0 
GA, 0.219697, 2.060288, 0 
GA, 0.223881, 2.107392, 0 
GA, 0.267361, 2.301952, 0 
forward:  8.032
forward:  7.349
forward:  8.405
forward:  7.65
AG, 0.168033, 1.793024, 0 
AG, 0.219697, 1.836032, 0 
AG, 0.223881, 1.799168, 0 
AG, 0.267361, 1.998848, 0 
Linear 2 Backward: 3.589, second_gemm: 3.573
Linear 2 Backward: 3.994, second_gemm: 3.986
Linear 2 Backward: 3.645, second_gemm: 3.627
Linear 2 Backward: 3.902, second_gemm: 3.884
GA, 0.168033, 1.997824, 0 
GA, 0.223881, 2.197504, 0 
GA, 0.219697, 1.969152, 0 
GA, 0.267361, 2.183168, 0 
perpare first backward gemm: 0.037,  fisrt gemm backward duration: 2.944,  weight grad: 1.541,  other: 0.445
Linear 1 Backward:  5.028
perpare first backward gemm: 0.027,  fisrt gemm backward duration: 2.963,  weight grad: 1.7,  other: 0.409
Linear 1 Backward:  5.135
perpare first backward gemm: 0.059,  fisrt gemm backward duration: 2.523,  weight grad: 1.753,  other: 0.448
Linear 1 Backward:  4.851
perpare first backward gemm: 0.059,  fisrt gemm backward duration: 2.248,  weight grad: 1.897,  other: 0.439
Linear 1 Backward:  4.708
STEP-78: step_time = 22.902464 ms, foward_time = 10.934976, backward_time = 11.854848, perf = 36.01 tflops.
start
start
start
start
block_info 268 60
block_info 244 41
block_info 264 58
block_info 288 77
cuda:2 process time:3.729104995727539, a: 0.7541179656982422, b: 1.2023448944091797, c: 0.10371208190917969, d: 1.6689300537109375
cuda:3 process time:4.192829132080078, a: 0.7576942443847656, b: 1.3265609741210938, c: 0.12564659118652344, d: 1.9829273223876953
2 wait time: 2.208
268
cuda:0 process time:4.2934417724609375, a: 0.6873607635498047, b: 1.2960433959960938, c: 0.11610984802246094, d: 2.193927764892578
cuda:1 process time:4.379034042358398, a: 0.6246566772460938, b: 1.299142837524414, c: 0.118255615234375, d: 2.3369789123535156
3 wait time: 2.559
244
1 wait time: 2.064
264
0 wait time: 2.019
288
AG, 0.168033, 1.793024, 0 
perpare first forward gemm: 0.258,  fisrt gemm forward duration: 2.147
AG, 0.223881, 1.800192, 0 
perpare first forward gemm: 0.281,  fisrt gemm forward duration: 2.433
AG, 0.219697, 1.815552, 0 
perpare first forward gemm: 0.297,  fisrt gemm forward duration: 2.055
AG, 0.267361, 1.969152, 0 
perpare first forward gemm: 0.326,  fisrt gemm forward duration: 2.044
GA, 0.168033, 1.922048, 0 
GA, 0.219697, 1.989632, 0 
GA, 0.223881, 2.146304, 0 
GA, 0.267361, 2.211840, 0 
forward:  7.706
forward:  7.657
forward:  7.543
forward:  8.044
AG, 0.219697, 1.818624, 0 
AG, 0.168033, 1.788928, 0 
AG, 0.223881, 1.808384, 0 
AG, 0.267361, 1.971200, 0 
Linear 2 Backward: 3.381, second_gemm: 3.365
Linear 2 Backward: 3.499, second_gemm: 3.49
Linear 2 Backward: 3.531, second_gemm: 3.517
Linear 2 Backward: 3.8, second_gemm: 3.786
GA, 0.168033, 1.934336, 0 
GA, 0.223881, 2.104320, 0 
GA, 0.219697, 1.978368, 0 
GA, 0.267361, 2.178048, 0 
perpare first backward gemm: 0.037,  fisrt gemm backward duration: 2.804,  weight grad: 1.533,  other: 0.412
Linear 1 Backward:  4.832
perpare first backward gemm: 0.027,  fisrt gemm backward duration: 2.772,  weight grad: 1.702,  other: 0.412
Linear 1 Backward:  4.951
perpare first backward gemm: 0.038,  fisrt gemm backward duration: 2.519,  weight grad: 1.757,  other: 0.441
Linear 1 Backward:  4.806
perpare first backward gemm: 0.039,  fisrt gemm backward duration: 2.237,  weight grad: 1.909,  other: 0.43
Linear 1 Backward:  4.664
STEP-79: step_time = 22.044672 ms, foward_time = 10.475520, backward_time = 11.469824, perf = 37.41 tflops.
start
start
start
start
block_info 288 77
block_info 268 60
block_info 244 41
block_info 264 58
cuda:2 process time:3.8118362426757812, a: 0.6787776947021484, b: 1.039743423461914, c: 0.09393692016601562, d: 1.9993782043457031
cuda:0 process time:3.9751529693603516, a: 0.7851123809814453, b: 1.21307373046875, c: 0.10180473327636719, d: 1.875162124633789
cuda:3 process time:4.456043243408203, a: 0.759124755859375, b: 1.5194416046142578, c: 0.11372566223144531, d: 2.063751220703125
cuda:1 process time:4.417896270751953, a: 0.7736682891845703, b: 1.485586166381836, c: 0.11086463928222656, d: 2.0477771759033203
2 wait time: 1.833
268
0 wait time: 2.425
288
1 wait time: 2.529
3 wait time: 2.601
244
264
AG, 0.223881, 1.801216, 0 
perpare first forward gemm: 0.319,  fisrt gemm forward duration: 2.072
AG, 0.168033, 1.797120, 0 
perpare first forward gemm: 0.261,  fisrt gemm forward duration: 1.942
AG, 0.219697, 1.815552, 0 
perpare first forward gemm: 0.289,  fisrt gemm forward duration: 1.882
AG, 0.267361, 1.979392, 0 
perpare first forward gemm: 0.304,  fisrt gemm forward duration: 2.184
GA, 0.168033, 1.840128, 0 
GA, 0.219697, 2.014208, 0 
GA, 0.223881, 2.072576, 0 
GA, 0.267361, 2.273280, 0 
forward:  7.722
forward:  7.482
forward:  7.479
forward:  7.628
AG, 0.219697, 1.818624, 0 
AG, 0.223881, 1.800192, 0 
AG, 0.168033, 1.790976, 0 
AG, 0.267361, 1.965056, 0 
Linear 2 Backward: 3.262, second_gemm: 3.248
Linear 2 Backward: 3.583, second_gemm: 3.575
Linear 2 Backward: 3.482, second_gemm: 3.469
Linear 2 Backward: 3.782, second_gemm: 3.771
GA, 0.168033, 1.920000, 0 
GA, 0.219697, 1.893376, 0 
GA, 0.223881, 2.152448, 0 
GA, 0.267361, 2.173952, 0 
perpare first backward gemm: 0.031,  fisrt gemm backward duration: 2.852,  weight grad: 1.523,  other: 0.41
Linear 1 Backward:  4.859
perpare first backward gemm: 0.028,  fisrt gemm backward duration: 2.772,  weight grad: 1.703,  other: 0.41
Linear 1 Backward:  4.952
perpare first backward gemm: 0.04,  fisrt gemm backward duration: 2.553,  weight grad: 1.762,  other: 0.441
Linear 1 Backward:  4.853
perpare first backward gemm: 0.043,  fisrt gemm backward duration: 2.236,  weight grad: 1.947,  other: 0.443
Linear 1 Backward:  4.724
STEP-80: step_time = 22.609888 ms, foward_time = 10.990561, backward_time = 11.518976, perf = 36.47 tflops.
start
start
start
start
block_info 288 77
block_info 268 60
block_info 244 41
block_info 264 58
cuda:0 process time:3.655672073364258, a: 0.9219646453857422, b: 0.9891986846923828, c: 0.09107589721679688, d: 1.653432846069336
cuda:2 process time:3.9925575256347656, a: 0.7157325744628906, b: 1.4767646789550781, c: 0.10967254638671875, d: 1.6903877258300781
cuda:3 process time:4.159450531005859, a: 0.7207393646240234, b: 1.5611648559570312, c: 0.10323524475097656, d: 1.7743110656738281
0 wait time: 2.222
288
cuda:1 process time:4.294872283935547, a: 0.6279945373535156, b: 1.3475418090820312, c: 0.110626220703125, d: 2.208709716796875
2 wait time: 2.194
268
3 wait time: 2.256
244
1 wait time: 2.249
264
AG, 0.223881, 1.797120, 0 
perpare first forward gemm: 0.294,  fisrt gemm forward duration: 2.107
AG, 0.168033, 1.797120, 0 
perpare first forward gemm: 0.26,  fisrt gemm forward duration: 2.073
AG, 0.219697, 1.814528, 0 
perpare first forward gemm: 0.278,  fisrt gemm forward duration: 1.873
AG, 0.267361, 1.984512, 0 
perpare first forward gemm: 0.318,  fisrt gemm forward duration: 2.382
GA, 0.168033, 1.883136, 0 
GA, 0.219697, 2.003968, 0 
GA, 0.223881, 2.104320, 0 
GA, 0.267361, 2.305024, 0 
forward:  7.409
forward:  7.587
forward:  7.821
forward:  7.709
AG, 0.168033, 1.789952, 0 
AG, 0.219697, 1.843200, 0 
AG, 0.223881, 1.799168, 0 
AG, 0.267361, 1.990656, 0 
Linear 2 Backward: 3.662, second_gemm: 3.645
Linear 2 Backward: 3.85, second_gemm: 3.842
Linear 2 Backward: 3.679, second_gemm: 3.661
Linear 2 Backward: 3.906, second_gemm: 3.888
GA, 0.168033, 1.958912, 0 
GA, 0.223881, 2.208768, 0 
GA, 0.219697, 1.953792, 0 
GA, 0.267361, 2.230272, 0 
perpare first backward gemm: 0.04,  fisrt gemm backward duration: 2.999,  weight grad: 1.536,  other: 0.466
Linear 1 Backward:  5.106
perpare first backward gemm: 0.027,  fisrt gemm backward duration: 3.013,  weight grad: 1.7,  other: 0.422
Linear 1 Backward:  5.198
perpare first backward gemm: 0.06,  fisrt gemm backward duration: 2.543,  weight grad: 1.753,  other: 0.426
Linear 1 Backward:  4.848
perpare first backward gemm: 0.06,  fisrt gemm backward duration: 2.296,  weight grad: 1.922,  other: 0.43
Linear 1 Backward:  4.773
STEP-81: step_time = 22.973057 ms, foward_time = 10.911360, backward_time = 11.961344, perf = 35.90 tflops.
start
start
start
start
block_info 288 77
block_info 268 60
block_info 264 58
block_info 244 41
cuda:0 process time:3.725290298461914, a: 0.7507801055908203, b: 1.1675357818603516, c: 0.09202957153320312, d: 1.714944839477539
cuda:2 process time:3.887653350830078, a: 0.6432533264160156, b: 1.3778209686279297, c: 0.09465217590332031, d: 1.7719268798828125
0 wait time: 2.234
288
2 wait time: 1.928
268
cuda:3 process time:4.3125152587890625, a: 0.7739067077636719, b: 1.359701156616211, c: 0.1552104949951172, d: 2.0236968994140625
cuda:1 process time:4.374504089355469, a: 0.8652210235595703, b: 1.325368881225586, c: 0.11444091796875, d: 2.0694732666015625
1 wait time: 2.557
264
3 wait time: 2.699
244
AG, 0.267361, 1.980416, 0 
perpare first forward gemm: 0.293,  fisrt gemm forward duration: 2.686
AG, 0.219697, 1.816576, 0 
perpare first forward gemm: 0.317,  fisrt gemm forward duration: 1.926
AG, 0.223881, 1.800192, 0 
perpare first forward gemm: 0.278,  fisrt gemm forward duration: 2.416
AG, 0.168033, 1.796096, 0 
perpare first forward gemm: 0.295,  fisrt gemm forward duration: 1.866
GA, 0.223881, 2.187264, 0 
GA, 0.168033, 1.972224, 0 
GA, 0.219697, 2.142208, 0 
GA, 0.267361, 2.388992, 0 
forward:  7.676
forward:  7.602
forward:  8.172
forward:  8.091
AG, 0.168033, 1.802240, 0 
AG, 0.219697, 1.818624, 0 
AG, 0.223881, 1.797120, 0 
AG, 0.267361, 1.994752, 0 
Linear 2 Backward: 3.621, second_gemm: 3.614
Linear 2 Backward: 3.502, second_gemm: 3.486
Linear 2 Backward: 3.682, second_gemm: 3.664
Linear 2 Backward: 3.916, second_gemm: 3.9
GA, 0.168033, 1.974272, 0 
GA, 0.223881, 2.196480, 0 
GA, 0.219697, 1.971200, 0 
GA, 0.267361, 2.206720, 0 
perpare first backward gemm: 0.035,  fisrt gemm backward duration: 3.057,  weight grad: 1.534,  other: 0.411
Linear 1 Backward:  5.082
perpare first backward gemm: 0.028,  fisrt gemm backward duration: 3.038,  weight grad: 1.702,  other: 0.412
Linear 1 Backward:  5.217
perpare first backward gemm: 0.06,  fisrt gemm backward duration: 2.566,  weight grad: 1.805,  other: 0.429
Linear 1 Backward:  4.929
perpare first backward gemm: 0.06,  fisrt gemm backward duration: 2.293,  weight grad: 1.967,  other: 0.443
Linear 1 Backward:  4.828
STEP-82: step_time = 23.181633 ms, foward_time = 11.246912, backward_time = 11.834368, perf = 35.57 tflops.
start
start
start
start
block_info 244 41
block_info 288 77
cuda:3 process time:3.807544708251953, a: 0.7627010345458984, b: 1.215219497680664, c: 0.09250640869140625, d: 1.7371177673339844
block_info 264 58
cuda:0 process time:3.96728515625, a: 0.7643699645996094, b: 1.1754035949707031, c: 0.09822845458984375, d: 1.9292831420898438
block_info 268 60
3 wait time: 1.883
244
0 wait time: 2.048
288
cuda:1 process time:4.194736480712891, a: 0.7555484771728516, b: 1.2791156768798828, c: 0.11229515075683594, d: 2.0477771759033203
cuda:2 process time:4.421472549438477, a: 0.7543563842773438, b: 1.172780990600586, c: 0.1609325408935547, d: 2.333402633666992
1 wait time: 2.543
264
2 wait time: 2.118
268
AG, 0.219697, 1.813504, 0 
perpare first forward gemm: 0.289,  fisrt gemm forward duration: 2.027
AG, 0.267361, 1.977344, 0 
perpare first forward gemm: 0.303,  fisrt gemm forward duration: 2.668
AG, 0.168033, 1.807360, 0 
perpare first forward gemm: 0.259,  fisrt gemm forward duration: 2.732
AG, 0.223881, 1.807360, 0 
perpare first forward gemm: 0.319,  fisrt gemm forward duration: 1.882
GA, 0.168033, 1.804288, 0 
GA, 0.219697, 1.973248, 0 
GA, 0.223881, 2.143232, 0 
GA, 0.267361, 2.223104, 0 
forward:  7.641
forward:  8.223
forward:  7.482
forward:  8.063
AG, 0.223881, 1.804288, 0 
AG, 0.219697, 1.817600, 0 
AG, 0.168033, 1.800192, 0 
AG, 0.267361, 1.971200, 0 
Linear 2 Backward: 3.368, second_gemm: 3.353
Linear 2 Backward: 3.659, second_gemm: 3.651
Linear 2 Backward: 3.494, second_gemm: 3.48
Linear 2 Backward: 3.83, second_gemm: 3.815
GA, 0.168033, 1.682432, 0 
GA, 0.219697, 1.810432, 0 
GA, 0.223881, 1.868800, 0 
GA, 0.267361, 2.021376, 0 
perpare first backward gemm: 0.033,  fisrt gemm backward duration: 2.739,  weight grad: 1.527,  other: 0.43
Linear 1 Backward:  4.781
perpare first backward gemm: 0.026,  fisrt gemm backward duration: 2.641,  weight grad: 1.735,  other: 0.419
Linear 1 Backward:  4.858
perpare first backward gemm: 0.049,  fisrt gemm backward duration: 2.448,  weight grad: 1.749,  other: 0.462
Linear 1 Backward:  4.781
perpare first backward gemm: 0.053,  fisrt gemm backward duration: 2.097,  weight grad: 1.947,  other: 0.464
Linear 1 Backward:  4.63
STEP-83: step_time = 22.876160 ms, foward_time = 11.068416, backward_time = 11.707392, perf = 36.05 tflops.
start
start
start
start
block_info 244 41
block_info 268 60
cuda:3 process time:3.258943557739258, a: 0.5691051483154297, b: 1.3284683227539062, c: 0.07295608520507812, d: 1.2884140014648438
cuda:2 process time:3.4928321838378906, a: 0.5939006805419922, b: 1.3210773468017578, c: 0.06270408630371094, d: 1.5151500701904297
block_info 288 77
3 wait time: 1.332
244
block_info 264 58
2 wait time: 1.033
268
cuda:0 process time:3.860950469970703, a: 0.6787776947021484, b: 1.0123252868652344, c: 0.09441375732421875, d: 2.0754337310791016
cuda:1 process time:4.423379898071289, a: 0.7808208465576172, b: 1.3284683227539062, c: 0.11277198791503906, d: 2.2013187408447266
0 wait time: 1.956
288
1 wait time: 2.211
264
AG, 0.168033, 1.794048, 0 
perpare first forward gemm: 0.257,  fisrt gemm forward duration: 2.925
AG, 0.223881, 1.801216, 0 
perpare first forward gemm: 0.313,  fisrt gemm forward duration: 2.631
AG, 0.219697, 1.804288, 0 
perpare first forward gemm: 0.279,  fisrt gemm forward duration: 1.913
AG, 0.267361, 1.980416, 0 
perpare first forward gemm: 0.324,  fisrt gemm forward duration: 2.044
GA, 0.219697, 2.000896, 0 
GA, 0.168033, 1.941504, 0 
GA, 0.223881, 2.158592, 0 
GA, 0.267361, 2.244608, 0 
forward:  8.379
forward:  8.18
forward:  7.4
forward:  7.46
AG, 0.219697, 1.814528, 0 
AG, 0.168033, 1.804288, 0 
AG, 0.223881, 1.815552, 0 
AG, 0.267361, 1.967104, 0 
Linear 2 Backward: 3.427, second_gemm: 3.41
Linear 2 Backward: 3.941, second_gemm: 3.933
Linear 2 Backward: 3.575, second_gemm: 3.557
Linear 2 Backward: 3.896, second_gemm: 3.878
GA, 0.168033, 1.690624, 0 
GA, 0.219697, 1.811456, 0 
GA, 0.223881, 1.873920, 0 
GA, 0.267361, 2.045952, 0 
perpare first backward gemm: 0.037,  fisrt gemm backward duration: 2.783,  weight grad: 1.508,  other: 0.412
Linear 1 Backward:  4.789
perpare first backward gemm: 0.026,  fisrt gemm backward duration: 2.755,  weight grad: 1.731,  other: 0.406
Linear 1 Backward:  4.954
perpare first backward gemm: 0.057,  fisrt gemm backward duration: 2.465,  weight grad: 1.765,  other: 0.488
Linear 1 Backward:  4.862
perpare first backward gemm: 0.061,  fisrt gemm backward duration: 2.132,  weight grad: 1.981,  other: 0.483
Linear 1 Backward:  4.774
STEP-84: step_time = 22.765568 ms, foward_time = 10.402816, backward_time = 12.259328, perf = 36.22 tflops.
start
start
start
start
block_info 244 41
block_info 264 58
cuda:3 process time:5.471467971801758, a: 0.7328987121582031, b: 2.532958984375, c: 0.091552734375, d: 2.1140575408935547
block_info 268 60
cuda:1 process time:5.824089050292969, a: 0.8742809295654297, b: 2.5632381439208984, c: 0.11038780212402344, d: 2.276182174682617
block_info 288 77
3 wait time: 2.747
244
1 wait time: 2.282
264
cuda:2 process time:4.99272346496582, a: 0.9238719940185547, b: 1.2967586517333984, c: 0.1385211944580078, d: 2.6335716247558594
cuda:0 process time:6.298303604125977, a: 0.7669925689697266, b: 3.2911300659179688, c: 0.15664100646972656, d: 2.0835399627685547
2 wait time: 3.422
268
0 wait time: 2.969
288
AG, 0.219697, 1.820672, 0 
perpare first forward gemm: 0.317,  fisrt gemm forward duration: 2.678
AG, 0.168033, 1.800192, 0 
perpare first forward gemm: 0.258,  fisrt gemm forward duration: 2.991
AG, 0.223881, 1.793024, 0 
perpare first forward gemm: 0.282,  fisrt gemm forward duration: 2.156
AG, 0.267361, 1.985536, 0 
perpare first forward gemm: 0.308,  fisrt gemm forward duration: 2.057
GA, 0.219697, 2.018304, 0 
GA, 0.168033, 1.928192, 0 
GA, 0.223881, 2.157568, 0 
GA, 0.267361, 2.256896, 0 
forward:  8.465
forward:  8.298
forward:  7.475
forward:  7.732
AG, 0.219697, 1.811456, 0 
AG, 0.168033, 1.805312, 0 
AG, 0.223881, 1.811456, 0 
AG, 0.267361, 1.959936, 0 
Linear 2 Backward: 3.279, second_gemm: 3.26
Linear 2 Backward: 3.397, second_gemm: 3.389
Linear 2 Backward: 3.769, second_gemm: 3.761
Linear 2 Backward: 3.726, second_gemm: 3.715
GA, 0.219697, 1.885184, 0 
GA, 0.168033, 1.916928, 0 
GA, 0.223881, 2.158592, 0 
GA, 0.267361, 2.105344, 0 
perpare first backward gemm: 0.039,  fisrt gemm backward duration: 2.583,  weight grad: 1.539,  other: 0.452
Linear 1 Backward:  4.678
perpare first backward gemm: 0.027,  fisrt gemm backward duration: 2.533,  weight grad: 1.733,  other: 0.405
Linear 1 Backward:  4.732
perpare first backward gemm: 0.037,  fisrt gemm backward duration: 2.509,  weight grad: 1.721,  other: 0.447
Linear 1 Backward:  4.765
perpare first backward gemm: 0.04,  fisrt gemm backward duration: 2.162,  weight grad: 1.921,  other: 0.434
Linear 1 Backward:  4.606
STEP-85: step_time = 23.176192 ms, foward_time = 11.717632, backward_time = 11.348992, perf = 35.58 tflops.
start
start
start
start
block_info 268 60
cuda:2 process time:3.4368038177490234, a: 0.6158351898193359, b: 1.444101333618164, c: 0.059604644775390625, d: 1.3172626495361328
block_info 244 41
block_info 288 77
2 wait time: 1.129
268
block_info 264 58
cuda:0 process time:4.003763198852539, a: 0.7524490356445312, b: 1.2395381927490234, c: 0.0972747802734375, d: 1.9145011901855469
cuda:3 process time:4.324436187744141, a: 0.9856224060058594, b: 1.3697147369384766, c: 0.10704994201660156, d: 1.8620491027832031
cuda:1 process time:4.406452178955078, a: 0.8587837219238281, b: 1.3537406921386719, c: 0.11181831359863281, d: 2.0821094512939453
3 wait time: 2.707
244
0 wait time: 2.496
288
1 wait time: 2.816
264
AG, 0.267361, 1.968128, 0 
perpare first forward gemm: 0.291,  fisrt gemm forward duration: 2.059
AG, 0.223881, 1.804288, 0 
perpare first forward gemm: 0.279,  fisrt gemm forward duration: 2.896
AG, 0.168033, 1.782784, 0 
perpare first forward gemm: 0.259,  fisrt gemm forward duration: 1.959
AG, 0.219697, 1.809408, 0 
perpare first forward gemm: 0.277,  fisrt gemm forward duration: 1.866
GA, 0.168033, 1.869824, 0 
GA, 0.219697, 2.048000, 0 
GA, 0.223881, 2.097152, 0 
GA, 0.267361, 2.296832, 0 
forward:  7.483
forward:  7.413
forward:  7.446
forward:  8.448
AG, 0.219697, 1.808384, 0 
AG, 0.168033, 1.798144, 0 
AG, 0.223881, 1.818624, 0 
AG, 0.267361, 1.976320, 0 
Linear 2 Backward: 3.34, second_gemm: 3.324
Linear 2 Backward: 3.793, second_gemm: 3.785
Linear 2 Backward: 3.503, second_gemm: 3.489
Linear 2 Backward: 3.882, second_gemm: 3.865
GA, 0.168033, 1.694720, 0 
GA, 0.219697, 1.815552, 0 
GA, 0.223881, 1.894400, 0 
GA, 0.267361, 2.034688, 0 
perpare first backward gemm: 0.033,  fisrt gemm backward duration: 2.809,  weight grad: 1.513,  other: 0.422
Linear 1 Backward:  4.822
perpare first backward gemm: 0.026,  fisrt gemm backward duration: 2.69,  weight grad: 1.74,  other: 0.421
Linear 1 Backward:  4.913
perpare first backward gemm: 0.053,  fisrt gemm backward duration: 2.462,  weight grad: 1.76,  other: 0.478
Linear 1 Backward:  4.818
perpare first backward gemm: 0.059,  fisrt gemm backward duration: 2.116,  weight grad: 1.958,  other: 0.475
Linear 1 Backward:  4.669
STEP-86: step_time = 22.642689 ms, foward_time = 10.864640, backward_time = 11.677696, perf = 36.42 tflops.
start
start
start
start
block_info 244 41
block_info 268 60
block_info 288 77
cuda:3 process time:3.917217254638672, a: 0.7281303405761719, b: 1.6536712646484375, c: 0.08320808410644531, d: 1.4522075653076172
cuda:2 process time:3.660440444946289, a: 0.6151199340820312, b: 1.2972354888916016, c: 0.07009506225585938, d: 1.6779899597167969
block_info 264 58
cuda:0 process time:3.7462711334228516, a: 0.7596015930175781, b: 1.0411739349365234, c: 0.09012222290039062, d: 1.8553733825683594
2 wait time: 1.093
268
3 wait time: 1.937
244
cuda:1 process time:4.614830017089844, a: 0.732421875, b: 1.5456676483154297, c: 0.110626220703125, d: 2.226114273071289
0 wait time: 2.074
288
1 wait time: 2.217
264
AG, 0.168033, 1.787904, 0 
perpare first forward gemm: 0.267,  fisrt gemm forward duration: 2.465
AG, 0.267361, 1.969152, 0 
perpare first forward gemm: 0.332,  fisrt gemm forward duration: 2.263
AG, 0.223881, 1.801216, 0 
perpare first forward gemm: 0.321,  fisrt gemm forward duration: 2.422
AG, 0.219697, 1.807360, 0 
perpare first forward gemm: 0.291,  fisrt gemm forward duration: 1.87
GA, 0.168033, 1.831936, 0 
GA, 0.219697, 1.991680, 0 
GA, 0.223881, 2.046976, 0 
GA, 0.267361, 2.273280, 0 
forward:  7.468
forward:  8.081
forward:  7.75
forward:  8.043
AG, 0.223881, 1.817600, 0 
AG, 0.219697, 1.812480, 0 
AG, 0.168033, 1.805312, 0 
AG, 0.267361, 1.965056, 0 
Linear 2 Backward: 3.308, second_gemm: 3.291
Linear 2 Backward: 3.689, second_gemm: 3.681
Linear 2 Backward: 3.468, second_gemm: 3.453
Linear 2 Backward: 3.765, second_gemm: 3.75
GA, 0.168033, 1.858560, 0 
GA, 0.219697, 1.802240, 0 
GA, 0.223881, 2.070528, 0 
GA, 0.267361, 2.062336, 0 
perpare first backward gemm: 0.038,  fisrt gemm backward duration: 2.603,  weight grad: 1.547,  other: 0.41
Linear 1 Backward:  4.648
perpare first backward gemm: 0.041,  fisrt gemm backward duration: 2.453,  weight grad: 1.727,  other: 0.432
Linear 1 Backward:  4.706
perpare first backward gemm: 0.026,  fisrt gemm backward duration: 2.573,  weight grad: 1.739,  other: 0.46
Linear 1 Backward:  4.846
perpare first backward gemm: 0.045,  fisrt gemm backward duration: 2.139,  weight grad: 1.924,  other: 0.436
Linear 1 Backward:  4.595
STEP-87: step_time = 22.265856 ms, foward_time = 10.740736, backward_time = 11.424768, perf = 37.04 tflops.
start
start
start
start
block_info 264 58
cuda:1 process time:3.2181739807128906, a: 0.5676746368408203, b: 1.2705326080322266, c: 0.059604644775390625, d: 1.3203620910644531
block_info 288 77
1 wait time: 1.121
264
block_info 268 60
block_info 244 41
cuda:0 process time:3.8089752197265625, a: 0.7662773132324219, b: 1.3129711151123047, c: 0.09131431579589844, d: 1.6384124755859375
0 wait time: 2.159
288
cuda:2 process time:4.354000091552734, a: 0.6990432739257812, b: 1.3523101806640625, c: 0.11515617370605469, d: 2.187490463256836
cuda:3 process time:4.091024398803711, a: 0.7534027099609375, b: 1.1980533599853516, c: 0.11110305786132812, d: 2.0284652709960938
2 wait time: 2.256
268
3 wait time: 2.819
244
AG, 0.267361, 1.974272, 0 
perpare first forward gemm: 0.3,  fisrt gemm forward duration: 2.417
AG, 0.219697, 1.810432, 0 
perpare first forward gemm: 0.284,  fisrt gemm forward duration: 3.075
AG, 0.223881, 1.800192, 0 
perpare first forward gemm: 0.281,  fisrt gemm forward duration: 1.928
AG, 0.168033, 1.798144, 0 
perpare first forward gemm: 0.256,  fisrt gemm forward duration: 1.85
GA, 0.219697, 2.048000, 0 
GA, 0.168033, 1.965056, 0 
GA, 0.223881, 2.245632, 0 
GA, 0.267361, 2.283520, 0 
forward:  7.474
forward:  8.627
forward:  7.839
forward:  7.381
AG, 0.219697, 1.814528, 0 
AG, 0.223881, 1.818624, 0 
AG, 0.168033, 1.803264, 0 
AG, 0.267361, 1.958912, 0 
Linear 2 Backward: 3.252, second_gemm: 3.239
Linear 2 Backward: 3.428, second_gemm: 3.416
Linear 2 Backward: 3.633, second_gemm: 3.624
Linear 2 Backward: 3.727, second_gemm: 3.715
GA, 0.168033, 1.759232, 0 
GA, 0.219697, 1.841152, 0 
GA, 0.223881, 1.976320, 0 
GA, 0.267361, 2.094080, 0 
perpare first backward gemm: 0.03,  fisrt gemm backward duration: 2.722,  weight grad: 1.519,  other: 0.42
Linear 1 Backward:  4.737
perpare first backward gemm: 0.041,  fisrt gemm backward duration: 2.476,  weight grad: 1.733,  other: 0.439
perpare first backward gemm: 0.026,  fisrt gemm backward duration: 2.552,  weight grad: 1.735,  other: 0.406
Linear 1 Backward:  4.754
Linear 1 Backward:  4.746
perpare first backward gemm: 0.042,  fisrt gemm backward duration: 2.159,  weight grad: 1.928,  other: 0.44
Linear 1 Backward:  4.625
STEP-88: step_time = 22.439999 ms, foward_time = 10.862656, backward_time = 11.476992, perf = 36.75 tflops.
start
start
start
start
block_info 268 60
cuda:2 process time:3.8537979125976562, a: 0.5807876586914062, b: 1.7294883728027344, c: 0.06103515625, d: 1.4824867248535156
block_info 264 58
block_info 288 77
2 wait time: 0.994
268
block_info 244 41
cuda:1 process time:3.9751529693603516, a: 0.7839202880859375, b: 1.3849735260009766, c: 0.11968612670898438, d: 1.6865730285644531
cuda:0 process time:3.991365432739258, a: 0.8170604705810547, b: 1.3172626495361328, c: 0.09608268737792969, d: 1.7609596252441406
1 wait time: 2.084
264
cuda:3 process time:4.723548889160156, a: 0.70953369140625, b: 1.8799304962158203, c: 0.11706352233886719, d: 2.0170211791992188
0 wait time: 2.371
288
3 wait time: 2.563
244
AG, 0.223881, 1.799168, 0 
AG, 0.168033, 1.793024, 0 
perpare first forward gemm: 0.256,  fisrt gemm forward duration: 1.859
AG, 0.219697, 1.815552, 0 
perpare first forward gemm: 0.308,  fisrt gemm forward duration: 2.173
perpare first forward gemm: 0.311,  fisrt gemm forward duration: 2.738
AG, 0.267361, 1.988608, 0 
perpare first forward gemm: 0.327,  fisrt gemm forward duration: 2.051
GA, 0.168033, 1.963008, 0 
GA, 0.219697, 2.022400, 0 
GA, 0.223881, 2.202624, 0 
GA, 0.267361, 2.281472, 0 
forward:  8.337
forward:  7.789
forward:  7.356
forward:  7.526
AG, 0.168033, 1.808384, 0 
AG, 0.223881, 1.819648, 0 
AG, 0.219697, 1.802240, 0 
AG, 0.267361, 1.977344, 0 
Linear 2 Backward: 3.376, second_gemm: 3.36
Linear 2 Backward: 3.815, second_gemm: 3.808
Linear 2 Backward: 3.55, second_gemm: 3.532
Linear 2 Backward: 3.873, second_gemm: 3.856
GA, 0.168033, 1.696768, 0 
GA, 0.219697, 1.816576, 0 
GA, 0.223881, 1.908736, 0 
GA, 0.267361, 2.048000, 0 
perpare first backward gemm: 0.037,  fisrt gemm backward duration: 2.798,  weight grad: 1.511,  other: 0.41
Linear 1 Backward:  4.804
perpare first backward gemm: 0.03,  fisrt gemm backward duration: 2.738,  weight grad: 1.733,  other: 0.407
Linear 1 Backward:  4.943
perpare first backward gemm: 0.056,  fisrt gemm backward duration: 2.476,  weight grad: 1.764,  other: 0.507
Linear 1 Backward:  4.891
perpare first backward gemm: 0.06,  fisrt gemm backward duration: 2.136,  weight grad: 1.968,  other: 0.486
Linear 1 Backward:  4.733
STEP-89: step_time = 23.028063 ms, foward_time = 10.905952, backward_time = 12.017664, perf = 35.81 tflops.
start
start
start
start
block_info 244 41
block_info 264 58
block_info 288 77
block_info 268 60
cuda:3 process time:4.014730453491211, a: 0.8819103240966797, b: 1.0499954223632812, c: 0.1125335693359375, d: 1.9702911376953125
cuda:1 process time:4.081010818481445, a: 0.7419586181640625, b: 1.5544891357421875, c: 0.09441375732421875, d: 1.6901493072509766
cuda:0 process time:3.8878917694091797, a: 0.7638931274414062, b: 1.1897087097167969, c: 0.10323524475097656, d: 1.8310546875
1 wait time: 2.116
264
cuda:2 process time:4.453182220458984, a: 0.7576942443847656, b: 1.5149116516113281, c: 0.11205673217773438, d: 2.0685195922851562
3 wait time: 2.78
244
0 wait time: 2.375
288
2 wait time: 2.561
268
AG, 0.267361, 1.969152, 0 
perpare first forward gemm: 0.31,  fisrt gemm forward duration: 2.136
AG, 0.168033, 1.797120, 0 
perpare first forward gemm: 0.302,  fisrt gemm forward duration: 2.077
AG, 0.219697, 1.800192, 0 
perpare first forward gemm: 0.276,  fisrt gemm forward duration: 2.263
AG, 0.223881, 1.806336, 0 
perpare first forward gemm: 0.291,  fisrt gemm forward duration: 1.869
GA, 0.219697, 2.024448, 0 
GA, 0.168033, 1.978368, 0 
GA, 0.223881, 2.259968, 0 
GA, 0.267361, 2.262016, 0 
forward:  7.766
forward:  7.508
forward:  7.393
forward:  7.674
AG, 0.223881, 1.818624, 0 
AG, 0.219697, 1.812480, 0 
AG, 0.168033, 1.812480, 0 
AG, 0.267361, 1.955840, 0 
Linear 2 Backward: 3.264, second_gemm: 3.247
Linear 2 Backward: 3.857, second_gemm: 3.849
Linear 2 Backward: 3.5, second_gemm: 3.485
Linear 2 Backward: 4.028, second_gemm: 4.012
GA, 0.168033, 1.739776, 0 
GA, 0.219697, 1.810432, 0 
GA, 0.223881, 1.997824, 0 
GA, 0.267361, 2.060288, 0 
perpare first backward gemm: 0.037,  fisrt gemm backward duration: 2.704,  weight grad: 1.538,  other: 0.41
Linear 1 Backward:  4.737
perpare first backward gemm: 0.051,  fisrt gemm backward duration: 2.434,  weight grad: 1.755,  other: 0.43
perpare first backward gemm: 0.027,  fisrt gemm backward duration: 2.643,  weight grad: 1.73,  other: 0.413
Linear 1 Backward:  4.851
Linear 1 Backward:  4.732
perpare first backward gemm: 0.055,  fisrt gemm backward duration: 2.138,  weight grad: 1.934,  other: 0.428
Linear 1 Backward:  4.614
STEP-90: step_time = 22.565569 ms, foward_time = 10.775232, backward_time = 11.688960, perf = 36.54 tflops.
start
start
start
start
block_info 244 41
block_info 264 58
block_info 288 77
cuda:3 process time:3.5483837127685547, a: 0.9107589721679688, b: 1.0364055633544922, c: 0.09036064147949219, d: 1.5108585357666016
block_info 268 60
3 wait time: 2.223
244
cuda:1 process time:3.940582275390625, a: 0.7452964782714844, b: 1.277923583984375, c: 0.087738037109375, d: 1.8296241760253906
cuda:0 process time:3.8537979125976562, a: 0.7712841033935547, b: 1.338958740234375, c: 0.10991096496582031, d: 1.6336441040039062
cuda:2 process time:3.854990005493164, a: 0.7207393646240234, b: 1.1610984802246094, c: 0.09012222290039062, d: 1.8830299377441406
1 wait time: 1.596
264
0 wait time: 2.127
288
2 wait time: 1.649
268
AG, 0.219697, 1.810432, 0 
perpare first forward gemm: 0.285,  fisrt gemm forward duration: 2.148
AG, 0.168033, 1.796096, 0 
perpare first forward gemm: 0.26,  fisrt gemm forward duration: 2.332
AG, 0.223881, 1.804288, 0 
perpare first forward gemm: 0.319,  fisrt gemm forward duration: 1.88
AG, 0.267361, 1.966080, 0 
perpare first forward gemm: 0.3,  fisrt gemm forward duration: 2.119
GA, 0.168033, 1.829888, 0 
GA, 0.219697, 2.052096, 0 
GA, 0.223881, 2.083840, 0 
GA, 0.267361, 2.287616, 0 
forward:  7.514
forward:  7.936
forward:  7.698
forward:  7.527
AG, 0.219697, 1.800192, 0 
AG, 0.223881, 1.822720, 0 
AG, 0.168033, 1.794048, 0 
AG, 0.267361, 1.956864, 0 
Linear 2 Backward: 3.401, second_gemm: 3.388
Linear 2 Backward: 3.647, second_gemm: 3.64
Linear 2 Backward: 3.479, second_gemm: 3.465
Linear 2 Backward: 3.75, second_gemm: 3.736
GA, 0.168033, 1.689600, 0 
GA, 0.219697, 1.811456, 0 
GA, 0.223881, 1.891328, 0 
GA, 0.267361, 2.021376, 0 
perpare first backward gemm: 0.03,  fisrt gemm backward duration: 2.713,  weight grad: 1.518,  other: 0.409
Linear 1 Backward:  4.711
perpare first backward gemm: 0.027,  fisrt gemm backward duration: 2.578,  weight grad: 1.736,  other: 0.41
Linear 1 Backward:  4.786
perpare first backward gemm: 0.046,  fisrt gemm backward duration: 2.391,  weight grad: 1.742,  other: 0.457
Linear 1 Backward:  4.705
perpare first backward gemm: 0.052,  fisrt gemm backward duration: 2.097,  weight grad: 1.922,  other: 0.461
Linear 1 Backward:  4.597
STEP-91: step_time = 22.293441 ms, foward_time = 10.586048, backward_time = 11.597824, perf = 36.99 tflops.
start
start
start
start
block_info 268 60
block_info 264 58
cuda:2 process time:3.3147335052490234, a: 0.5958080291748047, b: 1.1456012725830078, c: 0.06985664367675781, d: 1.5034675598144531
block_info 244 41
2 wait time: 1.241
268
cuda:1 process time:4.114866256713867, a: 0.6415843963623047, b: 1.4739036560058594, c: 0.087738037109375, d: 1.9116401672363281
block_info 288 77
1 wait time: 1.609
264
cuda:3 process time:4.37164306640625, a: 0.7417201995849609, b: 1.5196800231933594, c: 0.11157989501953125, d: 1.9986629486083984
cuda:0 process time:4.290103912353516, a: 0.8022785186767578, b: 1.116037368774414, c: 0.11610984802246094, d: 2.255678176879883
3 wait time: 2.676
244
0 wait time: 2.348
288
AG, 0.219697, 1.822720, 0 
perpare first forward gemm: 0.3,  fisrt gemm forward duration: 2.512
AG, 0.168033, 1.794048, 0 
perpare first forward gemm: 0.256,  fisrt gemm forward duration: 2.044
AG, 0.223881, 1.798144, 0 
perpare first forward gemm: 0.312,  fisrt gemm forward duration: 2.793
AG, 0.267361, 1.976320, 0 
perpare first forward gemm: 0.321,  fisrt gemm forward duration: 2.041
GA, 0.219697, 2.040832, 0 
GA, 0.168033, 1.969152, 0 
GA, 0.223881, 2.205696, 0 
GA, 0.267361, 2.275328, 0 
forward:  7.499
forward:  8.354
forward:  8.031
forward:  7.447
AG, 0.219697, 1.804288, 0 
AG, 0.168033, 1.790976, 0 
AG, 0.223881, 1.824768, 0 
AG, 0.267361, 1.958912, 0 
Linear 2 Backward: 3.544, second_gemm: 3.528
Linear 2 Backward: 3.819, second_gemm: 3.811
Linear 2 Backward: 3.556, second_gemm: 3.539
Linear 2 Backward: 3.835, second_gemm: 3.818
GA, 0.168033, 1.692672, 0 
GA, 0.219697, 1.808384, 0 
GA, 0.223881, 1.948672, 0 
GA, 0.267361, 2.066432, 0 
perpare first backward gemm: 0.038,  fisrt gemm backward duration: 2.755,  weight grad: 1.537,  other: 0.445
Linear 1 Backward:  4.835
perpare first backward gemm: 0.026,  fisrt gemm backward duration: 2.728,  weight grad: 1.733,  other: 0.409
Linear 1 Backward:  4.932
perpare first backward gemm: 0.056,  fisrt gemm backward duration: 2.447,  weight grad: 1.764,  other: 0.487
Linear 1 Backward:  4.841
perpare first backward gemm: 0.061,  fisrt gemm backward duration: 2.153,  weight grad: 1.955,  other: 0.482
Linear 1 Backward:  4.735
STEP-92: step_time = 22.594559 ms, foward_time = 10.663936, backward_time = 11.829248, perf = 36.50 tflops.
start
start
start
start
block_info 288 77
block_info 264 58
cuda:0 process time:3.1855106353759766, a: 0.6802082061767578, b: 0.9949207305908203, c: 0.07462501525878906, d: 1.4357566833496094
block_info 268 60
block_info 244 41
0 wait time: 1.432
288
cuda:1 process time:3.930807113647461, a: 0.7696151733398438, b: 1.299142837524414, c: 0.09369850158691406, d: 1.768350601196289
1 wait time: 1.834
264
cuda:2 process time:4.024267196655273, a: 0.6732940673828125, b: 1.2094974517822266, c: 0.0934600830078125, d: 2.048015594482422
cuda:3 process time:4.228353500366211, a: 0.7500648498535156, b: 1.329183578491211, c: 0.12946128845214844, d: 2.019643783569336
2 wait time: 1.712
268
3 wait time: 2.62
244
AG, 0.223881, 1.798144, 0 
perpare first forward gemm: 0.317,  fisrt gemm forward duration: 1.873
AG, 0.219697, 1.806336, 0 
perpare first forward gemm: 0.281,  fisrt gemm forward duration: 2.473
AG, 0.267361, 1.966080, 0 
perpare first forward gemm: 0.292,  fisrt gemm forward duration: 2.967
AG, 0.168033, 1.800192, 0 
perpare first forward gemm: 0.256,  fisrt gemm forward duration: 1.876
GA, 0.168033, 1.807360, 0 
GA, 0.219697, 2.039808, 0 
GA, 0.223881, 2.083840, 0 
GA, 0.267361, 2.269184, 0 
forward:  7.507
forward:  7.981
forward:  7.344
forward:  8.316
AG, 0.168033, 1.798144, 0 
AG, 0.223881, 1.811456, 0 
AG, 0.219697, 1.812480, 0 
AG, 0.267361, 2.007040, 0 
Linear 2 Backward: 3.395, second_gemm: 3.38
Linear 2 Backward: 3.785, second_gemm: 3.777
Linear 2 Backward: 3.526, second_gemm: 3.511
Linear 2 Backward: 3.882, second_gemm: 3.864
GA, 0.168033, 1.688576, 0 
GA, 0.219697, 1.805312, 0 
GA, 0.223881, 1.891328, 0 
GA, 0.267361, 2.016256, 0 
perpare first backward gemm: 0.033,  fisrt gemm backward duration: 2.813,  weight grad: 1.511,  other: 0.409
Linear 1 Backward:  4.81
perpare first backward gemm: 0.054,  fisrt gemm backward duration: 2.448,  weight grad: 1.757,  other: 0.446
perpare first backward gemm: 0.027,  fisrt gemm backward duration: 2.69,  weight grad: 1.736,  other: 0.414
Linear 1 Backward:  4.903
Linear 1 Backward:  4.783
perpare first backward gemm: 0.058,  fisrt gemm backward duration: 2.097,  weight grad: 1.938,  other: 0.431
Linear 1 Backward:  4.584
STEP-93: step_time = 22.387712 ms, foward_time = 10.802176, backward_time = 11.486208, perf = 36.83 tflops.
start
start
start
start
block_info 264 58
block_info 268 60
block_info 244 41
cuda:1 process time:3.816843032836914, a: 0.7417201995849609, b: 1.4216899871826172, c: 0.08749961853027344, d: 1.5659332275390625
block_info 288 77
cuda:2 process time:3.7431716918945312, a: 0.7102489471435547, b: 1.1148452758789062, c: 0.091552734375, d: 1.8265247344970703
1 wait time: 1.99
264
2 wait time: 1.853
268
cuda:3 process time:4.202127456665039, a: 0.7379055023193359, b: 1.3697147369384766, c: 0.11372566223144531, d: 1.9807815551757812
cuda:0 process time:4.336357116699219, a: 0.8029937744140625, b: 1.2745857238769531, c: 0.11539459228515625, d: 2.143383026123047
3 wait time: 2.554
244
0 wait time: 2.757
288
AG, 0.223881, 1.800192, 0 
perpare first forward gemm: 0.288,  fisrt gemm forward duration: 2.627
AG, 0.168033, 1.787904, 0 
perpare first forward gemm: 0.276,  fisrt gemm forward duration: 2.178
AG, 0.219697, 1.816576, 0 
perpare first forward gemm: 0.292,  fisrt gemm forward duration: 2.649
AG, 0.267361, 1.959936, 0 
perpare first forward gemm: 0.302,  fisrt gemm forward duration: 2.023
GA, 0.219697, 2.063360, 0 
GA, 0.168033, 1.980416, 0 
GA, 0.223881, 2.214912, 0 
GA, 0.267361, 2.324480, 0 
forward:  8.259
forward:  7.472
forward:  8.229
forward:  7.774
AG, 0.223881, 1.826816, 0 
AG, 0.219697, 1.817600, 0 
AG, 0.168033, 1.799168, 0 
AG, 0.267361, 1.996800, 0 
Linear 2 Backward: 3.25, second_gemm: 3.233
Linear 2 Backward: 3.775, second_gemm: 3.768
Linear 2 Backward: 3.539, second_gemm: 3.525
Linear 2 Backward: 4.098, second_gemm: 4.083
GA, 0.168033, 1.723392, 0 
GA, 0.219697, 1.813504, 0 
GA, 0.223881, 2.019328, 0 
GA, 0.267361, 2.023424, 0 
perpare first backward gemm: 0.038,  fisrt gemm backward duration: 2.698,  weight grad: 1.551,  other: 0.416
Linear 1 Backward:  4.751
perpare first backward gemm: 0.027,  fisrt gemm backward duration: 2.625,  weight grad: 1.747,  other: 0.453
Linear 1 Backward:  4.903
perpare first backward gemm: 0.049,  fisrt gemm backward duration: 2.44,  weight grad: 1.754,  other: 0.433
Linear 1 Backward:  4.738
perpare first backward gemm: 0.053,  fisrt gemm backward duration: 2.098,  weight grad: 1.926,  other: 0.431
Linear 1 Backward:  4.565
STEP-94: step_time = 22.944767 ms, foward_time = 11.143168, backward_time = 11.700224, perf = 35.94 tflops.
start
start
start
start
block_info 268 60
block_info 264 58
block_info 244 41
block_info 288 77
cuda:2 process time:3.9103031158447266, a: 0.7042884826660156, b: 1.2004375457763672, c: 0.08749961853027344, d: 1.9180774688720703
cuda:1 process time:4.271030426025391, a: 0.6525516510009766, b: 1.5766620635986328, c: 0.08678436279296875, d: 1.9550323486328125
cuda:3 process time:4.196405410766602, a: 0.7357597351074219, b: 1.3463497161865234, c: 0.11801719665527344, d: 1.9962787628173828
2 wait time: 1.598
268
1 wait time: 1.32
cuda:0 process time:4.311323165893555, a: 0.7836818695068359, b: 1.0769367218017578, c: 0.11467933654785156, d: 2.3360252380371094
264
3 wait time: 2.501
244
0 wait time: 2.517
288
AG, 0.219697, 1.821696, 0 
perpare first forward gemm: 0.309,  fisrt gemm forward duration: 2.152
AG, 0.168033, 1.792000, 0 
perpare first forward gemm: 0.257,  fisrt gemm forward duration: 2.007
AG, 0.223881, 1.802240, 0 
perpare first forward gemm: 0.272,  fisrt gemm forward duration: 2.349
AG, 0.267361, 1.974272, 0 
perpare first forward gemm: 0.298,  fisrt gemm forward duration: 2.031
GA, 0.168033, 1.949696, 0 
GA, 0.223881, 2.162688, 0 
GA, 0.219697, 2.222080, 0 
GA, 0.267361, 2.428928, 0 
forward:  7.979
forward:  7.513
forward:  7.631
forward:  7.891
AG, 0.223881, 1.825792, 0 
AG, 0.168033, 1.803264, 0 
AG, 0.219697, 1.808384, 0 
AG, 0.267361, 1.958912, 0 
Linear 2 Backward: 3.273, second_gemm: 3.255
Linear 2 Backward: 3.683, second_gemm: 3.676
Linear 2 Backward: 3.548, second_gemm: 3.533
Linear 2 Backward: 3.83, second_gemm: 3.816
GA, 0.168033, 1.776640, 0 
GA, 0.219697, 1.810432, 0 
GA, 0.223881, 2.019328, 0 
GA, 0.267361, 2.064384, 0 
perpare first backward gemm: 0.027,  fisrt gemm backward duration: 2.603,  weight grad: 1.729,  other: 0.409
Linear 1 Backward:  4.802
perpare first backward gemm: 0.038,  fisrt gemm backward duration: 2.641,  weight grad: 1.541,  other: 0.445
Linear 1 Backward:  4.727
perpare first backward gemm: 0.046,  fisrt gemm backward duration: 2.439,  weight grad: 1.755,  other: 0.458
Linear 1 Backward:  4.766
perpare first backward gemm: 0.051,  fisrt gemm backward duration: 2.137,  weight grad: 1.931,  other: 0.458
Linear 1 Backward:  4.642
STEP-95: step_time = 22.761472 ms, foward_time = 10.962944, backward_time = 11.697152, perf = 36.23 tflops.
start
start
start
start
block_info 264 58
cuda:1 process time:3.7546157836914062, a: 0.5872249603271484, b: 1.6145706176757812, c: 0.06628036499023438, d: 1.4865398406982422
block_info 288 77
1 wait time: 1.322
block_info 244 41
264
block_info 268 60
cuda:0 process time:3.9758682250976562, a: 0.8063316345214844, b: 1.0251998901367188, c: 0.09012222290039062, d: 2.0542144775390625
cuda:3 process time:4.536867141723633, a: 0.7450580596923828, b: 1.6808509826660156, c: 0.12636184692382812, d: 1.9845962524414062
0 wait time: 1.85
288
cuda:2 process time:4.923105239868164, a: 0.7805824279785156, b: 1.6252994537353516, c: 0.11444091796875, d: 2.402782440185547
3 wait time: 2.585
244
2 wait time: 2.119
268
AG, 0.219697, 1.821696, 0 
perpare first forward gemm: 0.301,  fisrt gemm forward duration: 3.09
AG, 0.267361, 1.973248, 0 
perpare first forward gemm: 0.328,  fisrt gemm forward duration: 2.486
AG, 0.168033, 1.806336, 0 
perpare first forward gemm: 0.258,  fisrt gemm forward duration: 2.297
AG, 0.223881, 1.811456, 0 
perpare first forward gemm: 0.329,  fisrt gemm forward duration: 1.886
GA, 0.168033, 1.807360, 0 
GA, 0.219697, 1.992704, 0 
GA, 0.223881, 2.021376, 0 
GA, 0.267361, 2.210816, 0 
forward:  8.761
forward:  7.848
forward:  7.561
forward:  7.992
AG, 0.223881, 1.814528, 0 
AG, 0.219697, 1.807360, 0 
AG, 0.168033, 1.793024, 0 
AG, 0.267361, 1.997824, 0 
Linear 2 Backward: 3.379, second_gemm: 3.362
Linear 2 Backward: 3.771, second_gemm: 3.763
Linear 2 Backward: 3.514, second_gemm: 3.497
Linear 2 Backward: 3.85, second_gemm: 3.833
GA, 0.219697, 1.820672, 0 
GA, 0.168033, 1.723392, 0 
GA, 0.223881, 1.900544, 0 
GA, 0.267361, 2.043904, 0 
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 2.769,  weight grad: 1.529,  other: 0.409
Linear 1 Backward:  4.79
perpare first backward gemm: 0.053,  fisrt gemm backward duration: 2.459,  weight grad: 1.757,  other: 0.431
perpare first backward gemm: 0.026,  fisrt gemm backward duration: 2.712,  weight grad: 1.73,  other: 0.41
Linear 1 Backward:  4.914
Linear 1 Backward:  4.764
perpare first backward gemm: 0.057,  fisrt gemm backward duration: 2.126,  weight grad: 1.941,  other: 0.429
Linear 1 Backward:  4.614
STEP-96: step_time = 22.552576 ms, foward_time = 10.885120, backward_time = 11.566080, perf = 36.56 tflops.
start
start
start
start
block_info 268 60
block_info 244 41
block_info 288 77
block_info 264 58
cuda:3 process time:3.659963607788086, a: 0.7431507110595703, b: 1.4772415161132812, c: 0.11205673217773438, d: 1.3275146484375
cuda:2 process time:3.6439895629882812, a: 0.7488727569580078, b: 1.2249946594238281, c: 0.09012222290039062, d: 1.5799999237060547
cuda:0 process time:3.704071044921875, a: 0.7584095001220703, b: 1.1699199676513672, c: 0.12373924255371094, d: 1.6520023345947266
cuda:1 process time:3.7932395935058594, a: 0.7874965667724609, b: 1.2431144714355469, c: 0.0934600830078125, d: 1.669168472290039
3 wait time: 1.917
244
2 wait time: 2.003
268
1 wait time: 2.099
264
0 wait time: 2.18
288
AG, 0.168033, 1.788928, 0 
perpare first forward gemm: 0.274,  fisrt gemm forward duration: 2.27
AG, 0.219697, 1.800192, 0 
perpare first forward gemm: 0.29,  fisrt gemm forward duration: 1.964
AG, 0.223881, 1.804288, 0 
perpare first forward gemm: 0.287,  fisrt gemm forward duration: 2.149
AG, 0.267361, 1.964032, 0 
perpare first forward gemm: 0.303,  fisrt gemm forward duration: 2.026
GA, 0.168033, 1.901568, 0 
GA, 0.219697, 2.004992, 0 
GA, 0.223881, 2.183168, 0 
GA, 0.267361, 2.262016, 0 
forward:  7.553
forward:  7.696
forward:  7.812
forward:  7.471
AG, 0.168033, 1.793024, 0 
AG, 0.219697, 1.798144, 0 
AG, 0.223881, 1.807360, 0 
AG, 0.267361, 1.958912, 0 
Linear 2 Backward: 3.403, second_gemm: 3.39
Linear 2 Backward: 3.702, second_gemm: 3.693
Linear 2 Backward: 3.461, second_gemm: 3.447
Linear 2 Backward: 3.767, second_gemm: 3.753
GA, 0.168033, 1.688576, 0 
GA, 0.219697, 1.796096, 0 
GA, 0.223881, 1.874944, 0 
GA, 0.267361, 2.019328, 0 
perpare first backward gemm: 0.029,  fisrt gemm backward duration: 2.737,  weight grad: 1.519,  other: 0.416
Linear 1 Backward:  4.743
perpare first backward gemm: 0.028,  fisrt gemm backward duration: 2.588,  weight grad: 1.731,  other: 0.41
Linear 1 Backward:  4.795
perpare first backward gemm: 0.049,  fisrt gemm backward duration: 2.411,  weight grad: 1.742,  other: 0.43
Linear 1 Backward:  4.692
perpare first backward gemm: 0.053,  fisrt gemm backward duration: 2.095,  weight grad: 1.924,  other: 0.43
Linear 1 Backward:  4.559
STEP-97: step_time = 22.079872 ms, foward_time = 10.591616, backward_time = 11.387904, perf = 37.35 tflops.
start
start
start
start
block_info 264 58
block_info 288 77
block_info 268 60
block_info 244 41
cuda:2 process time:3.6885738372802734, a: 0.7529258728027344, b: 1.2311935424804688, c: 0.10228157043457031, d: 1.6021728515625
cuda:1 process time:4.096746444702148, a: 0.7560253143310547, b: 1.5795230865478516, c: 0.09751319885253906, d: 1.6636848449707031
cuda:0 process time:3.814697265625, a: 0.7700920104980469, b: 1.1615753173828125, c: 0.09822845458984375, d: 1.7848014831542969
cuda:3 process time:4.333734512329102, a: 0.7493495941162109, b: 1.3535022735595703, c: 0.11658668518066406, d: 2.1142959594726562
2 wait time: 1.994
268
1 wait time: 2.152
264
0 wait time: 2.373
288
3 wait time: 2.286
244
AG, 0.219697, 1.805312, 0 
perpare first forward gemm: 0.284,  fisrt gemm forward duration: 2.084
AG, 0.267361, 1.959936, 0 
perpare first forward gemm: 0.294,  fisrt gemm forward duration: 2.098
AG, 0.223881, 1.796096, 0 
perpare first forward gemm: 0.28,  fisrt gemm forward duration: 2.315
AG, 0.168033, 1.794048, 0 
perpare first forward gemm: 0.26,  fisrt gemm forward duration: 1.849
GA, 0.219697, 2.038784, 0 
GA, 0.168033, 1.955840, 0 
GA, 0.223881, 2.196480, 0 
GA, 0.267361, 2.277376, 0 
forward:  7.62
forward:  7.825
forward:  7.464
forward:  7.359
AG, 0.223881, 1.804288, 0 
AG, 0.219697, 1.805312, 0 
AG, 0.168033, 1.804288, 0 
AG, 0.267361, 1.964032, 0 
Linear 2 Backward: 3.256, second_gemm: 3.238
Linear 2 Backward: 3.686, second_gemm: 3.676
Linear 2 Backward: 3.766, second_gemm: 3.759
Linear 2 Backward: 4.015, second_gemm: 4.005
GA, 0.219697, 1.811456, 0 
GA, 0.168033, 1.854464, 0 
GA, 0.223881, 2.054144, 0 
GA, 0.267361, 2.076672, 0 
perpare first backward gemm: 0.037,  fisrt gemm backward duration: 2.622,  weight grad: 1.537,  other: 0.462
Linear 1 Backward:  4.721
perpare first backward gemm: 0.027,  fisrt gemm backward duration: 2.567,  weight grad: 1.733,  other: 0.406
Linear 1 Backward:  4.767
perpare first backward gemm: 0.041,  fisrt gemm backward duration: 2.487,  weight grad: 1.73,  other: 0.442
Linear 1 Backward:  4.76
perpare first backward gemm: 0.046,  fisrt gemm backward duration: 2.143,  weight grad: 1.92,  other: 0.442
Linear 1 Backward:  4.608
STEP-98: step_time = 22.573696 ms, foward_time = 10.762880, backward_time = 11.708416, perf = 36.53 tflops.
start
start
start
start
block_info 244 41
block_info 268 60
block_info 288 77
block_info 264 58
cuda:3 process time:4.239797592163086, a: 0.7517337799072266, b: 1.528024673461914, c: 0.10466575622558594, d: 1.8553733825683594
cuda:2 process time:4.361867904663086, a: 0.6623268127441406, b: 1.5659332275390625, c: 0.09512901306152344, d: 2.0384788513183594
cuda:0 process time:3.9260387420654297, a: 0.70953369140625, b: 0.9989738464355469, c: 0.09679794311523438, d: 2.1207332611083984
3 wait time: 2.322
244
2 wait time: 1.76
268
cuda:1 process time:4.373073577880859, a: 0.7784366607666016, b: 1.3875961303710938, c: 0.11301040649414062, d: 2.0940303802490234
0 wait time: 1.947
288
1 wait time: 2.588
264
AG, 0.168033, 1.800192, 0 
perpare first forward gemm: 0.258,  fisrt gemm forward duration: 2.312
AG, 0.223881, 1.798144, 0 
perpare first forward gemm: 0.315,  fisrt gemm forward duration: 2.125
AG, 0.219697, 1.807360, 0 
perpare first forward gemm: 0.281,  fisrt gemm forward duration: 1.866
AG, 0.267361, 1.953792, 0 
perpare first forward gemm: 0.327,  fisrt gemm forward duration: 2.069
GA, 0.168033, 1.963008, 0 
GA, 0.219697, 2.060288, 0 
GA, 0.223881, 2.192384, 0 
GA, 0.267361, 2.298880, 0 
forward:  7.775
forward:  7.358
forward:  7.708
forward:  7.512
AG, 0.223881, 1.820672, 0 
AG, 0.168033, 1.806336, 0 
AG, 0.219697, 1.816576, 0 
AG, 0.267361, 1.965056, 0 
Linear 2 Backward: 3.279, second_gemm: 3.263
Linear 2 Backward: 3.713, second_gemm: 3.705
Linear 2 Backward: 3.422, second_gemm: 3.41
Linear 2 Backward: 3.723, second_gemm: 3.711
GA, 0.168033, 1.858560, 0 
GA, 0.219697, 1.843200, 0 
GA, 0.223881, 2.008064, 0 
GA, 0.267361, 2.087936, 0 
perpare first backward gemm: 0.038,  fisrt gemm backward duration: 2.585,  weight grad: 1.511,  other: 0.407
Linear 1 Backward:  4.588
perpare first backward gemm: 0.04,  fisrt gemm backward duration: 2.461,  weight grad: 1.725,  other: 0.438
Linear 1 Backward:  4.721
perpare first backward gemm: 0.027,  fisrt gemm backward duration: 2.543,  weight grad: 1.731,  other: 0.408
Linear 1 Backward:  4.742
perpare first backward gemm: 0.042,  fisrt gemm backward duration: 2.15,  weight grad: 1.914,  other: 0.442
Linear 1 Backward:  4.606
STEP-99: step_time = 22.022143 ms, foward_time = 10.534912, backward_time = 11.388928, perf = 37.45 tflops.

[Summary] Average synchronized step_time = 22.477580642700197 ms, forward = 10.77080316543579, backward = 11.605094528198242.

 end end end
cuda:3
cuda:1
cuda:2
cuda:0
rank: 2, nranks: 4
rank: 3, nranks: 4
rank: 1, nranks: 4
rank: 0, nranks: 4
DistributedDataParallel(
  (module): ExampleModel(
    (attn): MultiHeadSelfAttention(
      (linear_q): Linear(in_features=1024, out_features=1024, bias=False)
      (linear_k): Linear(in_features=1024, out_features=1024, bias=False)
      (linear_v): Linear(in_features=1024, out_features=1024, bias=False)
      (linear_o): Linear(in_features=1024, out_features=1024, bias=False)
    )
    (_moe_layer): MixMOETransformerMLP(
      (gate): NaiveGate(
        (gate): Linear(in_features=1024, out_features=128, bias=True)
      )
      (experts): _Expert(
        (htoh4): FMoELinear(num_expert=38, in_features=1024,         out_features=4096, bias=True, rank=0)
        (h4toh): FMoELinear(num_expert=38, in_features=4096,         out_features=1024, bias=True, rank=0)
        (activation): GELU(approximate='none')
      )
    )
  )
)
[Benchmark] world_size = 4, dtype = float16, model_dim = 1024, hidden_size = 4096, samples = 8192, num_local_experts = 32, topK = 2, a2a_ffn_overlap_degree = 1, device = `cuda:0`
start
start
start
start
block_info 215 9
cuda:1 process time:2123.969554901123, a: 6.578207015991211, b: 2114.8579120635986, c: 0.2930164337158203, d: 2.240419387817383
1 wait time: 2.149
215
block_info 235 27
block_info 287 67
block_info 299 76
cuda:2 process time:2125.507593154907, a: 7.812261581420898, b: 2114.449977874756, c: 0.3192424774169922, d: 2.9261112213134766
cuda:3 process time:2126.110553741455, a: 7.249593734741211, b: 2115.391492843628, c: 0.35262107849121094, d: 3.1168460845947266
2 wait time: 2.914
235
cuda:0 process time:2124.607801437378, a: 8.928775787353516, b: 2110.786199569702, c: 0.5841255187988281, d: 4.3087005615234375
3 wait time: 3.142
299
0 wait time: 5.961
287
AG, 0.041860, 1.056768, 0 
perpare first forward gemm: 1.012,  fisrt gemm forward duration: 4.906
AG, 0.254181, 1.894400, 0 
perpare first forward gemm: 1.068,  fisrt gemm forward duration: 3.977
AG, 0.114894, 1.815552, 0 
perpare first forward gemm: 1.018,  fisrt gemm forward duration: 3.906
AG, 0.233449, 1.855488, 0 
perpare first forward gemm: 1.24,  fisrt gemm forward duration: 3.23
GA, 0.041860, 0.775168, 0 
GA, 0.114894, 1.488896, 0 
GA, 0.254181, 2.085888, 0 
GA, 0.233449, 1.976320, 0 
forward:  14.335
forward:  13.083
forward:  16.002
forward:  14.704
AG, 0.041860, 1.118208, 0 
AG, 0.114894, 1.799168, 0 
AG, 0.254181, 1.910784, 0 
AG, 0.233449, 1.832960, 0 
Linear 2 Backward: 3.627, second_gemm: 3.607
Linear 2 Backward: 4.474, second_gemm: 4.451
GA, 0.041860, 0.777216, 0 
GA, 0.114894, 1.517568, 0 
Linear 2 Backward: 12.319, second_gemm: 12.301
Linear 2 Backward: 11.772, second_gemm: 11.756
GA, 0.233449, 2.019328, 0 
GA, 0.254181, 2.112512, 0 
perpare first backward gemm: 0.031,  fisrt gemm backward duration: 2.438,  weight grad: 1.961,  other: 2.315
Linear 1 Backward:  6.797
perpare first backward gemm: 0.032,  fisrt gemm backward duration: 2.167,  weight grad: 1.875,  other: 7.07
Linear 1 Backward:  11.196
perpare first backward gemm: 0.026,  fisrt gemm backward duration: 11.133,  weight grad: 6.931,  other: 2.243
Linear 1 Backward:  20.383
perpare first backward gemm: 0.075,  fisrt gemm backward duration: 9.623,  weight grad: 7.838,  other: 2.225
Linear 1 Backward:  19.828
STEP-0: step_time = 52.023438 ms, foward_time = 21.251465, backward_time = 30.412800, perf = 15.85 tflops.
start
start
start
start
block_info 299 76
block_info 287 67
block_info 215 9
cuda:0 process time:7.693290710449219, a: 4.452943801879883, b: 1.7337799072265625, c: 0.087738037109375, d: 1.4188289642333984
cuda:3 process time:7.67827033996582, a: 5.090475082397461, b: 1.1205673217773438, c: 0.1068115234375, d: 1.3604164123535156
cuda:1 process time:7.908105850219727, a: 4.948854446411133, b: 1.2173652648925781, c: 0.10013580322265625, d: 1.6417503356933594
block_info 235 27
3 wait time: 1.942
299
0 wait time: 1.451
287
1 wait time: 1.051
215
cuda:2 process time:8.880853652954102, a: 5.10096549987793, b: 1.2516975402832031, c: 0.17642974853515625, d: 2.3517608642578125
2 wait time: 2.411
235
AG, 0.041860, 1.133568, 0 
perpare first forward gemm: 0.252,  fisrt gemm forward duration: 2.091
AG, 0.233449, 1.838080, 0 
perpare first forward gemm: 0.292,  fisrt gemm forward duration: 3.123
AG, 0.114894, 1.798144, 0 
perpare first forward gemm: 0.265,  fisrt gemm forward duration: 1.858
AG, 0.254181, 1.879040, 0 
perpare first forward gemm: 0.298,  fisrt gemm forward duration: 3.063
GA, 0.041860, 0.776192, 0 
GA, 0.114894, 1.509376, 0 
GA, 0.233449, 1.938432, 0 
GA, 0.254181, 2.110464, 0 
forward:  9.799
forward:  8.602
forward:  9.478
forward:  9.701
AG, 0.041860, 1.102848, 0 
AG, 0.254181, 1.876992, 0 
AG, 0.233449, 1.845248, 0 
AG, 0.114894, 1.810432, 0 
Linear 2 Backward: 3.267, second_gemm: 3.259
Linear 2 Backward: 4.086, second_gemm: 4.078
Linear 2 Backward: 3.486, second_gemm: 3.477
Linear 2 Backward: 4.304, second_gemm: 4.295
GA, 0.041860, 0.768000, 0 
GA, 0.114894, 1.532928, 0 
GA, 0.233449, 1.943552, 0 
GA, 0.254181, 2.056192, 0 
perpare first backward gemm: 0.022,  fisrt gemm backward duration: 3.231,  weight grad: 1.45,  other: 0.421
Linear 1 Backward:  5.162
perpare first backward gemm: 0.023,  fisrt gemm backward duration: 2.378,  weight grad: 1.616,  other: 0.411
Linear 1 Backward:  4.464
perpare first backward gemm: 0.029,  fisrt gemm backward duration: 2.107,  weight grad: 1.861,  other: 0.432
Linear 1 Backward:  4.466
perpare first backward gemm: 0.028,  fisrt gemm backward duration: 2.055,  weight grad: 1.947,  other: 0.422
Linear 1 Backward:  4.488
STEP-1: step_time = 23.881728 ms, foward_time = 12.412929, backward_time = 11.321344, perf = 34.53 tflops.
start
start
start
start
block_info 215 9
block_info 235 27
block_info 299 76
cuda:1 process time:3.5130977630615234, a: 0.5962848663330078, b: 1.5599727630615234, c: 0.0743865966796875, d: 1.2824535369873047
block_info 287 67
cuda:2 process time:3.4415721893310547, a: 0.6463527679443359, b: 1.2967586517333984, c: 0.07867813110351562, d: 1.4197826385498047
cuda:3 process time:3.3833980560302734, a: 0.6456375122070312, b: 1.07574462890625, c: 0.0782012939453125, d: 1.5838146209716797
1 wait time: 0.688
215
2 wait time: 1.132
235
cuda:0 process time:3.841400146484375, a: 0.8459091186523438, b: 1.10626220703125, c: 0.1087188720703125, d: 1.7805099487304688
3 wait time: 1.453
299
0 wait time: 1.833
287
AG, 0.041860, 1.113088, 0 
perpare first forward gemm: 0.281,  fisrt gemm forward duration: 1.771
AG, 0.233449, 1.836032, 0 
perpare first forward gemm: 0.319,  fisrt gemm forward duration: 1.897
AG, 0.114894, 1.802240, 0 
perpare first forward gemm: 0.298,  fisrt gemm forward duration: 2.213
AG, 0.254181, 1.994752, 0 
perpare first forward gemm: 0.33,  fisrt gemm forward duration: 2.306
GA, 0.041860, 0.771072, 0 
GA, 0.114894, 1.505280, 0 
GA, 0.233449, 1.940480, 0 
GA, 0.254181, 2.056192, 0 
forward:  9.216
forward:  8.66
forward:  8.985
forward:  8.919
AG, 0.041860, 1.149952, 0 
AG, 0.114894, 1.803264, 0 
AG, 0.233449, 1.845248, 0 
AG, 0.254181, 1.899520, 0 
Linear 2 Backward: 2.737, second_gemm: 2.722
Linear 2 Backward: 3.45, second_gemm: 3.441
Linear 2 Backward: 3.653, second_gemm: 3.639
Linear 2 Backward: 3.769, second_gemm: 3.754
GA, 0.041860, 0.782336, 0 
GA, 0.114894, 1.517568, 0 
GA, 0.233449, 1.957888, 0 
GA, 0.254181, 2.091008, 0 
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 3.242,  weight grad: 1.482,  other: 0.453
Linear 1 Backward:  5.279
perpare first backward gemm: 0.026,  fisrt gemm backward duration: 2.614,  weight grad: 1.621,  other: 0.415
Linear 1 Backward:  4.716
perpare first backward gemm: 0.047,  fisrt gemm backward duration: 2.161,  weight grad: 1.895,  other: 0.482
Linear 1 Backward:  4.652
perpare first backward gemm: 0.043,  fisrt gemm backward duration: 2.117,  weight grad: 1.971,  other: 0.488
Linear 1 Backward:  4.698
STEP-2: step_time = 22.843392 ms, foward_time = 11.649024, backward_time = 11.097088, perf = 36.10 tflops.
start
start
start
start
block_info 299 76
cuda:3 process time:3.419160842895508, a: 0.7612705230712891, b: 1.1053085327148438, c: 0.11301040649414062, d: 1.4395713806152344
block_info 215 9
block_info 235 27
3 wait time: 1.945
299
block_info 287 67
cuda:1 process time:4.271745681762695, a: 0.7557868957519531, b: 1.405954360961914, c: 0.1437664031982422, d: 1.966238021850586
cuda:2 process time:4.3277740478515625, a: 0.8080005645751953, b: 1.2545585632324219, c: 0.14853477478027344, d: 2.116680145263672
cuda:0 process time:4.724264144897461, a: 0.751495361328125, b: 1.6431808471679688, c: 0.14591217041015625, d: 2.183675765991211
1 wait time: 2.546
215
2 wait time: 2.738
235
0 wait time: 2.738
287
AG, 0.041860, 1.117184, 0 
perpare first forward gemm: 0.249,  fisrt gemm forward duration: 1.69
AG, 0.114894, 1.798144, 0 
perpare first forward gemm: 0.259,  fisrt gemm forward duration: 2.125
AG, 0.233449, 1.861632, 0 
perpare first forward gemm: 0.29,  fisrt gemm forward duration: 1.916
AG, 0.254181, 1.893376, 0 
perpare first forward gemm: 0.317,  fisrt gemm forward duration: 3.103
GA, 0.041860, 0.775168, 0 
GA, 0.114894, 1.507328, 0 
GA, 0.233449, 1.940480, 0 
GA, 0.254181, 2.086912, 0 
forward:  8.618
forward:  9.001
forward:  8.759
forward:  9.698
AG, 0.041860, 1.119232, 0 
AG, 0.114894, 1.819648, 0 
AG, 0.233449, 1.867776, 0 
AG, 0.254181, 1.898496, 0 
Linear 2 Backward: 2.634, second_gemm: 2.619
Linear 2 Backward: 3.613, second_gemm: 3.598
Linear 2 Backward: 3.717, second_gemm: 3.703
Linear 2 Backward: 3.72, second_gemm: 3.705
GA, 0.041860, 0.780288, 0 
GA, 0.114894, 1.625088, 0 
GA, 0.233449, 1.898496, 0 
GA, 0.254181, 2.279424, 0 
perpare first backward gemm: 0.037,  fisrt gemm backward duration: 3.466,  weight grad: 1.484,  other: 0.467
Linear 1 Backward:  5.519
perpare first backward gemm: 0.059,  fisrt gemm backward duration: 2.032,  weight grad: 1.678,  other: 0.474
Linear 1 Backward:  4.386
perpare first backward gemm: 0.044,  fisrt gemm backward duration: 2.345,  weight grad: 1.893,  other: 0.448
Linear 1 Backward:  4.796
perpare first backward gemm: 0.041,  fisrt gemm backward duration: 2.287,  weight grad: 1.991,  other: 0.47
Linear 1 Backward:  4.855
STEP-3: step_time = 24.304831 ms, foward_time = 12.294336, backward_time = 11.912192, perf = 33.93 tflops.
start
start
start
start
block_info 287 67
block_info 215 9
cuda:0 process time:5.486011505126953, a: 0.7069110870361328, b: 3.242015838623047, c: 0.08177757263183594, d: 1.4553070068359375
block_info 299 76
0 wait time: 1.299
287
cuda:1 process time:5.573749542236328, a: 0.7889270782470703, b: 2.9070377349853516, c: 0.11205673217773438, d: 1.7657279968261719
cuda:3 process time:5.906105041503906, a: 0.7586479187011719, b: 3.290891647338867, c: 0.09632110595703125, d: 1.760244369506836
block_info 235 27
1 wait time: 1.577
215
3 wait time: 1.537
299
cuda:2 process time:4.631757736206055, a: 0.8795261383056641, b: 1.2676715850830078, c: 0.17547607421875, d: 2.309083938598633
2 wait time: 2.358
235
AG, 0.041860, 1.128448, 0 
perpare first forward gemm: 0.291,  fisrt gemm forward duration: 2.116
AG, 0.233449, 1.857536, 0 
perpare first forward gemm: 0.296,  fisrt gemm forward duration: 3.389
AG, 0.114894, 1.806336, 0 
perpare first forward gemm: 0.298,  fisrt gemm forward duration: 1.881
AG, 0.254181, 1.891328, 0 
perpare first forward gemm: 0.336,  fisrt gemm forward duration: 2.773
GA, 0.041860, 0.768000, 0 
GA, 0.114894, 1.532928, 0 
GA, 0.233449, 1.908736, 0 
GA, 0.254181, 2.185216, 0 
forward:  10.189
forward:  9.699
forward:  8.795
forward:  9.607
AG, 0.041860, 1.135616, 0 
AG, 0.114894, 1.801216, 0 
AG, 0.233449, 1.858560, 0 
AG, 0.254181, 1.897472, 0 
Linear 2 Backward: 2.732, second_gemm: 2.724
Linear 2 Backward: 3.376, second_gemm: 3.367
Linear 2 Backward: 3.594, second_gemm: 3.58
Linear 2 Backward: 3.777, second_gemm: 3.769
GA, 0.041860, 0.771072, 0 
GA, 0.114894, 1.513472, 0 
GA, 0.233449, 1.977344, 0 
GA, 0.254181, 2.064384, 0 
perpare first backward gemm: 0.022,  fisrt gemm backward duration: 3.374,  weight grad: 1.447,  other: 0.404
Linear 1 Backward:  5.281
perpare first backward gemm: 0.024,  fisrt gemm backward duration: 2.565,  weight grad: 1.611,  other: 0.417
Linear 1 Backward:  4.651
perpare first backward gemm: 0.044,  fisrt gemm backward duration: 2.121,  weight grad: 1.858,  other: 0.418
Linear 1 Backward:  4.489
perpare first backward gemm: 0.027,  fisrt gemm backward duration: 2.203,  weight grad: 1.961,  other: 0.407
Linear 1 Backward:  4.634
STEP-4: step_time = 23.483393 ms, foward_time = 12.405760, backward_time = 10.976256, perf = 35.12 tflops.
start
start
start
start
block_info 299 76
block_info 215 9
block_info 287 67
cuda:3 process time:3.749847412109375, a: 0.7331371307373047, b: 1.1508464813232422, c: 0.095367431640625, d: 1.7704963684082031
cuda:1 process time:3.663301467895508, a: 0.8089542388916016, b: 1.07574462890625, c: 0.11014938354492188, d: 1.6684532165527344
block_info 235 27
1 wait time: 1.781
3 wait time: 1.563
299
cuda:0 process time:4.027605056762695, a: 0.7574558258056641, b: 1.1379718780517578, c: 0.11229515075683594, d: 2.0198822021484375
215
0 wait time: 1.679
287
cuda:2 process time:4.688501358032227, a: 0.7240772247314453, b: 1.3346672058105469, c: 0.1506805419921875, d: 2.479076385498047
2 wait time: 2.572
235
AG, 0.041860, 1.136640, 0 
perpare first forward gemm: 0.289,  fisrt gemm forward duration: 2.172
AG, 0.114894, 1.805312, 0 
perpare first forward gemm: 0.3,  fisrt gemm forward duration: 1.881
AG, 0.233449, 1.867776, 0 
perpare first forward gemm: 0.329,  fisrt gemm forward duration: 2.564
AG, 0.254181, 1.914880, 0 
perpare first forward gemm: 0.334,  fisrt gemm forward duration: 2.878
GA, 0.041860, 0.771072, 0 
GA, 0.114894, 1.468416, 0 
GA, 0.233449, 1.918976, 0 
GA, 0.254181, 2.053120, 0 
forward:  9.37
forward:  9.652
forward:  8.711
forward:  9.625
AG, 0.041860, 1.156096, 0 
AG, 0.114894, 1.825792, 0 
AG, 0.233449, 1.879040, 0 
AG, 0.254181, 1.899520, 0 
Linear 2 Backward: 2.595, second_gemm: 2.581
Linear 2 Backward: 3.572, second_gemm: 3.559
Linear 2 Backward: 3.604, second_gemm: 3.59
Linear 2 Backward: 3.807, second_gemm: 3.794
GA, 0.041860, 0.779264, 0 
GA, 0.114894, 1.506304, 0 
GA, 0.233449, 1.975296, 0 
GA, 0.254181, 2.083840, 0 
perpare first backward gemm: 0.034,  fisrt gemm backward duration: 3.23,  weight grad: 1.478,  other: 0.445
Linear 1 Backward:  5.248
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 2.459,  weight grad: 1.641,  other: 0.446
Linear 1 Backward:  4.641
perpare first backward gemm: 0.043,  fisrt gemm backward duration: 2.166,  weight grad: 1.887,  other: 0.409
Linear 1 Backward:  4.554
perpare first backward gemm: 0.039,  fisrt gemm backward duration: 2.096,  weight grad: 1.997,  other: 0.448
Linear 1 Backward:  4.641
STEP-5: step_time = 23.832576 ms, foward_time = 12.167168, backward_time = 11.565056, perf = 34.60 tflops.
start
start
start
start
block_info 215 9
block_info 287 67
cuda:1 process time:3.1387805938720703, a: 0.7138252258300781, b: 1.130819320678711, c: 0.09036064147949219, d: 1.203775405883789
block_info 299 76
cuda:0 process time:3.4742355346679688, a: 0.7131099700927734, b: 1.146554946899414, c: 0.09083747863769531, d: 1.523733139038086
1 wait time: 1.679
215
0 wait time: 1.683
287
block_info 235 27
cuda:3 process time:4.022359848022461, a: 0.7860660552978516, b: 1.1377334594726562, c: 0.12063980102539062, d: 1.9779205322265625
3 wait time: 2.056
299
cuda:2 process time:4.361629486083984, a: 0.7863044738769531, b: 1.3020038604736328, c: 0.13709068298339844, d: 2.13623046875
2 wait time: 2.675
235
AG, 0.041860, 1.122304, 0 
perpare first forward gemm: 0.251,  fisrt gemm forward duration: 2.335
AG, 0.114894, 1.795072, 0 
perpare first forward gemm: 0.264,  fisrt gemm forward duration: 1.851
AG, 0.233449, 1.856512, 0 
perpare first forward gemm: 0.293,  fisrt gemm forward duration: 2.79
AG, 0.254181, 1.873920, 0 
perpare first forward gemm: 0.3,  fisrt gemm forward duration: 2.325
GA, 0.041860, 0.769024, 0 
GA, 0.114894, 1.506304, 0 
GA, 0.233449, 1.942528, 0 
GA, 0.254181, 2.072576, 0 
forward:  9.404
forward:  8.441
forward:  8.875
forward:  9.593
AG, 0.041860, 1.118208, 0 
AG, 0.114894, 1.796096, 0 
AG, 0.233449, 1.851392, 0 
AG, 0.254181, 1.886208, 0 
Linear 2 Backward: 2.551, second_gemm: 2.537
Linear 2 Backward: 3.581, second_gemm: 3.567
Linear 2 Backward: 3.629, second_gemm: 3.614
Linear 2 Backward: 3.795, second_gemm: 3.781
GA, 0.041860, 0.774144, 0 
GA, 0.114894, 1.522688, 0 
GA, 0.233449, 1.945600, 0 
GA, 0.254181, 2.078720, 0 
perpare first backward gemm: 0.037,  fisrt gemm backward duration: 3.275,  weight grad: 1.484,  other: 0.453
Linear 1 Backward:  5.314
perpare first backward gemm: 0.037,  fisrt gemm backward duration: 2.423,  weight grad: 1.648,  other: 0.453
Linear 1 Backward:  4.626
perpare first backward gemm: 0.044,  fisrt gemm backward duration: 2.145,  weight grad: 1.896,  other: 0.452
Linear 1 Backward:  4.605
perpare first backward gemm: 0.041,  fisrt gemm backward duration: 2.104,  weight grad: 1.99,  other: 0.471
Linear 1 Backward:  4.674
STEP-6: step_time = 23.378944 ms, foward_time = 11.996160, backward_time = 11.283456, perf = 35.27 tflops.
start
start
start
start
block_info 299 76
cuda:3 process time:3.354787826538086, a: 0.8656978607177734, b: 0.9863376617431641, c: 0.0782012939453125, d: 1.424551010131836
block_info 287 67
block_info 215 9
3 wait time: 1.328
299
cuda:0 process time:4.180192947387695, a: 0.7936954498291016, b: 1.485586166381836, c: 0.11849403381347656, d: 1.7824172973632812
cuda:1 process time:3.9937496185302734, a: 0.6666183471679688, b: 1.2598037719726562, c: 0.11992454528808594, d: 1.9474029541015625
0 wait time: 2.213
287
block_info 235 27
1 wait time: 1.7
215
cuda:2 process time:4.827976226806641, a: 0.7467269897460938, b: 1.3074874877929688, c: 0.1609325408935547, d: 2.6128292083740234
2 wait time: 2.701
235
AG, 0.041860, 1.140736, 0 
perpare first forward gemm: 0.288,  fisrt gemm forward duration: 2.222
AG, 0.114894, 1.809408, 0 
AG, 0.233449, 1.854464, 0 
perpare first forward gemm: 0.292,  fisrt gemm forward duration: 3.054
perpare first forward gemm: 0.299,  fisrt gemm forward duration: 1.884
AG, 0.254181, 1.906688, 0 
perpare first forward gemm: 0.353,  fisrt gemm forward duration: 3.521
GA, 0.041860, 0.766976, 0 
GA, 0.114894, 1.501184, 0 
GA, 0.233449, 1.953792, 0 
GA, 0.254181, 2.119680, 0 
forward:  9.764
forward:  9.851
forward:  8.771
forward:  10.355
AG, 0.041860, 1.122304, 0 
AG, 0.114894, 1.804288, 0 
AG, 0.233449, 1.850368, 0 
AG, 0.254181, 1.892352, 0 
Linear 2 Backward: 2.571, second_gemm: 2.558
Linear 2 Backward: 3.586, second_gemm: 3.574
Linear 2 Backward: 3.714, second_gemm: 3.7
Linear 2 Backward: 3.632, second_gemm: 3.619
GA, 0.041860, 0.775168, 0 
GA, 0.114894, 1.507328, 0 
GA, 0.233449, 1.907712, 0 
GA, 0.254181, 2.075648, 0 
perpare first backward gemm: 0.032,  fisrt gemm backward duration: 3.314,  weight grad: 1.449,  other: 0.417
Linear 1 Backward:  5.257
perpare first backward gemm: 0.033,  fisrt gemm backward duration: 2.478,  weight grad: 1.638,  other: 0.44
Linear 1 Backward:  4.645
perpare first backward gemm: 0.043,  fisrt gemm backward duration: 2.143,  weight grad: 1.892,  other: 0.449
Linear 1 Backward:  4.592
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 2.166,  weight grad: 1.983,  other: 0.44
Linear 1 Backward:  4.682
STEP-7: step_time = 24.548352 ms, foward_time = 12.981248, backward_time = 11.468800, perf = 33.59 tflops.
start
start
start
start
block_info 215 9
cuda:1 process time:3.7527084350585938, a: 0.6320476531982422, b: 1.6255378723144531, c: 0.08654594421386719, d: 1.4085769653320312
block_info 235 27
block_info 299 76
1 wait time: 1.305
215
cuda:2 process time:3.7126541137695312, a: 0.8628368377685547, b: 1.0924339294433594, c: 0.11324882507324219, d: 1.644134521484375
block_info 287 67
cuda:3 process time:3.9348602294921875, a: 0.6649494171142578, b: 1.3401508331298828, c: 0.09202957153320312, d: 1.8377304077148438
2 wait time: 1.65
235
3 wait time: 1.367
299
cuda:0 process time:4.5185089111328125, a: 0.7576942443847656, b: 1.4681816101074219, c: 0.11777877807617188, d: 2.174854278564453
0 wait time: 1.771
287
AG, 0.041860, 1.129472, 0 
perpare first forward gemm: 0.275,  fisrt gemm forward duration: 2.229
AG, 0.233449, 1.859584, 0 
perpare first forward gemm: 0.328,  fisrt gemm forward duration: 1.932
AG, 0.114894, 1.793024, 0 
perpare first forward gemm: 0.298,  fisrt gemm forward duration: 2.513
AG, 0.254181, 1.909760, 0 
perpare first forward gemm: 0.344,  fisrt gemm forward duration: 2.378
GA, 0.041860, 0.773120, 0 
GA, 0.114894, 1.498112, 0 
GA, 0.233449, 1.875968, 0 
GA, 0.254181, 2.114560, 0 
forward:  8.811
forward:  9.399
forward:  9.746
forward:  9.193
AG, 0.041860, 1.111040, 0 
AG, 0.233449, 1.858560, 0 
AG, 0.114894, 1.786880, 0 
AG, 0.254181, 1.900544, 0 
Linear 2 Backward: 2.73, second_gemm: 2.719
Linear 2 Backward: 3.325, second_gemm: 3.312
Linear 2 Backward: 3.686, second_gemm: 3.674
Linear 2 Backward: 3.78, second_gemm: 3.767
GA, 0.041860, 0.779264, 0 
GA, 0.114894, 1.508352, 0 
GA, 0.254181, 2.054144, 0 
GA, 0.233449, 1.973248, 0 
perpare first backward gemm: 0.028,  fisrt gemm backward duration: 3.316,  weight grad: 1.462,  other: 0.408
Linear 1 Backward:  5.257
perpare first backward gemm: 0.035,  fisrt gemm backward duration: 2.432,  weight grad: 1.645,  other: 0.406
Linear 1 Backward:  4.563
perpare first backward gemm: 0.038,  fisrt gemm backward duration: 2.166,  weight grad: 1.878,  other: 0.41
Linear 1 Backward:  4.536
perpare first backward gemm: 0.038,  fisrt gemm backward duration: 2.04,  weight grad: 1.996,  other: 0.41
Linear 1 Backward:  4.534
STEP-8: step_time = 22.852608 ms, foward_time = 11.742208, backward_time = 11.011072, perf = 36.08 tflops.
start
start
start
start
block_info 235 27
cuda:2 process time:3.0705928802490234, a: 0.6699562072753906, b: 1.1653900146484375, c: 0.07414817810058594, d: 1.1610984802246094
block_info 215 9
2 wait time: 1.163
235
block_info 287 67
cuda:1 process time:3.5500526428222656, a: 0.7557868957519531, b: 1.1036396026611328, c: 0.11777877807617188, d: 1.5728473663330078
block_info 299 76
cuda:0 process time:3.8461685180664062, a: 0.78582763671875, b: 1.1098384857177734, c: 0.11086463928222656, d: 1.8396377563476562
1 wait time: 2.1
215
0 wait time: 1.811
287
cuda:3 process time:4.392862319946289, a: 0.7863044738769531, b: 1.1048316955566406, c: 0.14710426330566406, d: 2.3546218872070312
3 wait time: 2.476
299
AG, 0.041860, 1.112064, 0 
perpare first forward gemm: 0.252,  fisrt gemm forward duration: 1.981
AG, 0.233449, 1.880064, 0 
perpare first forward gemm: 0.306,  fisrt gemm forward duration: 2.627
AG, 0.114894, 1.797120, 0 
perpare first forward gemm: 0.267,  fisrt gemm forward duration: 3.403
AG, 0.254181, 1.889280, 0 
perpare first forward gemm: 0.301,  fisrt gemm forward duration: 1.945
GA, 0.041860, 0.776192, 0 
GA, 0.114894, 1.466368, 0 
GA, 0.233449, 1.926144, 0 
GA, 0.254181, 2.034688, 0 
forward:  9.195
forward:  9.98
forward:  9.232
forward:  8.46
AG, 0.041860, 1.127424, 0 
AG, 0.114894, 1.807360, 0 
AG, 0.254181, 1.887232, 0 
AG, 0.233449, 1.900544, 0 
Linear 2 Backward: 2.696, second_gemm: 2.684
Linear 2 Backward: 3.458, second_gemm: 3.447
Linear 2 Backward: 3.693, second_gemm: 3.68
Linear 2 Backward: 3.687, second_gemm: 3.675
GA, 0.041860, 0.770048, 0 
GA, 0.114894, 1.511424, 0 
GA, 0.233449, 1.959936, 0 
GA, 0.254181, 2.066432, 0 
perpare first backward gemm: 0.029,  fisrt gemm backward duration: 3.301,  weight grad: 1.467,  other: 0.432
Linear 1 Backward:  5.28
perpare first backward gemm: 0.03,  fisrt gemm backward duration: 2.497,  weight grad: 1.645,  other: 0.429
Linear 1 Backward:  4.653
perpare first backward gemm: 0.043,  fisrt gemm backward duration: 2.15,  weight grad: 1.895,  other: 0.451
Linear 1 Backward:  4.605
perpare first backward gemm: 0.035,  fisrt gemm backward duration: 2.077,  weight grad: 1.997,  other: 0.428
Linear 1 Backward:  4.589
STEP-9: step_time = 23.447551 ms, foward_time = 12.061696, backward_time = 11.286528, perf = 35.17 tflops.
start
start
start
start
block_info 235 27
block_info 299 76
cuda:2 process time:3.4224987030029297, a: 0.6685256958007812, b: 1.4162063598632812, c: 0.07462501525878906, d: 1.2631416320800781
cuda:3 process time:3.416776657104492, a: 0.6048679351806641, b: 1.421213150024414, c: 0.07867813110351562, d: 1.3120174407958984
block_info 215 9
2 wait time: 1.094
235
block_info 287 67
3 wait time: 1.305
299
cuda:1 process time:3.9720535278320312, a: 0.72479248046875, b: 1.547098159790039, c: 0.11658668518066406, d: 1.5835762023925781
cuda:0 process time:4.021883010864258, a: 0.8435249328613281, b: 1.0366439819335938, c: 0.11181831359863281, d: 2.029895782470703
1 wait time: 2.116
215
0 wait time: 1.625
287
AG, 0.041860, 1.146880, 0 
perpare first forward gemm: 0.25,  fisrt gemm forward duration: 1.535
AG, 0.114894, 1.808384, 0 
perpare first forward gemm: 0.288,  fisrt gemm forward duration: 2.811
AG, 0.254181, 1.893376, 0 
perpare first forward gemm: 0.294,  fisrt gemm forward duration: 2.766
AG, 0.233449, 1.850368, 0 
perpare first forward gemm: 0.33,  fisrt gemm forward duration: 1.924
GA, 0.041860, 0.771072, 0 
GA, 0.114894, 1.594368, 0 
GA, 0.233449, 1.961984, 0 
GA, 0.254181, 2.232320, 0 
forward:  9.64
forward:  8.789
forward:  9.488
forward:  8.983
AG, 0.041860, 1.115136, 0 
AG, 0.233449, 1.859584, 0 
AG, 0.114894, 1.797120, 0 
AG, 0.254181, 1.889280, 0 
Linear 2 Backward: 2.568, second_gemm: 2.555
Linear 2 Backward: 3.354, second_gemm: 3.34
Linear 2 Backward: 3.808, second_gemm: 3.795
Linear 2 Backward: 3.763, second_gemm: 3.749
GA, 0.041860, 0.777216, 0 
GA, 0.114894, 1.495040, 0 
GA, 0.233449, 1.940480, 0 
GA, 0.254181, 2.061312, 0 
perpare first backward gemm: 0.033,  fisrt gemm backward duration: 3.246,  weight grad: 1.474,  other: 0.409
Linear 1 Backward:  5.208
perpare first backward gemm: 0.035,  fisrt gemm backward duration: 2.396,  weight grad: 1.64,  other: 0.411
Linear 1 Backward:  4.528
perpare first backward gemm: 0.04,  fisrt gemm backward duration: 2.123,  weight grad: 1.884,  other: 0.434
Linear 1 Backward:  4.539
perpare first backward gemm: 0.039,  fisrt gemm backward duration: 2.061,  weight grad: 1.987,  other: 0.422
Linear 1 Backward:  4.557
STEP-10: step_time = 22.936577 ms, foward_time = 11.580416, backward_time = 11.256832, perf = 35.95 tflops.
start
start
start
start
block_info 235 27
cuda:2 process time:3.0629634857177734, a: 0.5688667297363281, b: 1.2211799621582031, c: 0.07534027099609375, d: 1.1975765228271484
block_info 215 9
2 wait time: 1.095
235
block_info 287 67
cuda:1 process time:3.7648677825927734, a: 0.8113384246826172, b: 1.2030601501464844, c: 0.11157989501953125, d: 1.6388893127441406
block_info 299 76
cuda:0 process time:3.855466842651367, a: 0.7703304290771484, b: 1.199483871459961, c: 0.11968612670898438, d: 1.7659664154052734
1 wait time: 1.715
215
0 wait time: 2.19
287
cuda:3 process time:4.533529281616211, a: 0.8389949798583984, b: 1.3484954833984375, c: 0.14352798461914062, d: 2.2025108337402344
3 wait time: 2.817
299
AG, 0.041860, 1.129472, 0 
perpare first forward gemm: 0.289,  fisrt gemm forward duration: 2.071
AG, 0.114894, 1.802240, 0 
perpare first forward gemm: 0.266,  fisrt gemm forward duration: 3.425
AG, 0.233449, 1.855488, 0 
perpare first forward gemm: 0.3,  fisrt gemm forward duration: 2.58
AG, 0.254181, 1.892352, 0 
perpare first forward gemm: 0.304,  fisrt gemm forward duration: 1.949
GA, 0.041860, 0.774144, 0 
GA, 0.114894, 1.507328, 0 
GA, 0.233449, 1.915904, 0 
GA, 0.254181, 2.119680, 0 
forward:  9.261
forward:  9.465
forward:  10.09
forward:  8.592
AG, 0.041860, 1.134592, 0 
AG, 0.114894, 1.796096, 0 
AG, 0.233449, 1.858560, 0 
AG, 0.254181, 1.905664, 0 
Linear 2 Backward: 2.594, second_gemm: 2.582
Linear 2 Backward: 3.466, second_gemm: 3.454
Linear 2 Backward: 3.635, second_gemm: 3.623
Linear 2 Backward: 3.612, second_gemm: 3.601
GA, 0.041860, 0.778240, 0 
GA, 0.114894, 1.490944, 0 
GA, 0.233449, 1.956864, 0 
GA, 0.254181, 2.074624, 0 
perpare first backward gemm: 0.029,  fisrt gemm backward duration: 3.279,  weight grad: 1.45,  other: 0.419
Linear 1 Backward:  5.219
perpare first backward gemm: 0.032,  fisrt gemm backward duration: 2.436,  weight grad: 1.634,  other: 0.433
Linear 1 Backward:  4.587
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 2.132,  weight grad: 1.894,  other: 0.433
Linear 1 Backward:  4.546
perpare first backward gemm: 0.034,  fisrt gemm backward duration: 2.109,  weight grad: 1.957,  other: 0.409
Linear 1 Backward:  4.553
STEP-11: step_time = 23.549472 ms, foward_time = 12.373536, backward_time = 11.072512, perf = 35.02 tflops.
start
start
start
start
block_info 235 27
block_info 215 9
cuda:2 process time:3.5207271575927734, a: 0.5941390991210938, b: 1.5287399291992188, c: 0.07343292236328125, d: 1.3244152069091797
block_info 287 67
2 wait time: 0.585
235
cuda:1 process time:3.6268234252929688, a: 0.6680488586425781, b: 1.1703968048095703, c: 0.11086463928222656, d: 1.6775131225585938
cuda:0 process time:4.183053970336914, a: 0.797271728515625, b: 1.4913082122802734, c: 0.118255615234375, d: 1.7762184143066406
block_info 299 76
1 wait time: 1.785
215
0 wait time: 2.201
287
cuda:3 process time:4.628181457519531, a: 0.8847713470458984, b: 1.367330551147461, c: 0.14638900756835938, d: 2.2296905517578125
3 wait time: 2.817
299
AG, 0.041860, 1.133568, 0 
perpare first forward gemm: 0.285,  fisrt gemm forward duration: 2.253
AG, 0.114894, 1.809408, 0 
perpare first forward gemm: 0.296,  fisrt gemm forward duration: 3.369
AG, 0.233449, 1.858560, 0 
perpare first forward gemm: 0.285,  fisrt gemm forward duration: 2.876
AG, 0.254181, 1.946624, 0 
perpare first forward gemm: 0.34,  fisrt gemm forward duration: 2.022
GA, 0.041860, 0.774144, 0 
GA, 0.114894, 1.479680, 0 
GA, 0.233449, 1.967104, 0 
GA, 0.254181, 2.041856, 0 
forward:  9.645
forward:  9.783
forward:  10.234
forward:  8.849
AG, 0.041860, 1.127424, 0 
AG, 0.114894, 1.796096, 0 
AG, 0.233449, 1.875968, 0 
AG, 0.254181, 1.896448, 0 
Linear 2 Backward: 2.538, second_gemm: 2.53
Linear 2 Backward: 3.328, second_gemm: 3.315
Linear 2 Backward: 3.729, second_gemm: 3.72
Linear 2 Backward: 3.864, second_gemm: 3.856
GA, 0.041860, 0.776192, 0 
GA, 0.114894, 1.492992, 0 
GA, 0.233449, 1.913856, 0 
GA, 0.254181, 2.025472, 0 
perpare first backward gemm: 0.025,  fisrt gemm backward duration: 3.211,  weight grad: 1.458,  other: 0.415
Linear 1 Backward:  5.15
perpare first backward gemm: 0.035,  fisrt gemm backward duration: 2.291,  weight grad: 1.642,  other: 0.459
Linear 1 Backward:  4.486
perpare first backward gemm: 0.032,  fisrt gemm backward duration: 2.077,  weight grad: 1.882,  other: 0.433
Linear 1 Backward:  4.467
perpare first backward gemm: 0.03,  fisrt gemm backward duration: 1.979,  weight grad: 1.966,  other: 0.417
Linear 1 Backward:  4.436
STEP-12: step_time = 23.727104 ms, foward_time = 12.678144, backward_time = 10.936320, perf = 34.75 tflops.
start
start
start
start
block_info 235 27
cuda:2 process time:3.0732154846191406, a: 0.6635189056396484, b: 1.1608600616455078, c: 0.07414817810058594, d: 1.1746883392333984
2 wait time: 1.189
235
block_info 287 67
block_info 299 76
block_info 215 9
cuda:0 process time:3.9005279541015625, a: 0.7603168487548828, b: 1.3680458068847656, c: 0.11277198791503906, d: 1.659393310546875
cuda:3 process time:3.7865638732910156, a: 0.7970333099365234, b: 1.1973381042480469, c: 0.11229515075683594, d: 1.6798973083496094
cuda:1 process time:4.04047966003418, a: 0.7469654083251953, b: 1.2044906616210938, c: 0.1461505889892578, d: 1.9428730010986328
0 wait time: 2.062
287
3 wait time: 2.195
299
1 wait time: 2.48
215
AG, 0.041860, 1.116160, 0 
perpare first forward gemm: 0.258,  fisrt gemm forward duration: 1.176
AG, 0.114894, 1.800192, 0 
perpare first forward gemm: 0.269,  fisrt gemm forward duration: 2.908
AG, 0.233449, 1.856512, 0 
perpare first forward gemm: 0.304,  fisrt gemm forward duration: 2.161
AG, 0.254181, 1.899520, 0 
perpare first forward gemm: 0.302,  fisrt gemm forward duration: 2.097
GA, 0.041860, 0.778240, 0 
GA, 0.114894, 1.490944, 0 
GA, 0.233449, 1.959936, 0 
GA, 0.254181, 2.137088, 0 
forward:  8.898
forward:  8.58
forward:  9.637
forward:  8.772
AG, 0.041860, 1.135616, 0 
AG, 0.114894, 1.795072, 0 
AG, 0.233449, 1.857536, 0 
AG, 0.254181, 1.888256, 0 
Linear 2 Backward: 2.731, second_gemm: 2.721
Linear 2 Backward: 3.352, second_gemm: 3.338
Linear 2 Backward: 3.741, second_gemm: 3.729
Linear 2 Backward: 3.827, second_gemm: 3.818
GA, 0.041860, 0.775168, 0 
GA, 0.114894, 1.520640, 0 
GA, 0.233449, 1.968128, 0 
GA, 0.254181, 2.050048, 0 
perpare first backward gemm: 0.026,  fisrt gemm backward duration: 3.271,  weight grad: 1.452,  other: 0.418
Linear 1 Backward:  5.211
perpare first backward gemm: 0.037,  fisrt gemm backward duration: 2.365,  weight grad: 1.645,  other: 0.448
Linear 1 Backward:  4.559
perpare first backward gemm: 0.037,  fisrt gemm backward duration: 2.124,  weight grad: 1.9,  other: 0.437
Linear 1 Backward:  4.554
perpare first backward gemm: 0.03,  fisrt gemm backward duration: 2.113,  weight grad: 1.966,  other: 0.418
Linear 1 Backward:  4.571
STEP-13: step_time = 23.162911 ms, foward_time = 11.800608, backward_time = 11.262976, perf = 35.60 tflops.
start
start
start
start
block_info 235 27
cuda:2 process time:3.219127655029297, a: 0.6034374237060547, b: 1.2712478637695312, c: 0.07343292236328125, d: 1.2710094451904297
block_info 215 9
block_info 287 67
block_info 299 76
2 wait time: 1.009
235
cuda:1 process time:3.957986831665039, a: 0.7891654968261719, b: 1.3620853424072266, c: 0.14591217041015625, d: 1.6608238220214844
cuda:0 process time:4.163980484008789, a: 0.7939338684082031, b: 1.5904903411865234, c: 0.11181831359863281, d: 1.6677379608154297
cuda:3 process time:3.849506378173828, a: 0.6949901580810547, b: 1.1374950408935547, c: 0.11086463928222656, d: 1.9061565399169922
1 wait time: 1.778
215
0 wait time: 2.126
287
3 wait time: 2.056
299
AG, 0.041860, 1.113088, 0 
perpare first forward gemm: 0.247,  fisrt gemm forward duration: 1.723
AG, 0.114894, 1.793024, 0 
perpare first forward gemm: 0.278,  fisrt gemm forward duration: 2.927
AG, 0.233449, 1.858560, 0 
perpare first forward gemm: 0.307,  fisrt gemm forward duration: 2.154
AG, 0.254181, 1.887232, 0 
perpare first forward gemm: 0.355,  fisrt gemm forward duration: 1.962
GA, 0.041860, 0.776192, 0 
GA, 0.114894, 1.462272, 0 
GA, 0.233449, 1.913856, 0 
GA, 0.254181, 2.050048, 0 
forward:  8.956
forward:  9.687
forward:  8.78
forward:  9.136
AG, 0.041860, 1.117184, 0 
AG, 0.254181, 1.878016, 0 
AG, 0.114894, 1.803264, 0 
AG, 0.233449, 1.862656, 0 
Linear 2 Backward: 2.528, second_gemm: 2.515
Linear 2 Backward: 3.469, second_gemm: 3.456
Linear 2 Backward: 3.612, second_gemm: 3.599
Linear 2 Backward: 3.698, second_gemm: 3.684
GA, 0.041860, 0.770048, 0 
GA, 0.114894, 1.476608, 0 
GA, 0.233449, 1.885184, 0 
GA, 0.254181, 2.054144, 0 
perpare first backward gemm: 0.034,  fisrt gemm backward duration: 3.206,  weight grad: 1.477,  other: 0.43
Linear 1 Backward:  5.193
perpare first backward gemm: 0.035,  fisrt gemm backward duration: 2.37,  weight grad: 1.638,  other: 0.41
Linear 1 Backward:  4.499
perpare first backward gemm: 0.04,  fisrt gemm backward duration: 2.116,  weight grad: 1.887,  other: 0.438
Linear 1 Backward:  4.539
perpare first backward gemm: 0.039,  fisrt gemm backward duration: 2.031,  weight grad: 1.98,  other: 0.422
Linear 1 Backward:  4.519
STEP-14: step_time = 23.182400 ms, foward_time = 11.977793, backward_time = 11.104256, perf = 35.57 tflops.
start
start
start
start
block_info 235 27
block_info 215 9
cuda:2 process time:3.3190250396728516, a: 0.5662441253662109, b: 1.4829635620117188, c: 0.07557868957519531, d: 1.1942386627197266
block_info 287 67
cuda:1 process time:3.2939910888671875, a: 0.8697509765625, b: 0.9312629699707031, c: 0.09012222290039062, d: 1.4028549194335938
2 wait time: 1.097
235
1 wait time: 1.434
215
cuda:0 process time:3.9315223693847656, a: 0.7846355438232422, b: 1.382589340209961, c: 0.11134147644042969, d: 1.6529560089111328
block_info 299 76
0 wait time: 2.06
287
cuda:3 process time:4.662513732910156, a: 0.8275508880615234, b: 1.4753341674804688, c: 0.14901161193847656, d: 2.2106170654296875
3 wait time: 2.769
299
AG, 0.041860, 1.111040, 0 
perpare first forward gemm: 0.288,  fisrt gemm forward duration: 2.408
AG, 0.114894, 1.808384, 0 
perpare first forward gemm: 0.268,  fisrt gemm forward duration: 3.509
AG, 0.233449, 1.849344, 0 
perpare first forward gemm: 0.295,  fisrt gemm forward duration: 2.831
AG, 0.254181, 1.892352, 0 
perpare first forward gemm: 0.302,  fisrt gemm forward duration: 1.954
GA, 0.041860, 0.773120, 0 
GA, 0.114894, 1.477632, 0 
GA, 0.233449, 1.906688, 0 
GA, 0.254181, 2.085888, 0 
forward:  9.502
forward:  9.843
forward:  10.182
forward:  8.576
AG, 0.041860, 1.120256, 0 
AG, 0.114894, 1.805312, 0 
AG, 0.233449, 1.868800, 0 
AG, 0.254181, 1.900544, 0 
Linear 2 Backward: 2.473, second_gemm: 2.462
Linear 2 Backward: 3.414, second_gemm: 3.402
Linear 2 Backward: 3.65, second_gemm: 3.639
Linear 2 Backward: 3.723, second_gemm: 3.711
GA, 0.041860, 0.779264, 0 
GA, 0.114894, 1.512448, 0 
GA, 0.233449, 1.838080, 0 
GA, 0.254181, 2.044928, 0 
perpare first backward gemm: 0.026,  fisrt gemm backward duration: 3.27,  weight grad: 1.467,  other: 0.422
Linear 1 Backward:  5.23
perpare first backward gemm: 0.032,  fisrt gemm backward duration: 2.369,  weight grad: 1.633,  other: 0.434
Linear 1 Backward:  4.522
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 2.103,  weight grad: 1.878,  other: 0.428
Linear 1 Backward:  4.497
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 2.018,  weight grad: 1.978,  other: 0.436
Linear 1 Backward:  4.523
STEP-15: step_time = 23.763969 ms, foward_time = 12.407808, backward_time = 11.255808, perf = 34.70 tflops.
start
start
start
start
block_info 235 27
block_info 215 9
block_info 299 76
cuda:2 process time:3.5088062286376953, a: 0.6086826324462891, b: 1.4989376068115234, c: 0.07390975952148438, d: 1.3272762298583984
block_info 287 67
cuda:3 process time:3.454446792602539, a: 0.6079673767089844, b: 1.188516616821289, c: 0.0762939453125, d: 1.5816688537597656
2 wait time: 0.935
235
cuda:1 process time:3.747224807739258, a: 0.8649826049804688, b: 1.1467933654785156, c: 0.1163482666015625, d: 1.619100570678711
cuda:0 process time:3.7775039672851562, a: 0.7796287536621094, b: 1.1775493621826172, c: 0.11277198791503906, d: 1.7075538635253906
3 wait time: 0.744
299
1 wait time: 2.251
215
0 wait time: 2.103
287
AG, 0.041860, 1.134592, 0 
perpare first forward gemm: 0.232,  fisrt gemm forward duration: 1.474
AG, 0.114894, 1.807360, 0 
perpare first forward gemm: 0.295,  fisrt gemm forward duration: 2.379
AG, 0.233449, 1.867776, 0 
perpare first forward gemm: 0.288,  fisrt gemm forward duration: 1.925
AG, 0.254181, 1.931264, 0 
perpare first forward gemm: 0.336,  fisrt gemm forward duration: 2.106
GA, 0.041860, 0.770048, 0 
GA, 0.114894, 1.518592, 0 
GA, 0.233449, 1.973248, 0 
GA, 0.254181, 2.088960, 0 
forward:  8.93
forward:  9.286
forward:  8.753
forward:  8.938
AG, 0.041860, 1.144832, 0 
AG, 0.114894, 1.816576, 0 
AG, 0.254181, 1.885184, 0 
AG, 0.233449, 1.884160, 0 
Linear 2 Backward: 2.656, second_gemm: 2.641
Linear 2 Backward: 3.566, second_gemm: 3.553
Linear 2 Backward: 3.815, second_gemm: 3.806
Linear 2 Backward: 3.726, second_gemm: 3.713
GA, 0.041860, 0.778240, 0 
GA, 0.114894, 1.504256, 0 
GA, 0.254181, 2.073600, 0 
GA, 0.233449, 1.955840, 0 
perpare first backward gemm: 0.035,  fisrt gemm backward duration: 3.196,  weight grad: 1.48,  other: 0.43
Linear 1 Backward:  5.19
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 2.421,  weight grad: 1.64,  other: 0.419
Linear 1 Backward:  4.562
perpare first backward gemm: 0.039,  fisrt gemm backward duration: 2.191,  weight grad: 1.886,  other: 0.452
Linear 1 Backward:  4.626
perpare first backward gemm: 0.041,  fisrt gemm backward duration: 2.02,  weight grad: 1.993,  other: 0.414
Linear 1 Backward:  4.515
STEP-16: step_time = 23.190528 ms, foward_time = 11.781120, backward_time = 11.311104, perf = 35.56 tflops.
start
start
start
start
block_info 235 27
block_info 287 67
cuda:2 process time:3.3562183380126953, a: 0.5400180816650391, b: 1.5552043914794922, c: 0.07486343383789062, d: 1.1861324310302734
block_info 215 9
cuda:0 process time:3.5784244537353516, a: 0.5936622619628906, b: 1.5575885772705078, c: 0.07557868957519531, d: 1.3515949249267578
2 wait time: 1.089
235
block_info 299 76
0 wait time: 1.159
287
cuda:1 process time:3.904104232788086, a: 0.7693767547607422, b: 1.459360122680664, c: 0.11706352233886719, d: 1.5583038330078125
cuda:3 process time:3.8504600524902344, a: 0.7483959197998047, b: 1.0266304016113281, c: 0.11658668518066406, d: 1.9588470458984375
1 wait time: 2.095
215
3 wait time: 2.182
299
AG, 0.041860, 1.126400, 0 
perpare first forward gemm: 0.254,  fisrt gemm forward duration: 1.565
AG, 0.114894, 1.800192, 0 
perpare first forward gemm: 0.266,  fisrt gemm forward duration: 2.901
AG, 0.233449, 1.859584, 0 
perpare first forward gemm: 0.296,  fisrt gemm forward duration: 2.737
AG, 0.254181, 1.886208, 0 
perpare first forward gemm: 0.303,  fisrt gemm forward duration: 1.948
GA, 0.041860, 0.769024, 0 
GA, 0.114894, 1.491968, 0 
GA, 0.233449, 1.938432, 0 
GA, 0.254181, 2.101248, 0 
forward:  9.587
forward:  9.411
forward:  8.902
forward:  8.585
AG, 0.041860, 1.104896, 0 
AG, 0.114894, 1.794048, 0 
AG, 0.233449, 1.860608, 0 
AG, 0.254181, 1.888256, 0 
Linear 2 Backward: 2.525, second_gemm: 2.513
Linear 2 Backward: 3.307, second_gemm: 3.295
Linear 2 Backward: 3.588, second_gemm: 3.578
Linear 2 Backward: 3.661, second_gemm: 3.649
GA, 0.041860, 0.778240, 0 
GA, 0.114894, 1.532928, 0 
GA, 0.233449, 1.956864, 0 
GA, 0.254181, 2.086912, 0 
perpare first backward gemm: 0.031,  fisrt gemm backward duration: 3.202,  weight grad: 1.47,  other: 0.433
Linear 1 Backward:  5.19
perpare first backward gemm: 0.032,  fisrt gemm backward duration: 2.42,  weight grad: 1.635,  other: 0.434
Linear 1 Backward:  4.574
perpare first backward gemm: 0.035,  fisrt gemm backward duration: 2.157,  weight grad: 1.874,  other: 0.423
Linear 1 Backward:  4.538
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 2.055,  weight grad: 1.976,  other: 0.435
Linear 1 Backward:  4.555
STEP-17: step_time = 22.687745 ms, foward_time = 11.399168, backward_time = 11.188224, perf = 36.35 tflops.
start
start
start
block_info 235 27
start
block_info 215 9
block_info 287 67
cuda:2 process time:3.2286643981933594, a: 0.5784034729003906, b: 1.2378692626953125, c: 0.07367134094238281, d: 1.3387203216552734
cuda:0 process time:3.290414810180664, a: 0.6494522094726562, b: 1.0771751403808594, c: 0.07390975952148438, d: 1.489877700805664
cuda:1 process time:3.619670867919922, a: 0.7371902465820312, b: 1.1951923370361328, c: 0.11444091796875, d: 1.5728473663330078
2 wait time: 0.412
235
block_info 299 76
0 wait time: 1.119
287
1 wait time: 1.725
215
cuda:3 process time:4.151582717895508, a: 0.8087158203125, b: 1.116037368774414, c: 0.11992454528808594, d: 2.106904983520508
3 wait time: 1.768
299
AG, 0.041860, 1.096704, 0 
perpare first forward gemm: 0.246,  fisrt gemm forward duration: 1.889
AG, 0.114894, 1.808384, 0 
perpare first forward gemm: 0.296,  fisrt gemm forward duration: 2.783
AG, 0.233449, 1.854464, 0 
perpare first forward gemm: 0.33,  fisrt gemm forward duration: 2.571
AG, 0.254181, 1.950720, 0 
perpare first forward gemm: 0.338,  fisrt gemm forward duration: 2.023
GA, 0.041860, 0.768000, 0 
GA, 0.114894, 1.501184, 0 
GA, 0.233449, 1.949696, 0 
GA, 0.254181, 2.074624, 0 
forward:  9.418
forward:  9.71
forward:  9.493
forward:  8.867
AG, 0.041860, 1.136640, 0 
AG, 0.233449, 1.858560, 0 
AG, 0.254181, 1.930240, 0 
AG, 0.114894, 1.812480, 0 
Linear 2 Backward: 2.568, second_gemm: 2.553
Linear 2 Backward: 3.538, second_gemm: 3.524
Linear 2 Backward: 3.707, second_gemm: 3.695
Linear 2 Backward: 3.707, second_gemm: 3.693
GA, 0.041860, 0.775168, 0 
GA, 0.114894, 1.504256, 0 
GA, 0.254181, 2.007040, 0 
GA, 0.233449, 1.958912, 0 
perpare first backward gemm: 0.035,  fisrt gemm backward duration: 3.22,  weight grad: 1.478,  other: 0.444
Linear 1 Backward:  5.225
perpare first backward gemm: 0.038,  fisrt gemm backward duration: 2.386,  weight grad: 1.647,  other: 0.429
Linear 1 Backward:  4.548
perpare first backward gemm: 0.038,  fisrt gemm backward duration: 2.105,  weight grad: 1.895,  other: 0.435
Linear 1 Backward:  4.529
perpare first backward gemm: 0.042,  fisrt gemm backward duration: 2.042,  weight grad: 1.987,  other: 0.411
Linear 1 Backward:  4.532
STEP-18: step_time = 22.907905 ms, foward_time = 11.617280, backward_time = 11.192320, perf = 36.00 tflops.
start
start
start
start
block_info 235 27
block_info 287 67
cuda:2 process time:3.138303756713867, a: 0.5476474761962891, b: 1.321554183959961, c: 0.07605552673339844, d: 1.1930465698242188
cuda:0 process time:3.4148693084716797, a: 0.667572021484375, b: 1.3217926025390625, c: 0.0762939453125, d: 1.3492107391357422
2 wait time: 1.124
235
block_info 299 76
block_info 215 9
0 wait time: 1.293
287
cuda:3 process time:4.082679748535156, a: 0.7791519165039062, b: 1.2145042419433594, c: 0.12183189392089844, d: 1.9671916961669922
cuda:1 process time:4.207849502563477, a: 0.8437633514404297, b: 1.0981559753417969, c: 0.15306472778320312, d: 2.112865447998047
3 wait time: 1.922
299
1 wait time: 2.203
215
AG, 0.041860, 1.117184, 0 
perpare first forward gemm: 0.288,  fisrt gemm forward duration: 1.192
AG, 0.114894, 1.802240, 0 
perpare first forward gemm: 0.268,  fisrt gemm forward duration: 3.118
AG, 0.233449, 1.857536, 0 
perpare first forward gemm: 0.302,  fisrt gemm forward duration: 2.773
AG, 0.254181, 1.915904, 0 
perpare first forward gemm: 0.311,  fisrt gemm forward duration: 2.302
GA, 0.041860, 0.772096, 0 
GA, 0.114894, 1.509376, 0 
GA, 0.233449, 1.977344, 0 
GA, 0.254181, 2.095104, 0 
forward:  9.516
forward:  9.854
forward:  8.668
forward:  8.994
AG, 0.041860, 1.120256, 0 
AG, 0.233449, 1.856512, 0 
AG, 0.114894, 1.805312, 0 
AG, 0.254181, 1.890304, 0 
Linear 2 Backward: 2.792, second_gemm: 2.782
Linear 2 Backward: 3.58, second_gemm: 3.568
Linear 2 Backward: 3.571, second_gemm: 3.56
Linear 2 Backward: 3.845, second_gemm: 3.833
GA, 0.041860, 0.773120, 0 
GA, 0.114894, 1.510400, 0 
GA, 0.233449, 1.942528, 0 
GA, 0.254181, 2.080768, 0 
perpare first backward gemm: 0.025,  fisrt gemm backward duration: 3.317,  weight grad: 1.457,  other: 0.416
Linear 1 Backward:  5.259
perpare first backward gemm: 0.032,  fisrt gemm backward duration: 2.441,  weight grad: 1.632,  other: 0.434
Linear 1 Backward:  4.59
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 2.139,  weight grad: 1.891,  other: 0.431
Linear 1 Backward:  4.547
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 2.067,  weight grad: 1.976,  other: 0.435
Linear 1 Backward:  4.569
STEP-19: step_time = 23.195649 ms, foward_time = 11.776000, backward_time = 11.319296, perf = 35.55 tflops.
start
start
block_info 235 27
block_info 287 67
start
start
block_info 215 9
cuda:2 process time:3.6716461181640625, a: 0.5850791931152344, b: 1.6803741455078125, c: 0.07390975952148438, d: 1.3322830200195312
cuda:0 process time:3.803730010986328, a: 0.6358623504638672, b: 1.544952392578125, c: 0.0743865966796875, d: 1.5485286712646484
block_info 299 76
2 wait time: 0.441
235
cuda:1 process time:3.6907196044921875, a: 0.8575916290283203, b: 1.2111663818359375, c: 0.12731552124023438, d: 1.4946460723876953
0 wait time: 0.569
287
1 wait time: 2.006
215
cuda:3 process time:4.611968994140625, a: 0.8866786956787109, b: 1.4159679412841797, c: 0.11587142944335938, d: 2.193450927734375
3 wait time: 1.827
299
AG, 0.041860, 1.129472, 0 
perpare first forward gemm: 0.287,  fisrt gemm forward duration: 1.56
AG, 0.114894, 1.795072, 0 
perpare first forward gemm: 0.299,  fisrt gemm forward duration: 2.714
AG, 0.233449, 1.875968, 0 
perpare first forward gemm: 0.331,  fisrt gemm forward duration: 2.513
AG, 0.254181, 1.923072, 0 
perpare first forward gemm: 0.34,  fisrt gemm forward duration: 2
GA, 0.041860, 0.792576, 0 
GA, 0.114894, 1.495040, 0 
GA, 0.233449, 1.895424, 0 
GA, 0.254181, 2.085888, 0 
forward:  9.407
forward:  9.174
forward:  9.627
forward:  8.861
AG, 0.041860, 1.142784, 0 
AG, 0.114894, 1.803264, 0 
AG, 0.233449, 1.867776, 0 
AG, 0.254181, 1.912832, 0 
Linear 2 Backward: 2.676, second_gemm: 2.661
Linear 2 Backward: 3.36, second_gemm: 3.346
Linear 2 Backward: 3.754, second_gemm: 3.742
Linear 2 Backward: 3.705, second_gemm: 3.692
GA, 0.041860, 0.773120, 0 
GA, 0.114894, 1.506304, 0 
GA, 0.233449, 1.942528, 0 
GA, 0.254181, 1.988608, 0 
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 3.108,  weight grad: 1.455,  other: 0.414
Linear 1 Backward:  5.064
perpare first backward gemm: 0.042,  fisrt gemm backward duration: 2.326,  weight grad: 1.643,  other: 0.422
Linear 1 Backward:  4.481
perpare first backward gemm: 0.04,  fisrt gemm backward duration: 2.05,  weight grad: 1.904,  other: 0.442
perpare first backward gemm: 0.03,  fisrt gemm backward duration: 2.025,  weight grad: 1.967,  other: 0.416
Linear 1 Backward:  4.494
Linear 1 Backward:  4.478
STEP-20: step_time = 22.799360 ms, foward_time = 11.474944, backward_time = 11.227136, perf = 36.17 tflops.
start
start
start
start
block_info 235 27
block_info 287 67
block_info 215 9
cuda:2 process time:2.9175281524658203, a: 0.5357265472412109, b: 1.1143684387207031, c: 0.0762939453125, d: 1.1911392211914062
cuda:0 process time:3.348827362060547, a: 0.640869140625, b: 1.1985301971435547, c: 0.08559226989746094, d: 1.4238357543945312
2 wait time: 1.122
block_info 299 76
235
cuda:1 process time:3.4720897674560547, a: 0.9198188781738281, b: 0.8800029754638672, c: 0.11014938354492188, d: 1.5621185302734375
0 wait time: 1.442
287
cuda:3 process time:3.9179325103759766, a: 0.7987022399902344, b: 1.2645721435546875, c: 0.11301040649414062, d: 1.741647720336914
1 wait time: 2.178
215
3 wait time: 2.142
299
AG, 0.041860, 1.113088, 0 
perpare first forward gemm: 0.252,  fisrt gemm forward duration: 1.453
AG, 0.114894, 1.806336, 0 
perpare first forward gemm: 0.266,  fisrt gemm forward duration: 2.712
AG, 0.233449, 1.857536, 0 
perpare first forward gemm: 0.296,  fisrt gemm forward duration: 2.365
AG, 0.254181, 1.914880, 0 
perpare first forward gemm: 0.305,  fisrt gemm forward duration: 1.977
GA, 0.041860, 0.768000, 0 
GA, 0.114894, 1.470464, 0 
GA, 0.233449, 1.947648, 0 
GA, 0.254181, 2.061312, 0 
forward:  9.053
forward:  8.822
forward:  9.407
forward:  8.622
AG, 0.041860, 1.121280, 0 
AG, 0.114894, 1.805312, 0 
AG, 0.233449, 1.854464, 0 
AG, 0.254181, 1.898496, 0 
Linear 2 Backward: 2.566, second_gemm: 2.557
Linear 2 Backward: 3.374, second_gemm: 3.362
Linear 2 Backward: 3.556, second_gemm: 3.545
Linear 2 Backward: 3.591, second_gemm: 3.582
GA, 0.041860, 0.768000, 0 
GA, 0.114894, 1.510400, 0 
GA, 0.233449, 1.965056, 0 
GA, 0.254181, 2.094080, 0 
perpare first backward gemm: 0.024,  fisrt gemm backward duration: 3.323,  weight grad: 1.453,  other: 0.417
Linear 1 Backward:  5.259
perpare first backward gemm: 0.033,  fisrt gemm backward duration: 2.446,  weight grad: 1.634,  other: 0.433
Linear 1 Backward:  4.597
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 2.166,  weight grad: 1.896,  other: 0.431
Linear 1 Backward:  4.581
perpare first backward gemm: 0.031,  fisrt gemm backward duration: 2.167,  weight grad: 1.966,  other: 0.418
Linear 1 Backward:  4.624
STEP-21: step_time = 22.511616 ms, foward_time = 11.431937, backward_time = 10.978304, perf = 36.63 tflops.
start
start
start
start
block_info 235 27
block_info 287 67
cuda:2 process time:3.263235092163086, a: 0.5800724029541016, b: 1.3327598571777344, c: 0.07343292236328125, d: 1.2769699096679688
cuda:0 process time:3.084421157836914, a: 0.6122589111328125, b: 0.9620189666748047, c: 0.07367134094238281, d: 1.436471939086914
block_info 299 76
2 wait time: 0.948
235
block_info 215 9
0 wait time: 1.127
287
cuda:3 process time:3.9741992950439453, a: 0.8604526519775391, b: 1.064300537109375, c: 0.11134147644042969, d: 1.9381046295166016
3 wait time: 1.711
299
cuda:1 process time:4.216432571411133, a: 0.7436275482177734, b: 1.3701915740966797, c: 0.14495849609375, d: 1.9576549530029297
1 wait time: 2.541
215
AG, 0.041860, 1.119232, 0 
perpare first forward gemm: 0.271,  fisrt gemm forward duration: 1.186
AG, 0.114894, 1.797120, 0 
perpare first forward gemm: 0.291,  fisrt gemm forward duration: 2.89
AG, 0.233449, 1.864704, 0 
perpare first forward gemm: 0.312,  fisrt gemm forward duration: 2.693
AG, 0.254181, 1.932288, 0 
perpare first forward gemm: 0.328,  fisrt gemm forward duration: 2.335
GA, 0.041860, 0.773120, 0 
GA, 0.114894, 1.524736, 0 
GA, 0.233449, 1.951744, 0 
GA, 0.254181, 2.174976, 0 
forward:  9.744
forward:  8.671
forward:  9.511
forward:  9.118
AG, 0.041860, 1.106944, 0 
AG, 0.114894, 1.800192, 0 
AG, 0.233449, 1.855488, 0 
AG, 0.254181, 1.905664, 0 
Linear 2 Backward: 2.639, second_gemm: 2.625
Linear 2 Backward: 3.446, second_gemm: 3.432
Linear 2 Backward: 3.618, second_gemm: 3.609
Linear 2 Backward: 3.672, second_gemm: 3.657
GA, 0.041860, 0.778240, 0 
GA, 0.114894, 1.512448, 0 
GA, 0.233449, 1.947648, 0 
GA, 0.254181, 2.075648, 0 
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 3.184,  weight grad: 1.478,  other: 0.448
Linear 1 Backward:  5.212
perpare first backward gemm: 0.038,  fisrt gemm backward duration: 2.351,  weight grad: 1.648,  other: 0.448
Linear 1 Backward:  4.549
perpare first backward gemm: 0.035,  fisrt gemm backward duration: 2.151,  weight grad: 1.891,  other: 0.429
Linear 1 Backward:  4.555
perpare first backward gemm: 0.042,  fisrt gemm backward duration: 2.025,  weight grad: 2.001,  other: 0.453
Linear 1 Backward:  4.595
STEP-22: step_time = 22.680576 ms, foward_time = 11.669504, backward_time = 10.910720, perf = 36.36 tflops.
start
start
start
block_info 287 67
block_info 235 27
cuda:2 process time:3.2122135162353516, a: 0.553131103515625, b: 1.3518333435058594, c: 0.0743865966796875, d: 1.2328624725341797
block_info 215 9
block_info 299 76
cuda:0 process time:3.3206939697265625, a: 0.5581378936767578, b: 1.2977123260498047, c: 0.0762939453125, d: 1.3885498046875
2 wait time: 1.013
235
cuda:1 process time:3.709554672241211, a: 0.7364749908447266, b: 1.1610984802246094, c: 0.12469291687011719, d: 1.6872882843017578
cuda:3 process time:3.4193992614746094, a: 0.6632804870605469, b: 0.9951591491699219, c: 0.08630752563476562, d: 1.674652099609375
start
0 wait time: 0.134
287
3 wait time: 1.316
299
1 wait time: 1.862
215
AG, 0.041860, 1.101824, 0 
perpare first forward gemm: 0.254,  fisrt gemm forward duration: 1.312
AG, 0.114894, 1.808384, 0 
perpare first forward gemm: 0.273,  fisrt gemm forward duration: 2.558
AG, 0.233449, 1.859584, 0 
perpare first forward gemm: 0.332,  fisrt gemm forward duration: 2.013
AG, 0.254181, 1.892352, 0 
perpare first forward gemm: 0.343,  fisrt gemm forward duration: 1.968
GA, 0.041860, 0.769024, 0 
GA, 0.114894, 1.476608, 0 
GA, 0.233449, 1.901568, 0 
GA, 0.254181, 2.094080, 0 
forward:  8.851
forward:  8.758
forward:  9.341
forward:  8.79
AG, 0.041860, 1.125376, 0 
AG, 0.114894, 1.819648, 0 
AG, 0.233449, 1.863680, 0 
AG, 0.254181, 1.901568, 0 
Linear 2 Backward: 2.786, second_gemm: 2.773
Linear 2 Backward: 3.622, second_gemm: 3.61
Linear 2 Backward: 3.81, second_gemm: 3.799
Linear 2 Backward: 3.667, second_gemm: 3.654
GA, 0.041860, 0.778240, 0 
GA, 0.114894, 1.530880, 0 
GA, 0.254181, 2.051072, 0 
GA, 0.233449, 1.976320, 0 
perpare first backward gemm: 0.029,  fisrt gemm backward duration: 3.269,  weight grad: 1.448,  other: 0.422
Linear 1 Backward:  5.213
perpare first backward gemm: 0.033,  fisrt gemm backward duration: 2.415,  weight grad: 1.63,  other: 0.408
Linear 1 Backward:  4.53
perpare first backward gemm: 0.035,  fisrt gemm backward duration: 2.155,  weight grad: 1.891,  other: 0.411
Linear 1 Backward:  4.534
perpare first backward gemm: 0.039,  fisrt gemm backward duration: 2.038,  weight grad: 1.99,  other: 0.409
Linear 1 Backward:  4.523
STEP-23: step_time = 21.069824 ms, foward_time = 10.029056, backward_time = 10.939392, perf = 39.14 tflops.
start
start
start
start
block_info 235 27
block_info 287 67
cuda:2 process time:3.160238265991211, a: 0.5514621734619141, b: 1.344442367553711, c: 0.07677078247070312, d: 1.1875629425048828
cuda:0 process time:3.322601318359375, a: 0.7259845733642578, b: 1.1844635009765625, c: 0.08678436279296875, d: 1.325368881225586
2 wait time: 1.089
235
block_info 215 9
0 wait time: 1.501
287
block_info 299 76
cuda:1 process time:4.203319549560547, a: 0.8087158203125, b: 1.2927055358886719, c: 0.14543533325195312, d: 1.9564628601074219
cuda:3 process time:4.4345855712890625, a: 0.8497238159179688, b: 1.2373924255371094, c: 0.14543533325195312, d: 2.2020339965820312
1 wait time: 2.517
215
3 wait time: 2.722
299
AG, 0.041860, 1.123328, 0 
perpare first forward gemm: 0.252,  fisrt gemm forward duration: 1.532
AG, 0.114894, 1.803264, 0 
perpare first forward gemm: 0.266,  fisrt gemm forward duration: 3.375
AG, 0.254181, 1.895424, 0 
perpare first forward gemm: 0.3,  fisrt gemm forward duration: 1.956
AG, 0.233449, 1.856512, 0 
perpare first forward gemm: 0.279,  fisrt gemm forward duration: 3.157
GA, 0.041860, 0.773120, 0 
GA, 0.114894, 1.491968, 0 
GA, 0.233449, 1.959936, 0 
GA, 0.254181, 2.098176, 0 
forward:  10.045
forward:  8.887
forward:  9.806
forward:  8.599
AG, 0.041860, 1.124352, 0 
AG, 0.233449, 1.848320, 0 
AG, 0.114894, 1.793024, 0 
AG, 0.254181, 1.887232, 0 
Linear 2 Backward: 2.879, second_gemm: 2.869
Linear 2 Backward: 3.631, second_gemm: 3.619
Linear 2 Backward: 3.61, second_gemm: 3.596
Linear 2 Backward: 4.023, second_gemm: 4.016
GA, 0.041860, 0.771072, 0 
GA, 0.114894, 1.519616, 0 
GA, 0.233449, 1.949696, 0 
GA, 0.254181, 2.044928, 0 
perpare first backward gemm: 0.025,  fisrt gemm backward duration: 3.348,  weight grad: 1.454,  other: 0.416
Linear 1 Backward:  5.287
perpare first backward gemm: 0.032,  fisrt gemm backward duration: 2.491,  weight grad: 1.637,  other: 0.434
Linear 1 Backward:  4.648
perpare first backward gemm: 0.042,  fisrt gemm backward duration: 2.13,  weight grad: 1.909,  other: 0.451
perpare first backward gemm: 0.028,  fisrt gemm backward duration: 2.236,  weight grad: 1.958,  other: 0.411
Linear 1 Backward:  4.67
Linear 1 Backward:  4.598
STEP-24: step_time = 23.757824 ms, foward_time = 12.217344, backward_time = 11.439104, perf = 34.71 tflops.
start
start
start
start
block_info 287 67
block_info 235 27
block_info 299 76
cuda:0 process time:3.512144088745117, a: 0.6091594696044922, b: 1.5666484832763672, c: 0.08249282836914062, d: 1.2538433074951172
cuda:2 process time:3.592252731323242, a: 0.6067752838134766, b: 1.590728759765625, c: 0.07343292236328125, d: 1.3213157653808594
cuda:3 process time:3.4875869750976562, a: 0.659942626953125, b: 1.2269020080566406, c: 0.07605552673339844, d: 1.5246868133544922
2 wait time: 0.61
235
0 wait time: 1.421
287
block_info 215 9
3 wait time: 1.135
299
cuda:1 process time:4.164934158325195, a: 0.8521080017089844, b: 1.0218620300292969, c: 0.19097328186035156, d: 2.0999908447265625
1 wait time: 2.147
215
AG, 0.041860, 1.144832, 0 
perpare first forward gemm: 0.284,  fisrt gemm forward duration: 1.218
AG, 0.233449, 1.858560, 0 
perpare first forward gemm: 0.28,  fisrt gemm forward duration: 2.977
AG, 0.114894, 1.800192, 0 
perpare first forward gemm: 0.298,  fisrt gemm forward duration: 2.851
AG, 0.254181, 1.930240, 0 
perpare first forward gemm: 0.336,  fisrt gemm forward duration: 2.588
GA, 0.041860, 0.776192, 0 
GA, 0.114894, 1.510400, 0 
GA, 0.233449, 1.910784, 0 
GA, 0.254181, 2.054144, 0 
forward:  9.716
forward:  8.72
forward:  9.703
forward:  9.374
AG, 0.041860, 1.118208, 0 
AG, 0.114894, 1.801216, 0 
AG, 0.233449, 1.854464, 0 
AG, 0.254181, 1.925120, 0 
Linear 2 Backward: 2.848, second_gemm: 2.834
Linear 2 Backward: 3.442, second_gemm: 3.427
Linear 2 Backward: 3.824, second_gemm: 3.811
Linear 2 Backward: 3.659, second_gemm: 3.646
GA, 0.041860, 0.773120, 0 
GA, 0.114894, 1.512448, 0 
GA, 0.233449, 1.935360, 0 
GA, 0.254181, 2.083840, 0 
perpare first backward gemm: 0.035,  fisrt gemm backward duration: 3.297,  weight grad: 1.477,  other: 0.405
Linear 1 Backward:  5.262
perpare first backward gemm: 0.039,  fisrt gemm backward duration: 2.442,  weight grad: 1.648,  other: 0.41
Linear 1 Backward:  4.587
perpare first backward gemm: 0.041,  fisrt gemm backward duration: 2.147,  weight grad: 1.905,  other: 0.446
Linear 1 Backward:  4.601
perpare first backward gemm: 0.039,  fisrt gemm backward duration: 2.147,  weight grad: 1.984,  other: 0.413
Linear 1 Backward:  4.63
STEP-25: step_time = 23.506943 ms, foward_time = 12.017663, backward_time = 11.387904, perf = 35.08 tflops.
start
start
start
start
block_info 215 9
block_info 235 27
block_info 287 67
cuda:1 process time:2.927064895629883, a: 0.7276535034179688, b: 1.1022090911865234, c: 0.08797645568847656, d: 1.009225845336914
cuda:2 process time:3.045320510864258, a: 0.6115436553955078, b: 1.1715888977050781, c: 0.07486343383789062, d: 1.1873245239257812
cuda:0 process time:3.191709518432617, a: 0.6673336029052734, b: 1.1761188507080078, c: 0.080108642578125, d: 1.268148422241211
2 wait time: 0.988
235
1 wait time: 1.448
215
0 wait time: 1.334
287
block_info 299 76
cuda:3 process time:4.271030426025391, a: 0.6716251373291016, b: 1.0743141174316406, c: 0.14710426330566406, d: 2.3779869079589844
3 wait time: 2.564
299
AG, 0.041860, 1.131520, 0 
perpare first forward gemm: 0.252,  fisrt gemm forward duration: 2.603
AG, 0.114894, 1.796096, 0 
perpare first forward gemm: 0.263,  fisrt gemm forward duration: 3.428
AG, 0.233449, 1.859584, 0 
perpare first forward gemm: 0.285,  fisrt gemm forward duration: 3.068
AG, 0.254181, 1.892352, 0 
perpare first forward gemm: 0.297,  fisrt gemm forward duration: 1.949
GA, 0.041860, 0.772096, 0 
GA, 0.114894, 1.484800, 0 
GA, 0.233449, 1.965056, 0 
GA, 0.254181, 2.046976, 0 
forward:  9.937
forward:  10.039
forward:  9.654
forward:  8.514
AG, 0.041860, 1.122304, 0 
AG, 0.233449, 1.852416, 0 
AG, 0.114894, 1.807360, 0 
AG, 0.254181, 1.881088, 0 
Linear 2 Backward: 2.69, second_gemm: 2.678
Linear 2 Backward: 3.479, second_gemm: 3.467
Linear 2 Backward: 3.546, second_gemm: 3.535
Linear 2 Backward: 3.647, second_gemm: 3.636
GA, 0.041860, 0.772096, 0 
GA, 0.114894, 1.505280, 0 
GA, 0.233449, 1.918976, 0 
GA, 0.254181, 2.089984, 0 
perpare first backward gemm: 0.029,  fisrt gemm backward duration: 3.253,  weight grad: 1.465,  other: 0.442
Linear 1 Backward:  5.241
perpare first backward gemm: 0.031,  fisrt gemm backward duration: 2.413,  weight grad: 1.629,  other: 0.428
Linear 1 Backward:  4.551
perpare first backward gemm: 0.037,  fisrt gemm backward duration: 2.147,  weight grad: 1.877,  other: 0.428
Linear 1 Backward:  4.539
perpare first backward gemm: 0.034,  fisrt gemm backward duration: 2.089,  weight grad: 1.993,  other: 0.432
Linear 1 Backward:  4.601
STEP-26: step_time = 23.183360 ms, foward_time = 11.921408, backward_time = 11.160576, perf = 35.57 tflops.
start
start
start
start
block_info 235 27
cuda:2 process time:3.214120864868164, a: 0.6155967712402344, b: 1.2576580047607422, c: 0.07534027099609375, d: 1.2655258178710938
block_info 287 67
block_info 215 9
2 wait time: 1.055
235
cuda:0 process time:3.4112930297851562, a: 0.6203651428222656, b: 1.2302398681640625, c: 0.07462501525878906, d: 1.486063003540039
0 wait time: 0.973
287
block_info 299 76
cuda:1 process time:3.997325897216797, a: 0.6079673767089844, b: 1.4395713806152344, c: 0.12564659118652344, d: 1.8241405487060547
1 wait time: 2.029
215
cuda:3 process time:4.1675567626953125, a: 0.8065700531005859, b: 1.2695789337158203, c: 0.16307830810546875, d: 1.9283294677734375
3 wait time: 1.971
299
AG, 0.041860, 1.102848, 0 
perpare first forward gemm: 0.241,  fisrt gemm forward duration: 1.767
AG, 0.114894, 1.806336, 0 
perpare first forward gemm: 0.298,  fisrt gemm forward duration: 3.136
AG, 0.233449, 1.861632, 0 
perpare first forward gemm: 0.327,  fisrt gemm forward duration: 2.819
AG, 0.254181, 1.926144, 0 
perpare first forward gemm: 0.335,  fisrt gemm forward duration: 2
GA, 0.041860, 0.774144, 0 
GA, 0.114894, 1.474560, 0 
GA, 0.233449, 1.965056, 0 
GA, 0.254181, 2.077696, 0 
forward:  9.651
forward:  9.202
forward:  9.974
forward:  8.766
AG, 0.041860, 1.115136, 0 
AG, 0.114894, 1.801216, 0 
AG, 0.233449, 1.860608, 0 
AG, 0.254181, 1.878016, 0 
Linear 2 Backward: 2.707, second_gemm: 2.693
Linear 2 Backward: 3.339, second_gemm: 3.325
Linear 2 Backward: 3.677, second_gemm: 3.663
Linear 2 Backward: 3.818, second_gemm: 3.805
GA, 0.041860, 0.777216, 0 
GA, 0.114894, 1.495040, 0 
GA, 0.233449, 1.957888, 0 
GA, 0.254181, 2.078720, 0 
perpare first backward gemm: 0.034,  fisrt gemm backward duration: 3.239,  weight grad: 1.473,  other: 0.409
Linear 1 Backward:  5.203
perpare first backward gemm: 0.035,  fisrt gemm backward duration: 2.415,  weight grad: 1.641,  other: 0.41
Linear 1 Backward:  4.547
perpare first backward gemm: 0.041,  fisrt gemm backward duration: 2.144,  weight grad: 1.888,  other: 0.443
Linear 1 Backward:  4.577
perpare first backward gemm: 0.039,  fisrt gemm backward duration: 2.034,  weight grad: 1.989,  other: 0.413
Linear 1 Backward:  4.523
STEP-27: step_time = 23.108607 ms, foward_time = 11.665408, backward_time = 11.341824, perf = 35.69 tflops.
start
start
start
block_info 235 27
block_info 287 67
cuda:2 process time:2.885580062866211, a: 0.7665157318115234, b: 1.039743423461914, c: 0.08630752563476562, d: 0.9930133819580078
block_info 299 76
2 wait time: 1.411
235
block_info 215 9
start
cuda:0 process time:3.6509037017822266, a: 0.6422996520996094, b: 1.3403892517089844, c: 0.07414817810058594, d: 1.5940666198730469
cuda:3 process time:3.786802291870117, a: 0.8106231689453125, b: 1.3527870178222656, c: 0.10037422180175781, d: 1.5230178833007812
0 wait time: 0.296
287
cuda:1 process time:3.975391387939453, a: 0.7865428924560547, b: 1.3964176177978516, c: 0.12564659118652344, d: 1.6667842864990234
3 wait time: 2.039
299
1 wait time: 2.137
215
AG, 0.041860, 1.130496, 0 
perpare first forward gemm: 0.237,  fisrt gemm forward duration: 1.197
AG, 0.114894, 1.802240, 0 
perpare first forward gemm: 0.269,  fisrt gemm forward duration: 2.604
AG, 0.233449, 1.893376, 0 
AG, 0.254181, 1.905664, 0 
perpare first forward gemm: 0.296,  fisrt gemm forward duration: 1.963
perpare first forward gemm: 0.329,  fisrt gemm forward duration: 2.105
GA, 0.041860, 0.772096, 0 
GA, 0.114894, 1.513472, 0 
GA, 0.233449, 1.955840, 0 
GA, 0.254181, 2.140160, 0 
forward:  8.544
forward:  8.864
forward:  9.31
forward:  8.593
AG, 0.041860, 1.138688, 0 
AG, 0.114894, 1.799168, 0 
AG, 0.254181, 1.883136, 0 
AG, 0.233449, 1.867776, 0 
Linear 2 Backward: 3.035, second_gemm: 3.024
Linear 2 Backward: 3.893, second_gemm: 3.882
Linear 2 Backward: 4.01, second_gemm: 4.0
Linear 2 Backward: 3.665, second_gemm: 3.649
GA, 0.041860, 0.777216, 0 
GA, 0.114894, 1.494016, 0 
GA, 0.254181, 2.067456, 0 
GA, 0.233449, 1.921024, 0 
perpare first backward gemm: 0.028,  fisrt gemm backward duration: 3.187,  weight grad: 1.461,  other: 0.426
Linear 1 Backward:  5.151
perpare first backward gemm: 0.031,  fisrt gemm backward duration: 2.393,  weight grad: 1.63,  other: 0.448
Linear 1 Backward:  4.552
perpare first backward gemm: 0.033,  fisrt gemm backward duration: 2.128,  weight grad: 1.873,  other: 0.436
Linear 1 Backward:  4.518
perpare first backward gemm: 0.035,  fisrt gemm backward duration: 1.98,  weight grad: 1.978,  other: 0.432
Linear 1 Backward:  4.479
STEP-28: step_time = 21.917696 ms, foward_time = 10.611712, backward_time = 11.108352, perf = 37.62 tflops.
start
start
start
block_info 235 27
start
cuda:2 process time:3.248929977416992, a: 0.5803108215332031, b: 1.2843608856201172, c: 0.07414817810058594, d: 1.310110092163086
block_info 215 9
block_info 287 67
block_info 299 76
2 wait time: 0.665
235
cuda:1 process time:4.106283187866211, a: 0.7498264312744141, b: 1.4834403991699219, c: 0.11014938354492188, d: 1.7628669738769531
1 wait time: 1.397
215
cuda:0 process time:3.8712024688720703, a: 0.7047653198242188, b: 1.1873245239257812, c: 0.1475811004638672, d: 1.8315315246582031
cuda:3 process time:4.016399383544922, a: 0.7390975952148438, b: 1.1370182037353516, c: 0.11873245239257812, d: 2.0215511322021484
0 wait time: 1.217
287
3 wait time: 2.118
299
AG, 0.041860, 1.113088, 0 
perpare first forward gemm: 0.246,  fisrt gemm forward duration: 1.899
AG, 0.233449, 1.864704, 0 
perpare first forward gemm: 0.387,  fisrt gemm forward duration: 2.153
AG, 0.114894, 1.802240, 0 
perpare first forward gemm: 0.294,  fisrt gemm forward duration: 2.862
AG, 0.254181, 1.917952, 0 
perpare first forward gemm: 0.34,  fisrt gemm forward duration: 1.993
GA, 0.041860, 0.774144, 0 
GA, 0.114894, 1.476608, 0 
GA, 0.233449, 1.949696, 0 
GA, 0.254181, 2.111488, 0 
forward:  9.432
forward:  9.156
forward:  9.769
forward:  8.874
AG, 0.041860, 1.098752, 0 
AG, 0.114894, 1.810432, 0 
AG, 0.233449, 1.864704, 0 
AG, 0.254181, 1.927168, 0 
Linear 2 Backward: 2.663, second_gemm: 2.649
Linear 2 Backward: 3.406, second_gemm: 3.392
Linear 2 Backward: 3.693, second_gemm: 3.683
Linear 2 Backward: 3.663, second_gemm: 3.649
GA, 0.041860, 0.775168, 0 
GA, 0.114894, 1.488896, 0 
GA, 0.233449, 1.930240, 0 
GA, 0.254181, 2.115584, 0 
perpare first backward gemm: 0.035,  fisrt gemm backward duration: 3.2,  weight grad: 1.497,  other: 0.407
Linear 1 Backward:  5.186
perpare first backward gemm: 0.035,  fisrt gemm backward duration: 2.359,  weight grad: 1.644,  other: 0.407
Linear 1 Backward:  4.491
perpare first backward gemm: 0.029,  fisrt gemm backward duration: 2.173,  weight grad: 1.883,  other: 0.41
Linear 1 Backward:  4.531
perpare first backward gemm: 0.039,  fisrt gemm backward duration: 2.027,  weight grad: 1.988,  other: 0.411
Linear 1 Backward:  4.512
STEP-29: step_time = 22.533120 ms, foward_time = 11.521024, backward_time = 10.898432, perf = 36.60 tflops.
start
start
start
start
block_info 235 27
cuda:2 process time:3.0760765075683594, a: 0.5657672882080078, b: 1.2507438659667969, c: 0.0743865966796875, d: 1.1851787567138672
2 wait time: 1.169
235
block_info 287 67
block_info 215 9
block_info 299 76
cuda:0 process time:3.9319992065429688, a: 0.7579326629638672, b: 1.3518333435058594, c: 0.11420249938964844, d: 1.7080307006835938
0 wait time: 1.677
287
cuda:1 process time:4.561662673950195, a: 0.7545948028564453, b: 1.4607906341552734, c: 0.1518726348876953, d: 2.1944046020507812
cuda:3 process time:4.400014877319336, a: 0.8177757263183594, b: 1.2221336364746094, c: 0.14400482177734375, d: 2.2161006927490234
1 wait time: 1.932
215
3 wait time: 2.831
299
AG, 0.041860, 1.105920, 0 
perpare first forward gemm: 0.253,  fisrt gemm forward duration: 1.445
AG, 0.114894, 1.792000, 0 
perpare first forward gemm: 0.262,  fisrt gemm forward duration: 3.434
AG, 0.233449, 1.854464, 0 
perpare first forward gemm: 0.319,  fisrt gemm forward duration: 2.627
AG, 0.254181, 1.923072, 0 
perpare first forward gemm: 0.297,  fisrt gemm forward duration: 1.981
GA, 0.041860, 0.777216, 0 
GA, 0.114894, 1.491968, 0 
GA, 0.233449, 1.970176, 0 
GA, 0.254181, 2.023424, 0 
forward:  8.783
forward:  10.065
forward:  9.311
forward:  8.554
AG, 0.041860, 1.137664, 0 
AG, 0.114894, 1.810432, 0 
AG, 0.233449, 1.861632, 0 
AG, 0.254181, 1.913856, 0 
Linear 2 Backward: 2.684, second_gemm: 2.669
Linear 2 Backward: 3.619, second_gemm: 3.608
Linear 2 Backward: 3.598, second_gemm: 3.586
Linear 2 Backward: 3.692, second_gemm: 3.681
GA, 0.041860, 0.778240, 0 
GA, 0.114894, 1.502208, 0 
GA, 0.233449, 1.934336, 0 
GA, 0.254181, 2.085888, 0 
perpare first backward gemm: 0.03,  fisrt gemm backward duration: 2.463,  weight grad: 1.627,  other: 0.429
Linear 1 Backward:  4.6
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 3.216,  weight grad: 1.481,  other: 0.451
Linear 1 Backward:  5.248
perpare first backward gemm: 0.038,  fisrt gemm backward duration: 2.145,  weight grad: 1.895,  other: 0.433
Linear 1 Backward:  4.566
perpare first backward gemm: 0.035,  fisrt gemm backward duration: 2.133,  weight grad: 1.977,  other: 0.455
Linear 1 Backward:  4.653
STEP-30: step_time = 23.300096 ms, foward_time = 11.976704, backward_time = 11.211776, perf = 35.39 tflops.
start
start
block_info 235 27
block_info 299 76
block_info 287 67
start
cuda:2 process time:3.3750534057617188, a: 0.4913806915283203, b: 1.4705657958984375, c: 0.07343292236328125, d: 1.3396739959716797
cuda:3 process time:3.217935562133789, a: 0.6124973297119141, b: 0.9977817535400391, c: 0.07581710815429688, d: 1.531839370727539
block_info 215 9
2 wait time: 0.349
cuda:0 process time:3.8585662841796875, a: 0.5664825439453125, b: 1.64794921875, c: 0.16236305236816406, d: 1.481771469116211
235
3 wait time: 1.009
299
cuda:1 process time:4.224300384521484, a: 0.7297992706298828, b: 1.2428760528564453, c: 0.14853477478027344, d: 2.103090286254883
start
0 wait time: 0.01
287
1 wait time: 2.171
215
AG, 0.041860, 1.100800, 0 
perpare first forward gemm: 0.255,  fisrt gemm forward duration: 1.186
AG, 0.114894, 1.795072, 0 
perpare first forward gemm: 0.296,  fisrt gemm forward duration: 2.509
AG, 0.233449, 1.864704, 0 
perpare first forward gemm: 0.384,  fisrt gemm forward duration: 1.943
AG, 0.254181, 1.907712, 0 
perpare first forward gemm: 0.343,  fisrt gemm forward duration: 2.489
GA, 0.041860, 0.771072, 0 
GA, 0.114894, 1.484800, 0 
GA, 0.233449, 1.867776, 0 
GA, 0.254181, 2.052096, 0 
forward:  9.364
forward:  8.677
forward:  9.313
forward:  8.885
AG, 0.041860, 1.138688, 0 
AG, 0.233449, 1.862656, 0 
AG, 0.114894, 1.806336, 0 
AG, 0.254181, 1.923072, 0 
Linear 2 Backward: 2.881, second_gemm: 2.869
Linear 2 Backward: 3.731, second_gemm: 3.717
Linear 2 Backward: 3.898, second_gemm: 3.888
Linear 2 Backward: 3.658, second_gemm: 3.644
GA, 0.041860, 0.779264, 0 
GA, 0.114894, 1.525760, 0 
GA, 0.233449, 1.866752, 0 
GA, 0.254181, 2.093056, 0 
perpare first backward gemm: 0.032,  fisrt gemm backward duration: 3.192,  weight grad: 1.47,  other: 0.409
Linear 1 Backward:  5.147
perpare first backward gemm: 0.034,  fisrt gemm backward duration: 2.343,  weight grad: 1.639,  other: 0.407
Linear 1 Backward:  4.469
perpare first backward gemm: 0.03,  fisrt gemm backward duration: 2.14,  weight grad: 1.876,  other: 0.409
Linear 1 Backward:  4.491
perpare first backward gemm: 0.04,  fisrt gemm backward duration: 1.994,  weight grad: 1.999,  other: 0.413
Linear 1 Backward:  4.494
STEP-31: step_time = 21.010432 ms, foward_time = 9.857024, backward_time = 11.042816, perf = 39.25 tflops.
start
start
start
start
block_info 235 27
cuda:2 process time:3.391742706298828, a: 0.5514621734619141, b: 1.5780925750732422, c: 0.07486343383789062, d: 1.1873245239257812
block_info 215 9
2 wait time: 0.994
235
cuda:1 process time:3.8232803344726562, a: 0.8482933044433594, b: 1.3892650604248047, c: 0.11372566223144531, d: 1.4719963073730469
block_info 287 67
block_info 299 76
1 wait time: 1.92
215
cuda:0 process time:4.520654678344727, a: 0.8337497711181641, b: 1.2049674987792969, c: 0.14829635620117188, d: 2.3336410522460938
cuda:3 process time:4.612445831298828, a: 0.8332729339599609, b: 1.4216899871826172, c: 0.14519691467285156, d: 2.2122859954833984
0 wait time: 2.543
287
3 wait time: 2.902
299
AG, 0.041860, 1.114112, 0 
perpare first forward gemm: 0.254,  fisrt gemm forward duration: 2.273
AG, 0.233449, 1.841152, 0 
perpare first forward gemm: 0.322,  fisrt gemm forward duration: 1.987
AG, 0.114894, 1.802240, 0 
perpare first forward gemm: 0.262,  fisrt gemm forward duration: 3.635
AG, 0.254181, 1.916928, 0 
perpare first forward gemm: 0.301,  fisrt gemm forward duration: 1.972
GA, 0.041860, 0.768000, 0 
GA, 0.114894, 1.507328, 0 
GA, 0.233449, 1.831936, 0 
GA, 0.254181, 2.022400, 0 
forward:  9.563
forward:  10.223
forward:  8.498
forward:  8.644
AG, 0.041860, 1.141760, 0 
AG, 0.114894, 1.798144, 0 
AG, 0.233449, 1.849344, 0 
AG, 0.254181, 1.906688, 0 
Linear 2 Backward: 2.778, second_gemm: 2.767
Linear 2 Backward: 3.615, second_gemm: 3.604
Linear 2 Backward: 3.618, second_gemm: 3.606
Linear 2 Backward: 3.632, second_gemm: 3.62
GA, 0.041860, 0.773120, 0 
GA, 0.114894, 1.552384, 0 
GA, 0.233449, 1.937408, 0 
GA, 0.254181, 2.106368, 0 
perpare first backward gemm: 0.029,  fisrt gemm backward duration: 3.273,  weight grad: 1.464,  other: 0.428
Linear 1 Backward:  5.246
perpare first backward gemm: 0.034,  fisrt gemm backward duration: 2.479,  weight grad: 1.646,  other: 0.433
Linear 1 Backward:  4.645
perpare first backward gemm: 0.037,  fisrt gemm backward duration: 2.166,  weight grad: 1.897,  other: 0.451
Linear 1 Backward:  4.606
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 2.102,  weight grad: 1.963,  other: 0.433
Linear 1 Backward:  4.589
STEP-32: step_time = 23.615488 ms, foward_time = 12.163072, backward_time = 11.341824, perf = 34.92 tflops.
start
block_info 235 27
start
start
cuda:2 process time:3.641366958618164, a: 0.5612373352050781, b: 1.89971923828125, c: 0.07319450378417969, d: 1.1072158813476562
block_info 215 9
block_info 299 76
start
cuda:1 process time:4.265308380126953, a: 0.7128715515136719, b: 1.8341541290283203, c: 0.12922286987304688, d: 1.589059829711914
2 wait time: 0.011
235
1 wait time: 1.644
215
cuda:3 process time:4.315376281738281, a: 0.69427490234375, b: 1.4679431915283203, c: 0.1456737518310547, d: 2.0074844360351562
block_info 287 67
3 wait time: 1.786
299
cuda:0 process time:4.782915115356445, a: 0.9286403656005859, b: 1.1720657348632812, c: 0.1480579376220703, d: 2.534151077270508
0 wait time: 2.258
287
AG, 0.041860, 1.098752, 0 
perpare first forward gemm: 0.247,  fisrt gemm forward duration: 2.683
AG, 0.233449, 1.842176, 0 
perpare first forward gemm: 0.368,  fisrt gemm forward duration: 1.922
AG, 0.114894, 1.796096, 0 
perpare first forward gemm: 0.296,  fisrt gemm forward duration: 3.492
AG, 0.254181, 1.923072, 0 
perpare first forward gemm: 0.337,  fisrt gemm forward duration: 2.754
GA, 0.041860, 0.770048, 0 
GA, 0.114894, 1.479680, 0 
GA, 0.233449, 1.974272, 0 
GA, 0.254181, 2.069504, 0 
forward:  10.173
forward:  9.584
forward:  8.895
forward:  10.473
AG, 0.041860, 1.123328, 0 
AG, 0.114894, 1.810432, 0 
AG, 0.233449, 1.837056, 0 
AG, 0.254181, 1.883136, 0 
Linear 2 Backward: 2.538, second_gemm: 2.526
Linear 2 Backward: 3.408, second_gemm: 3.4
Linear 2 Backward: 3.67, second_gemm: 3.663
Linear 2 Backward: 3.634, second_gemm: 3.621
GA, 0.041860, 0.772096, 0 
GA, 0.114894, 1.506304, 0 
GA, 0.233449, 1.928192, 0 
GA, 0.254181, 2.063360, 0 
perpare first backward gemm: 0.032,  fisrt gemm backward duration: 3.275,  weight grad: 1.471,  other: 0.438
Linear 1 Backward:  5.273
perpare first backward gemm: 0.023,  fisrt gemm backward duration: 2.596,  weight grad: 1.614,  other: 0.405
Linear 1 Backward:  4.673
perpare first backward gemm: 0.046,  fisrt gemm backward duration: 2.15,  weight grad: 1.907,  other: 0.45
Linear 1 Backward:  4.621
perpare first backward gemm: 0.027,  fisrt gemm backward duration: 2.282,  weight grad: 1.943,  other: 0.41
Linear 1 Backward:  4.698
STEP-33: step_time = 23.737344 ms, foward_time = 12.294144, backward_time = 11.330560, perf = 34.74 tflops.
start
start
start
start
block_info 235 27
cuda:2 process time:3.679513931274414, a: 0.5655288696289062, b: 1.6949176788330078, c: 0.07319450378417969, d: 1.3458728790283203
2 wait time: 0.898
235
block_info 299 76
block_info 287 67
block_info 215 9
cuda:3 process time:4.179239273071289, a: 0.8490085601806641, b: 1.2881755828857422, c: 0.11110305786132812, d: 1.9309520721435547
cuda:0 process time:4.047870635986328, a: 0.7371902465820312, b: 1.1255741119384766, c: 0.10895729064941406, d: 2.0761489868164062
cuda:1 process time:4.693031311035156, a: 0.7531642913818359, b: 1.6121864318847656, c: 0.1480579376220703, d: 2.1796226501464844
3 wait time: 2.041
299
0 wait time: 1.71
287
1 wait time: 1.923
215
AG, 0.041860, 1.111040, 0 
perpare first forward gemm: 0.289,  fisrt gemm forward duration: 1.28
AG, 0.114894, 1.800192, 0 
perpare first forward gemm: 0.281,  fisrt gemm forward duration: 3.191
AG, 0.233449, 1.861632, 0 
perpare first forward gemm: 0.372,  fisrt gemm forward duration: 1.955
AG, 0.254181, 1.936384, 0 
perpare first forward gemm: 0.338,  fisrt gemm forward duration: 2.292
GA, 0.041860, 0.776192, 0 
GA, 0.114894, 1.486848, 0 
GA, 0.233449, 1.932288, 0 
GA, 0.254181, 2.085888, 0 
forward:  10.089
forward:  8.916
forward:  9.146
forward:  8.95
AG, 0.041860, 1.123328, 0 
AG, 0.233449, 1.850368, 0 
AG, 0.114894, 1.806336, 0 
AG, 0.254181, 1.925120, 0 
Linear 2 Backward: 2.821, second_gemm: 2.807
Linear 2 Backward: 3.668, second_gemm: 3.653
Linear 2 Backward: 3.877, second_gemm: 3.864
Linear 2 Backward: 3.653, second_gemm: 3.638
GA, 0.041860, 0.780288, 0 
GA, 0.114894, 1.519616, 0 
GA, 0.233449, 1.918976, 0 
GA, 0.254181, 2.036736, 0 
perpare first backward gemm: 0.033,  fisrt gemm backward duration: 3.242,  weight grad: 1.473,  other: 0.42
Linear 1 Backward:  5.216
perpare first backward gemm: 0.037,  fisrt gemm backward duration: 2.371,  weight grad: 1.645,  other: 0.41
Linear 1 Backward:  4.51
perpare first backward gemm: 0.04,  fisrt gemm backward duration: 2.099,  weight grad: 1.903,  other: 0.444
Linear 1 Backward:  4.543
perpare first backward gemm: 0.042,  fisrt gemm backward duration: 2.051,  weight grad: 1.993,  other: 0.409
Linear 1 Backward:  4.545
STEP-34: step_time = 23.185409 ms, foward_time = 11.756544, backward_time = 11.319296, perf = 35.57 tflops.
start
start
start
start
block_info 235 27
cuda:2 process time:3.275156021118164, a: 0.5776882171630859, b: 1.4469623565673828, c: 0.07414817810058594, d: 1.1763572692871094
block_info 215 9
2 wait time: 1.004
235
block_info 287 67
cuda:1 process time:3.7736892700195312, a: 0.7693767547607422, b: 1.4197826385498047, c: 0.11324882507324219, d: 1.4712810516357422
cuda:0 process time:3.7262439727783203, a: 0.6964206695556641, b: 1.0879039764404297, c: 0.11157989501953125, d: 1.8303394317626953
block_info 299 76
1 wait time: 1.957
215
0 wait time: 2.035
287
cuda:3 process time:4.60052490234375, a: 0.7970333099365234, b: 1.3341903686523438, c: 0.1494884490966797, d: 2.319812774658203
3 wait time: 2.845
299
AG, 0.041860, 1.128448, 0 
perpare first forward gemm: 0.256,  fisrt gemm forward duration: 2.195
AG, 0.114894, 1.799168, 0 
perpare first forward gemm: 0.255,  fisrt gemm forward duration: 3.678
AG, 0.233449, 1.843200, 0 
perpare first forward gemm: 0.323,  fisrt gemm forward duration: 2.604
AG, 0.254181, 1.923072, 0 
perpare first forward gemm: 0.307,  fisrt gemm forward duration: 1.986
GA, 0.041860, 0.774144, 0 
GA, 0.114894, 1.483776, 0 
GA, 0.233449, 1.936384, 0 
GA, 0.254181, 2.115584, 0 
forward:  10.417
forward:  9.695
forward:  8.705
forward:  9.426
AG, 0.041860, 1.125376, 0 
AG, 0.233449, 1.843200, 0 
AG, 0.114894, 1.796096, 0 
AG, 0.254181, 1.892352, 0 
Linear 2 Backward: 2.66, second_gemm: 2.649
Linear 2 Backward: 3.427, second_gemm: 3.417
Linear 2 Backward: 3.615, second_gemm: 3.604
Linear 2 Backward: 3.665, second_gemm: 3.65
GA, 0.041860, 0.775168, 0 
GA, 0.114894, 1.510400, 0 
GA, 0.254181, 2.043904, 0 
GA, 0.233449, 1.961984, 0 
perpare first backward gemm: 0.029,  fisrt gemm backward duration: 3.284,  weight grad: 1.465,  other: 0.427
Linear 1 Backward:  5.256
perpare first backward gemm: 0.03,  fisrt gemm backward duration: 2.477,  weight grad: 1.63,  other: 0.445
Linear 1 Backward:  4.632
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 2.172,  weight grad: 1.892,  other: 0.43
Linear 1 Backward:  4.581
perpare first backward gemm: 0.042,  fisrt gemm backward duration: 2.031,  weight grad: 1.978,  other: 0.448
Linear 1 Backward:  4.564
STEP-35: step_time = 23.759871 ms, foward_time = 12.425216, backward_time = 11.222016, perf = 34.71 tflops.
start
start
start
block_info 235 27
block_info 299 76
block_info 215 9
start
cuda:3 process time:3.666400909423828, a: 0.766754150390625, b: 1.711130142211914, c: 0.07677078247070312, d: 1.111745834350586
cuda:2 process time:3.999471664428711, a: 0.5810260772705078, b: 2.001047134399414, c: 0.07486343383789062, d: 1.3425350189208984
2 wait time: 0.226
235
cuda:1 process time:4.26173210144043, a: 0.7102489471435547, b: 1.9633769989013672, c: 0.11110305786132812, d: 1.4770030975341797
3 wait time: 1.601
299
block_info 287 67
1 wait time: 1.89
215
cuda:0 process time:4.0874481201171875, a: 0.7574558258056641, b: 1.110076904296875, c: 0.11801719665527344, d: 2.101898193359375
0 wait time: 1.904
287
AG, 0.041860, 1.121280, 0 
perpare first forward gemm: 0.262,  fisrt gemm forward duration: 2.053
AG, 0.233449, 1.844224, 0 
perpare first forward gemm: 0.37,  fisrt gemm forward duration: 1.924
AG, 0.254181, 1.891328, 0 
AG, 0.114894, 1.801216, 0 
perpare first forward gemm: 0.294,  fisrt gemm forward duration: 3.089
perpare first forward gemm: 0.301,  fisrt gemm forward duration: 3.033
GA, 0.041860, 0.768000, 0 
GA, 0.114894, 1.556480, 0 
GA, 0.233449, 1.905664, 0 
GA, 0.254181, 2.183168, 0 
forward:  9.915
forward:  8.831
forward:  9.764
forward:  9.547
AG, 0.041860, 1.140736, 0 
AG, 0.114894, 1.803264, 0 
AG, 0.233449, 1.852416, 0 
AG, 0.254181, 1.902592, 0 
Linear 2 Backward: 2.599, second_gemm: 2.587
Linear 2 Backward: 3.513, second_gemm: 3.499
Linear 2 Backward: 3.767, second_gemm: 3.753
Linear 2 Backward: 3.689, second_gemm: 3.676
GA, 0.041860, 0.774144, 0 
GA, 0.114894, 1.513472, 0 
GA, 0.233449, 1.936384, 0 
GA, 0.254181, 2.091008, 0 
perpare first backward gemm: 0.032,  fisrt gemm backward duration: 3.293,  weight grad: 1.471,  other: 0.44
Linear 1 Backward:  5.293
perpare first backward gemm: 0.035,  fisrt gemm backward duration: 2.498,  weight grad: 1.639,  other: 0.441
Linear 1 Backward:  4.673
perpare first backward gemm: 0.044,  fisrt gemm backward duration: 2.158,  weight grad: 1.912,  other: 0.45
Linear 1 Backward:  4.63
perpare first backward gemm: 0.04,  fisrt gemm backward duration: 2.102,  weight grad: 1.975,  other: 0.443
Linear 1 Backward:  4.622
STEP-36: step_time = 23.584769 ms, foward_time = 11.879424, backward_time = 11.593728, perf = 34.96 tflops.
start
start
start
start
block_info 235 27
cuda:2 process time:3.5126209259033203, a: 0.5769729614257812, b: 1.5614032745361328, c: 0.07319450378417969, d: 1.3010501861572266
block_info 215 9
2 wait time: 0.501
235
block_info 299 76
cuda:1 process time:3.8466453552246094, a: 0.7474422454833984, b: 1.2726783752441406, c: 0.11157989501953125, d: 1.714944839477539
1 wait time: 1.462
215
cuda:3 process time:4.071712493896484, a: 0.6566047668457031, b: 1.2965202331542969, c: 0.12445449829101562, d: 1.9941329956054688
3 wait time: 2.105
299
block_info 287 67
cuda:0 process time:7.065773010253906, a: 0.5948543548583984, b: 1.3155937194824219, c: 0.08726119995117188, d: 5.068063735961914
0 wait time: 4.557
287
AG, 0.041860, 1.148928, 0 
perpare first forward gemm: 0.245,  fisrt gemm forward duration: 5.011
AG, 0.114894, 1.805312, 0 
perpare first forward gemm: 0.29,  fisrt gemm forward duration: 6.178
AG, 0.254181, 1.891328, 0 
perpare first forward gemm: 0.296,  fisrt gemm forward duration: 5.108
AG, 0.233449, 1.868800, 0 
perpare first forward gemm: 0.369,  fisrt gemm forward duration: 1.95
GA, 0.041860, 0.771072, 0 
GA, 0.114894, 1.471488, 0 
GA, 0.233449, 1.899520, 0 
GA, 0.254181, 2.108416, 0 
forward:  12.899
forward:  12.326
forward:  8.755
forward:  11.743
AG, 0.041860, 1.118208, 0 
AG, 0.233449, 1.853440, 0 
AG, 0.114894, 1.785856, 0 
AG, 0.254181, 1.893376, 0 
Linear 2 Backward: 2.572, second_gemm: 2.557
Linear 2 Backward: 3.584, second_gemm: 3.576
Linear 2 Backward: 3.713, second_gemm: 3.699
Linear 2 Backward: 3.728, second_gemm: 3.72
GA, 0.041860, 0.781312, 0 
GA, 0.114894, 1.511424, 0 
GA, 0.233449, 1.934336, 0 
GA, 0.254181, 2.045952, 0 
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 3.227,  weight grad: 1.481,  other: 0.451
Linear 1 Backward:  5.261
perpare first backward gemm: 0.023,  fisrt gemm backward duration: 2.601,  weight grad: 1.614,  other: 0.407
Linear 1 Backward:  4.679
perpare first backward gemm: 0.047,  fisrt gemm backward duration: 2.117,  weight grad: 1.894,  other: 0.448
perpare first backward gemm: 0.027,  fisrt gemm backward duration: 2.243,  weight grad: 1.962,  other: 0.422
Linear 1 Backward:  4.572
Linear 1 Backward:  4.691
STEP-37: step_time = 25.651201 ms, foward_time = 14.307328, backward_time = 11.231232, perf = 32.15 tflops.
start
start
start
block_info 235 27
block_info 215 9
block_info 299 76
start
block_info 287 67
cuda:2 process time:3.353118896484375, a: 0.5581378936767578, b: 1.3942718505859375, c: 0.07390975952148438, d: 1.3267993927001953
2 wait time: 0.294
235
cuda:3 process time:3.5660266876220703, a: 0.6406307220458984, b: 1.2547969818115234, c: 0.091552734375, d: 1.5790462493896484
cuda:1 process time:3.7283897399902344, a: 0.7421970367431641, b: 1.245260238647461, c: 0.110626220703125, d: 1.6303062438964844
cuda:0 process time:3.504514694213867, a: 0.6766319274902344, b: 1.055002212524414, c: 0.10561943054199219, d: 1.6672611236572266
1 wait time: 1.677
215
3 wait time: 1.793
299
0 wait time: 1.855
287
AG, 0.041860, 1.117184, 0 
perpare first forward gemm: 0.251,  fisrt gemm forward duration: 1.504
AG, 0.254181, 1.894400, 0 
AG, 0.114894, 1.807360, 0 
perpare first forward gemm: 0.293,  fisrt gemm forward duration: 2.425
AG, 0.233449, 1.862656, 0 
perpare first forward gemm: 0.313,  fisrt gemm forward duration: 1.923
perpare first forward gemm: 0.3,  fisrt gemm forward duration: 2.089
GA, 0.041860, 0.780288, 0 
GA, 0.114894, 1.607680, 0 
GA, 0.233449, 1.963008, 0 
GA, 0.254181, 2.134016, 0 
forward:  8.707
forward:  9.207
forward:  8.909
forward:  8.804
AG, 0.041860, 1.110016, 0 
AG, 0.254181, 1.885184, 0 
AG, 0.233449, 1.859584, 0 
AG, 0.114894, 1.808384, 0 
Linear 2 Backward: 2.58, second_gemm: 2.567
Linear 2 Backward: 3.374, second_gemm: 3.361
Linear 2 Backward: 3.518, second_gemm: 3.509
Linear 2 Backward: 3.663, second_gemm: 3.649
GA, 0.041860, 0.781312, 0 
GA, 0.114894, 1.506304, 0 
GA, 0.254181, 2.074624, 0 
GA, 0.233449, 1.952768, 0 
perpare first backward gemm: 0.032,  fisrt gemm backward duration: 3.231,  weight grad: 1.472,  other: 0.428
Linear 1 Backward:  5.21
perpare first backward gemm: 0.034,  fisrt gemm backward duration: 2.354,  weight grad: 1.639,  other: 0.407
Linear 1 Backward:  4.48
perpare first backward gemm: 0.032,  fisrt gemm backward duration: 2.193,  weight grad: 1.865,  other: 0.406
Linear 1 Backward:  4.544
perpare first backward gemm: 0.039,  fisrt gemm backward duration: 2.017,  weight grad: 1.986,  other: 0.413
Linear 1 Backward:  4.503
STEP-38: step_time = 22.518784 ms, foward_time = 11.534336, backward_time = 10.874880, perf = 36.62 tflops.
start
start
start
start
block_info 235 27
cuda:2 process time:3.4987926483154297, a: 0.553131103515625, b: 1.687765121459961, c: 0.07462501525878906, d: 1.1832714080810547
2 wait time: 1.002
235
block_info 287 67
block_info 215 9
cuda:0 process time:3.728151321411133, a: 0.8199214935302734, b: 1.2969970703125, c: 0.1049041748046875, d: 1.5063285827636719
cuda:1 process time:3.894329071044922, a: 0.8521080017089844, b: 1.1286735534667969, c: 0.11873245239257812, d: 1.7948150634765625
block_info 299 76
1 wait time: 1.778
215
0 wait time: 2.051
287
cuda:3 process time:4.651069641113281, a: 0.7772445678710938, b: 1.1844635009765625, c: 0.14829635620117188, d: 2.541065216064453
3 wait time: 2.351
299
AG, 0.041860, 1.143808, 0 
perpare first forward gemm: 0.292,  fisrt gemm forward duration: 2.31
AG, 0.114894, 1.802240, 0 
perpare first forward gemm: 0.266,  fisrt gemm forward duration: 3.876
AG, 0.233449, 1.854464, 0 
perpare first forward gemm: 0.326,  fisrt gemm forward duration: 2.854
AG, 0.254181, 1.921024, 0 
perpare first forward gemm: 0.335,  fisrt gemm forward duration: 1.988
GA, 0.041860, 0.772096, 0 
GA, 0.114894, 1.459200, 0 
GA, 0.233449, 1.925120, 0 
GA, 0.254181, 2.057216, 0 
forward:  10.516
forward:  8.635
forward:  9.635
forward:  9.681
AG, 0.041860, 1.118208, 0 
AG, 0.114894, 1.803264, 0 
AG, 0.233449, 1.854464, 0 
AG, 0.254181, 1.916928, 0 
Linear 2 Backward: 2.704, second_gemm: 2.692
Linear 2 Backward: 3.537, second_gemm: 3.525
Linear 2 Backward: 3.73, second_gemm: 3.716
Linear 2 Backward: 3.623, second_gemm: 3.611
GA, 0.041860, 0.775168, 0 
GA, 0.114894, 1.497088, 0 
GA, 0.233449, 1.952768, 0 
GA, 0.254181, 2.020352, 0 
perpare first backward gemm: 0.031,  fisrt gemm backward duration: 3.307,  weight grad: 1.472,  other: 0.461
Linear 1 Backward:  5.326
perpare first backward gemm: 0.031,  fisrt gemm backward duration: 2.474,  weight grad: 1.637,  other: 0.432
Linear 1 Backward:  4.626
perpare first backward gemm: 0.043,  fisrt gemm backward duration: 2.086,  weight grad: 1.903,  other: 0.47
Linear 1 Backward:  4.57
perpare first backward gemm: 0.035,  fisrt gemm backward duration: 2.119,  weight grad: 1.981,  other: 0.436
Linear 1 Backward:  4.626
STEP-39: step_time = 24.084193 ms, foward_time = 12.688096, backward_time = 11.283456, perf = 34.24 tflops.
start
start
start
start
block_info 299 76
block_info 235 27
cuda:2 process time:3.701448440551758, a: 0.5846023559570312, b: 1.7244815826416016, c: 0.07414817810058594, d: 1.318216323852539
cuda:3 process time:3.3550262451171875, a: 0.8068084716796875, b: 0.9708404541015625, c: 0.07963180541992188, d: 1.4977455139160156
block_info 215 9
2 wait time: 0.501
235
3 wait time: 1.235
299
block_info 287 67
cuda:1 process time:4.0493011474609375, a: 0.7109642028808594, b: 1.2941360473632812, c: 0.11587142944335938, d: 1.9283294677734375
cuda:0 process time:4.246711730957031, a: 0.6830692291259766, b: 1.462697982788086, c: 0.11873245239257812, d: 1.9822120666503906
1 wait time: 1.491
215
0 wait time: 2.145
287
AG, 0.041860, 1.129472, 0 
perpare first forward gemm: 0.291,  fisrt gemm forward duration: 1.452
AG, 0.114894, 1.799168, 0 
perpare first forward gemm: 0.295,  fisrt gemm forward duration: 2.927
AG, 0.233449, 1.864704, 0 
perpare first forward gemm: 0.313,  fisrt gemm forward duration: 1.924
AG, 0.254181, 1.888256, 0 
perpare first forward gemm: 0.346,  fisrt gemm forward duration: 2.856
GA, 0.041860, 0.776192, 0 
GA, 0.114894, 1.490944, 0 
GA, 0.233449, 1.954816, 0 
GA, 0.254181, 2.085888, 0 
forward:  9.756
forward:  8.953
forward:  9.696
forward:  8.724
AG, 0.041860, 1.112064, 0 
AG, 0.233449, 1.860608, 0 
AG, 0.114894, 1.801216, 0 
AG, 0.254181, 1.900544, 0 
Linear 2 Backward: 2.691, second_gemm: 2.678
Linear 2 Backward: 3.526, second_gemm: 3.512
Linear 2 Backward: 3.645, second_gemm: 3.636
Linear 2 Backward: 3.661, second_gemm: 3.647
GA, 0.041860, 0.779264, 0 
GA, 0.114894, 1.526784, 0 
GA, 0.254181, 2.101248, 0 
GA, 0.233449, 1.984512, 0 
perpare first backward gemm: 0.033,  fisrt gemm backward duration: 3.247,  weight grad: 1.488,  other: 0.407
Linear 1 Backward:  5.22
perpare first backward gemm: 0.034,  fisrt gemm backward duration: 2.444,  weight grad: 1.648,  other: 0.416
Linear 1 Backward:  4.589
perpare first backward gemm: 0.03,  fisrt gemm backward duration: 2.24,  weight grad: 1.859,  other: 0.412
Linear 1 Backward:  4.578
perpare first backward gemm: 0.04,  fisrt gemm backward duration: 2.048,  weight grad: 1.985,  other: 0.409
Linear 1 Backward:  4.53
STEP-40: step_time = 22.942720 ms, foward_time = 11.849728, backward_time = 10.983424, perf = 35.94 tflops.
start
start
start
start
block_info 235 27
cuda:2 process time:3.508329391479492, a: 0.6146430969238281, b: 1.6255378723144531, c: 0.0743865966796875, d: 1.1937618255615234
block_info 215 9
2 wait time: 0.945
235
block_info 287 67
cuda:1 process time:3.925323486328125, a: 0.7028579711914062, b: 1.4977455139160156, c: 0.11587142944335938, d: 1.6088485717773438
block_info 299 76
1 wait time: 1.71
215
cuda:0 process time:3.9496421813964844, a: 0.8296966552734375, b: 1.2447834014892578, c: 0.11730194091796875, d: 1.7578601837158203
cuda:3 process time:4.513025283813477, a: 0.8063316345214844, b: 1.35040283203125, c: 0.1418590545654297, d: 2.2144317626953125
0 wait time: 2.358
287
3 wait time: 3.016
299
AG, 0.041860, 1.112064, 0 
perpare first forward gemm: 0.249,  fisrt gemm forward duration: 2.256
AG, 0.114894, 1.797120, 0 
perpare first forward gemm: 0.263,  fisrt gemm forward duration: 3.447
AG, 0.233449, 1.861632, 0 
AG, 0.254181, 1.883136, 0 
perpare first forward gemm: 0.319,  fisrt gemm forward duration: 2.299
perpare first forward gemm: 0.298,  fisrt gemm forward duration: 1.941
GA, 0.041860, 0.771072, 0 
GA, 0.114894, 1.500160, 0 
GA, 0.233449, 1.955840, 0 
GA, 0.254181, 2.097152, 0 
forward:  10.066
forward:  9.539
forward:  8.953
forward:  8.526
AG, 0.041860, 1.110016, 0 
AG, 0.233449, 1.857536, 0 
AG, 0.114894, 1.790976, 0 
AG, 0.254181, 1.874944, 0 
Linear 2 Backward: 2.62, second_gemm: 2.606
Linear 2 Backward: 3.396, second_gemm: 3.385
Linear 2 Backward: 3.757, second_gemm: 3.746
Linear 2 Backward: 3.614, second_gemm: 3.603
GA, 0.041860, 0.777216, 0 
GA, 0.114894, 1.495040, 0 
GA, 0.233449, 1.911808, 0 
GA, 0.254181, 2.072576, 0 
perpare first backward gemm: 0.035,  fisrt gemm backward duration: 3.141,  weight grad: 1.481,  other: 0.449
Linear 1 Backward:  5.171
perpare first backward gemm: 0.03,  fisrt gemm backward duration: 2.407,  weight grad: 1.633,  other: 0.436
Linear 1 Backward:  4.555
perpare first backward gemm: 0.035,  fisrt gemm backward duration: 2.128,  weight grad: 1.873,  other: 0.426
Linear 1 Backward:  4.513
perpare first backward gemm: 0.035,  fisrt gemm backward duration: 2.037,  weight grad: 1.974,  other: 0.431
Linear 1 Backward:  4.529
STEP-41: step_time = 23.468032 ms, foward_time = 12.265472, backward_time = 11.088896, perf = 35.14 tflops.
start
start
start
block_info 235 27
block_info 299 76
cuda:3 process time:3.620624542236328, a: 0.7278919219970703, b: 1.6024112701416016, c: 0.09417533874511719, d: 1.196146011352539
cuda:2 process time:3.924846649169922, a: 0.5490779876708984, b: 1.7712116241455078, c: 0.07343292236328125, d: 1.5311241149902344
3 wait time: 1.68
299
block_info 287 67
block_info 215 9
start
2 wait time: 0.011
235
cuda:0 process time:4.132270812988281, a: 0.7388591766357422, b: 1.1298656463623047, c: 0.11777877807617188, d: 2.1457672119140625
cuda:1 process time:4.600048065185547, a: 0.7684230804443359, b: 1.4677047729492188, c: 0.16069412231445312, d: 2.203226089477539
0 wait time: 1.945
287
1 wait time: 1.91
215
AG, 0.041860, 1.122304, 0 
perpare first forward gemm: 0.287,  fisrt gemm forward duration: 1.286
AG, 0.114894, 1.803264, 0 
perpare first forward gemm: 0.329,  fisrt gemm forward duration: 2.556
AG, 0.233449, 1.873920, 0 
perpare first forward gemm: 0.371,  fisrt gemm forward duration: 1.953
AG, 0.254181, 1.922048, 0 
perpare first forward gemm: 0.291,  fisrt gemm forward duration: 3.104
GA, 0.041860, 0.775168, 0 
GA, 0.114894, 1.521664, 0 
GA, 0.233449, 1.943552, 0 
GA, 0.254181, 2.170880, 0 
forward:  8.88
forward:  8.819
forward:  9.487
forward:  9.787
AG, 0.041860, 1.119232, 0 
AG, 0.114894, 1.795072, 0 
AG, 0.233449, 1.869824, 0 
AG, 0.254181, 1.903616, 0 
Linear 2 Backward: 2.702, second_gemm: 2.69
Linear 2 Backward: 3.339, second_gemm: 3.325
Linear 2 Backward: 3.803, second_gemm: 3.796
Linear 2 Backward: 3.683, second_gemm: 3.669
GA, 0.041860, 0.781312, 0 
GA, 0.114894, 1.513472, 0 
GA, 0.254181, 2.081792, 0 
GA, 0.233449, 1.942528, 0 
perpare first backward gemm: 0.032,  fisrt gemm backward duration: 3.21,  weight grad: 1.473,  other: 0.438
Linear 1 Backward:  5.212
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 2.381,  weight grad: 1.644,  other: 0.45
Linear 1 Backward:  4.572
perpare first backward gemm: 0.032,  fisrt gemm backward duration: 2.18,  weight grad: 1.9,  other: 0.418
Linear 1 Backward:  4.573
perpare first backward gemm: 0.039,  fisrt gemm backward duration: 2.006,  weight grad: 1.987,  other: 0.447
Linear 1 Backward:  4.542
STEP-42: step_time = 23.343105 ms, foward_time = 11.938816, backward_time = 11.290624, perf = 35.33 tflops.
start
start
start
start
block_info 235 27
cuda:2 process time:3.404378890991211, a: 0.7147789001464844, b: 1.4731884002685547, c: 0.07414817810058594, d: 1.142263412475586
block_info 215 9
2 wait time: 1.124
235
block_info 299 76
block_info 287 67
cuda:1 process time:3.777742385864258, a: 0.7309913635253906, b: 1.4719963073730469, c: 0.1087188720703125, d: 1.4660358428955078
1 wait time: 1.859
215
cuda:0 process time:4.0683746337890625, a: 0.8275508880615234, b: 1.3039112091064453, c: 0.14472007751464844, d: 1.7921924591064453
cuda:3 process time:4.257440567016602, a: 0.7793903350830078, b: 1.5215873718261719, c: 0.11920928955078125, d: 1.8372535705566406
0 wait time: 2.344
287
3 wait time: 2.411
299
AG, 0.041860, 1.130496, 0 
perpare first forward gemm: 0.268,  fisrt gemm forward duration: 1.99
AG, 0.114894, 1.806336, 0 
perpare first forward gemm: 0.257,  fisrt gemm forward duration: 3.354
AG, 0.233449, 1.861632, 0 
perpare first forward gemm: 0.351,  fisrt gemm forward duration: 1.929
AG, 0.254181, 1.923072, 0 
perpare first forward gemm: 0.322,  fisrt gemm forward duration: 2.026
GA, 0.041860, 0.775168, 0 
GA, 0.114894, 1.475584, 0 
GA, 0.233449, 1.955840, 0 
GA, 0.254181, 2.087936, 0 
forward:  9.373
forward:  8.677
forward:  10.007
forward:  8.718
AG, 0.041860, 1.111040, 0 
AG, 0.114894, 1.802240, 0 
AG, 0.233449, 1.860608, 0 
AG, 0.254181, 1.902592, 0 
Linear 2 Backward: 2.724, second_gemm: 2.713
Linear 2 Backward: 3.45, second_gemm: 3.436
Linear 2 Backward: 3.94, second_gemm: 3.929
Linear 2 Backward: 3.675, second_gemm: 3.66
GA, 0.041860, 0.770048, 0 
GA, 0.114894, 1.514496, 0 
GA, 0.254181, 2.081792, 0 
GA, 0.233449, 1.941504, 0 
perpare first backward gemm: 0.028,  fisrt gemm backward duration: 3.291,  weight grad: 1.464,  other: 0.426
Linear 1 Backward:  5.257
perpare first backward gemm: 0.037,  fisrt gemm backward duration: 2.373,  weight grad: 1.644,  other: 0.449
Linear 1 Backward:  4.567
perpare first backward gemm: 0.035,  fisrt gemm backward duration: 2.146,  weight grad: 1.888,  other: 0.429
Linear 1 Backward:  4.541
perpare first backward gemm: 0.041,  fisrt gemm backward duration: 2.018,  weight grad: 2.025,  other: 0.453
Linear 1 Backward:  4.586
STEP-43: step_time = 23.364288 ms, foward_time = 12.022464, backward_time = 11.230208, perf = 35.29 tflops.
start
start
start
start
block_info 235 27
block_info 299 76
block_info 215 9
cuda:2 process time:3.5707950592041016, a: 0.6287097930908203, b: 1.5671253204345703, c: 0.07414817810058594, d: 1.300811767578125
cuda:3 process time:3.4589767456054688, a: 0.7152557373046875, b: 1.5096664428710938, c: 0.07891654968261719, d: 1.1551380157470703
2 wait time: 0.723
235
block_info 287 67
cuda:1 process time:3.8084983825683594, a: 0.7183551788330078, b: 1.392364501953125, c: 0.110626220703125, d: 1.5871524810791016
3 wait time: 1.645
299
1 wait time: 1.635
215
cuda:0 process time:3.9131641387939453, a: 0.8156299591064453, b: 1.2133121490478516, c: 0.12612342834472656, d: 1.7580986022949219
0 wait time: 2.304
287
AG, 0.041860, 1.104896, 0 
perpare first forward gemm: 0.254,  fisrt gemm forward duration: 1.843
AG, 0.114894, 1.808384, 0 
perpare first forward gemm: 0.296,  fisrt gemm forward duration: 2.875
AG, 0.233449, 1.866752, 0 
perpare first forward gemm: 0.312,  fisrt gemm forward duration: 1.925
AG, 0.254181, 1.926144, 0 
perpare first forward gemm: 0.295,  fisrt gemm forward duration: 2.759
GA, 0.041860, 0.769024, 0 
GA, 0.114894, 1.526784, 0 
GA, 0.233449, 1.954816, 0 
GA, 0.254181, 2.147328, 0 
forward:  8.702
forward:  9.285
forward:  9.683
forward:  9.429
AG, 0.041860, 1.120256, 0 
AG, 0.114894, 1.806336, 0 
AG, 0.233449, 1.863680, 0 
AG, 0.254181, 1.889280, 0 
Linear 2 Backward: 2.539, second_gemm: 2.525
Linear 2 Backward: 3.635, second_gemm: 3.623
Linear 2 Backward: 3.785, second_gemm: 3.771
Linear 2 Backward: 3.808, second_gemm: 3.796
GA, 0.041860, 0.780288, 0 
GA, 0.114894, 1.530880, 0 
GA, 0.233449, 1.969152, 0 
GA, 0.254181, 2.067456, 0 
perpare first backward gemm: 0.034,  fisrt gemm backward duration: 3.265,  weight grad: 1.484,  other: 0.408
Linear 1 Backward:  5.238
perpare first backward gemm: 0.034,  fisrt gemm backward duration: 2.461,  weight grad: 1.638,  other: 0.437
Linear 1 Backward:  4.626
perpare first backward gemm: 0.043,  fisrt gemm backward duration: 2.133,  weight grad: 1.913,  other: 0.449
Linear 1 Backward:  4.604
perpare first backward gemm: 0.038,  fisrt gemm backward duration: 2.107,  weight grad: 1.985,  other: 0.442
Linear 1 Backward:  4.63
STEP-44: step_time = 23.549185 ms, foward_time = 11.982080, backward_time = 11.454464, perf = 35.02 tflops.
start
start
start
start
block_info 235 27
cuda:2 process time:3.628253936767578, a: 0.6740093231201172, b: 1.6248226165771484, c: 0.07510185241699219, d: 1.2543201446533203
2 wait time: 0.962
235
block_info 299 76
block_info 287 67
block_info 215 9
cuda:3 process time:4.241943359375, a: 0.8261203765869141, b: 1.4681816101074219, c: 0.1266002655029297, d: 1.8210411071777344
cuda:0 process time:4.150390625, a: 0.9076595306396484, b: 1.3432502746582031, c: 0.1201629638671875, d: 1.779317855834961
cuda:1 process time:4.557132720947266, a: 0.8692741394042969, b: 1.3532638549804688, c: 0.1480579376220703, d: 2.1865367889404297
3 wait time: 2.341
299
1 wait time: 1.894
215
0 wait time: 2.366
287
AG, 0.041860, 1.134592, 0 
perpare first forward gemm: 0.28,  fisrt gemm forward duration: 1.456
AG, 0.233449, 1.861632, 0 
perpare first forward gemm: 0.355,  fisrt gemm forward duration: 1.928
AG, 0.114894, 1.795072, 0 
perpare first forward gemm: 0.283,  fisrt gemm forward duration: 3.325
AG, 0.254181, 1.910784, 0 
perpare first forward gemm: 0.298,  fisrt gemm forward duration: 2.288
GA, 0.041860, 0.769024, 0 
GA, 0.114894, 1.564672, 0 
GA, 0.233449, 1.971200, 0 
GA, 0.254181, 2.176000, 0 
forward:  8.918
forward:  10.117
forward:  8.971
forward:  8.841
AG, 0.041860, 1.143808, 0 
AG, 0.254181, 1.887232, 0 
AG, 0.114894, 1.814528, 0 
AG, 0.233449, 1.851392, 0 
Linear 2 Backward: 2.69, second_gemm: 2.676
Linear 2 Backward: 3.665, second_gemm: 3.651
Linear 2 Backward: 3.885, second_gemm: 3.876
Linear 2 Backward: 3.667, second_gemm: 3.652
GA, 0.041860, 0.778240, 0 
GA, 0.114894, 1.501184, 0 
GA, 0.254181, 2.068480, 0 
GA, 0.233449, 1.976320, 0 
perpare first backward gemm: 0.033,  fisrt gemm backward duration: 3.215,  weight grad: 1.473,  other: 0.472
Linear 1 Backward:  5.239
perpare first backward gemm: 0.038,  fisrt gemm backward duration: 2.36,  weight grad: 1.653,  other: 0.451
Linear 1 Backward:  4.551
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 2.178,  weight grad: 1.889,  other: 0.429
Linear 1 Backward:  4.585
perpare first backward gemm: 0.042,  fisrt gemm backward duration: 2.045,  weight grad: 1.99,  other: 0.411
Linear 1 Backward:  4.537
STEP-45: step_time = 23.459903 ms, foward_time = 12.194880, backward_time = 11.153408, perf = 35.15 tflops.
start
start
start
start
block_info 235 27
cuda:2 process time:3.548145294189453, a: 0.6754398345947266, b: 1.6472339630126953, c: 0.07367134094238281, d: 1.1518001556396484
2 wait time: 1.061
235
block_info 299 76
block_info 287 67
block_info 215 9
cuda:3 process time:4.304170608520508, a: 0.8423328399658203, b: 1.3496875762939453, c: 0.11920928955078125, d: 1.992940902709961
cuda:0 process time:4.430294036865234, a: 0.8726119995117188, b: 1.7528533935546875, c: 0.1125335693359375, d: 1.6922950744628906
3 wait time: 2.074
299
cuda:1 process time:4.670381546020508, a: 0.9000301361083984, b: 1.3494491577148438, c: 0.21696090698242188, d: 2.2039413452148438
0 wait time: 2.262
287
1 wait time: 2.22
215
AG, 0.041860, 1.143808, 0 
perpare first forward gemm: 0.289,  fisrt gemm forward duration: 1.218
AG, 0.114894, 1.800192, 0 
perpare first forward gemm: 0.279,  fisrt gemm forward duration: 3.655
AG, 0.233449, 1.857536, 0 
perpare first forward gemm: 0.309,  fisrt gemm forward duration: 2.321
AG, 0.254181, 1.932288, 0 
perpare first forward gemm: 0.333,  fisrt gemm forward duration: 2.428
GA, 0.041860, 0.770048, 0 
GA, 0.114894, 1.471488, 0 
GA, 0.254181, 2.049024, 0 
GA, 0.233449, 1.874944, 0 
forward:  11.639
forward:  10.381
forward:  9.946
forward:  10.354
AG, 0.041860, 1.138688, 0 
AG, 0.233449, 1.855488, 0 
AG, 0.114894, 1.793024, 0 
AG, 0.254181, 1.883136, 0 
Linear 2 Backward: 3.089, second_gemm: 3.081
Linear 2 Backward: 3.779, second_gemm: 3.771
Linear 2 Backward: 4.108, second_gemm: 4.098
Linear 2 Backward: 3.667, second_gemm: 3.655
GA, 0.041860, 0.769024, 0 
GA, 0.114894, 1.512448, 0 
GA, 0.233449, 1.905664, 0 
GA, 0.254181, 2.091008, 0 
perpare first backward gemm: 0.021,  fisrt gemm backward duration: 3.337,  weight grad: 1.445,  other: 0.423
Linear 1 Backward:  5.263
perpare first backward gemm: 0.026,  fisrt gemm backward duration: 2.531,  weight grad: 1.614,  other: 0.409
Linear 1 Backward:  4.615
perpare first backward gemm: 0.037,  fisrt gemm backward duration: 2.148,  weight grad: 1.877,  other: 0.427
Linear 1 Backward:  4.542
perpare first backward gemm: 0.037,  fisrt gemm backward duration: 1.999,  weight grad: 1.961,  other: 0.417
Linear 1 Backward:  4.459
STEP-46: step_time = 25.062304 ms, foward_time = 13.665185, backward_time = 11.233280, perf = 32.90 tflops.
start
start
block_info 235 27
start
block_info 215 9
cuda:2 process time:3.820657730102539, a: 0.5929470062255859, b: 1.9526481628417969, c: 0.07295608520507812, d: 1.2021064758300781
block_info 299 76
cuda:1 process time:3.8781166076660156, a: 0.4658699035644531, b: 2.168893814086914, c: 0.07176399230957031, d: 1.1715888977050781
start
cuda:3 process time:4.058837890625, a: 0.7147789001464844, b: 1.7180442810058594, c: 0.08654594421386719, d: 1.539468765258789
2 wait time: 0.01
235
block_info 287 67
1 wait time: 1.001
215
3 wait time: 1.445
299
cuda:0 process time:4.233121871948242, a: 0.9391307830810547, b: 1.148223876953125, c: 0.11205673217773438, d: 2.033710479736328
0 wait time: 1.821
287
AG, 0.041860, 1.103872, 0 
perpare first forward gemm: 0.243,  fisrt gemm forward duration: 2.213
AG, 0.114894, 1.801216, 0 
perpare first forward gemm: 0.298,  fisrt gemm forward duration: 3.009
AG, 0.233449, 1.856512, 0 
perpare first forward gemm: 0.376,  fisrt gemm forward duration: 1.968
AG, 0.254181, 1.915904, 0 
perpare first forward gemm: 0.337,  fisrt gemm forward duration: 2.657
GA, 0.041860, 0.768000, 0 
GA, 0.114894, 1.514496, 0 
GA, 0.233449, 1.896448, 0 
GA, 0.254181, 2.146304, 0 
forward:  9.92
forward:  9.712
forward:  9.5
forward:  8.935
AG, 0.041860, 1.119232, 0 
AG, 0.233449, 1.843200, 0 
AG, 0.114894, 1.794048, 0 
AG, 0.254181, 1.907712, 0 
Linear 2 Backward: 2.62, second_gemm: 2.605
Linear 2 Backward: 3.42, second_gemm: 3.408
Linear 2 Backward: 3.668, second_gemm: 3.659
Linear 2 Backward: 3.561, second_gemm: 3.552
GA, 0.041860, 0.773120, 0 
GA, 0.114894, 1.520640, 0 
GA, 0.233449, 1.938432, 0 
GA, 0.254181, 2.082816, 0 
perpare first backward gemm: 0.031,  fisrt gemm backward duration: 2.382,  weight grad: 1.635,  other: 0.435
Linear 1 Backward:  4.535
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 3.125,  weight grad: 1.48,  other: 0.451
Linear 1 Backward:  5.156
perpare first backward gemm: 0.032,  fisrt gemm backward duration: 2.133,  weight grad: 1.864,  other: 0.417
Linear 1 Backward:  4.488
perpare first backward gemm: 0.031,  fisrt gemm backward duration: 2.096,  weight grad: 1.954,  other: 0.425
Linear 1 Backward:  4.552
STEP-47: step_time = 22.857728 ms, foward_time = 11.890688, backward_time = 10.854400, perf = 36.08 tflops.
start
start
start
block_info 235 27
block_info 215 9
cuda:2 process time:3.8433074951171875, a: 0.6468296051025391, b: 1.893758773803711, c: 0.07390975952148438, d: 1.2288093566894531
2 wait time: 0.95
235
cuda:1 process time:3.6673545837402344, a: 0.48422813415527344, b: 1.8334388732910156, c: 0.07200241088867188, d: 1.2776851654052734
start
block_info 287 67
block_info 299 76
1 wait time: 0.185
215
cuda:0 process time:4.15492057800293, a: 0.9300708770751953, b: 1.0793209075927734, c: 0.1125335693359375, d: 2.0329952239990234
cuda:3 process time:4.700183868408203, a: 0.8306503295898438, b: 1.7130374908447266, c: 0.11682510375976562, d: 2.039670944213867
0 wait time: 1.734
287
3 wait time: 2.152
299
AG, 0.041860, 1.133568, 0 
perpare first forward gemm: 0.287,  fisrt gemm forward duration: 2.101
AG, 0.114894, 1.809408, 0 
perpare first forward gemm: 0.283,  fisrt gemm forward duration: 3.281
AG, 0.233449, 1.839104, 0 
perpare first forward gemm: 0.384,  fisrt gemm forward duration: 1.962
AG, 0.254181, 1.901568, 0 
perpare first forward gemm: 0.348,  fisrt gemm forward duration: 1.973
GA, 0.041860, 0.774144, 0 
GA, 0.114894, 1.478656, 0 
GA, 0.233449, 1.900544, 0 
GA, 0.254181, 2.087936, 0 
forward:  10.056
forward:  9.579
forward:  8.745
forward:  8.873
AG, 0.041860, 1.145856, 0 
AG, 0.254181, 1.871872, 0 
AG, 0.233449, 1.855488, 0 
AG, 0.114894, 1.800192, 0 
Linear 2 Backward: 2.766, second_gemm: 2.752
Linear 2 Backward: 3.571, second_gemm: 3.557
Linear 2 Backward: 3.737, second_gemm: 3.727
Linear 2 Backward: 3.667, second_gemm: 3.652
GA, 0.041860, 0.774144, 0 
GA, 0.114894, 1.490944, 0 
GA, 0.254181, 2.081792, 0 
GA, 0.233449, 1.963008, 0 
perpare first backward gemm: 0.033,  fisrt gemm backward duration: 3.198,  weight grad: 1.477,  other: 0.447
Linear 1 Backward:  5.215
perpare first backward gemm: 0.037,  fisrt gemm backward duration: 2.383,  weight grad: 1.648,  other: 0.409
Linear 1 Backward:  4.525
perpare first backward gemm: 0.033,  fisrt gemm backward duration: 2.213,  weight grad: 1.873,  other: 0.406
Linear 1 Backward:  4.568
perpare first backward gemm: 0.041,  fisrt gemm backward duration: 2.03,  weight grad: 1.989,  other: 0.408
Linear 1 Backward:  4.518
STEP-48: step_time = 22.860800 ms, foward_time = 11.789312, backward_time = 10.951680, perf = 36.07 tflops.
start
start
start
start
block_info 215 9
block_info 235 27
cuda:1 process time:3.1006336212158203, a: 0.5190372467041016, b: 1.377105712890625, c: 0.07367134094238281, d: 1.130819320678711
cuda:2 process time:3.391265869140625, a: 0.5533695220947266, b: 1.5642642974853516, c: 0.07653236389160156, d: 1.1970996856689453
2 wait time: 0.975
235
block_info 287 67
1 wait time: 1.153
215
cuda:0 process time:3.7729740142822266, a: 0.7777214050292969, b: 1.0526180267333984, c: 0.1163482666015625, d: 1.8262863159179688
block_info 299 76
0 wait time: 1.993
287
cuda:3 process time:4.53948974609375, a: 0.8432865142822266, b: 1.3370513916015625, c: 0.1442432403564453, d: 2.2149085998535156
3 wait time: 2.873
299
AG, 0.041860, 1.106944, 0 
perpare first forward gemm: 0.249,  fisrt gemm forward duration: 2.77
AG, 0.233449, 1.841152, 0 
perpare first forward gemm: 0.315,  fisrt gemm forward duration: 2.596
AG, 0.114894, 1.796096, 0 
perpare first forward gemm: 0.265,  fisrt gemm forward duration: 3.573
AG, 0.254181, 1.904640, 0 
perpare first forward gemm: 0.302,  fisrt gemm forward duration: 1.963
GA, 0.041860, 0.768000, 0 
GA, 0.114894, 1.524736, 0 
GA, 0.233449, 1.935360, 0 
GA, 0.254181, 2.087936, 0 
forward:  10.085
forward:  9.273
forward:  10.217
forward:  8.542
AG, 0.041860, 1.118208, 0 
AG, 0.114894, 1.802240, 0 
AG, 0.254181, 1.864704, 0 
AG, 0.233449, 1.850368, 0 
Linear 2 Backward: 2.539, second_gemm: 2.529
Linear 2 Backward: 3.312, second_gemm: 3.3
Linear 2 Backward: 3.644, second_gemm: 3.635
Linear 2 Backward: 3.68, second_gemm: 3.668
GA, 0.041860, 0.777216, 0 
GA, 0.114894, 1.509376, 0 
GA, 0.254181, 2.075648, 0 
GA, 0.233449, 1.907712, 0 
perpare first backward gemm: 0.025,  fisrt gemm backward duration: 3.241,  weight grad: 1.454,  other: 0.418
Linear 1 Backward:  5.179
perpare first backward gemm: 0.032,  fisrt gemm backward duration: 2.362,  weight grad: 1.636,  other: 0.43
Linear 1 Backward:  4.513
perpare first backward gemm: 0.032,  fisrt gemm backward duration: 2.183,  weight grad: 1.866,  other: 0.415
Linear 1 Backward:  4.537
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 1.968,  weight grad: 1.96,  other: 0.432
Linear 1 Backward:  4.45
STEP-49: step_time = 23.406593 ms, foward_time = 12.240896, backward_time = 11.053056, perf = 35.23 tflops.
start
start
block_info 215 9
block_info 235 27
start
start
cuda:2 process time:3.887176513671875, a: 0.5784034729003906, b: 1.8858909606933594, c: 0.07367134094238281, d: 1.3492107391357422
cuda:1 process time:3.646373748779297, a: 0.46706199645996094, b: 1.7652511596679688, c: 0.07295608520507812, d: 1.341104507446289
2 wait time: 0.231
235
block_info 287 67
1 wait time: 0.318
215
block_info 299 76
cuda:0 process time:4.122257232666016, a: 0.7307529449462891, b: 1.0938644409179688, c: 0.14352798461914062, d: 2.154111862182617
0 wait time: 1.94
287
cuda:3 process time:4.716157913208008, a: 0.9019374847412109, b: 1.394510269165039, c: 0.14710426330566406, d: 2.2726058959960938
3 wait time: 2.901
299
AG, 0.041860, 1.120256, 0 
perpare first forward gemm: 0.287,  fisrt gemm forward duration: 2.584
AG, 0.114894, 1.792000, 0 
perpare first forward gemm: 0.299,  fisrt gemm forward duration: 3.445
AG, 0.233449, 1.861632, 0 
perpare first forward gemm: 0.371,  fisrt gemm forward duration: 2.326
AG, 0.254181, 1.894400, 0 
perpare first forward gemm: 0.338,  fisrt gemm forward duration: 1.969
GA, 0.041860, 0.777216, 0 
GA, 0.114894, 1.508352, 0 
GA, 0.233449, 1.945600, 0 
GA, 0.254181, 2.059264, 0 
forward:  10.062
forward:  10.258
forward:  8.747
forward:  9.22
AG, 0.041860, 1.107968, 0 
AG, 0.114894, 1.803264, 0 
AG, 0.233449, 1.863680, 0 
AG, 0.254181, 1.874944, 0 
Linear 2 Backward: 2.865, second_gemm: 2.855
Linear 2 Backward: 3.547, second_gemm: 3.533
Linear 2 Backward: 3.894, second_gemm: 3.88
Linear 2 Backward: 3.705, second_gemm: 3.692
GA, 0.041860, 0.774144, 0 
GA, 0.114894, 1.505280, 0 
GA, 0.233449, 1.917952, 0 
GA, 0.254181, 2.098176, 0 
perpare first backward gemm: 0.023,  fisrt gemm backward duration: 3.414,  weight grad: 1.455,  other: 0.407
Linear 1 Backward:  5.336
perpare first backward gemm: 0.037,  fisrt gemm backward duration: 2.432,  weight grad: 1.644,  other: 0.45
Linear 1 Backward:  4.628
perpare first backward gemm: 0.043,  fisrt gemm backward duration: 2.168,  weight grad: 1.89,  other: 0.449
Linear 1 Backward:  4.617
perpare first backward gemm: 0.039,  fisrt gemm backward duration: 2.069,  weight grad: 1.994,  other: 0.452
Linear 1 Backward:  4.617
STEP-50: step_time = 23.989248 ms, foward_time = 12.292096, backward_time = 11.585536, perf = 34.38 tflops.
start
start
start
start
block_info 235 27
block_info 215 9
cuda:2 process time:3.2422542572021484, a: 0.644683837890625, b: 1.3890266418457031, c: 0.08082389831542969, d: 1.1277198791503906
cuda:1 process time:3.348827362060547, a: 0.5354881286621094, b: 1.5583038330078125, c: 0.07271766662597656, d: 1.1823177337646484
2 wait time: 1.06
235
block_info 299 76
1 wait time: 1.216
215
block_info 287 67
cuda:3 process time:3.745555877685547, a: 0.7598400115966797, b: 1.1396408081054688, c: 0.11229515075683594, d: 1.7337799072265625
cuda:0 process time:4.049777984619141, a: 0.7922649383544922, b: 1.3585090637207031, c: 0.11968612670898438, d: 1.779317855834961
3 wait time: 2.321
299
0 wait time: 2.328
287
AG, 0.041860, 1.119232, 0 
perpare first forward gemm: 0.247,  fisrt gemm forward duration: 2.223
AG, 0.114894, 1.796096, 0 
perpare first forward gemm: 0.26,  fisrt gemm forward duration: 3.202
AG, 0.233449, 1.857536, 0 
perpare first forward gemm: 0.316,  fisrt gemm forward duration: 1.917
AG, 0.254181, 1.923072, 0 
perpare first forward gemm: 0.286,  fisrt gemm forward duration: 2.172
GA, 0.041860, 0.769024, 0 
GA, 0.114894, 1.500160, 0 
GA, 0.233449, 1.973248, 0 
GA, 0.254181, 2.120704, 0 
forward:  8.724
forward:  9.885
forward:  9.57
forward:  8.649
AG, 0.041860, 1.136640, 0 
AG, 0.114894, 1.790976, 0 
AG, 0.254181, 1.886208, 0 
AG, 0.233449, 1.887232, 0 
Linear 2 Backward: 2.738, second_gemm: 2.727
Linear 2 Backward: 3.743, second_gemm: 3.735
Linear 2 Backward: 3.98, second_gemm: 3.969
Linear 2 Backward: 3.745, second_gemm: 3.715
GA, 0.041860, 0.774144, 0 
GA, 0.114894, 1.507328, 0 
GA, 0.254181, 2.019328, 0 
GA, 0.233449, 1.911808, 0 
perpare first backward gemm: 0.028,  fisrt gemm backward duration: 3.292,  weight grad: 1.461,  other: 0.426
Linear 1 Backward:  5.255
perpare first backward gemm: 0.023,  fisrt gemm backward duration: 2.569,  weight grad: 1.613,  other: 0.406
Linear 1 Backward:  4.646
perpare first backward gemm: 0.035,  fisrt gemm backward duration: 2.207,  weight grad: 1.873,  other: 0.427
Linear 1 Backward:  4.586
perpare first backward gemm: 0.042,  fisrt gemm backward duration: 1.978,  weight grad: 1.992,  other: 0.412
Linear 1 Backward:  4.473
STEP-51: step_time = 23.181216 ms, foward_time = 11.986848, backward_time = 11.061248, perf = 35.57 tflops.
start
start
start
block_info 215 9
block_info 235 27
cuda:1 process time:3.4019947052001953, a: 0.4725456237792969, b: 1.689910888671875, c: 0.07271766662597656, d: 1.1668205261230469
cuda:2 process time:3.9603710174560547, a: 0.5590915679931641, b: 2.0287036895751953, c: 0.07414817810058594, d: 1.2984275817871094
2 wait time: 0.491
235
block_info 287 67
start
1 wait time: 0.01
215
block_info 299 76
cuda:0 process time:4.120826721191406, a: 0.9229183197021484, b: 1.081228256225586, c: 0.11348724365234375, d: 2.003192901611328
0 wait time: 1.721
287
cuda:3 process time:4.908084869384766, a: 0.8199214935302734, b: 1.7323493957519531, c: 0.1494884490966797, d: 2.2063255310058594
3 wait time: 2.769
299
AG, 0.041860, 1.121280, 0 
perpare first forward gemm: 0.287,  fisrt gemm forward duration: 2.452
AG, 0.114894, 1.797120, 0 
perpare first forward gemm: 0.298,  fisrt gemm forward duration: 3.357
AG, 0.233449, 1.879040, 0 
AG, 0.254181, 1.905664, 0 
perpare first forward gemm: 0.37,  fisrt gemm forward duration: 2.376
perpare first forward gemm: 0.307,  fisrt gemm forward duration: 1.967
GA, 0.041860, 0.779264, 0 
GA, 0.114894, 1.489920, 0 
GA, 0.233449, 1.915904, 0 
GA, 0.254181, 2.149376, 0 
forward:  10.228
forward:  9.984
forward:  8.728
forward:  9.307
AG, 0.041860, 1.142784, 0 
AG, 0.114894, 1.803264, 0 
AG, 0.254181, 1.895424, 0 
AG, 0.233449, 1.868800, 0 
Linear 2 Backward: 2.737, second_gemm: 2.723
Linear 2 Backward: 3.416, second_gemm: 3.402
Linear 2 Backward: 3.614, second_gemm: 3.6
Linear 2 Backward: 3.717, second_gemm: 3.704
GA, 0.041860, 0.777216, 0 
GA, 0.114894, 1.503232, 0 
GA, 0.233449, 1.961984, 0 
GA, 0.254181, 2.083840, 0 
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 3.239,  weight grad: 1.48,  other: 0.467
Linear 1 Backward:  5.288
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 2.443,  weight grad: 1.644,  other: 0.448
Linear 1 Backward:  4.633
perpare first backward gemm: 0.042,  fisrt gemm backward duration: 2.15,  weight grad: 1.909,  other: 0.47
perpare first backward gemm: 0.038,  fisrt gemm backward duration: 2.084,  weight grad: 1.979,  other: 0.44
Linear 1 Backward:  4.637
Linear 1 Backward:  4.6
STEP-52: step_time = 23.713791 ms, foward_time = 12.192768, backward_time = 11.407360, perf = 34.77 tflops.
start
start
block_info 215 9
start
block_info 235 27
block_info 299 76
start
cuda:2 process time:3.3910274505615234, a: 0.545501708984375, b: 1.6334056854248047, c: 0.080108642578125, d: 1.1320114135742188
cuda:1 process time:3.7147998809814453, a: 0.5860328674316406, b: 1.7592906951904297, c: 0.07200241088867188, d: 1.2974739074707031
2 wait time: 1.09
235
cuda:3 process time:3.5653114318847656, a: 0.8928775787353516, b: 1.1775493621826172, c: 0.07605552673339844, d: 1.4188289642333984
1 wait time: 0.4
215
block_info 287 67
3 wait time: 1.476
299
cuda:0 process time:4.096508026123047, a: 0.7755756378173828, b: 1.1515617370605469, c: 0.11014938354492188, d: 2.0592212677001953
0 wait time: 1.696
287
AG, 0.041860, 1.126400, 0 
perpare first forward gemm: 0.28,  fisrt gemm forward duration: 2.439
AG, 0.114894, 1.796096, 0 
perpare first forward gemm: 0.259,  fisrt gemm forward duration: 3.365
AG, 0.233449, 1.852416, 0 
perpare first forward gemm: 0.37,  fisrt gemm forward duration: 1.931
AG, 0.254181, 1.891328, 0 
perpare first forward gemm: 0.336,  fisrt gemm forward duration: 2.831
GA, 0.041860, 0.773120, 0 
GA, 0.114894, 1.469440, 0 
GA, 0.233449, 1.956864, 0 
GA, 0.254181, 2.054144, 0 
forward:  10.093
forward:  9.899
forward:  9.616
forward:  8.835
AG, 0.041860, 1.139712, 0 
AG, 0.233449, 1.860608, 0 
AG, 0.254181, 1.912832, 0 
AG, 0.114894, 1.811456, 0 
Linear 2 Backward: 2.722, second_gemm: 2.708
Linear 2 Backward: 3.538, second_gemm: 3.525
Linear 2 Backward: 3.717, second_gemm: 3.707
Linear 2 Backward: 3.706, second_gemm: 3.692
GA, 0.041860, 0.783360, 0 
GA, 0.114894, 1.506304, 0 
GA, 0.254181, 2.042880, 0 
GA, 0.233449, 1.958912, 0 
perpare first backward gemm: 0.035,  fisrt gemm backward duration: 2.402,  weight grad: 1.637,  other: 0.411
Linear 1 Backward:  4.532
perpare first backward gemm: 0.038,  fisrt gemm backward duration: 3.214,  weight grad: 1.476,  other: 0.464
Linear 1 Backward:  5.256
perpare first backward gemm: 0.034,  fisrt gemm backward duration: 2.188,  weight grad: 1.888,  other: 0.41
Linear 1 Backward:  4.563
perpare first backward gemm: 0.039,  fisrt gemm backward duration: 2.023,  weight grad: 1.98,  other: 0.411
Linear 1 Backward:  4.501
STEP-53: step_time = 22.696961 ms, foward_time = 11.662336, backward_time = 10.923008, perf = 36.33 tflops.
start
start
start
start
block_info 215 9
block_info 235 27
cuda:1 process time:3.195047378540039, a: 0.5316734313964844, b: 1.4393329620361328, c: 0.07343292236328125, d: 1.1506080627441406
cuda:2 process time:3.4830570220947266, a: 0.6191730499267578, b: 1.5854835510253906, c: 0.07367134094238281, d: 1.2047290802001953
2 wait time: 0.98
235
1 wait time: 1.138
215
block_info 287 67
block_info 299 76
cuda:0 process time:3.9093494415283203, a: 0.8039474487304688, b: 1.2161731719970703, c: 0.1373291015625, d: 1.7518997192382812
cuda:3 process time:4.117012023925781, a: 0.8156299591064453, b: 1.3811588287353516, c: 0.1201629638671875, d: 1.8000602722167969
0 wait time: 2.283
287
3 wait time: 2.395
299
AG, 0.041860, 1.116160, 0 
perpare first forward gemm: 0.247,  fisrt gemm forward duration: 2.252
AG, 0.254181, 1.893376, 0 
AG, 0.233449, 1.865728, 0 
perpare first forward gemm: 0.317,  fisrt gemm forward duration: 1.926
AG, 0.114894, 1.807360, 0 
perpare first forward gemm: 0.262,  fisrt gemm forward duration: 3.046
perpare first forward gemm: 0.299,  fisrt gemm forward duration: 1.968
GA, 0.041860, 0.776192, 0 
GA, 0.114894, 1.488896, 0 
GA, 0.254181, 2.055168, 0 
GA, 0.233449, 2.578432, 0 
forward:  10.212
forward:  10.099
forward:  9.109
forward:  9.379
AG, 0.041860, 1.138688, 0 
AG, 0.114894, 1.796096, 0 
AG, 0.233449, 1.863680, 0 
AG, 0.254181, 1.898496, 0 
Linear 2 Backward: 3.522, second_gemm: 3.511
Linear 2 Backward: 4.316, second_gemm: 4.305
Linear 2 Backward: 3.613, second_gemm: 3.591
Linear 2 Backward: 4.326, second_gemm: 4.311
GA, 0.041860, 0.777216, 0 
GA, 0.114894, 1.504256, 0 
GA, 0.233449, 1.949696, 0 
GA, 0.254181, 2.111488, 0 
perpare first backward gemm: 0.029,  fisrt gemm backward duration: 3.402,  weight grad: 1.467,  other: 0.429
Linear 1 Backward:  5.378
perpare first backward gemm: 0.031,  fisrt gemm backward duration: 2.593,  weight grad: 1.644,  other: 0.434
Linear 1 Backward:  4.766
perpare first backward gemm: 0.044,  fisrt gemm backward duration: 2.182,  weight grad: 1.909,  other: 0.452
Linear 1 Backward:  4.636
perpare first backward gemm: 0.028,  fisrt gemm backward duration: 2.282,  weight grad: 1.974,  other: 0.415
Linear 1 Backward:  4.746
STEP-54: step_time = 24.470560 ms, foward_time = 13.204512, backward_time = 11.112448, perf = 33.70 tflops.
start
start
block_info 235 27
start
block_info 215 9
cuda:2 process time:4.810571670532227, a: 0.6427764892578125, b: 2.9087066650390625, c: 0.07343292236328125, d: 1.1856555938720703
2 wait time: 0.843
235
cuda:1 process time:4.466533660888672, a: 0.5745887756347656, b: 2.61688232421875, c: 0.07224082946777344, d: 1.2028217315673828
start
block_info 299 76
1 wait time: 0.175
215
cuda:3 process time:5.609750747680664, a: 0.7467269897460938, b: 2.526521682739258, c: 0.11682510375976562, d: 2.219676971435547
block_info 287 67
3 wait time: 1.775
299
cuda:0 process time:5.105733871459961, a: 0.9922981262207031, b: 1.1904239654541016, c: 0.2224445343017578, d: 2.7005672454833984
0 wait time: 2.803
287
AG, 0.041860, 1.123328, 0 
perpare first forward gemm: 0.314,  fisrt gemm forward duration: 2.814
AG, 0.233449, 1.866752, 0 
perpare first forward gemm: 0.302,  fisrt gemm forward duration: 1.921
AG, 0.114894, 1.793024, 0 
perpare first forward gemm: 0.248,  fisrt gemm forward duration: 4.211
AG, 0.254181, 1.902592, 0 
perpare first forward gemm: 0.339,  fisrt gemm forward duration: 2.724
GA, 0.041860, 0.773120, 0 
GA, 0.114894, 1.504256, 0 
GA, 0.233449, 1.959936, 0 
GA, 0.254181, 2.054144, 0 
forward:  10.221
forward:  8.561
forward:  10.804
forward:  9.394
AG, 0.041860, 1.146880, 0 
AG, 0.114894, 1.800192, 0 
AG, 0.233449, 1.843200, 0 
AG, 0.254181, 1.918976, 0 
Linear 2 Backward: 2.838, second_gemm: 2.824
Linear 2 Backward: 3.363, second_gemm: 3.348
Linear 2 Backward: 3.827, second_gemm: 3.82
Linear 2 Backward: 3.672, second_gemm: 3.664
GA, 0.041860, 0.777216, 0 
GA, 0.114894, 1.512448, 0 
GA, 0.233449, 2.011136, 0 
GA, 0.254181, 2.102272, 0 
perpare first backward gemm: 0.035,  fisrt gemm backward duration: 3.088,  weight grad: 1.481,  other: 0.45
Linear 1 Backward:  5.119
perpare first backward gemm: 0.037,  fisrt gemm backward duration: 2.312,  weight grad: 1.644,  other: 0.448
Linear 1 Backward:  4.488
perpare first backward gemm: 0.029,  fisrt gemm backward duration: 2.148,  weight grad: 1.877,  other: 0.41
Linear 1 Backward:  4.5
perpare first backward gemm: 0.028,  fisrt gemm backward duration: 2.13,  weight grad: 1.967,  other: 0.412
Linear 1 Backward:  4.575
STEP-55: step_time = 23.953408 ms, foward_time = 12.916737, backward_time = 10.919936, perf = 34.43 tflops.
start
start
start
block_info 215 9
block_info 299 76
start
cuda:1 process time:4.01616096496582, a: 0.5643367767333984, b: 2.0618438720703125, c: 0.07271766662597656, d: 1.3172626495361328
cuda:3 process time:3.8595199584960938, a: 0.6015300750732422, b: 1.6679763793945312, c: 0.07605552673339844, d: 1.5139579772949219
block_info 235 27
1 wait time: 0.392
215
3 wait time: 0.708
299
block_info 287 67
cuda:2 process time:4.7016143798828125, a: 0.7865428924560547, b: 1.7580986022949219, c: 0.1468658447265625, d: 2.0101070404052734
2 wait time: 2.426
235
cuda:0 process time:4.806041717529297, a: 0.9407997131347656, b: 1.268148422241211, c: 0.14519691467285156, d: 2.4518966674804688
0 wait time: 2.486
287
AG, 0.041860, 1.117184, 0 
perpare first forward gemm: 0.289,  fisrt gemm forward duration: 2.724
AG, 0.233449, 1.861632, 0 
AG, 0.114894, 1.795072, 0 
perpare first forward gemm: 0.271,  fisrt gemm forward duration: 2.695
perpare first forward gemm: 0.37,  fisrt gemm forward duration: 1.943
AG, 0.254181, 1.904640, 0 
perpare first forward gemm: 0.338,  fisrt gemm forward duration: 3.299
GA, 0.041860, 0.770048, 0 
GA, 0.114894, 1.470464, 0 
GA, 0.233449, 1.958912, 0 
GA, 0.254181, 2.084864, 0 
forward:  9.446
forward:  10.213
forward:  10.067
forward:  8.85
AG, 0.041860, 1.126400, 0 
AG, 0.233449, 1.859584, 0 
AG, 0.114894, 1.807360, 0 
AG, 0.254181, 1.906688, 0 
Linear 2 Backward: 2.614, second_gemm: 2.599
Linear 2 Backward: 3.574, second_gemm: 3.566
Linear 2 Backward: 3.705, second_gemm: 3.697
Linear 2 Backward: 3.649, second_gemm: 3.635
GA, 0.041860, 0.777216, 0 
GA, 0.114894, 1.499136, 0 
GA, 0.233449, 1.959936, 0 
GA, 0.254181, 2.043904, 0 
perpare first backward gemm: 0.023,  fisrt gemm backward duration: 2.619,  weight grad: 1.614,  other: 0.416
Linear 1 Backward:  4.708
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 3.233,  weight grad: 1.486,  other: 0.453
Linear 1 Backward:  5.272
perpare first backward gemm: 0.028,  fisrt gemm backward duration: 2.26,  weight grad: 1.957,  other: 0.421
perpare first backward gemm: 0.046,  fisrt gemm backward duration: 2.116,  weight grad: 1.91,  other: 0.45
Linear 1 Backward:  4.703
Linear 1 Backward:  4.586
STEP-56: step_time = 23.985152 ms, foward_time = 12.583936, backward_time = 11.289600, perf = 34.38 tflops.
start
start
start
block_info 215 9
cuda:1 process time:3.1626224517822266, a: 0.457763671875, b: 1.5060901641845703, c: 0.07390975952148438, d: 1.1248588562011719
block_info 235 27
start
1 wait time: 0.011
215
cuda:2 process time:3.770589828491211, a: 0.8335113525390625, b: 1.1250972747802734, c: 0.11157989501953125, d: 1.7004013061523438
block_info 299 76
2 wait time: 1.597
235
block_info 287 67
cuda:3 process time:4.61125373840332, a: 0.7991790771484375, b: 1.4357566833496094, c: 0.14472007751464844, d: 2.231597900390625
cuda:0 process time:4.652738571166992, a: 0.9331703186035156, b: 1.251220703125, c: 0.1461505889892578, d: 2.3221969604492188
3 wait time: 2.888
0 wait time: 2.336
287
299
AG, 0.041860, 1.123328, 0 
perpare first forward gemm: 0.286,  fisrt gemm forward duration: 2.767
AG, 0.114894, 1.796096, 0 
perpare first forward gemm: 0.296,  fisrt gemm forward duration: 3.021
AG, 0.233449, 1.864704, 0 
perpare first forward gemm: 0.371,  fisrt gemm forward duration: 1.943
AG, 0.254181, 1.909760, 0 
perpare first forward gemm: 0.299,  fisrt gemm forward duration: 2.131
GA, 0.041860, 0.775168, 0 
GA, 0.114894, 1.500160, 0 
GA, 0.233449, 1.927168, 0 
GA, 0.254181, 2.151424, 0 
forward:  9.844
forward:  10.253
forward:  8.82
forward:  8.841
AG, 0.041860, 1.139712, 0 
AG, 0.233449, 1.872896, 0 
AG, 0.114894, 1.794048, 0 
AG, 0.254181, 1.914880, 0 
Linear 2 Backward: 2.805, second_gemm: 2.797
Linear 2 Backward: 3.39, second_gemm: 3.377
Linear 2 Backward: 3.739, second_gemm: 3.726
Linear 2 Backward: 3.663, second_gemm: 3.65
GA, 0.041860, 0.770048, 0 
GA, 0.114894, 1.518592, 0 
GA, 0.233449, 1.905664, 0 
GA, 0.254181, 2.092032, 0 
perpare first backward gemm: 0.026,  fisrt gemm backward duration: 3.417,  weight grad: 1.452,  other: 0.414
Linear 1 Backward:  5.351
perpare first backward gemm: 0.035,  fisrt gemm backward duration: 2.5,  weight grad: 1.636,  other: 0.419
Linear 1 Backward:  4.636
perpare first backward gemm: 0.04,  fisrt gemm backward duration: 2.155,  weight grad: 1.904,  other: 0.447
Linear 1 Backward:  4.609
perpare first backward gemm: 0.04,  fisrt gemm backward duration: 2.141,  weight grad: 1.989,  other: 0.446
Linear 1 Backward:  4.678
STEP-57: step_time = 23.840769 ms, foward_time = 12.298240, backward_time = 11.428864, perf = 34.59 tflops.
start
start
start
start
block_info 215 9
cuda:1 process time:3.4499168395996094, a: 0.7498264312744141, b: 1.6312599182128906, c: 0.10180473327636719, d: 0.9670257568359375
1 wait time: 1.416
215
block_info 235 27
block_info 299 76
cuda:2 process time:4.469156265258789, a: 0.7326602935791016, b: 1.857757568359375, c: 0.11205673217773438, d: 1.7666816711425781
cuda:3 process time:4.3239593505859375, a: 0.8471012115478516, b: 1.4476776123046875, c: 0.11110305786132812, d: 1.9180774688720703
block_info 287 67
2 wait time: 1.475
235
3 wait time: 2.072
299
cuda:0 process time:4.55784797668457, a: 0.7719993591308594, b: 1.2311935424804688, c: 0.1373291015625, d: 2.417325973510742
0 wait time: 2.152
287
AG, 0.041860, 1.120256, 0 
perpare first forward gemm: 0.272,  fisrt gemm forward duration: 3.056
AG, 0.114894, 1.790976, 0 
perpare first forward gemm: 0.283,  fisrt gemm forward duration: 3.029
AG, 0.233449, 1.869824, 0 
perpare first forward gemm: 0.386,  fisrt gemm forward duration: 1.936
AG, 0.254181, 1.896448, 0 
perpare first forward gemm: 0.331,  fisrt gemm forward duration: 2.662
GA, 0.041860, 0.771072, 0 
GA, 0.114894, 1.473536, 0 
GA, 0.233449, 1.948672, 0 
GA, 0.254181, 2.050048, 0 
forward:  10.382
forward:  9.685
forward:  8.745
forward:  9.297
AG, 0.041860, 1.118208, 0 
AG, 0.233449, 1.864704, 0 
AG, 0.114894, 1.818624, 0 
AG, 0.254181, 1.896448, 0 
Linear 2 Backward: 2.565, second_gemm: 2.553
Linear 2 Backward: 3.527, second_gemm: 3.516
Linear 2 Backward: 3.733, second_gemm: 3.719
Linear 2 Backward: 3.684, second_gemm: 3.67
GA, 0.041860, 0.770048, 0 
GA, 0.114894, 1.504256, 0 
GA, 0.233449, 1.950720, 0 
GA, 0.254181, 2.087936, 0 
perpare first backward gemm: 0.028,  fisrt gemm backward duration: 3.396,  weight grad: 1.464,  other: 0.408
Linear 1 Backward:  5.338
perpare first backward gemm: 0.032,  fisrt gemm backward duration: 2.532,  weight grad: 1.633,  other: 0.432
Linear 1 Backward:  4.67
perpare first backward gemm: 0.043,  fisrt gemm backward duration: 2.154,  weight grad: 1.909,  other: 0.409
Linear 1 Backward:  4.564
perpare first backward gemm: 0.041,  fisrt gemm backward duration: 2.112,  weight grad: 1.992,  other: 0.408
Linear 1 Backward:  4.602
STEP-58: step_time = 23.111680 ms, foward_time = 12.051455, backward_time = 10.946560, perf = 35.68 tflops.
start
start
start
start
block_info 215 9
cuda:1 process time:3.115415573120117, a: 0.6451606750488281, b: 1.28936767578125, c: 0.07772445678710938, d: 1.1031627655029297
block_info 235 27
1 wait time: 1.208
215
cuda:2 process time:3.80706787109375, a: 0.7169246673583984, b: 1.4672279357910156, c: 0.11229515075683594, d: 1.5106201171875
block_info 299 76
2 wait time: 1.883
235
block_info 287 67
cuda:3 process time:4.425525665283203, a: 0.6914138793945312, b: 1.2426376342773438, c: 0.15091896057128906, d: 2.340555191040039
cuda:0 process time:4.433870315551758, a: 0.8387565612792969, b: 1.2698173522949219, c: 0.14472007751464844, d: 2.1805763244628906
3 wait time: 2.513
299
0 wait time: 2.806
287
AG, 0.041860, 1.106944, 0 
perpare first forward gemm: 0.241,  fisrt gemm forward duration: 2.879
AG, 0.233449, 1.848320, 0 
perpare first forward gemm: 0.309,  fisrt gemm forward duration: 1.907
AG, 0.114894, 1.792000, 0 
perpare first forward gemm: 0.255,  fisrt gemm forward duration: 2.906
AG, 0.254181, 1.895424, 0 
perpare first forward gemm: 0.294,  fisrt gemm forward duration: 2.056
GA, 0.041860, 0.770048, 0 
GA, 0.114894, 1.510400, 0 
GA, 0.233449, 1.939456, 0 
GA, 0.254181, 2.087936, 0 
forward:  9.653
forward:  10.214
forward:  8.676
forward:  8.631
AG, 0.041860, 1.112064, 0 
AG, 0.233449, 1.860608, 0 
AG, 0.114894, 1.803264, 0 
AG, 0.254181, 1.904640, 0 
Linear 2 Backward: 2.721, second_gemm: 2.707
Linear 2 Backward: 3.567, second_gemm: 3.555
Linear 2 Backward: 3.737, second_gemm: 3.725
Linear 2 Backward: 3.641, second_gemm: 3.629
GA, 0.041860, 0.772096, 0 
GA, 0.114894, 1.481728, 0 
GA, 0.233449, 1.876992, 0 
GA, 0.254181, 2.036736, 0 
perpare first backward gemm: 0.032,  fisrt gemm backward duration: 2.383,  weight grad: 1.633,  other: 0.433
Linear 1 Backward:  4.535
perpare first backward gemm: 0.035,  fisrt gemm backward duration: 3.166,  weight grad: 1.482,  other: 0.45
Linear 1 Backward:  5.198
perpare first backward gemm: 0.038,  fisrt gemm backward duration: 2.097,  weight grad: 1.894,  other: 0.436
Linear 1 Backward:  4.519
perpare first backward gemm: 0.035,  fisrt gemm backward duration: 2.029,  weight grad: 1.978,  other: 0.435
Linear 1 Backward:  4.532
STEP-59: step_time = 23.633921 ms, foward_time = 12.359680, backward_time = 11.163648, perf = 34.89 tflops.
start
start
start
block_info 215 9
start
cuda:1 process time:3.1006336212158203, a: 0.7867813110351562, b: 0.9939670562744141, c: 0.07271766662597656, d: 1.2471675872802734
block_info 235 27
1 wait time: 1.166
215
cuda:2 process time:3.7910938262939453, a: 0.7367134094238281, b: 1.2924671173095703, c: 0.11920928955078125, d: 1.6427040100097656
2 wait time: 1.642
235
block_info 299 76
block_info 287 67
cuda:3 process time:4.536628723144531, a: 0.7610321044921875, b: 1.1827945709228516, c: 0.16689300537109375, d: 2.4259090423583984
cuda:0 process time:5.067348480224609, a: 0.8132457733154297, b: 1.4955997467041016, c: 0.14638900756835938, d: 2.6121139526367188
3 wait time: 2.617
299
0 wait time: 2.215
287
AG, 0.041860, 1.118208, 0 
perpare first forward gemm: 0.292,  fisrt gemm forward duration: 3.037
AG, 0.114894, 1.798144, 0 
perpare first forward gemm: 0.259,  fisrt gemm forward duration: 3.502
AG, 0.233449, 1.864704, 0 
perpare first forward gemm: 0.367,  fisrt gemm forward duration: 1.945
AG, 0.254181, 1.904640, 0 
perpare first forward gemm: 0.339,  fisrt gemm forward duration: 2.239
GA, 0.041860, 0.774144, 0 
GA, 0.114894, 1.479680, 0 
GA, 0.233449, 1.917952, 0 
GA, 0.254181, 2.029568, 0 
forward:  10.229
forward:  8.838
forward:  10.576
forward:  9.016
AG, 0.041860, 1.138688, 0 
AG, 0.114894, 1.801216, 0 
AG, 0.233449, 1.858560, 0 
AG, 0.254181, 1.925120, 0 
Linear 2 Backward: 2.723, second_gemm: 2.708
Linear 2 Backward: 3.383, second_gemm: 3.369
Linear 2 Backward: 3.719, second_gemm: 3.711
Linear 2 Backward: 3.718, second_gemm: 3.704
GA, 0.041860, 0.776192, 0 
GA, 0.114894, 1.487872, 0 
GA, 0.233449, 1.851392, 0 
GA, 0.254181, 2.094080, 0 
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 3.292,  weight grad: 1.478,  other: 0.455
Linear 1 Backward:  5.327
perpare first backward gemm: 0.037,  fisrt gemm backward duration: 2.468,  weight grad: 1.645,  other: 0.451
Linear 1 Backward:  4.665
perpare first backward gemm: 0.027,  fisrt gemm backward duration: 2.288,  weight grad: 1.957,  other: 0.411
perpare first backward gemm: 0.043,  fisrt gemm backward duration: 2.16,  weight grad: 1.907,  other: 0.47
Linear 1 Backward:  4.719
Linear 1 Backward:  4.647
STEP-60: step_time = 23.550976 ms, foward_time = 12.077056, backward_time = 11.362304, perf = 35.01 tflops.
start
start
start
start
block_info 215 9
block_info 235 27
cuda:1 process time:3.265380859375, a: 0.5767345428466797, b: 1.4061927795410156, c: 0.07390975952148438, d: 1.2085437774658203
cuda:2 process time:3.4530162811279297, a: 0.7455348968505859, b: 1.3768672943115234, c: 0.10347366333007812, d: 1.2271404266357422
1 wait time: 1.096
215
2 wait time: 1.592
235
block_info 287 67
block_info 299 76
cuda:3 process time:4.308223724365234, a: 0.858306884765625, b: 1.1322498321533203, c: 0.14853477478027344, d: 2.1691322326660156
cuda:0 process time:4.4841766357421875, a: 0.8988380432128906, b: 1.1703968048095703, c: 0.14281272888183594, d: 2.2721290588378906
3 wait time: 2.181
299
0 wait time: 2.35
287
AG, 0.041860, 1.111040, 0 
perpare first forward gemm: 0.273,  fisrt gemm forward duration: 2.605
AG, 0.233449, 1.861632, 0 
perpare first forward gemm: 0.349,  fisrt gemm forward duration: 1.929
AG, 0.114894, 1.797120, 0 
perpare first forward gemm: 0.281,  fisrt gemm forward duration: 3.145
AG, 0.254181, 1.897472, 0 
perpare first forward gemm: 0.332,  fisrt gemm forward duration: 2.155
GA, 0.041860, 0.779264, 0 
GA, 0.114894, 1.499136, 0 
GA, 0.233449, 1.944576, 0 
GA, 0.254181, 2.013184, 0 
forward:  9.926
forward:  9.794
forward:  8.772
forward:  8.625
AG, 0.041860, 1.122304, 0 
AG, 0.254181, 1.905664, 0 
AG, 0.114894, 1.807360, 0 
AG, 0.233449, 1.859584, 0 
Linear 2 Backward: 2.888, second_gemm: 2.877
Linear 2 Backward: 3.758, second_gemm: 3.745
Linear 2 Backward: 3.926, second_gemm: 3.911
Linear 2 Backward: 3.674, second_gemm: 3.66
GA, 0.041860, 0.775168, 0 
GA, 0.114894, 1.505280, 0 
GA, 0.233449, 1.916928, 0 
GA, 0.254181, 2.073600, 0 
perpare first backward gemm: 0.028,  fisrt gemm backward duration: 3.387,  weight grad: 1.463,  other: 0.466
Linear 1 Backward:  5.4
perpare first backward gemm: 0.046,  fisrt gemm backward duration: 2.459,  weight grad: 1.644,  other: 0.408
Linear 1 Backward:  4.603
perpare first backward gemm: 0.043,  fisrt gemm backward duration: 2.157,  weight grad: 1.91,  other: 0.411
Linear 1 Backward:  4.57
perpare first backward gemm: 0.042,  fisrt gemm backward duration: 2.111,  weight grad: 1.99,  other: 0.422
Linear 1 Backward:  4.615
STEP-61: step_time = 23.249919 ms, foward_time = 11.979776, backward_time = 11.157504, perf = 35.47 tflops.
start
start
start
start
block_info 215 9
block_info 299 76
cuda:1 process time:3.1728744506835938, a: 0.5631446838378906, b: 1.3659000396728516, c: 0.07486343383789062, d: 1.168966293334961
cuda:3 process time:3.2994747161865234, a: 0.7641315460205078, b: 1.1894702911376953, c: 0.08606910705566406, d: 1.2598037719726562
1 wait time: 1.115
215
block_info 287 67
block_info 235 27
3 wait time: 1.78
299
cuda:0 process time:3.8030147552490234, a: 0.7863044738769531, b: 1.1262893676757812, c: 0.148773193359375, d: 1.741647720336914
cuda:2 process time:3.8580894470214844, a: 0.6678104400634766, b: 1.1944770812988281, c: 0.14352798461914062, d: 1.852273941040039
0 wait time: 1.976
287
2 wait time: 1.951
235
AG, 0.041860, 1.116160, 0 
perpare first forward gemm: 0.272,  fisrt gemm forward duration: 2.087
AG, 0.233449, 1.861632, 0 
perpare first forward gemm: 0.307,  fisrt gemm forward duration: 1.919
AG, 0.114894, 1.798144, 0 
perpare first forward gemm: 0.269,  fisrt gemm forward duration: 1.926
AG, 0.254181, 1.932288, 0 
perpare first forward gemm: 0.294,  fisrt gemm forward duration: 2.519
GA, 0.041860, 0.774144, 0 
GA, 0.114894, 1.478656, 0 
GA, 0.233449, 1.955840, 0 
GA, 0.254181, 2.063360, 0 
forward:  9.467
forward:  8.621
forward:  9.112
forward:  8.648
AG, 0.041860, 1.113088, 0 
AG, 0.254181, 1.903616, 0 
AG, 0.114894, 1.798144, 0 
AG, 0.233449, 1.868800, 0 
Linear 2 Backward: 2.519, second_gemm: 2.509
Linear 2 Backward: 3.496, second_gemm: 3.484
Linear 2 Backward: 3.696, second_gemm: 3.684
Linear 2 Backward: 3.641, second_gemm: 3.629
GA, 0.041860, 0.773120, 0 
GA, 0.114894, 1.500160, 0 
GA, 0.233449, 1.959936, 0 
GA, 0.254181, 2.067456, 0 
perpare first backward gemm: 0.027,  fisrt gemm backward duration: 3.331,  weight grad: 1.462,  other: 0.421
Linear 1 Backward:  5.286
perpare first backward gemm: 0.032,  fisrt gemm backward duration: 2.471,  weight grad: 1.633,  other: 0.447
Linear 1 Backward:  4.637
perpare first backward gemm: 0.039,  fisrt gemm backward duration: 2.142,  weight grad: 1.899,  other: 0.437
Linear 1 Backward:  4.571
perpare first backward gemm: 0.038,  fisrt gemm backward duration: 2.079,  weight grad: 1.999,  other: 0.438
Linear 1 Backward:  4.609
STEP-62: step_time = 22.787071 ms, foward_time = 11.523072, backward_time = 11.152384, perf = 36.19 tflops.
start
start
start
start
block_info 215 9
cuda:1 process time:2.9015541076660156, a: 0.6337165832519531, b: 1.0237693786621094, c: 0.07295608520507812, d: 1.171112060546875
block_info 287 67
1 wait time: 1.141
215
block_info 235 27
cuda:0 process time:3.6420822143554688, a: 0.6430149078369141, b: 1.2259483337402344, c: 0.1010894775390625, d: 1.6720294952392578
cuda:2 process time:3.8039684295654297, a: 0.732421875, b: 1.2269020080566406, c: 0.12683868408203125, d: 1.7178058624267578
block_info 299 76
0 wait time: 1.828
287
2 wait time: 2.186
235
cuda:3 process time:4.520893096923828, a: 0.7927417755126953, b: 1.3413429260253906, c: 0.1499652862548828, d: 2.2368431091308594
3 wait time: 2.796
299
AG, 0.041860, 1.118208, 0 
perpare first forward gemm: 0.264,  fisrt gemm forward duration: 2.895
AG, 0.114894, 1.785856, 0 
perpare first forward gemm: 0.279,  fisrt gemm forward duration: 2.541
AG, 0.233449, 1.872896, 0 
perpare first forward gemm: 0.334,  fisrt gemm forward duration: 2.732
AG, 0.254181, 1.900544, 0 
perpare first forward gemm: 0.316,  fisrt gemm forward duration: 1.964
GA, 0.041860, 0.778240, 0 
GA, 0.114894, 1.502208, 0 
GA, 0.233449, 1.964032, 0 
GA, 0.254181, 2.083840, 0 
forward:  10.311
forward:  9.374
forward:  8.673
forward:  9.542
AG, 0.041860, 1.113088, 0 
AG, 0.114894, 1.803264, 0 
AG, 0.233449, 1.867776, 0 
AG, 0.254181, 1.912832, 0 
Linear 2 Backward: 2.751, second_gemm: 2.741
Linear 2 Backward: 3.511, second_gemm: 3.498
Linear 2 Backward: 3.662, second_gemm: 3.647
Linear 2 Backward: 3.751, second_gemm: 3.737
GA, 0.041860, 0.774144, 0 
GA, 0.114894, 1.476608, 0 
GA, 0.233449, 1.866752, 0 
GA, 0.254181, 2.032640, 0 
perpare first backward gemm: 0.028,  fisrt gemm backward duration: 3.353,  weight grad: 1.461,  other: 0.427
Linear 1 Backward:  5.318
perpare first backward gemm: 0.035,  fisrt gemm backward duration: 2.481,  weight grad: 1.641,  other: 0.443
Linear 1 Backward:  4.66
perpare first backward gemm: 0.055,  fisrt gemm backward duration: 2.102,  weight grad: 1.91,  other: 0.452
Linear 1 Backward:  4.569
perpare first backward gemm: 0.042,  fisrt gemm backward duration: 2.047,  weight grad: 2.004,  other: 0.453
Linear 1 Backward:  4.597
STEP-63: step_time = 23.501823 ms, foward_time = 12.329984, backward_time = 11.060224, perf = 35.09 tflops.
start
start
start
start
block_info 215 9
block_info 235 27
block_info 299 76
cuda:1 process time:2.9876232147216797, a: 0.6151199340820312, b: 1.135110855102539, c: 0.07414817810058594, d: 1.1632442474365234
cuda:2 process time:3.345012664794922, a: 0.7331371307373047, b: 1.4619827270507812, c: 0.07939338684082031, d: 1.0704994201660156
cuda:3 process time:3.5114288330078125, a: 0.6659030914306641, b: 1.3887882232666016, c: 0.07796287536621094, d: 1.378774642944336
2 wait time: 1.441
1 wait time: 1.097
235
215
3 wait time: 1.269
block_info 287 67
299
cuda:0 process time:4.253387451171875, a: 0.8256435394287109, b: 1.2755393981933594, c: 0.1380443572998047, d: 2.01416015625
0 wait time: 2.614
287
AG, 0.041860, 1.106944, 0 
perpare first forward gemm: 0.258,  fisrt gemm forward duration: 2.599
AG, 0.114894, 1.802240, 0 
perpare first forward gemm: 0.258,  fisrt gemm forward duration: 3.221
AG, 0.233449, 1.874944, 0 
perpare first forward gemm: 0.319,  fisrt gemm forward duration: 1.934
AG, 0.254181, 1.898496, 0 
perpare first forward gemm: 0.313,  fisrt gemm forward duration: 2.992
GA, 0.041860, 0.773120, 0 
GA, 0.114894, 1.464320, 0 
GA, 0.233449, 1.971200, 0 
GA, 0.254181, 2.006016, 0 
forward:  9.909
forward:  9.898
forward:  9.59
forward:  8.613
AG, 0.041860, 1.107968, 0 
AG, 0.114894, 1.815552, 0 
AG, 0.233449, 1.852416, 0 
AG, 0.254181, 1.903616, 0 
Linear 2 Backward: 3.475, second_gemm: 3.463
Linear 2 Backward: 4.531, second_gemm: 4.52
Linear 2 Backward: 4.672, second_gemm: 4.659
Linear 2 Backward: 3.585, second_gemm: 3.577
GA, 0.041860, 0.776192, 0 
GA, 0.114894, 1.544192, 0 
GA, 0.233449, 1.981440, 0 
GA, 0.254181, 1.977344, 0 
perpare first backward gemm: 0.029,  fisrt gemm backward duration: 3.228,  weight grad: 1.463,  other: 0.429
Linear 1 Backward:  5.2
perpare first backward gemm: 0.032,  fisrt gemm backward duration: 2.345,  weight grad: 1.636,  other: 0.432
Linear 1 Backward:  4.496
perpare first backward gemm: 0.039,  fisrt gemm backward duration: 2.039,  weight grad: 1.897,  other: 0.44
Linear 1 Backward:  4.471
perpare first backward gemm: 0.027,  fisrt gemm backward duration: 2.097,  weight grad: 1.957,  other: 0.429
Linear 1 Backward:  4.547
STEP-64: step_time = 24.385984 ms, foward_time = 13.146560, backward_time = 11.097088, perf = 33.82 tflops.
start
start
block_info 215 9
start
cuda:1 process time:3.9856433868408203, a: 0.6117820739746094, b: 1.9617080688476562, c: 0.07200241088867188, d: 1.3401508331298828
block_info 235 27
start
block_info 299 76
1 wait time: 0.279
215
cuda:2 process time:4.493474960327148, a: 0.6945133209228516, b: 1.9297599792480469, c: 0.1316070556640625, d: 1.7375946044921875
cuda:3 process time:4.439115524291992, a: 0.6582736968994141, b: 1.867055892944336, c: 0.09393692016601562, d: 1.8198490142822266
block_info 287 67
2 wait time: 1.95
235
3 wait time: 1.43
299
cuda:0 process time:4.729986190795898, a: 0.9512901306152344, b: 1.2638568878173828, c: 0.1354217529296875, d: 2.3794174194335938
0 wait time: 2.429
287
AG, 0.041860, 1.123328, 0 
perpare first forward gemm: 0.288,  fisrt gemm forward duration: 2.716
AG, 0.233449, 1.871872, 0 
perpare first forward gemm: 0.374,  fisrt gemm forward duration: 1.953
AG, 0.114894, 1.801216, 0 
perpare first forward gemm: 0.262,  fisrt gemm forward duration: 2.965
AG, 0.254181, 1.898496, 0 
perpare first forward gemm: 0.337,  fisrt gemm forward duration: 2.778
GA, 0.041860, 0.774144, 0 
GA, 0.114894, 1.516544, 0 
GA, 0.233449, 1.937408, 0 
GA, 0.254181, 2.071552, 0 
forward:  10.213
forward:  8.865
forward:  9.726
forward:  9.58
AG, 0.041860, 1.126400, 0 
AG, 0.114894, 1.790976, 0 
AG, 0.254181, 1.896448, 0 
AG, 0.233449, 1.853440, 0 
Linear 2 Backward: 2.642, second_gemm: 2.627
Linear 2 Backward: 3.546, second_gemm: 3.532
Linear 2 Backward: 3.774, second_gemm: 3.766
Linear 2 Backward: 3.551, second_gemm: 3.543
GA, 0.041860, 0.775168, 0 
GA, 0.114894, 1.502208, 0 
GA, 0.233449, 1.993728, 0 
GA, 0.254181, 2.129920, 0 
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 3.109,  weight grad: 1.48,  other: 0.471
Linear 1 Backward:  5.162
perpare first backward gemm: 0.035,  fisrt gemm backward duration: 2.307,  weight grad: 1.643,  other: 0.447
Linear 1 Backward:  4.493
perpare first backward gemm: 0.029,  fisrt gemm backward duration: 2.178,  weight grad: 1.859,  other: 0.405
Linear 1 Backward:  4.506
perpare first backward gemm: 0.028,  fisrt gemm backward duration: 2.097,  weight grad: 1.959,  other: 0.409
Linear 1 Backward:  4.529
STEP-65: step_time = 23.641088 ms, foward_time = 12.644352, backward_time = 10.877952, perf = 34.88 tflops.
start
start
start
start
block_info 215 9
block_info 299 76
cuda:1 process time:3.3152103424072266, a: 0.5519390106201172, b: 1.432657241821289, c: 0.07295608520507812, d: 1.2576580047607422
block_info 235 27
cuda:3 process time:3.591775894165039, a: 0.7097721099853516, b: 1.4522075653076172, c: 0.08893013000488281, d: 1.3408660888671875
block_info 287 67
1 wait time: 1.039
215
3 wait time: 1.775
299
cuda:2 process time:3.987550735473633, a: 0.7379055023193359, b: 1.2459754943847656, c: 0.11944770812988281, d: 1.8842220306396484
cuda:0 process time:4.015684127807617, a: 0.81634521484375, b: 1.0399818420410156, c: 0.11205673217773438, d: 2.047300338745117
2 wait time: 1.584
235
0 wait time: 1.817
287
AG, 0.041860, 1.120256, 0 
perpare first forward gemm: 0.272,  fisrt gemm forward duration: 2.165
AG, 0.114894, 1.796096, 0 
perpare first forward gemm: 0.288,  fisrt gemm forward duration: 2.332
AG, 0.233449, 1.863680, 0 
perpare first forward gemm: 0.349,  fisrt gemm forward duration: 1.928
AG, 0.254181, 1.889280, 0 
perpare first forward gemm: 0.3,  fisrt gemm forward duration: 2.688
GA, 0.041860, 0.770048, 0 
GA, 0.114894, 1.482752, 0 
GA, 0.233449, 1.970176, 0 
GA, 0.254181, 1.987584, 0 
forward:  8.945
forward:  9.443
forward:  9.214
forward:  8.592
AG, 0.041860, 1.104896, 0 
AG, 0.114894, 1.809408, 0 
AG, 0.233449, 1.879040, 0 
AG, 0.254181, 1.892352, 0 
Linear 2 Backward: 2.852, second_gemm: 2.843
Linear 2 Backward: 3.71, second_gemm: 3.697
Linear 2 Backward: 3.595, second_gemm: 3.581
Linear 2 Backward: 3.769, second_gemm: 3.754
GA, 0.041860, 0.774144, 0 
GA, 0.114894, 1.509376, 0 
GA, 0.254181, 2.049024, 0 
GA, 0.233449, 1.991680, 0 
perpare first backward gemm: 0.027,  fisrt gemm backward duration: 3.377,  weight grad: 1.459,  other: 0.424
Linear 1 Backward:  5.333
perpare first backward gemm: 0.035,  fisrt gemm backward duration: 2.451,  weight grad: 1.641,  other: 0.473
Linear 1 Backward:  4.662
perpare first backward gemm: 0.042,  fisrt gemm backward duration: 2.159,  weight grad: 1.891,  other: 0.468
Linear 1 Backward:  4.633
perpare first backward gemm: 0.046,  fisrt gemm backward duration: 2.058,  weight grad: 1.992,  other: 0.477
Linear 1 Backward:  4.622
STEP-66: step_time = 22.710272 ms, foward_time = 11.421696, backward_time = 11.175936, perf = 36.31 tflops.
start
start
start
start
block_info 215 9
cuda:1 process time:3.2176971435546875, a: 0.5698204040527344, b: 1.361846923828125, c: 0.07390975952148438, d: 1.2121200561523438
block_info 235 27
1 wait time: 1.092
215
block_info 299 76
block_info 287 67
cuda:2 process time:3.952503204345703, a: 0.7386207580566406, b: 1.4760494232177734, c: 0.11777877807617188, d: 1.6200542449951172
2 wait time: 1.992
235
cuda:3 process time:4.248380661010742, a: 0.8804798126220703, b: 1.430511474609375, c: 0.12278556823730469, d: 1.8146038055419922
cuda:0 process time:4.256010055541992, a: 0.8137226104736328, b: 1.2764930725097656, c: 0.13589859008789062, d: 2.029895782470703
3 wait time: 2.3
299
0 wait time: 2.633
287
AG, 0.041860, 1.132544, 0 
perpare first forward gemm: 0.262,  fisrt gemm forward duration: 2.53
AG, 0.233449, 1.854464, 0 
perpare first forward gemm: 0.31,  fisrt gemm forward duration: 1.912
AG, 0.114894, 1.795072, 0 
perpare first forward gemm: 0.256,  fisrt gemm forward duration: 2.721
AG, 0.254181, 1.920000, 0 
perpare first forward gemm: 0.339,  fisrt gemm forward duration: 2.135
GA, 0.041860, 0.779264, 0 
GA, 0.114894, 1.472512, 0 
GA, 0.233449, 1.957888, 0 
GA, 0.254181, 2.077696, 0 
forward:  9.477
forward:  9.98
forward:  8.952
forward:  8.729
AG, 0.041860, 1.112064, 0 
AG, 0.254181, 1.875968, 0 
AG, 0.233449, 1.849344, 0 
AG, 0.114894, 1.800192, 0 
Linear 2 Backward: 2.57, second_gemm: 2.559
Linear 2 Backward: 3.511, second_gemm: 3.499
Linear 2 Backward: 3.606, second_gemm: 3.593
Linear 2 Backward: 3.627, second_gemm: 3.613
GA, 0.041860, 0.774144, 0 
GA, 0.114894, 1.532928, 0 
GA, 0.233449, 1.942528, 0 
GA, 0.254181, 2.082816, 0 
perpare first backward gemm: 0.029,  fisrt gemm backward duration: 3.277,  weight grad: 1.464,  other: 0.431
Linear 1 Backward:  5.253
perpare first backward gemm: 0.035,  fisrt gemm backward duration: 2.437,  weight grad: 1.638,  other: 0.439
Linear 1 Backward:  4.605
perpare first backward gemm: 0.039,  fisrt gemm backward duration: 2.166,  weight grad: 1.886,  other: 0.436
Linear 1 Backward:  4.586
perpare first backward gemm: 0.037,  fisrt gemm backward duration: 2.092,  weight grad: 1.983,  other: 0.439
Linear 1 Backward:  4.607
STEP-67: step_time = 23.591200 ms, foward_time = 12.289312, backward_time = 11.188224, perf = 34.96 tflops.
start
start
start
start
block_info 215 9
cuda:1 process time:3.283977508544922, a: 0.629425048828125, b: 1.3887882232666016, c: 0.07319450378417969, d: 1.1925697326660156
1 wait time: 1.05
215
block_info 235 27
block_info 299 76
cuda:2 process time:3.777742385864258, a: 0.7152557373046875, b: 1.1630058288574219, c: 0.1239776611328125, d: 1.775503158569336
2 wait time: 1.744
235
block_info 287 67
cuda:3 process time:4.206418991088867, a: 0.8046627044677734, b: 1.3849735260009766, c: 0.13327598571777344, d: 1.8835067749023438
3 wait time: 2.31
299
cuda:0 process time:4.669904708862305, a: 0.8504390716552734, b: 1.3718605041503906, c: 0.18024444580078125, d: 2.2673606872558594
0 wait time: 2.835
287
AG, 0.041860, 1.120256, 0 
perpare first forward gemm: 0.263,  fisrt gemm forward duration: 3.11
AG, 0.114894, 1.802240, 0 
perpare first forward gemm: 0.281,  fisrt gemm forward duration: 3.069
AG, 0.233449, 1.859584, 0 
perpare first forward gemm: 0.349,  fisrt gemm forward duration: 1.926
AG, 0.254181, 1.923072, 0 
perpare first forward gemm: 0.305,  fisrt gemm forward duration: 2.783
GA, 0.041860, 0.776192, 0 
GA, 0.114894, 1.475584, 0 
GA, 0.233449, 1.848320, 0 
GA, 0.254181, 2.085888, 0 
forward:  10.472
forward:  9.776
forward:  9.391
forward:  8.705
AG, 0.041860, 1.140736, 0 
AG, 0.114894, 1.813504, 0 
AG, 0.233449, 1.872896, 0 
AG, 0.254181, 1.899520, 0 
Linear 2 Backward: 2.763, second_gemm: 2.751
Linear 2 Backward: 3.559, second_gemm: 3.546
Linear 2 Backward: 3.687, second_gemm: 3.672
Linear 2 Backward: 3.717, second_gemm: 3.703
GA, 0.041860, 0.773120, 0 
GA, 0.114894, 1.516544, 0 
GA, 0.233449, 1.934336, 0 
GA, 0.254181, 2.033664, 0 
perpare first backward gemm: 0.028,  fisrt gemm backward duration: 3.294,  weight grad: 1.463,  other: 0.429
Linear 1 Backward:  5.257
perpare first backward gemm: 0.05,  fisrt gemm backward duration: 2.402,  weight grad: 1.642,  other: 0.446
Linear 1 Backward:  4.587
perpare first backward gemm: 0.045,  fisrt gemm backward duration: 2.099,  weight grad: 1.912,  other: 0.457
Linear 1 Backward:  4.561
perpare first backward gemm: 0.042,  fisrt gemm backward duration: 2.025,  weight grad: 1.997,  other: 0.442
Linear 1 Backward:  4.556
STEP-68: step_time = 23.632448 ms, foward_time = 12.506688, backward_time = 11.013120, perf = 34.89 tflops.
start
start
start
block_info 215 9
start
cuda:1 process time:3.1044483184814453, a: 0.5695819854736328, b: 1.2850761413574219, c: 0.07343292236328125, d: 1.1763572692871094
block_info 299 76
block_info 235 27
1 wait time: 1.13
215
cuda:3 process time:3.406047821044922, a: 0.6177425384521484, b: 1.1916160583496094, c: 0.07677078247070312, d: 1.519918441772461
cuda:2 process time:3.871917724609375, a: 0.7479190826416016, b: 1.3248920440673828, c: 0.11968612670898438, d: 1.6794204711914062
3 wait time: 0.98
299
2 wait time: 1.671
235
block_info 287 67
cuda:0 process time:4.425525665283203, a: 0.81634521484375, b: 1.2960433959960938, c: 0.14591217041015625, d: 2.167224884033203
0 wait time: 2.81
287
AG, 0.041860, 1.115136, 0 
perpare first forward gemm: 0.261,  fisrt gemm forward duration: 2.817
AG, 0.233449, 1.858560, 0 
perpare first forward gemm: 0.308,  fisrt gemm forward duration: 1.915
AG, 0.114894, 1.798144, 0 
perpare first forward gemm: 0.254,  fisrt gemm forward duration: 3.016
AG, 0.254181, 1.909760, 0 
perpare first forward gemm: 0.338,  fisrt gemm forward duration: 3.019
GA, 0.041860, 0.778240, 0 
GA, 0.114894, 1.459200, 0 
GA, 0.233449, 1.952768, 0 
GA, 0.254181, 2.077696, 0 
forward:  9.787
forward:  9.843
forward:  10.312
forward:  8.728
AG, 0.041860, 1.102848, 0 
AG, 0.233449, 1.865728, 0 
AG, 0.114894, 1.803264, 0 
AG, 0.254181, 1.890304, 0 
Linear 2 Backward: 2.718, second_gemm: 2.703
Linear 2 Backward: 3.562, second_gemm: 3.55
Linear 2 Backward: 3.636, second_gemm: 3.623
Linear 2 Backward: 3.666, second_gemm: 3.653
GA, 0.041860, 0.781312, 0 
GA, 0.114894, 1.508352, 0 
GA, 0.233449, 1.916928, 0 
GA, 0.254181, 2.058240, 0 
perpare first backward gemm: 0.032,  fisrt gemm backward duration: 2.439,  weight grad: 1.632,  other: 0.431
Linear 1 Backward:  4.587
perpare first backward gemm: 0.037,  fisrt gemm backward duration: 3.227,  weight grad: 1.496,  other: 0.452
Linear 1 Backward:  5.279
perpare first backward gemm: 0.039,  fisrt gemm backward duration: 2.12,  weight grad: 1.901,  other: 0.439
Linear 1 Backward:  4.557
perpare first backward gemm: 0.037,  fisrt gemm backward duration: 2.061,  weight grad: 1.984,  other: 0.443
Linear 1 Backward:  4.583
STEP-69: step_time = 23.897089 ms, foward_time = 12.471296, backward_time = 11.313152, perf = 34.51 tflops.
start
start
start
block_info 215 9
start
cuda:1 process time:3.388643264770508, a: 0.5762577056884766, b: 1.4832019805908203, c: 0.07271766662597656, d: 1.2564659118652344
block_info 299 76
1 wait time: 0.888
215
block_info 235 27
cuda:3 process time:3.641366958618164, a: 0.6535053253173828, b: 1.1532306671142578, c: 0.08940696716308594, d: 1.7452239990234375
cuda:2 process time:3.9148330688476562, a: 0.6806850433349609, b: 1.2035369873046875, c: 0.11873245239257812, d: 1.9118785858154297
3 wait time: 1.296
299
2 wait time: 1.563
235
block_info 287 67
cuda:0 process time:4.880428314208984, a: 0.8027553558349609, b: 1.2154579162597656, c: 0.1456737518310547, d: 2.716541290283203
0 wait time: 2.404
287
AG, 0.041860, 1.118208, 0 
perpare first forward gemm: 0.273,  fisrt gemm forward duration: 3.245
AG, 0.114894, 1.814528, 0 
perpare first forward gemm: 0.297,  fisrt gemm forward duration: 3.156
AG, 0.233449, 1.855488, 0 
perpare first forward gemm: 0.366,  fisrt gemm forward duration: 1.936
AG, 0.254181, 1.945600, 0 
perpare first forward gemm: 0.341,  fisrt gemm forward duration: 3.369
GA, 0.041860, 0.775168, 0 
GA, 0.114894, 1.486848, 0 
GA, 0.233449, 1.953792, 0 
GA, 0.254181, 2.034688, 0 
forward:  9.992
forward:  10.747
forward:  10.147
forward:  8.878
AG, 0.041860, 1.140736, 0 
AG, 0.233449, 1.854464, 0 
AG, 0.114894, 1.803264, 0 
AG, 0.254181, 1.924096, 0 
Linear 2 Backward: 2.713, second_gemm: 2.703
Linear 2 Backward: 3.338, second_gemm: 3.325
Linear 2 Backward: 3.671, second_gemm: 3.663
Linear 2 Backward: 3.73, second_gemm: 3.716
GA, 0.041860, 0.766976, 0 
GA, 0.114894, 1.530880, 0 
GA, 0.233449, 1.871872, 0 
GA, 0.254181, 2.071552, 0 
perpare first backward gemm: 0.039,  fisrt gemm backward duration: 3.327,  weight grad: 1.449,  other: 0.41
Linear 1 Backward:  5.264
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 2.485,  weight grad: 1.64,  other: 0.462
Linear 1 Backward:  4.684
perpare first backward gemm: 0.027,  fisrt gemm backward duration: 2.279,  weight grad: 1.96,  other: 0.407
Linear 1 Backward:  4.71
perpare first backward gemm: 0.043,  fisrt gemm backward duration: 2.139,  weight grad: 1.911,  other: 0.473
Linear 1 Backward:  4.632
STEP-70: step_time = 23.779327 ms, foward_time = 12.372993, backward_time = 11.275264, perf = 34.68 tflops.
start
start
start
start
block_info 215 9
cuda:1 process time:3.0694007873535156, a: 0.6387233734130859, b: 1.1572837829589844, c: 0.07319450378417969, d: 1.2001991271972656
block_info 299 76
block_info 235 27
1 wait time: 1.158
215
cuda:3 process time:3.500223159790039, a: 0.7414817810058594, b: 1.2307167053222656, c: 0.0972747802734375, d: 1.4307498931884766
cuda:2 process time:3.7429332733154297, a: 0.7548332214355469, b: 1.25885009765625, c: 0.118255615234375, d: 1.6109943389892578
3 wait time: 1.863
299
block_info 287 67
2 wait time: 2.005
235
cuda:0 process time:4.513978958129883, a: 0.7891654968261719, b: 1.1589527130126953, c: 0.15306472778320312, d: 2.4127960205078125
0 wait time: 2.532
287
AG, 0.041860, 1.132544, 0 
perpare first forward gemm: 0.269,  fisrt gemm forward duration: 2.915
AG, 0.114894, 1.795072, 0 
perpare first forward gemm: 0.263,  fisrt gemm forward duration: 2.899
AG, 0.254181, 1.886208, 0 
AG, 0.233449, 1.875968, 0 
perpare first forward gemm: 0.339,  fisrt gemm forward duration: 1.945
perpare first forward gemm: 0.301,  fisrt gemm forward duration: 3.1
GA, 0.041860, 0.776192, 0 
GA, 0.114894, 1.484800, 0 
GA, 0.254181, 2.074624, 0 
GA, 0.233449, 1.942528, 0 
forward:  10.208
forward:  9.574
forward:  9.68
forward:  8.62
AG, 0.041860, 1.142784, 0 
AG, 0.254181, 1.885184, 0 
AG, 0.233449, 1.851392, 0 
AG, 0.114894, 1.814528, 0 
Linear 2 Backward: 2.839, second_gemm: 2.828
Linear 2 Backward: 3.577, second_gemm: 3.564
Linear 2 Backward: 3.675, second_gemm: 3.661
Linear 2 Backward: 3.654, second_gemm: 3.641
GA, 0.041860, 0.773120, 0 
GA, 0.114894, 1.511424, 0 
GA, 0.233449, 1.968128, 0 
GA, 0.254181, 2.062336, 0 
perpare first backward gemm: 0.029,  fisrt gemm backward duration: 3.298,  weight grad: 1.465,  other: 0.431
Linear 1 Backward:  5.274
perpare first backward gemm: 0.035,  fisrt gemm backward duration: 2.451,  weight grad: 1.641,  other: 0.443
Linear 1 Backward:  4.63
perpare first backward gemm: 0.042,  fisrt gemm backward duration: 2.158,  weight grad: 1.895,  other: 0.454
perpare first backward gemm: 0.072,  fisrt gemm backward duration: 2.073,  weight grad: 1.962,  other: 0.413
Linear 1 Backward:  4.567
Linear 1 Backward:  4.615
STEP-71: step_time = 23.250945 ms, foward_time = 12.155905, backward_time = 10.982400, perf = 35.47 tflops.
start
start
start
start
block_info 215 9
cuda:1 process time:3.1440258026123047, a: 0.5309581756591797, b: 1.4259815216064453, c: 0.07271766662597656, d: 1.1143684387207031
block_info 235 27
1 wait time: 1.161
block_info 299 76
215
cuda:2 process time:4.002094268798828, a: 0.7295608520507812, b: 1.4615058898925781, c: 0.12469291687011719, d: 1.6863346099853516
2 wait time: 1.666
235
block_info 287 67
cuda:3 process time:4.271268844604492, a: 0.7960796356201172, b: 1.5659332275390625, c: 0.1251697540283203, d: 1.7840862274169922
3 wait time: 2.256
299
cuda:0 process time:4.498481750488281, a: 0.8380413055419922, b: 1.1527538299560547, c: 0.14662742614746094, d: 2.3610591888427734
0 wait time: 2.488
287
AG, 0.041860, 1.114112, 0 
perpare first forward gemm: 0.251,  fisrt gemm forward duration: 2.794
AG, 0.114894, 1.801216, 0 
perpare first forward gemm: 0.254,  fisrt gemm forward duration: 3.081
AG, 0.233449, 1.886208, 0 
perpare first forward gemm: 0.334,  fisrt gemm forward duration: 1.954
AG, 0.254181, 1.894400, 0 
perpare first forward gemm: 0.293,  fisrt gemm forward duration: 2.682
GA, 0.041860, 0.775168, 0 
GA, 0.114894, 1.505280, 0 
GA, 0.233449, 1.941504, 0 
GA, 0.254181, 2.100224, 0 
forward:  9.706
forward:  9.246
forward:  10.119
forward:  8.683
AG, 0.041860, 1.116160, 0 
AG, 0.254181, 1.868800, 0 
AG, 0.114894, 1.805312, 0 
AG, 0.233449, 1.902592, 0 
Linear 2 Backward: 2.585, second_gemm: 2.571
Linear 2 Backward: 3.651, second_gemm: 3.64
Linear 2 Backward: 3.804, second_gemm: 3.796
Linear 2 Backward: 3.848, second_gemm: 3.833
GA, 0.041860, 0.777216, 0 
GA, 0.114894, 1.501184, 0 
GA, 0.254181, 2.076672, 0 
GA, 0.233449, 1.961984, 0 
perpare first backward gemm: 0.037,  fisrt gemm backward duration: 3.258,  weight grad: 1.482,  other: 0.45
Linear 1 Backward:  5.293
perpare first backward gemm: 0.032,  fisrt gemm backward duration: 2.52,  weight grad: 1.632,  other: 0.434
Linear 1 Backward:  4.67
perpare first backward gemm: 0.035,  fisrt gemm backward duration: 2.328,  weight grad: 1.869,  other: 0.422
Linear 1 Backward:  4.701
perpare first backward gemm: 0.042,  fisrt gemm backward duration: 2.03,  weight grad: 2.022,  other: 0.457
Linear 1 Backward:  4.617
STEP-72: step_time = 23.935999 ms, foward_time = 12.224512, backward_time = 11.600896, perf = 34.45 tflops.
start
start
block_info 235 27
start
block_info 215 9
cuda:2 process time:3.3643245697021484, a: 0.3788471221923828, b: 1.720428466796875, c: 0.07224082946777344, d: 1.1928081512451172
cuda:1 process time:3.3719539642333984, a: 0.5621910095214844, b: 1.4863014221191406, c: 0.072479248046875, d: 1.2509822845458984
1 wait time: 0.929
215
start
2 wait time: 0.011
235
block_info 299 76
cuda:3 process time:4.12750244140625, a: 0.8268356323242188, b: 1.1386871337890625, c: 0.11706352233886719, d: 2.0449161529541016
block_info 287 67
3 wait time: 2.202
299
cuda:0 process time:4.758596420288086, a: 0.8077621459960938, b: 1.2118816375732422, c: 0.14519691467285156, d: 2.5937557220458984
0 wait time: 2.294
287
AG, 0.041860, 1.098752, 0 
perpare first forward gemm: 0.241,  fisrt gemm forward duration: 3.146
AG, 0.114894, 1.810432, 0 
perpare first forward gemm: 0.297,  fisrt gemm forward duration: 3.666
AG, 0.233449, 1.870848, 0 
perpare first forward gemm: 0.372,  fisrt gemm forward duration: 1.951
AG, 0.254181, 1.922048, 0 
perpare first forward gemm: 0.353,  fisrt gemm forward duration: 2.692
GA, 0.041860, 0.770048, 0 
GA, 0.114894, 1.496064, 0 
GA, 0.233449, 1.868800, 0 
GA, 0.254181, 2.065408, 0 
forward:  10.586
forward:  10.491
forward:  9.488
forward:  8.885
AG, 0.041860, 1.130496, 0 
AG, 0.254181, 1.872896, 0 
AG, 0.114894, 1.794048, 0 
AG, 0.233449, 1.854464, 0 
Linear 2 Backward: 2.617, second_gemm: 2.606
Linear 2 Backward: 3.581, second_gemm: 3.572
Linear 2 Backward: 3.706, second_gemm: 3.698
Linear 2 Backward: 3.556, second_gemm: 3.548
GA, 0.041860, 0.770048, 0 
GA, 0.114894, 1.467392, 0 
GA, 0.233449, 1.952768, 0 
GA, 0.254181, 2.087936, 0 
perpare first backward gemm: 0.027,  fisrt gemm backward duration: 3.13,  weight grad: 1.452,  other: 0.406
Linear 1 Backward:  5.056
perpare first backward gemm: 0.024,  fisrt gemm backward duration: 2.392,  weight grad: 1.617,  other: 0.408
Linear 1 Backward:  4.475
perpare first backward gemm: 0.029,  fisrt gemm backward duration: 2.137,  weight grad: 1.855,  other: 0.408
Linear 1 Backward:  4.465
perpare first backward gemm: 0.027,  fisrt gemm backward duration: 2.043,  weight grad: 1.958,  other: 0.409
Linear 1 Backward:  4.475
STEP-73: step_time = 23.209985 ms, foward_time = 12.352512, backward_time = 10.740736, perf = 35.53 tflops.
start
start
start
start
block_info 235 27
block_info 215 9
cuda:2 process time:3.476381301879883, a: 0.5731582641601562, b: 1.6505718231201172, c: 0.07343292236328125, d: 1.1792182922363281
cuda:1 process time:3.1583309173583984, a: 0.5893707275390625, b: 1.2581348419189453, c: 0.072479248046875, d: 1.2383460998535156
2 wait time: 1.051
235
1 wait time: 0.893
215
block_info 287 67
block_info 299 76
cuda:0 process time:3.971099853515625, a: 0.8146762847900391, b: 1.087188720703125, c: 0.11920928955078125, d: 1.9500255584716797
0 wait time: 2.098
287
cuda:3 process time:4.616975784301758, a: 0.83160400390625, b: 1.4262199401855469, c: 0.1442432403564453, d: 2.2149085998535156
3 wait time: 2.819
299
AG, 0.041860, 1.154048, 0 
perpare first forward gemm: 0.279,  fisrt gemm forward duration: 2.626
AG, 0.233449, 1.878016, 0 
perpare first forward gemm: 0.336,  fisrt gemm forward duration: 2.341
AG, 0.254181, 1.899520, 0 
perpare first forward gemm: 0.3,  fisrt gemm forward duration: 1.957
AG, 0.114894, 1.800192, 0 
perpare first forward gemm: 0.254,  fisrt gemm forward duration: 3.459
GA, 0.041860, 0.769024, 0 
GA, 0.114894, 1.517568, 0 
GA, 0.233449, 1.982464, 0 
GA, 0.254181, 2.098176, 0 
forward:  9.954
forward:  10.078
forward:  8.533
forward:  9.042
AG, 0.041860, 1.111040, 0 
AG, 0.114894, 1.799168, 0 
AG, 0.233449, 1.853440, 0 
AG, 0.254181, 1.882112, 0 
Linear 2 Backward: 2.719, second_gemm: 2.708
Linear 2 Backward: 3.552, second_gemm: 3.539
Linear 2 Backward: 3.773, second_gemm: 3.759
Linear 2 Backward: 3.673, second_gemm: 3.659
GA, 0.041860, 0.773120, 0 
GA, 0.114894, 1.516544, 0 
GA, 0.233449, 1.955840, 0 
GA, 0.254181, 2.037760, 0 
perpare first backward gemm: 0.028,  fisrt gemm backward duration: 3.301,  weight grad: 1.478,  other: 0.428
Linear 1 Backward:  5.287
perpare first backward gemm: 0.032,  fisrt gemm backward duration: 2.456,  weight grad: 1.633,  other: 0.44
Linear 1 Backward:  4.615
perpare first backward gemm: 0.043,  fisrt gemm backward duration: 2.109,  weight grad: 1.89,  other: 0.447
Linear 1 Backward:  4.59
perpare first backward gemm: 0.042,  fisrt gemm backward duration: 2.023,  weight grad: 1.993,  other: 0.455
Linear 1 Backward:  4.58
STEP-74: step_time = 23.382016 ms, foward_time = 12.132352, backward_time = 11.136000, perf = 35.27 tflops.
start
start
block_info 215 9
block_info 235 27
start
cuda:1 process time:3.5305023193359375, a: 0.5619525909423828, b: 1.5749931335449219, c: 0.07295608520507812, d: 1.3206005096435547
start
cuda:2 process time:3.8726329803466797, a: 0.46753883361816406, b: 2.017498016357422, c: 0.07343292236328125, d: 1.3141632080078125
block_info 299 76
1 wait time: 0.386
215
2 wait time: 0.285
235
block_info 287 67
cuda:3 process time:3.9975643157958984, a: 0.8275508880615234, b: 1.0437965393066406, c: 0.11181831359863281, d: 2.0143985748291016
3 wait time: 1.825
299
cuda:0 process time:4.6539306640625, a: 0.8854866027832031, b: 2.056121826171875, c: 0.1506805419921875, d: 1.5616416931152344
0 wait time: 2.187
287
AG, 0.041860, 1.135616, 0 
perpare first forward gemm: 0.302,  fisrt gemm forward duration: 2.49
AG, 0.114894, 1.814528, 0 
perpare first forward gemm: 0.299,  fisrt gemm forward duration: 3.115
AG, 0.233449, 1.873920, 0 
perpare first forward gemm: 0.302,  fisrt gemm forward duration: 1.932
AG, 0.254181, 1.902592, 0 
perpare first forward gemm: 0.337,  fisrt gemm forward duration: 2.494
GA, 0.041860, 0.766976, 0 
GA, 0.114894, 1.494016, 0 
GA, 0.233449, 1.902592, 0 
GA, 0.254181, 2.078720, 0 
forward:  9.934
forward:  9.993
forward:  9.275
forward:  8.809
AG, 0.041860, 1.134592, 0 
AG, 0.233449, 1.873920, 0 
AG, 0.254181, 1.889280, 0 
AG, 0.114894, 1.808384, 0 
Linear 2 Backward: 2.643, second_gemm: 2.628
Linear 2 Backward: 3.57, second_gemm: 3.555
Linear 2 Backward: 3.733, second_gemm: 3.721
Linear 2 Backward: 3.661, second_gemm: 3.649
GA, 0.041860, 0.772096, 0 
GA, 0.114894, 1.509376, 0 
GA, 0.254181, 1.980416, 0 
GA, 0.233449, 1.952768, 0 
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 3.143,  weight grad: 1.481,  other: 0.448
Linear 1 Backward:  5.174
perpare first backward gemm: 0.037,  fisrt gemm backward duration: 2.355,  weight grad: 1.65,  other: 0.45
Linear 1 Backward:  4.557
perpare first backward gemm: 0.039,  fisrt gemm backward duration: 2.129,  weight grad: 1.887,  other: 0.438
Linear 1 Backward:  4.55
perpare first backward gemm: 0.038,  fisrt gemm backward duration: 2.018,  weight grad: 2,  other: 0.453
Linear 1 Backward:  4.568
STEP-75: step_time = 23.506944 ms, foward_time = 12.058624, backward_time = 11.336704, perf = 35.08 tflops.
start
start
start
block_info 235 27
start
cuda:2 process time:3.635883331298828, a: 0.5676746368408203, b: 1.6646385192871094, c: 0.07224082946777344, d: 1.331329345703125
block_info 299 76
2 wait time: 0.354
235
block_info 215 9
block_info 287 67
cuda:3 process time:4.292488098144531, a: 0.8425712585449219, b: 1.2738704681396484, c: 0.11181831359863281, d: 2.064228057861328
cuda:1 process time:4.565238952636719, a: 0.8800029754638672, b: 1.5819072723388672, c: 0.14662742614746094, d: 1.9567012786865234
3 wait time: 1.629
299
1 wait time: 2.453
215
cuda:0 process time:4.816532135009766, a: 0.9553432464599609, b: 1.2867450714111328, c: 0.14400482177734375, d: 2.430438995361328
0 wait time: 2.494
287
AG, 0.041860, 1.111040, 0 
perpare first forward gemm: 0.288,  fisrt gemm forward duration: 1.778
AG, 0.233449, 1.851392, 0 
perpare first forward gemm: 0.362,  fisrt gemm forward duration: 1.907
AG, 0.114894, 1.792000, 0 
perpare first forward gemm: 0.297,  fisrt gemm forward duration: 3.45
AG, 0.254181, 1.890304, 0 
perpare first forward gemm: 0.335,  fisrt gemm forward duration: 2.754
GA, 0.041860, 0.769024, 0 
GA, 0.114894, 1.469440, 0 
GA, 0.233449, 1.956864, 0 
GA, 0.254181, 2.077696, 0 
forward:  10.15
forward:  9.179
forward:  9.399
forward:  8.725
AG, 0.041860, 1.124352, 0 
AG, 0.254181, 1.893376, 0 
AG, 0.233449, 1.868800, 0 
AG, 0.114894, 1.801216, 0 
Linear 2 Backward: 2.798, second_gemm: 2.784
Linear 2 Backward: 3.598, second_gemm: 3.586
Linear 2 Backward: 3.815, second_gemm: 3.8
Linear 2 Backward: 3.701, second_gemm: 3.686
GA, 0.041860, 0.771072, 0 
GA, 0.114894, 1.496064, 0 
GA, 0.233449, 1.916928, 0 
GA, 0.254181, 2.086912, 0 
perpare first backward gemm: 0.034,  fisrt gemm backward duration: 3.278,  weight grad: 1.482,  other: 0.408
Linear 1 Backward:  5.251
perpare first backward gemm: 0.033,  fisrt gemm backward duration: 2.482,  weight grad: 1.634,  other: 0.44
Linear 1 Backward:  4.645
perpare first backward gemm: 0.043,  fisrt gemm backward duration: 2.156,  weight grad: 1.887,  other: 0.408
Linear 1 Backward:  4.543
perpare first backward gemm: 0.042,  fisrt gemm backward duration: 2.086,  weight grad: 1.986,  other: 0.412
Linear 1 Backward:  4.576
STEP-76: step_time = 23.579647 ms, foward_time = 12.288000, backward_time = 11.180032, perf = 34.97 tflops.
start
start
start
start
block_info 235 27
cuda:2 process time:3.1692981719970703, a: 0.6349086761474609, b: 1.4612674713134766, c: 0.08106231689453125, d: 0.9920597076416016
block_info 215 9
block_info 299 76
2 wait time: 1.462
235
cuda:1 process time:3.914356231689453, a: 0.70953369140625, b: 1.6243457794189453, c: 0.1125335693359375, d: 1.4679431915283203
cuda:3 process time:3.7620067596435547, a: 0.7836818695068359, b: 1.0917186737060547, c: 0.11491775512695312, d: 1.771688461303711
1 wait time: 1.87
215
block_info 287 67
3 wait time: 2.38
299
cuda:0 process time:4.438638687133789, a: 0.8304119110107422, b: 1.2638568878173828, c: 0.14328956604003906, d: 2.201080322265625
0 wait time: 2.819
287
AG, 0.041860, 1.111040, 0 
perpare first forward gemm: 0.254,  fisrt gemm forward duration: 2.297
AG, 0.114894, 1.798144, 0 
perpare first forward gemm: 0.271,  fisrt gemm forward duration: 3.374
AG, 0.233449, 1.860608, 0 
perpare first forward gemm: 0.31,  fisrt gemm forward duration: 1.918
AG, 0.254181, 1.902592, 0 
perpare first forward gemm: 0.296,  fisrt gemm forward duration: 2.691
GA, 0.041860, 0.771072, 0 
GA, 0.114894, 1.485824, 0 
GA, 0.233449, 1.972224, 0 
GA, 0.254181, 2.116608, 0 
forward:  9.671
forward:  8.634
forward:  10.096
forward:  9.317
AG, 0.041860, 1.139712, 0 
AG, 0.114894, 1.799168, 0 
AG, 0.233449, 1.862656, 0 
AG, 0.254181, 1.896448, 0 
Linear 2 Backward: 2.807, second_gemm: 2.796
Linear 2 Backward: 3.473, second_gemm: 3.462
Linear 2 Backward: 3.597, second_gemm: 3.586
Linear 2 Backward: 3.618, second_gemm: 3.607
GA, 0.041860, 0.777216, 0 
GA, 0.114894, 1.518592, 0 
GA, 0.233449, 1.937408, 0 
GA, 0.254181, 2.092032, 0 
perpare first backward gemm: 0.029,  fisrt gemm backward duration: 3.147,  weight grad: 1.464,  other: 0.428
Linear 1 Backward:  5.119
perpare first backward gemm: 0.031,  fisrt gemm backward duration: 2.459,  weight grad: 1.627,  other: 0.43
Linear 1 Backward:  4.598
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 2.151,  weight grad: 1.89,  other: 0.43
Linear 1 Backward:  4.559
perpare first backward gemm: 0.035,  fisrt gemm backward duration: 2.113,  weight grad: 1.975,  other: 0.431
Linear 1 Backward:  4.606
STEP-77: step_time = 23.526400 ms, foward_time = 12.388352, backward_time = 11.024384, perf = 35.05 tflops.
start
start
start
block_info 235 27
start
block_info 215 9
cuda:2 process time:3.5347938537597656, a: 0.5383491516113281, b: 1.6713142395019531, c: 0.07295608520507812, d: 1.2521743774414062
2 wait time: 1.008
235
cuda:1 process time:3.995656967163086, a: 0.7469654083251953, b: 1.4965534210205078, c: 0.11086463928222656, d: 1.6412734985351562
block_info 299 76
1 wait time: 1.62
215
cuda:3 process time:4.145145416259766, a: 0.8873939514160156, b: 1.3599395751953125, c: 0.12087821960449219, d: 1.7769336700439453
block_info 287 67
3 wait time: 2.335
299
cuda:0 process time:5.01704216003418, a: 0.8094310760498047, b: 1.4379024505615234, c: 0.16188621520996094, d: 2.6078224182128906
0 wait time: 2.159
287
AG, 0.041860, 1.135616, 0 
perpare first forward gemm: 0.238,  fisrt gemm forward duration: 2.712
AG, 0.114894, 1.811456, 0 
perpare first forward gemm: 0.274,  fisrt gemm forward duration: 3.839
AG, 0.233449, 1.864704, 0 
perpare first forward gemm: 0.369,  fisrt gemm forward duration: 1.946
AG, 0.254181, 1.960960, 0 
perpare first forward gemm: 0.37,  fisrt gemm forward duration: 2.792
GA, 0.041860, 0.769024, 0 
GA, 0.114894, 1.517568, 0 
GA, 0.233449, 1.959936, 0 
GA, 0.254181, 2.040832, 0 
forward:  10.561
forward:  10.06
forward:  9.534
forward:  8.82
AG, 0.041860, 1.147904, 0 
AG, 0.233449, 1.860608, 0 
AG, 0.254181, 1.909760, 0 
AG, 0.114894, 1.882112, 0 
Linear 2 Backward: 2.585, second_gemm: 2.571
Linear 2 Backward: 3.595, second_gemm: 3.581
Linear 2 Backward: 3.703, second_gemm: 3.695
Linear 2 Backward: 3.633, second_gemm: 3.62
GA, 0.041860, 0.773120, 0 
GA, 0.114894, 1.502208, 0 
GA, 0.233449, 1.874944, 0 
GA, 0.254181, 2.087936, 0 
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 3.239,  weight grad: 1.446,  other: 0.41
Linear 1 Backward:  5.179
perpare first backward gemm: 0.037,  fisrt gemm backward duration: 2.32,  weight grad: 1.646,  other: 0.45
Linear 1 Backward:  4.52
perpare first backward gemm: 0.028,  fisrt gemm backward duration: 2.265,  weight grad: 1.959,  other: 0.409
Linear 1 Backward:  4.698
perpare first backward gemm: 0.041,  fisrt gemm backward duration: 2.153,  weight grad: 1.902,  other: 0.443
Linear 1 Backward:  4.602
STEP-78: step_time = 23.367681 ms, foward_time = 12.044288, backward_time = 11.211776, perf = 35.29 tflops.
start
start
start
start
block_info 235 27
cuda:2 process time:3.5953521728515625, a: 0.5640983581542969, b: 1.6407966613769531, c: 0.07200241088867188, d: 1.3184547424316406
2 wait time: 0.894
235
block_info 299 76
block_info 287 67
block_info 215 9
cuda:3 process time:4.347562789916992, a: 0.8561611175537109, b: 1.367330551147461, c: 0.11730194091796875, d: 2.0067691802978516
cuda:0 process time:4.481792449951172, a: 0.9007453918457031, b: 1.6465187072753906, c: 0.13637542724609375, d: 1.7981529235839844
cuda:1 process time:4.559516906738281, a: 0.682830810546875, b: 1.3616085052490234, c: 0.11944770812988281, d: 2.3956298828125
3 wait time: 2.1
299
0 wait time: 2.438
287
1 wait time: 1.983
215
AG, 0.041860, 1.127424, 0 
perpare first forward gemm: 0.286,  fisrt gemm forward duration: 1.3
AG, 0.114894, 1.788928, 0 
perpare first forward gemm: 0.296,  fisrt gemm forward duration: 3.185
AG, 0.233449, 1.861632, 0 
perpare first forward gemm: 0.361,  fisrt gemm forward duration: 1.965
AG, 0.254181, 1.899520, 0 
perpare first forward gemm: 0.338,  fisrt gemm forward duration: 2.214
GA, 0.041860, 0.771072, 0 
GA, 0.114894, 1.471488, 0 
GA, 0.233449, 1.974272, 0 
GA, 0.254181, 2.062336, 0 
forward:  9.899
forward:  8.664
forward:  8.931
forward:  8.766
AG, 0.041860, 1.116160, 0 
AG, 0.233449, 1.869824, 0 
AG, 0.114894, 1.804288, 0 
AG, 0.254181, 1.907712, 0 
Linear 2 Backward: 2.618, second_gemm: 2.603
Linear 2 Backward: 3.613, second_gemm: 3.604
Linear 2 Backward: 3.733, second_gemm: 3.719
Linear 2 Backward: 3.671, second_gemm: 3.657
GA, 0.041860, 0.775168, 0 
GA, 0.114894, 1.521664, 0 
GA, 0.233449, 1.968128, 0 
GA, 0.254181, 2.082816, 0 
perpare first backward gemm: 0.035,  fisrt gemm backward duration: 3.287,  weight grad: 1.479,  other: 0.411
Linear 1 Backward:  5.261
perpare first backward gemm: 0.032,  fisrt gemm backward duration: 2.531,  weight grad: 1.639,  other: 0.433
Linear 1 Backward:  4.689
perpare first backward gemm: 0.043,  fisrt gemm backward duration: 2.149,  weight grad: 1.905,  other: 0.408
Linear 1 Backward:  4.554
perpare first backward gemm: 0.028,  fisrt gemm backward duration: 2.154,  weight grad: 1.959,  other: 0.411
Linear 1 Backward:  4.589
STEP-79: step_time = 23.416640 ms, foward_time = 12.204864, backward_time = 11.097088, perf = 35.22 tflops.
start
start
start
start
block_info 235 27
cuda:2 process time:3.321409225463867, a: 0.6382465362548828, b: 1.4870166778564453, c: 0.08106231689453125, d: 1.1150836944580078
2 wait time: 1.156
235
block_info 215 9
block_info 287 67
block_info 299 76
cuda:1 process time:4.50444221496582, a: 0.7765293121337891, b: 1.634836196899414, c: 0.14472007751464844, d: 1.9483566284179688
cuda:0 process time:4.516839981079102, a: 1.0552406311035156, b: 1.1363029479980469, c: 0.1442432403564453, d: 2.1810531616210938
cuda:3 process time:4.75311279296875, a: 0.8246898651123047, b: 1.5873908996582031, c: 0.1418590545654297, d: 2.1991729736328125
1 wait time: 2.565
215
0 wait time: 2.854
287
3 wait time: 2.872
299
AG, 0.041860, 1.113088, 0 
perpare first forward gemm: 0.241,  fisrt gemm forward duration: 1.667
AG, 0.233449, 1.844224, 0 
perpare first forward gemm: 0.309,  fisrt gemm forward duration: 1.991
AG, 0.114894, 1.798144, 0 
perpare first forward gemm: 0.257,  fisrt gemm forward duration: 3.615
AG, 0.254181, 1.925120, 0 
perpare first forward gemm: 0.296,  fisrt gemm forward duration: 1.98
GA, 0.041860, 0.769024, 0 
GA, 0.114894, 1.470464, 0 
GA, 0.233449, 1.960960, 0 
GA, 0.254181, 2.067456, 0 
forward:  10.273
forward:  8.994
forward:  8.596
forward:  8.707
AG, 0.041860, 1.117184, 0 
AG, 0.114894, 1.794048, 0 
AG, 0.233449, 1.850368, 0 
AG, 0.254181, 1.913856, 0 
Linear 2 Backward: 2.561, second_gemm: 2.546
Linear 2 Backward: 3.544, second_gemm: 3.532
Linear 2 Backward: 3.759, second_gemm: 3.747
Linear 2 Backward: 3.672, second_gemm: 3.658
GA, 0.041860, 0.780288, 0 
GA, 0.114894, 1.520640, 0 
GA, 0.233449, 1.956864, 0 
GA, 0.254181, 2.110464, 0 
perpare first backward gemm: 0.031,  fisrt gemm backward duration: 2.517,  weight grad: 1.63,  other: 0.438
Linear 1 Backward:  4.667
perpare first backward gemm: 0.035,  fisrt gemm backward duration: 3.258,  weight grad: 1.482,  other: 0.452
Linear 1 Backward:  5.291
perpare first backward gemm: 0.038,  fisrt gemm backward duration: 2.17,  weight grad: 1.894,  other: 0.437
Linear 1 Backward:  4.593
perpare first backward gemm: 0.041,  fisrt gemm backward duration: 2.083,  weight grad: 1.988,  other: 0.45
Linear 1 Backward:  4.628
STEP-80: step_time = 23.792640 ms, foward_time = 12.515328, backward_time = 11.164672, perf = 34.66 tflops.
start
start
block_info 235 27
start
cuda:2 process time:3.049612045288086, a: 0.4787445068359375, b: 1.3477802276611328, c: 0.07271766662597656, d: 1.150369644165039
block_info 215 9
start
2 wait time: 0.011
235
block_info 299 76
cuda:1 process time:3.9179325103759766, a: 0.8370876312255859, b: 1.352548599243164, c: 0.13875961303710938, d: 1.5895366668701172
1 wait time: 1.665
215
cuda:3 process time:3.9713382720947266, a: 0.7379055023193359, b: 1.0564327239990234, c: 0.1461505889892578, d: 2.0308494567871094
block_info 287 67
3 wait time: 1.785
299
cuda:0 process time:4.872322082519531, a: 0.7929801940917969, b: 1.3530254364013672, c: 0.14638900756835938, d: 2.579927444458008
0 wait time: 2.22
287
AG, 0.041860, 1.131520, 0 
perpare first forward gemm: 0.286,  fisrt gemm forward duration: 2.438
AG, 0.233449, 1.836032, 0 
perpare first forward gemm: 0.367,  fisrt gemm forward duration: 1.914
AG, 0.254181, 1.909760, 0 
perpare first forward gemm: 0.338,  fisrt gemm forward duration: 2.687
AG, 0.114894, 1.809408, 0 
perpare first forward gemm: 0.299,  fisrt gemm forward duration: 3.62
GA, 0.041860, 0.773120, 0 
GA, 0.114894, 1.495040, 0 
GA, 0.233449, 1.940480, 0 
GA, 0.254181, 2.089984, 0 
forward:  9.962
forward:  10.474
forward:  8.863
forward:  9.514
AG, 0.041860, 1.122304, 0 
AG, 0.233449, 1.842176, 0 
AG, 0.254181, 1.896448, 0 
AG, 0.114894, 1.809408, 0 
Linear 2 Backward: 2.597, second_gemm: 2.583
Linear 2 Backward: 3.596, second_gemm: 3.588
Linear 2 Backward: 3.691, second_gemm: 3.678
Linear 2 Backward: 3.63, second_gemm: 3.617
GA, 0.041860, 0.778240, 0 
GA, 0.114894, 1.513472, 0 
GA, 0.233449, 1.891328, 0 
GA, 0.254181, 2.101248, 0 
perpare first backward gemm: 0.027,  fisrt gemm backward duration: 2.587,  weight grad: 1.621,  other: 0.417
Linear 1 Backward:  4.694
perpare first backward gemm: 0.038,  fisrt gemm backward duration: 3.256,  weight grad: 1.478,  other: 0.452
Linear 1 Backward:  5.29
perpare first backward gemm: 0.042,  fisrt gemm backward duration: 2.17,  weight grad: 1.903,  other: 0.444
Linear 1 Backward:  4.62
perpare first backward gemm: 0.039,  fisrt gemm backward duration: 2.141,  weight grad: 1.968,  other: 0.445
Linear 1 Backward:  4.655
STEP-81: step_time = 23.669760 ms, foward_time = 12.230656, backward_time = 11.327488, perf = 34.84 tflops.
start
start
start
start
block_info 235 27
cuda:2 process time:3.612995147705078, a: 0.7328987121582031, b: 1.6274452209472656, c: 0.07152557373046875, d: 1.1811256408691406
block_info 299 76
2 wait time: 1.186
235
block_info 215 9
cuda:3 process time:3.8390159606933594, a: 0.7281303405761719, b: 1.4460086822509766, c: 0.0896453857421875, d: 1.5752315521240234
3 wait time: 1.454
299
block_info 287 67
cuda:1 process time:3.977537155151367, a: 0.7958412170410156, b: 1.0724067687988281, c: 0.13947486877441406, d: 1.9698143005371094
1 wait time: 2.013
215
cuda:0 process time:4.720449447631836, a: 0.8997917175292969, b: 1.2743473052978516, c: 0.14400482177734375, d: 2.4023056030273438
0 wait time: 2.469
287
AG, 0.041860, 1.097728, 0 
perpare first forward gemm: 0.238,  fisrt gemm forward duration: 2.044
AG, 0.233449, 1.840128, 0 
perpare first forward gemm: 0.366,  fisrt gemm forward duration: 1.91
AG, 0.114894, 1.800192, 0 
perpare first forward gemm: 0.289,  fisrt gemm forward duration: 3.587
AG, 0.254181, 1.903616, 0 
perpare first forward gemm: 0.33,  fisrt gemm forward duration: 3.082
GA, 0.041860, 0.770048, 0 
GA, 0.114894, 1.495040, 0 
GA, 0.233449, 1.918976, 0 
GA, 0.254181, 2.036736, 0 
forward:  9.335
forward:  10.249
forward:  9.723
forward:  8.67
AG, 0.041860, 1.117184, 0 
AG, 0.114894, 1.798144, 0 
AG, 0.233449, 1.842176, 0 
AG, 0.254181, 1.899520, 0 
Linear 2 Backward: 2.471, second_gemm: 2.46
Linear 2 Backward: 3.625, second_gemm: 3.614
Linear 2 Backward: 3.799, second_gemm: 3.785
Linear 2 Backward: 3.671, second_gemm: 3.656
GA, 0.041860, 0.777216, 0 
GA, 0.114894, 1.514496, 0 
GA, 0.233449, 1.925120, 0 
GA, 0.254181, 2.092032, 0 
perpare first backward gemm: 0.028,  fisrt gemm backward duration: 3.39,  weight grad: 1.459,  other: 0.427
Linear 1 Backward:  5.345
perpare first backward gemm: 0.029,  fisrt gemm backward duration: 2.559,  weight grad: 1.626,  other: 0.411
Linear 1 Backward:  4.667
perpare first backward gemm: 0.043,  fisrt gemm backward duration: 2.16,  weight grad: 1.904,  other: 0.411
Linear 1 Backward:  4.567
perpare first backward gemm: 0.041,  fisrt gemm backward duration: 2.135,  weight grad: 1.971,  other: 0.408
Linear 1 Backward:  4.605
STEP-82: step_time = 23.332865 ms, foward_time = 12.199936, backward_time = 11.021312, perf = 35.34 tflops.
start
start
start
start
block_info 299 76
block_info 215 9
block_info 235 27
block_info 287 67
cuda:3 process time:4.067897796630859, a: 0.7460117340087891, b: 1.2865066528320312, c: 0.11873245239257812, d: 1.916646957397461
cuda:1 process time:4.239559173583984, a: 0.8599758148193359, b: 1.0428428649902344, c: 0.1456737518310547, d: 2.1910667419433594
cuda:2 process time:4.537343978881836, a: 0.7796287536621094, b: 1.4905929565429688, c: 0.14543533325195312, d: 2.1216869354248047
3 wait time: 2.046
299
cuda:0 process time:4.349708557128906, a: 0.8187294006347656, b: 1.3780593872070312, c: 0.13494491577148438, d: 2.017974853515625
2 wait time: 2.604
235
1 wait time: 2.042
215
0 wait time: 2.642
287
AG, 0.041860, 1.134592, 0 
perpare first forward gemm: 0.286,  fisrt gemm forward duration: 1.318
AG, 0.114894, 1.808384, 0 
perpare first forward gemm: 0.254,  fisrt gemm forward duration: 2.2
AG, 0.233449, 1.832960, 0 
perpare first forward gemm: 0.313,  fisrt gemm forward duration: 1.89
AG, 0.254181, 1.931264, 0 
perpare first forward gemm: 0.295,  fisrt gemm forward duration: 2.456
GA, 0.041860, 0.768000, 0 
GA, 0.114894, 1.479680, 0 
GA, 0.233449, 1.811456, 0 
GA, 0.254181, 2.065408, 0 
forward:  8.715
forward:  8.831
forward:  9.035
forward:  8.611
AG, 0.041860, 1.115136, 0 
AG, 0.114894, 1.804288, 0 
AG, 0.233449, 1.841152, 0 
AG, 0.254181, 1.905664, 0 
Linear 2 Backward: 2.537, second_gemm: 2.526
Linear 2 Backward: 3.303, second_gemm: 3.291
Linear 2 Backward: 3.602, second_gemm: 3.59
Linear 2 Backward: 3.591, second_gemm: 3.579
GA, 0.041860, 0.776192, 0 
GA, 0.114894, 1.525760, 0 
GA, 0.233449, 1.963008, 0 
GA, 0.254181, 2.093056, 0 
perpare first backward gemm: 0.028,  fisrt gemm backward duration: 3.309,  weight grad: 1.466,  other: 0.429
Linear 1 Backward:  5.282
perpare first backward gemm: 0.03,  fisrt gemm backward duration: 2.476,  weight grad: 1.63,  other: 0.429
Linear 1 Backward:  4.615
perpare first backward gemm: 0.037,  fisrt gemm backward duration: 2.153,  weight grad: 1.899,  other: 0.437
Linear 1 Backward:  4.58
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 2.137,  weight grad: 1.967,  other: 0.435
Linear 1 Backward:  4.629
STEP-83: step_time = 23.564352 ms, foward_time = 12.191808, backward_time = 11.260928, perf = 34.99 tflops.
start
start
start
start
block_info 235 27
block_info 299 76
block_info 215 9
cuda:2 process time:4.344701766967773, a: 0.7915496826171875, b: 1.9693374633789062, c: 0.14972686767578125, d: 1.4340877532958984
2 wait time: 1.374
235
cuda:3 process time:4.47535514831543, a: 0.8378028869628906, b: 1.4224052429199219, c: 0.11706352233886719, d: 2.09808349609375
block_info 287 67
cuda:1 process time:5.067586898803711, a: 0.8559226989746094, b: 1.8644332885742188, c: 0.14495849609375, d: 2.202272415161133
1 wait time: 1.89
215
3 wait time: 1.941
299
cuda:0 process time:4.84466552734375, a: 0.8254051208496094, b: 1.293182373046875, c: 0.14781951904296875, d: 2.578258514404297
0 wait time: 2.262
287
AG, 0.041860, 1.116160, 0 
perpare first forward gemm: 0.287,  fisrt gemm forward duration: 1.987
AG, 0.114894, 1.802240, 0 
perpare first forward gemm: 0.298,  fisrt gemm forward duration: 3.232
AG, 0.233449, 1.852416, 0 
perpare first forward gemm: 0.367,  fisrt gemm forward duration: 1.932
AG, 0.254181, 1.952768, 0 
perpare first forward gemm: 0.337,  fisrt gemm forward duration: 2.715
GA, 0.041860, 0.770048, 0 
GA, 0.114894, 1.477632, 0 
GA, 0.233449, 1.921024, 0 
GA, 0.254181, 2.092032, 0 
forward:  10.414
forward:  9.863
forward:  9.827
forward:  9.19
AG, 0.041860, 1.118208, 0 
AG, 0.254181, 1.892352, 0 
AG, 0.233449, 1.831936, 0 
AG, 0.114894, 1.793024, 0 
Linear 2 Backward: 2.625, second_gemm: 2.611
Linear 2 Backward: 3.566, second_gemm: 3.558
Linear 2 Backward: 3.72, second_gemm: 3.712
Linear 2 Backward: 3.501, second_gemm: 3.493
GA, 0.041860, 0.776192, 0 
GA, 0.114894, 1.510400, 0 
GA, 0.233449, 1.912832, 0 
GA, 0.254181, 2.059264, 0 
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 3.047,  weight grad: 1.48,  other: 0.448
Linear 1 Backward:  5.078
perpare first backward gemm: 0.024,  fisrt gemm backward duration: 2.41,  weight grad: 1.613,  other: 0.406
Linear 1 Backward:  4.489
perpare first backward gemm: 0.029,  fisrt gemm backward duration: 2.106,  weight grad: 1.875,  other: 0.408
Linear 1 Backward:  4.456
perpare first backward gemm: 0.027,  fisrt gemm backward duration: 2.089,  weight grad: 1.943,  other: 0.404
Linear 1 Backward:  4.499
STEP-84: step_time = 23.472127 ms, foward_time = 12.615680, backward_time = 10.742784, perf = 35.13 tflops.
start
start
start
start
block_info 235 27
cuda:2 process time:3.6034584045410156, a: 0.7433891296386719, b: 1.5180110931396484, c: 0.1087188720703125, d: 1.2333393096923828
block_info 215 9
2 wait time: 1.604
235
block_info 287 67
block_info 299 76
cuda:1 process time:4.153728485107422, a: 0.8087158203125, b: 1.0900497436523438, c: 0.1544952392578125, d: 2.1004676818847656
cuda:0 process time:4.409074783325195, a: 0.9019374847412109, b: 1.1000633239746094, c: 0.12612342834472656, d: 2.2809505462646484
1 wait time: 2.177
215
cuda:3 process time:4.629373550415039, a: 0.8361339569091797, b: 1.4109611511230469, c: 0.14519691467285156, d: 2.237081527709961
0 wait time: 2.073
287
3 wait time: 2.798
299
AG, 0.041860, 1.121280, 0 
perpare first forward gemm: 0.264,  fisrt gemm forward duration: 1.845
AG, 0.233449, 1.861632, 0 
perpare first forward gemm: 0.349,  fisrt gemm forward duration: 2.174
AG, 0.114894, 1.795072, 0 
perpare first forward gemm: 0.285,  fisrt gemm forward duration: 3.209
AG, 0.254181, 1.941504, 0 
perpare first forward gemm: 0.333,  fisrt gemm forward duration: 2.007
GA, 0.041860, 0.779264, 0 
GA, 0.114894, 1.489920, 0 
GA, 0.233449, 1.948672, 0 
GA, 0.254181, 2.062336, 0 
forward:  9.212
forward:  9.958
forward:  8.668
forward:  8.946
AG, 0.041860, 1.132544, 0 
AG, 0.254181, 1.883136, 0 
AG, 0.114894, 1.810432, 0 
AG, 0.233449, 1.840128, 0 
Linear 2 Backward: 2.658, second_gemm: 2.644
Linear 2 Backward: 3.539, second_gemm: 3.526
Linear 2 Backward: 3.677, second_gemm: 3.663
Linear 2 Backward: 3.639, second_gemm: 3.625
GA, 0.041860, 0.773120, 0 
GA, 0.114894, 1.537024, 0 
GA, 0.233449, 1.954816, 0 
GA, 0.254181, 2.079744, 0 
perpare first backward gemm: 0.033,  fisrt gemm backward duration: 3.272,  weight grad: 1.477,  other: 0.468
Linear 1 Backward:  5.297
perpare first backward gemm: 0.047,  fisrt gemm backward duration: 2.447,  weight grad: 1.64,  other: 0.445
Linear 1 Backward:  4.625
perpare first backward gemm: 0.043,  fisrt gemm backward duration: 2.147,  weight grad: 1.906,  other: 0.411
Linear 1 Backward:  4.557
perpare first backward gemm: 0.041,  fisrt gemm backward duration: 2.117,  weight grad: 1.977,  other: 0.413
Linear 1 Backward:  4.599
STEP-85: step_time = 23.011328 ms, foward_time = 11.991040, backward_time = 10.909696, perf = 35.84 tflops.
start
start
start
start
block_info 215 9
cuda:1 process time:3.104686737060547, a: 0.7224082946777344, b: 1.2030601501464844, c: 0.08130073547363281, d: 1.0979175567626953
block_info 235 27
1 wait time: 1.221
215
cuda:2 process time:3.854513168334961, a: 0.7162094116210938, b: 1.3222694396972656, c: 0.11968612670898438, d: 1.6963481903076172
block_info 299 76
block_info 287 67
2 wait time: 1.733
235
cuda:3 process time:4.450559616088867, a: 0.8223056793212891, b: 1.2936592102050781, c: 0.14400482177734375, d: 2.1905899047851562
cuda:0 process time:4.423856735229492, a: 0.8091926574707031, b: 1.2955665588378906, c: 0.1442432403564453, d: 2.174854278564453
3 wait time: 2.81
299
0 wait time: 2.815
287
AG, 0.041860, 1.122304, 0 
perpare first forward gemm: 0.257,  fisrt gemm forward duration: 2.852
AG, 0.233449, 1.840128, 0 
perpare first forward gemm: 0.307,  fisrt gemm forward duration: 1.898
AG, 0.114894, 1.804288, 0 
perpare first forward gemm: 0.254,  fisrt gemm forward duration: 2.963
AG, 0.254181, 1.911808, 0 
perpare first forward gemm: 0.296,  fisrt gemm forward duration: 2.022
GA, 0.041860, 0.774144, 0 
GA, 0.114894, 1.466368, 0 
GA, 0.233449, 1.934336, 0 
GA, 0.254181, 2.094080, 0 
forward:  9.613
forward:  8.64
forward:  8.609
forward:  10.234
AG, 0.041860, 1.115136, 0 
AG, 0.254181, 1.898496, 0 
AG, 0.114894, 1.814528, 0 
AG, 0.233449, 1.848320, 0 
Linear 2 Backward: 2.551, second_gemm: 2.537
Linear 2 Backward: 3.676, second_gemm: 3.664
Linear 2 Backward: 3.74, second_gemm: 3.727
Linear 2 Backward: 3.624, second_gemm: 3.611
GA, 0.041860, 0.780288, 0 
GA, 0.114894, 1.540096, 0 
GA, 0.233449, 1.940480, 0 
GA, 0.254181, 2.104320, 0 
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 3.255,  weight grad: 1.48,  other: 0.449
Linear 1 Backward:  5.286
perpare first backward gemm: 0.031,  fisrt gemm backward duration: 2.488,  weight grad: 1.633,  other: 0.432
Linear 1 Backward:  4.637
perpare first backward gemm: 0.039,  fisrt gemm backward duration: 2.167,  weight grad: 1.901,  other: 0.439
Linear 1 Backward:  4.605
perpare first backward gemm: 0.037,  fisrt gemm backward duration: 2.141,  weight grad: 1.966,  other: 0.436
Linear 1 Backward:  4.639
STEP-86: step_time = 23.984129 ms, foward_time = 12.347392, backward_time = 11.523072, perf = 34.38 tflops.
start
start
start
start
block_info 215 9
block_info 235 27
cuda:1 process time:3.6773681640625, a: 0.55694580078125, b: 1.825571060180664, c: 0.07462501525878906, d: 1.2202262878417969
cuda:2 process time:4.065513610839844, a: 0.644683837890625, b: 1.8191337585449219, c: 0.0858306884765625, d: 1.5158653259277344
1 wait time: 1.163
215
2 wait time: 0.923
235
block_info 299 76
block_info 287 67
cuda:3 process time:4.844188690185547, a: 0.8959770202636719, b: 1.3339519500732422, c: 0.1461505889892578, d: 2.468109130859375
cuda:0 process time:4.807233810424805, a: 0.9474754333496094, b: 1.2848377227783203, c: 0.14448165893554688, d: 2.430438995361328
3 wait time: 2.605
299
0 wait time: 2.459
287
AG, 0.041860, 1.100800, 0 
perpare first forward gemm: 0.248,  fisrt gemm forward duration: 2.919
AG, 0.233449, 1.840128, 0 
perpare first forward gemm: 0.367,  fisrt gemm forward duration: 1.921
AG, 0.254181, 1.905664, 0 
perpare first forward gemm: 0.337,  fisrt gemm forward duration: 2.019
AG, 0.114894, 1.805312, 0 
perpare first forward gemm: 0.295,  fisrt gemm forward duration: 3.356
GA, 0.041860, 0.769024, 0 
GA, 0.114894, 1.475584, 0 
GA, 0.233449, 1.947648, 0 
GA, 0.254181, 2.068480, 0 
forward:  10.19
forward:  8.87
forward:  10.407
forward:  8.858
AG, 0.041860, 1.118208, 0 
AG, 0.254181, 1.880064, 0 
AG, 0.114894, 1.799168, 0 
AG, 0.233449, 1.823744, 0 
Linear 2 Backward: 2.481, second_gemm: 2.471
Linear 2 Backward: 3.505, second_gemm: 3.492
Linear 2 Backward: 3.671, second_gemm: 3.664
Linear 2 Backward: 3.622, second_gemm: 3.614
GA, 0.041860, 0.775168, 0 
GA, 0.114894, 1.490944, 0 
GA, 0.233449, 1.970176, 0 
GA, 0.254181, 2.069504, 0 
perpare first backward gemm: 0.022,  fisrt gemm backward duration: 3.155,  weight grad: 1.449,  other: 0.41
Linear 1 Backward:  5.073
perpare first backward gemm: 0.034,  fisrt gemm backward duration: 2.261,  weight grad: 1.643,  other: 0.443
Linear 1 Backward:  4.441
perpare first backward gemm: 0.029,  fisrt gemm backward duration: 2.117,  weight grad: 1.875,  other: 0.411
Linear 1 Backward:  4.468
perpare first backward gemm: 0.028,  fisrt gemm backward duration: 2.086,  weight grad: 1.943,  other: 0.408
Linear 1 Backward:  4.502
STEP-87: step_time = 23.378944 ms, foward_time = 12.560384, backward_time = 10.703872, perf = 35.27 tflops.
start
start
start
start
block_info 215 9
cuda:1 process time:3.5026073455810547, a: 0.6117820739746094, b: 1.567840576171875, c: 0.072479248046875, d: 1.2505054473876953
block_info 299 76
1 wait time: 0.908
215
block_info 287 67
block_info 235 27
cuda:3 process time:3.9162635803222656, a: 0.8258819580078125, b: 1.1661052703857422, c: 0.1342296600341797, d: 1.7900466918945312
cuda:0 process time:4.085779190063477, a: 0.8270740509033203, b: 1.3728141784667969, c: 0.11897087097167969, d: 1.7669200897216797
3 wait time: 2.337
299
cuda:2 process time:4.364252090454102, a: 0.6814002990722656, b: 1.5170574188232422, c: 0.14472007751464844, d: 2.0210742950439453
0 wait time: 2.343
287
2 wait time: 2.515
235
AG, 0.041860, 1.120256, 0 
perpare first forward gemm: 0.282,  fisrt gemm forward duration: 2.177
AG, 0.233449, 1.861632, 0 
perpare first forward gemm: 0.331,  fisrt gemm forward duration: 1.927
AG, 0.114894, 1.793024, 0 
perpare first forward gemm: 0.254,  fisrt gemm forward duration: 1.93
AG, 0.254181, 1.901568, 0 
perpare first forward gemm: 0.305,  fisrt gemm forward duration: 2.235
GA, 0.041860, 0.768000, 0 
GA, 0.114894, 1.463296, 0 
GA, 0.254181, 2.049024, 0 
GA, 0.233449, 1.988608, 0 
forward:  8.57
forward:  9.548
forward:  8.828
forward:  8.633
AG, 0.041860, 1.103872, 0 
AG, 0.114894, 1.795072, 0 
AG, 0.233449, 1.850368, 0 
AG, 0.254181, 1.901568, 0 
Linear 2 Backward: 2.851, second_gemm: 2.84
Linear 2 Backward: 3.357, second_gemm: 3.344
Linear 2 Backward: 3.809, second_gemm: 3.795
Linear 2 Backward: 3.714, second_gemm: 3.699
GA, 0.041860, 0.778240, 0 
GA, 0.114894, 1.498112, 0 
GA, 0.254181, 2.086912, 0 
GA, 0.233449, 1.954816, 0 
perpare first backward gemm: 0.029,  fisrt gemm backward duration: 3.379,  weight grad: 1.461,  other: 0.429
Linear 1 Backward:  5.349
perpare first backward gemm: 0.035,  fisrt gemm backward duration: 2.486,  weight grad: 1.639,  other: 0.441
Linear 1 Backward:  4.66
perpare first backward gemm: 0.043,  fisrt gemm backward duration: 2.154,  weight grad: 1.91,  other: 0.454
Linear 1 Backward:  4.626
perpare first backward gemm: 0.042,  fisrt gemm backward duration: 2.061,  weight grad: 1.994,  other: 0.455
Linear 1 Backward:  4.619
STEP-88: step_time = 23.542944 ms, foward_time = 11.895967, backward_time = 11.534336, perf = 35.03 tflops.
start
start
block_info 215 9
block_info 235 27
start
start
cuda:1 process time:3.356456756591797, a: 0.5984306335449219, b: 1.3675689697265625, c: 0.08249282836914062, d: 1.3079643249511719
cuda:2 process time:3.4945011138916016, a: 0.5786418914794922, b: 1.4233589172363281, c: 0.08511543273925781, d: 1.4073848724365234
1 wait time: 0.482
2 wait time: 0.347
235
215
block_info 287 67
block_info 299 76
cuda:0 process time:4.382610321044922, a: 0.7729530334472656, b: 1.1577606201171875, c: 0.1456737518310547, d: 2.306222915649414
cuda:3 process time:4.862785339355469, a: 0.8678436279296875, b: 1.4185905456542969, c: 0.1499652862548828, d: 2.4263858795166016
0 wait time: 2.478
287
3 wait time: 2.526
299
AG, 0.041860, 1.144832, 0 
perpare first forward gemm: 0.288,  fisrt gemm forward duration: 2.732
AG, 0.254181, 1.889280, 0 
perpare first forward gemm: 0.339,  fisrt gemm forward duration: 1.965
AG, 0.233449, 1.853440, 0 
perpare first forward gemm: 0.344,  fisrt gemm forward duration: 2.079
AG, 0.114894, 1.811456, 0 
perpare first forward gemm: 0.294,  fisrt gemm forward duration: 3.4
GA, 0.041860, 0.773120, 0 
GA, 0.114894, 1.494016, 0 
GA, 0.233449, 1.944576, 0 
GA, 0.254181, 2.078720, 0 
forward:  10.214
forward:  8.948
forward:  10.213
forward:  8.779
AG, 0.041860, 1.105920, 0 
AG, 0.114894, 1.799168, 0 
AG, 0.233449, 1.864704, 0 
AG, 0.254181, 1.896448, 0 
Linear 2 Backward: 2.734, second_gemm: 2.72
Linear 2 Backward: 3.471, second_gemm: 3.459
Linear 2 Backward: 3.609, second_gemm: 3.596
Linear 2 Backward: 3.706, second_gemm: 3.692
GA, 0.041860, 0.774144, 0 
GA, 0.114894, 1.503232, 0 
GA, 0.233449, 1.954816, 0 
GA, 0.254181, 2.072576, 0 
perpare first backward gemm: 0.037,  fisrt gemm backward duration: 3.194,  weight grad: 1.48,  other: 0.449
Linear 1 Backward:  5.226
perpare first backward gemm: 0.033,  fisrt gemm backward duration: 2.467,  weight grad: 1.637,  other: 0.436
Linear 1 Backward:  4.631
perpare first backward gemm: 0.041,  fisrt gemm backward duration: 2.137,  weight grad: 1.907,  other: 0.444
Linear 1 Backward:  4.592
perpare first backward gemm: 0.039,  fisrt gemm backward duration: 2.061,  weight grad: 1.986,  other: 0.445
Linear 1 Backward:  4.592
STEP-89: step_time = 24.020992 ms, foward_time = 12.462080, backward_time = 11.444224, perf = 34.33 tflops.
start
start
start
start
block_info 215 9
cuda:1 process time:3.4589767456054688, a: 0.6804466247558594, b: 1.47247314453125, c: 0.072479248046875, d: 1.2335777282714844
1 wait time: 1.144
215
block_info 235 27
cuda:2 process time:4.576921463012695, a: 0.8521080017089844, b: 1.9650459289550781, c: 0.12087821960449219, d: 1.6388893127441406
block_info 299 76
block_info 287 67
2 wait time: 2.089
235
cuda:3 process time:4.795074462890625, a: 0.8683204650878906, b: 1.2772083282470703, c: 0.19216537475585938, d: 2.4573802947998047
cuda:0 process time:4.77910041809082, a: 0.9300708770751953, b: 1.2814998626708984, c: 0.14281272888183594, d: 2.4247169494628906
3 wait time: 2.563
299
0 wait time: 2.492
287
AG, 0.041860, 1.102848, 0 
perpare first forward gemm: 0.288,  fisrt gemm forward duration: 2.834
AG, 0.114894, 1.788928, 0 
perpare first forward gemm: 0.296,  fisrt gemm forward duration: 2.695
AG, 0.233449, 1.854464, 0 
perpare first forward gemm: 0.301,  fisrt gemm forward duration: 1.911
AG, 0.254181, 1.883136, 0 
perpare first forward gemm: 0.288,  fisrt gemm forward duration: 1.976
GA, 0.041860, 0.769024, 0 
GA, 0.114894, 1.499136, 0 
GA, 0.233449, 1.959936, 0 
GA, 0.254181, 2.085888, 0 
forward:  9.455
forward:  10.278
forward:  8.667
forward:  8.617
AG, 0.041860, 1.140736, 0 
AG, 0.233449, 1.875968, 0 
AG, 0.254181, 1.894400, 0 
AG, 0.114894, 1.798144, 0 
Linear 2 Backward: 2.736, second_gemm: 2.722
Linear 2 Backward: 3.341, second_gemm: 3.327
Linear 2 Backward: 3.653, second_gemm: 3.638
Linear 2 Backward: 3.726, second_gemm: 3.711
GA, 0.041860, 0.774144, 0 
GA, 0.114894, 1.499136, 0 
GA, 0.233449, 1.964032, 0 
GA, 0.254181, 2.108416, 0 
perpare first backward gemm: 0.034,  fisrt gemm backward duration: 2.54,  weight grad: 1.643,  other: 0.407
Linear 1 Backward:  4.67
perpare first backward gemm: 0.034,  fisrt gemm backward duration: 3.309,  weight grad: 1.474,  other: 0.448
Linear 1 Backward:  5.326
perpare first backward gemm: 0.042,  fisrt gemm backward duration: 2.211,  weight grad: 1.904,  other: 0.415
Linear 1 Backward:  4.621
perpare first backward gemm: 0.041,  fisrt gemm backward duration: 2.106,  weight grad: 1.992,  other: 0.41
Linear 1 Backward:  4.6
STEP-90: step_time = 23.588863 ms, foward_time = 12.310529, backward_time = 11.166720, perf = 34.96 tflops.
start
start
start
start
block_info 215 9
cuda:1 process time:3.2875537872314453, a: 0.6225109100341797, b: 1.3735294342041016, c: 0.07319450378417969, d: 1.2183189392089844
block_info 235 27
1 wait time: 1.017
215
block_info 287 67
cuda:2 process time:3.937959671020508, a: 0.7524490356445312, b: 1.4421939849853516, c: 0.11706352233886719, d: 1.6262531280517578
block_info 299 76
2 wait time: 2.051
235
cuda:0 process time:4.294395446777344, a: 0.8385181427001953, b: 1.2524127960205078, c: 0.13756752014160156, d: 2.065896987915039
cuda:3 process time:4.616022109985352, a: 0.7996559143066406, b: 1.4379024505615234, c: 0.1499652862548828, d: 2.2284984588623047
0 wait time: 2.649
287
3 wait time: 2.778
299
AG, 0.041860, 1.131520, 0 
perpare first forward gemm: 0.265,  fisrt gemm forward duration: 2.853
AG, 0.233449, 1.843200, 0 
perpare first forward gemm: 0.306,  fisrt gemm forward duration: 2.063
AG, 0.254181, 1.901568, 0 
perpare first forward gemm: 0.291,  fisrt gemm forward duration: 1.954
AG, 0.114894, 1.800192, 0 
perpare first forward gemm: 0.251,  fisrt gemm forward duration: 2.858
GA, 0.041860, 0.770048, 0 
GA, 0.114894, 1.507328, 0 
GA, 0.233449, 1.941504, 0 
GA, 0.254181, 2.076672, 0 
forward:  10.169
forward:  9.464
forward:  8.739
forward:  8.523
AG, 0.041860, 1.110016, 0 
AG, 0.233449, 1.865728, 0 
AG, 0.254181, 1.883136, 0 
AG, 0.114894, 1.801216, 0 
Linear 2 Backward: 2.653, second_gemm: 2.643
Linear 2 Backward: 3.496, second_gemm: 3.485
Linear 2 Backward: 3.583, second_gemm: 3.572
Linear 2 Backward: 3.623, second_gemm: 3.611
GA, 0.041860, 0.772096, 0 
GA, 0.114894, 1.521664, 0 
GA, 0.233449, 1.891328, 0 
GA, 0.254181, 2.072576, 0 
perpare first backward gemm: 0.027,  fisrt gemm backward duration: 3.26,  weight grad: 1.461,  other: 0.422
Linear 1 Backward:  5.216
perpare first backward gemm: 0.031,  fisrt gemm backward duration: 2.421,  weight grad: 1.634,  other: 0.429
Linear 1 Backward:  4.564
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 2.134,  weight grad: 1.891,  other: 0.445
Linear 1 Backward:  4.558
perpare first backward gemm: 0.035,  fisrt gemm backward duration: 2.057,  weight grad: 1.977,  other: 0.448
Linear 1 Backward:  4.569
STEP-91: step_time = 23.399041 ms, foward_time = 12.323456, backward_time = 10.958848, perf = 35.24 tflops.
start
start
start
start
block_info 215 9
cuda:1 process time:3.340482711791992, a: 0.5571842193603516, b: 1.5125274658203125, c: 0.07390975952148438, d: 1.1968612670898438
block_info 235 27
1 wait time: 1.106
215
cuda:2 process time:4.296064376831055, a: 0.8380413055419922, b: 1.4140605926513672, c: 0.13208389282226562, d: 1.9118785858154297
block_info 299 76
block_info 287 67
2 wait time: 1.673
235
cuda:3 process time:4.828929901123047, a: 0.8742809295654297, b: 1.3489723205566406, c: 0.14853477478027344, d: 2.457141876220703
cuda:0 process time:4.66609001159668, a: 0.7812976837158203, b: 1.1751651763916016, c: 0.1647472381591797, d: 2.544879913330078
3 wait time: 2.516
299
0 wait time: 2.202
287
AG, 0.041860, 1.121280, 0 
perpare first forward gemm: 0.263,  fisrt gemm forward duration: 2.911
AG, 0.233449, 1.861632, 0 
perpare first forward gemm: 0.31,  fisrt gemm forward duration: 1.931
AG, 0.114894, 1.800192, 0 
perpare first forward gemm: 0.299,  fisrt gemm forward duration: 2.716
AG, 0.254181, 1.928192, 0 
perpare first forward gemm: 0.338,  fisrt gemm forward duration: 2.016
GA, 0.041860, 0.772096, 0 
GA, 0.114894, 1.480704, 0 
GA, 0.254181, 2.116608, 0 
GA, 0.233449, 1.969152, 0 
forward:  9.688
forward:  8.882
forward:  10.449
forward:  8.868
AG, 0.041860, 1.136640, 0 
AG, 0.233449, 1.871872, 0 
AG, 0.114894, 1.812480, 0 
AG, 0.254181, 1.917952, 0 
Linear 2 Backward: 2.671, second_gemm: 2.663
Linear 2 Backward: 3.459, second_gemm: 3.447
Linear 2 Backward: 3.638, second_gemm: 3.625
Linear 2 Backward: 3.562, second_gemm: 3.554
GA, 0.041860, 0.772096, 0 
GA, 0.114894, 1.503232, 0 
GA, 0.233449, 1.974272, 0 
GA, 0.254181, 2.033664, 0 
perpare first backward gemm: 0.026,  fisrt gemm backward duration: 3.36,  weight grad: 1.457,  other: 0.417
Linear 1 Backward:  5.302
perpare first backward gemm: 0.033,  fisrt gemm backward duration: 2.451,  weight grad: 1.637,  other: 0.437
Linear 1 Backward:  4.615
perpare first backward gemm: 0.04,  fisrt gemm backward duration: 2.119,  weight grad: 1.909,  other: 0.447
perpare first backward gemm: 0.028,  fisrt gemm backward duration: 2.205,  weight grad: 1.959,  other: 0.414
Linear 1 Backward:  4.645
Linear 1 Backward:  4.577
STEP-92: step_time = 23.422976 ms, foward_time = 12.240896, backward_time = 11.064320, perf = 35.21 tflops.
start
start
start
block_info 215 9
start
cuda:1 process time:3.482341766357422, a: 0.6082057952880859, b: 1.468658447265625, c: 0.07271766662597656, d: 1.3327598571777344
block_info 235 27
1 wait time: 0.375
215
cuda:2 process time:4.291296005249023, a: 0.7531642913818359, b: 1.7867088317871094, c: 0.11801719665527344, d: 1.6334056854248047
block_info 287 67
block_info 299 76
2 wait time: 2.16
235
cuda:3 process time:4.534244537353516, a: 0.8513927459716797, b: 1.0979175567626953, c: 0.14472007751464844, d: 2.440214157104492
cuda:0 process time:4.7130584716796875, a: 0.8215904235839844, b: 1.4882087707519531, c: 0.14352798461914062, d: 2.2597312927246094
3 wait time: 2.495
299
0 wait time: 2.909
287
AG, 0.041860, 1.112064, 0 
perpare first forward gemm: 0.281,  fisrt gemm forward duration: 2.897
AG, 0.233449, 1.847296, 0 
perpare first forward gemm: 0.328,  fisrt gemm forward duration: 1.914
AG, 0.114894, 1.800192, 0 
perpare first forward gemm: 0.259,  fisrt gemm forward duration: 2.796
AG, 0.254181, 1.896448, 0 
perpare first forward gemm: 0.345,  fisrt gemm forward duration: 1.968
GA, 0.041860, 0.773120, 0 
GA, 0.114894, 1.490944, 0 
GA, 0.254181, 1.998848, 0 
GA, 0.233449, 1.956864, 0 
forward:  9.495
forward:  8.705
forward:  10.329
forward:  8.725
AG, 0.041860, 1.148928, 0 
AG, 0.233449, 1.842176, 0 
AG, 0.114894, 1.813504, 0 
AG, 0.254181, 1.904640, 0 
Linear 2 Backward: 2.804, second_gemm: 2.793
Linear 2 Backward: 3.404, second_gemm: 3.392
Linear 2 Backward: 3.545, second_gemm: 3.537
Linear 2 Backward: 3.766, second_gemm: 3.752
GA, 0.041860, 0.774144, 0 
GA, 0.114894, 1.512448, 0 
GA, 0.233449, 1.982464, 0 
GA, 0.254181, 2.049024, 0 
perpare first backward gemm: 0.028,  fisrt gemm backward duration: 3.313,  weight grad: 1.457,  other: 0.41
Linear 1 Backward:  5.249
perpare first backward gemm: 0.035,  fisrt gemm backward duration: 2.438,  weight grad: 1.638,  other: 0.407
Linear 1 Backward:  4.565
perpare first backward gemm: 0.043,  fisrt gemm backward duration: 2.134,  weight grad: 1.909,  other: 0.411
Linear 1 Backward:  4.546
perpare first backward gemm: 0.028,  fisrt gemm backward duration: 2.262,  weight grad: 1.96,  other: 0.429
Linear 1 Backward:  4.718
STEP-93: step_time = 23.728128 ms, foward_time = 12.699648, backward_time = 10.890240, perf = 34.75 tflops.
start
start
start
block_info 215 9
start
cuda:1 process time:3.5865306854248047, a: 0.6556510925292969, b: 1.6143321990966797, c: 0.07295608520507812, d: 1.24359130859375
block_info 235 27
1 wait time: 0.929
215
cuda:2 process time:4.317045211791992, a: 0.7281303405761719, b: 1.9466876983642578, c: 0.11205673217773438, d: 1.5301704406738281
block_info 299 76
2 wait time: 1.956
235
block_info 287 67
cuda:3 process time:5.017518997192383, a: 0.823974609375, b: 1.6446113586425781, c: 0.1480579376220703, d: 2.4008750915527344
cuda:0 process time:4.7969818115234375, a: 0.9505748748779297, b: 1.1677742004394531, c: 0.14710426330566406, d: 2.5315284729003906
3 wait time: 2.497
299
0 wait time: 2.312
287
AG, 0.041860, 1.133568, 0 
perpare first forward gemm: 0.264,  fisrt gemm forward duration: 3.234
AG, 0.233449, 1.862656, 0 
perpare first forward gemm: 0.385,  fisrt gemm forward duration: 1.935
AG, 0.114894, 1.798144, 0 
perpare first forward gemm: 0.254,  fisrt gemm forward duration: 3.187
AG, 0.254181, 1.915904, 0 
perpare first forward gemm: 0.306,  fisrt gemm forward duration: 2.379
GA, 0.041860, 0.775168, 0 
GA, 0.114894, 1.468416, 0 
GA, 0.233449, 1.979392, 0 
GA, 0.254181, 2.019328, 0 
forward:  9.83
forward:  10.509
forward:  8.929
forward:  8.701
AG, 0.041860, 1.130496, 0 
AG, 0.233449, 1.847296, 0 
AG, 0.114894, 1.804288, 0 
AG, 0.254181, 1.910784, 0 
Linear 2 Backward: 2.599, second_gemm: 2.584
Linear 2 Backward: 3.423, second_gemm: 3.412
Linear 2 Backward: 3.535, second_gemm: 3.527
Linear 2 Backward: 3.606, second_gemm: 3.594
GA, 0.041860, 0.774144, 0 
GA, 0.114894, 1.505280, 0 
GA, 0.233449, 1.947648, 0 
GA, 0.254181, 2.110464, 0 
perpare first backward gemm: 0.031,  fisrt gemm backward duration: 2.502,  weight grad: 1.63,  other: 0.429
Linear 1 Backward:  4.642
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 3.22,  weight grad: 1.48,  other: 0.45
Linear 1 Backward:  5.251
perpare first backward gemm: 0.037,  fisrt gemm backward duration: 2.171,  weight grad: 1.898,  other: 0.437
perpare first backward gemm: 0.028,  fisrt gemm backward duration: 2.266,  weight grad: 1.963,  other: 0.412
Linear 1 Backward:  4.6
Linear 1 Backward:  4.706
STEP-94: step_time = 23.063553 ms, foward_time = 12.138496, backward_time = 10.811392, perf = 35.75 tflops.
start
start
start
block_info 235 27
block_info 215 9
cuda:1 process time:3.346681594848633, a: 0.6809234619140625, b: 1.390695571899414, c: 0.0743865966796875, d: 1.2006759643554688
cuda:2 process time:3.2854080200195312, a: 0.7231235504150391, b: 1.4052391052246094, c: 0.08106231689453125, d: 1.0759830474853516
start
1 wait time: 1.144
215
2 wait time: 1.542
235
block_info 299 76
cuda:3 process time:4.294872283935547, a: 0.9090900421142578, b: 1.6391277313232422, c: 0.14734268188476562, d: 1.5993118286132812
block_info 287 67
3 wait time: 2.192
299
cuda:0 process time:4.789829254150391, a: 0.7822513580322266, b: 1.233816146850586, c: 0.1475811004638672, d: 2.626180648803711
0 wait time: 2.019
287
AG, 0.041860, 1.143808, 0 
perpare first forward gemm: 0.259,  fisrt gemm forward duration: 3.217
AG, 0.254181, 1.913856, 0 
perpare first forward gemm: 0.338,  fisrt gemm forward duration: 2.768
AG, 0.114894, 1.801216, 0 
perpare first forward gemm: 0.254,  fisrt gemm forward duration: 3.78
AG, 0.233449, 1.875968, 0 
perpare first forward gemm: 0.325,  fisrt gemm forward duration: 1.947
GA, 0.041860, 0.781312, 0 
GA, 0.114894, 1.470464, 0 
GA, 0.233449, 1.968128, 0 
GA, 0.254181, 2.055168, 0 
forward:  10.564
forward:  10.668
forward:  9.626
forward:  8.869
AG, 0.041860, 1.139712, 0 
AG, 0.233449, 1.861632, 0 
AG, 0.254181, 1.898496, 0 
AG, 0.114894, 1.793024, 0 
Linear 2 Backward: 2.93, second_gemm: 2.915
Linear 2 Backward: 3.634, second_gemm: 3.619
Linear 2 Backward: 3.766, second_gemm: 3.751
Linear 2 Backward: 3.705, second_gemm: 3.69
GA, 0.041860, 0.777216, 0 
GA, 0.114894, 1.534976, 0 
GA, 0.233449, 1.912832, 0 
GA, 0.254181, 2.099200, 0 
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 3.291,  weight grad: 1.48,  other: 0.453
Linear 1 Backward:  5.323
perpare first backward gemm: 0.038,  fisrt gemm backward duration: 2.472,  weight grad: 1.649,  other: 0.446
Linear 1 Backward:  4.67
perpare first backward gemm: 0.043,  fisrt gemm backward duration: 2.166,  weight grad: 1.908,  other: 0.451
Linear 1 Backward:  4.634
perpare first backward gemm: 0.042,  fisrt gemm backward duration: 2.105,  weight grad: 1.989,  other: 0.451
Linear 1 Backward:  4.652
STEP-95: step_time = 23.830528 ms, foward_time = 12.114944, backward_time = 11.613184, perf = 34.60 tflops.
start
start
start
start
block_info 215 9
cuda:1 process time:3.2639503479003906, a: 0.5447864532470703, b: 1.4834403991699219, c: 0.07677078247070312, d: 1.1589527130126953
1 wait time: 1.203
215
block_info 235 27
block_info 299 76
block_info 287 67
cuda:2 process time:4.172086715698242, a: 0.6418228149414062, b: 1.4951229095458984, c: 0.12183189392089844, d: 1.913309097290039
2 wait time: 1.605
235
cuda:3 process time:4.3926239013671875, a: 0.8261203765869141, b: 1.1534690856933594, c: 0.14591217041015625, d: 2.267122268676758
cuda:0 process time:4.5452117919921875, a: 0.8428096771240234, b: 1.3010501861572266, c: 0.14853477478027344, d: 2.252817153930664
3 wait time: 2.975
299
0 wait time: 2.895
287
AG, 0.041860, 1.113088, 0 
perpare first forward gemm: 0.259,  fisrt gemm forward duration: 2.959
AG, 0.114894, 1.787904, 0 
perpare first forward gemm: 0.296,  fisrt gemm forward duration: 2.732
AG, 0.254181, 1.903616, 0 
perpare first forward gemm: 0.296,  fisrt gemm forward duration: 2.344
AG, 0.233449, 1.851392, 0 
perpare first forward gemm: 0.318,  fisrt gemm forward duration: 1.919
GA, 0.041860, 0.775168, 0 
GA, 0.114894, 1.508352, 0 
GA, 0.233449, 1.952768, 0 
GA, 0.254181, 2.139136, 0 
forward:  9.518
forward:  10.356
forward:  8.723
forward:  8.981
AG, 0.041860, 1.113088, 0 
AG, 0.233449, 1.865728, 0 
AG, 0.114894, 1.821696, 0 
AG, 0.254181, 1.885184, 0 
Linear 2 Backward: 2.751, second_gemm: 2.737
Linear 2 Backward: 3.562, second_gemm: 3.549
Linear 2 Backward: 3.682, second_gemm: 3.669
Linear 2 Backward: 3.687, second_gemm: 3.674
GA, 0.041860, 0.778240, 0 
GA, 0.114894, 1.510400, 0 
GA, 0.254181, 2.066432, 0 
GA, 0.233449, 1.979392, 0 
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 3.196,  weight grad: 1.479,  other: 0.452
Linear 1 Backward:  5.228
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 2.406,  weight grad: 1.639,  other: 0.444
Linear 1 Backward:  4.584
perpare first backward gemm: 0.04,  fisrt gemm backward duration: 2.135,  weight grad: 1.883,  other: 0.441
Linear 1 Backward:  4.561
perpare first backward gemm: 0.04,  fisrt gemm backward duration: 2.044,  weight grad: 1.994,  other: 0.447
Linear 1 Backward:  4.587
STEP-96: step_time = 24.243904 ms, foward_time = 12.634816, backward_time = 11.498496, perf = 34.01 tflops.
start
start
start
start
block_info 215 9
cuda:1 process time:3.1104087829589844, a: 0.5517005920410156, b: 1.2753009796142578, c: 0.07510185241699219, d: 1.2083053588867188
block_info 235 27
1 wait time: 1.031
215
block_info 287 67
cuda:2 process time:3.6704540252685547, a: 0.7889270782470703, b: 1.1510848999023438, c: 0.1201629638671875, d: 1.6102790832519531
block_info 299 76
2 wait time: 2.025
235
cuda:0 process time:4.101991653442383, a: 0.8399486541748047, b: 1.2331008911132812, c: 0.12874603271484375, d: 1.9001960754394531
0 wait time: 2.383
287
cuda:3 process time:4.451513290405273, a: 0.7922649383544922, b: 1.0936260223388672, c: 0.148773193359375, d: 2.416849136352539
3 wait time: 2.558
299
AG, 0.041860, 1.128448, 0 
perpare first forward gemm: 0.267,  fisrt gemm forward duration: 2.843
AG, 0.233449, 1.864704, 0 
perpare first forward gemm: 0.295,  fisrt gemm forward duration: 2.391
AG, 0.114894, 1.803264, 0 
perpare first forward gemm: 0.26,  fisrt gemm forward duration: 2.879
AG, 0.254181, 1.898496, 0 
perpare first forward gemm: 0.322,  fisrt gemm forward duration: 1.961
GA, 0.041860, 0.775168, 0 
GA, 0.114894, 1.476608, 0 
GA, 0.233449, 1.941504, 0 
GA, 0.254181, 2.088960, 0 
forward:  9.017
forward:  10.172
forward:  9.49
forward:  8.588
AG, 0.041860, 1.122304, 0 
AG, 0.114894, 1.821696, 0 
AG, 0.233449, 1.868800, 0 
AG, 0.254181, 1.890304, 0 
Linear 2 Backward: 2.717, second_gemm: 2.706
Linear 2 Backward: 3.553, second_gemm: 3.54
Linear 2 Backward: 3.622, second_gemm: 3.608
Linear 2 Backward: 3.764, second_gemm: 3.749
GA, 0.041860, 0.779264, 0 
GA, 0.114894, 1.510400, 0 
GA, 0.233449, 1.945600, 0 
GA, 0.254181, 2.073600, 0 
perpare first backward gemm: 0.029,  fisrt gemm backward duration: 3.324,  weight grad: 1.461,  other: 0.431
Linear 1 Backward:  5.296
perpare first backward gemm: 0.038,  fisrt gemm backward duration: 2.429,  weight grad: 1.641,  other: 0.441
Linear 1 Backward:  4.61
perpare first backward gemm: 0.043,  fisrt gemm backward duration: 2.138,  weight grad: 1.892,  other: 0.475
Linear 1 Backward:  4.598
perpare first backward gemm: 0.041,  fisrt gemm backward duration: 2.055,  weight grad: 2.011,  other: 0.456
Linear 1 Backward:  4.611
STEP-97: step_time = 23.465983 ms, foward_time = 12.268544, backward_time = 11.092992, perf = 35.14 tflops.
start
start
start
start
block_info 215 9
cuda:1 process time:3.4546852111816406, a: 0.5459785461425781, b: 1.6558170318603516, c: 0.07510185241699219, d: 1.1777877807617188
1 wait time: 1.038
215
block_info 235 27
block_info 287 67
block_info 299 76
cuda:2 process time:4.162311553955078, a: 0.7083415985107422, b: 1.407623291015625, c: 0.12159347534179688, d: 1.924753189086914
cuda:0 process time:4.080772399902344, a: 0.8649826049804688, b: 1.2886524200439453, c: 0.14829635620117188, d: 1.7788410186767578
2 wait time: 1.52
235
0 wait time: 1.857
287
cuda:3 process time:4.762411117553711, a: 0.7960796356201172, b: 1.6062259674072266, c: 0.1475811004638672, d: 2.2125244140625
3 wait time: 2.821
299
AG, 0.041860, 1.116160, 0 
perpare first forward gemm: 0.26,  fisrt gemm forward duration: 2.803
AG, 0.233449, 1.855488, 0 
perpare first forward gemm: 0.33,  fisrt gemm forward duration: 2.359
AG, 0.114894, 1.807360, 0 
perpare first forward gemm: 0.296,  fisrt gemm forward duration: 2.567
AG, 0.254181, 1.884160, 0 
perpare first forward gemm: 0.297,  fisrt gemm forward duration: 1.94
GA, 0.041860, 0.776192, 0 
GA, 0.114894, 1.574912, 0 
GA, 0.233449, 1.947648, 0 
GA, 0.254181, 2.214912, 0 
forward:  9.198
forward:  9.382
forward:  10.243
forward:  8.637
AG, 0.041860, 1.104896, 0 
AG, 0.254181, 1.888256, 0 
AG, 0.233449, 1.853440, 0 
AG, 0.114894, 1.805312, 0 
Linear 2 Backward: 2.68, second_gemm: 2.669
Linear 2 Backward: 3.328, second_gemm: 3.316
Linear 2 Backward: 3.656, second_gemm: 3.643
Linear 2 Backward: 3.729, second_gemm: 3.716
GA, 0.041860, 0.772096, 0 
GA, 0.114894, 1.534976, 0 
GA, 0.233449, 1.954816, 0 
GA, 0.254181, 2.069504, 0 
perpare first backward gemm: 0.027,  fisrt gemm backward duration: 3.304,  weight grad: 1.462,  other: 0.424
Linear 1 Backward:  5.264
perpare first backward gemm: 0.033,  fisrt gemm backward duration: 2.402,  weight grad: 1.637,  other: 0.455
Linear 1 Backward:  4.585
perpare first backward gemm: 0.038,  fisrt gemm backward duration: 2.134,  weight grad: 1.882,  other: 0.452
Linear 1 Backward:  4.563
perpare first backward gemm: 0.038,  fisrt gemm backward duration: 2.057,  weight grad: 1.984,  other: 0.448
Linear 1 Backward:  4.584
STEP-98: step_time = 23.531520 ms, foward_time = 12.119040, backward_time = 11.313152, perf = 35.04 tflops.
start
start
start
block_info 215 9
block_info 235 27
start
cuda:2 process time:3.3071041107177734, a: 0.5671977996826172, b: 1.4035701751708984, c: 0.09250640869140625, d: 1.2438297271728516
cuda:1 process time:3.3533573150634766, a: 0.5879402160644531, b: 1.375436782836914, c: 0.07295608520507812, d: 1.3170242309570312
2 wait time: 1.339
235
1 wait time: 0.329
215
block_info 287 67
block_info 299 76
cuda:0 process time:4.44793701171875, a: 0.8115768432617188, b: 1.3017654418945312, c: 0.14400482177734375, d: 2.1905899047851562
cuda:3 process time:4.61125373840332, a: 0.8628368377685547, b: 1.157999038696289, c: 0.1728534698486328, d: 2.4175643920898438
0 wait time: 2.708
287
3 wait time: 2.617
299
AG, 0.041860, 1.117184, 0 
perpare first forward gemm: 0.291,  fisrt gemm forward duration: 2.75
AG, 0.233449, 1.853440, 0 
perpare first forward gemm: 0.293,  fisrt gemm forward duration: 2.255
AG, 0.114894, 1.793024, 0 
perpare first forward gemm: 0.26,  fisrt gemm forward duration: 3.63
AG, 0.254181, 1.942528, 0 
perpare first forward gemm: 0.342,  fisrt gemm forward duration: 2.007
GA, 0.041860, 0.773120, 0 
GA, 0.114894, 1.476608, 0 
GA, 0.233449, 1.963008, 0 
GA, 0.254181, 2.037760, 0 
forward:  10.156
forward:  8.648
forward:  8.912
forward:  10.274
AG, 0.041860, 1.121280, 0 
AG, 0.254181, 1.914880, 0 
AG, 0.233449, 1.858560, 0 
AG, 0.114894, 1.797120, 0 
Linear 2 Backward: 2.664, second_gemm: 2.65
Linear 2 Backward: 3.333, second_gemm: 3.319
Linear 2 Backward: 3.788, second_gemm: 3.773
Linear 2 Backward: 3.758, second_gemm: 3.744
GA, 0.041860, 0.784384, 0 
GA, 0.114894, 1.524736, 0 
GA, 0.233449, 1.937408, 0 
GA, 0.254181, 2.085888, 0 
perpare first backward gemm: 0.025,  fisrt gemm backward duration: 2.539,  weight grad: 1.618,  other: 0.415
perpare first backward gemm: 0.032,  fisrt gemm backward duration: 3.352,  weight grad: 1.473,  other: 0.441
Linear 1 Backward:  5.355
Linear 1 Backward:  4.637
perpare first backward gemm: 0.042,  fisrt gemm backward duration: 2.168,  weight grad: 1.943,  other: 0.409
Linear 1 Backward:  4.61
perpare first backward gemm: 0.041,  fisrt gemm backward duration: 2.13,  weight grad: 1.992,  other: 0.412
Linear 1 Backward:  4.625
STEP-99: step_time = 23.861248 ms, foward_time = 12.579840, backward_time = 11.161600, perf = 34.56 tflops.

[Summary] Average synchronized step_time = 23.613574409484862 ms, forward = 12.343021011352539, backward = 11.157094383239746.

 end end end
cuda:1
cuda:2
cuda:3
cuda:0
rank: 3, nranks: 4
rank: 1, nranks: 4
rank: 2, nranks: 4
rank: 0, nranks: 4
DistributedDataParallel(
  (module): ExampleModel(
    (attn): MultiHeadSelfAttention(
      (linear_q): Linear(in_features=1024, out_features=1024, bias=False)
      (linear_k): Linear(in_features=1024, out_features=1024, bias=False)
      (linear_v): Linear(in_features=1024, out_features=1024, bias=False)
      (linear_o): Linear(in_features=1024, out_features=1024, bias=False)
    )
    (_moe_layer): MixMOETransformerMLP(
      (gate): NaiveGate(
        (gate): Linear(in_features=1024, out_features=256, bias=True)
      )
      (experts): _Expert(
        (htoh4): FMoELinear(num_expert=70, in_features=1024,         out_features=4096, bias=True, rank=0)
        (h4toh): FMoELinear(num_expert=70, in_features=4096,         out_features=1024, bias=True, rank=0)
        (activation): GELU(approximate='none')
      )
    )
  )
)
[Benchmark] world_size = 4, dtype = float16, model_dim = 1024, hidden_size = 4096, samples = 8192, num_local_experts = 64, topK = 2, a2a_ffn_overlap_degree = 1, device = `cuda:0`
start
start
start
start
block_info 208 46
block_info 220 53
block_info 320 133
block_info 284 106
cuda:0 process time:2071.683168411255, a: 975.3291606903076, b: 1093.3539867401123, c: 0.6539821624755859, d: 2.346038818359375
cuda:3 process time:2070.664405822754, a: 981.8427562713623, b: 1084.563970565796, c: 0.5664825439453125, d: 3.6911964416503906
cuda:1 process time:2072.9761123657227, a: 980.0493717193604, b: 1088.8950824737549, c: 0.43702125549316406, d: 3.594636917114258
cuda:2 process time:2073.0395317077637, a: 983.0992221832275, b: 1085.881233215332, c: 0.5505084991455078, d: 3.5085678100585938
0 wait time: 2.941
320
1 wait time: 4.944
220
3 wait time: 5.845
208
2 wait time: 5.185
284
AG, 0.221154, 1.502208, 0 
perpare first forward gemm: 5.223,  fisrt gemm forward duration: 3.052
AG, 0.240909, 1.827840, 0 
perpare first forward gemm: 6.496,  fisrt gemm forward duration: 3.03
AG, 0.373239, 2.239488, 0 
perpare first forward gemm: 5.562,  fisrt gemm forward duration: 3.821
AG, 0.415625, 2.476032, 0 
perpare first forward gemm: 6.661,  fisrt gemm forward duration: 4.347
GA, 0.221154, 1.359872, 0 
GA, 0.240909, 1.829888, 0 
GA, 0.373239, 2.492416, 0 
GA, 0.415625, 2.493440, 0 
forward:  31.967
forward:  31.742
forward:  31.828
forward:  31.928
AG, 0.221154, 1.542144, 0 
AG, 0.240909, 1.831936, 0 
AG, 0.373239, 2.293760, 0 
AG, 0.415625, 2.621440, 0 
Linear 2 Backward: 3.313, second_gemm: 3.302
Linear 2 Backward: 3.933, second_gemm: 3.914
Linear 2 Backward: 5.043, second_gemm: 5.027
Linear 2 Backward: 5.972, second_gemm: 5.96
GA, 0.240909, 1.769472, 0 
GA, 0.221154, 1.065984, 0 
GA, 0.415625, 2.535424, 0 
GA, 0.373239, 2.147328, 0 
perpare first backward gemm: 0.045,  fisrt gemm backward duration: 3.537,  weight grad: 2.464,  other: 2.287
Linear 1 Backward:  8.402
perpare first backward gemm: 0.032,  fisrt gemm backward duration: 4.099,  weight grad: 2.647,  other: 2.221
Linear 1 Backward:  9.054
perpare first backward gemm: 0.051,  fisrt gemm backward duration: 2.293,  weight grad: 3.022,  other: 2.26
Linear 1 Backward:  7.695
perpare first backward gemm: 0.041,  fisrt gemm backward duration: 2.591,  weight grad: 4.562,  other: 2.332
Linear 1 Backward:  9.583
STEP-0: step_time = 58.853516 ms, foward_time = 37.446777, backward_time = 21.040129, perf = 14.01 tflops.
start
start
start
start
block_info 208 46
block_info 220 53
block_info 284 106
cuda:3 process time:3.512144088745117, a: 0.8077621459960938, b: 1.2791156768798828, c: 0.10037422180175781, d: 1.3248920440673828
cuda:1 process time:3.792285919189453, a: 0.8366107940673828, b: 1.5091896057128906, c: 0.13947486877441406, d: 1.3070106506347656
cuda:2 process time:3.8378238677978516, a: 0.8001327514648438, b: 1.5234947204589844, c: 0.11682510375976562, d: 1.3973712921142578
3 wait time: 1.415
208
1 wait time: 1.482
220
2 wait time: 1.934
284
block_info 320 133
cuda:0 process time:4.951953887939453, a: 0.9400844573974609, b: 1.2691020965576172, c: 0.22530555725097656, d: 2.5174617767333984
0 wait time: 3.244
320
AG, 0.221154, 1.521664, 0 
perpare first forward gemm: 0.24,  fisrt gemm forward duration: 3.419
AG, 0.240909, 1.833984, 0 
perpare first forward gemm: 0.251,  fisrt gemm forward duration: 3.617
AG, 0.373239, 2.289664, 0 
perpare first forward gemm: 0.282,  fisrt gemm forward duration: 3.803
AG, 0.415625, 2.604032, 0 
perpare first forward gemm: 0.299,  fisrt gemm forward duration: 2.658
GA, 0.221154, 1.067008, 0 
GA, 0.240909, 1.831936, 0 
GA, 0.373239, 2.145280, 0 
GA, 0.415625, 2.528256, 0 
forward:  14.194
forward:  14.271
forward:  13.968
forward:  12.507
AG, 0.221154, 1.477632, 0 
AG, 0.240909, 1.859584, 0 
AG, 0.373239, 2.268160, 0 
Linear 2 Backward: 3.253, second_gemm: 3.244
AG, 0.415625, 2.609152, 0 
Linear 2 Backward: 3.449, second_gemm: 3.435
Linear 2 Backward: 4.353, second_gemm: 4.338
GA, 0.221154, 1.045504, 0 
Linear 2 Backward: 4.755, second_gemm: 4.74
GA, 0.240909, 1.817600, 0 
GA, 0.373239, 1.968128, 0 
GA, 0.415625, 2.584576, 0 
perpare first backward gemm: 0.026,  fisrt gemm backward duration: 4.708,  weight grad: 1.418,  other: 0.421
Linear 1 Backward:  6.61
perpare first backward gemm: 0.039,  fisrt gemm backward duration: 4.263,  weight grad: 1.403,  other: 0.45
Linear 1 Backward:  6.215
perpare first backward gemm: 0.048,  fisrt gemm backward duration: 3.255,  weight grad: 2.034,  other: 0.461
Linear 1 Backward:  5.848
perpare first backward gemm: 0.056,  fisrt gemm backward duration: 2.657,  weight grad: 2.26,  other: 0.458
Linear 1 Backward:  5.484
STEP-1: step_time = 30.381345 ms, foward_time = 16.830753, backward_time = 13.436928, perf = 27.14 tflops.
start
start
start
start
block_info 284 106
block_info 208 46
cuda:2 process time:4.071712493896484, a: 0.6949901580810547, b: 1.6007423400878906, c: 0.10967254638671875, d: 1.6663074493408203
block_info 220 53
cuda:3 process time:4.271268844604492, a: 0.9450912475585938, b: 1.3914108276367188, c: 0.1621246337890625, d: 1.7726421356201172
2 wait time: 1.29
block_info 320 133
284
cuda:1 process time:4.663228988647461, a: 0.8766651153564453, b: 1.7056465148925781, c: 0.179290771484375, d: 1.9016265869140625
3 wait time: 1.787
208
1 wait time: 1.965
220
cuda:0 process time:4.746675491333008, a: 0.9641647338867188, b: 1.3298988342285156, c: 0.20122528076171875, d: 2.2513866424560547
0 wait time: 2.934
320
AG, 0.221154, 1.516544, 0 
perpare first forward gemm: 0.252,  fisrt gemm forward duration: 2.513
AG, 0.240909, 1.830912, 0 
perpare first forward gemm: 0.289,  fisrt gemm forward duration: 2.382
AG, 0.373239, 2.304000, 0 
perpare first forward gemm: 0.323,  fisrt gemm forward duration: 3.361
AG, 0.415625, 2.608128, 0 
perpare first forward gemm: 0.313,  fisrt gemm forward duration: 2.668
GA, 0.221154, 1.062912, 0 
GA, 0.240909, 1.817600, 0 
GA, 0.373239, 2.102272, 0 
GA, 0.415625, 2.552832, 0 
forward:  13.139
forward:  13.462
forward:  13.656
forward:  12.609
AG, 0.221154, 1.528832, 0 
AG, 0.240909, 1.837056, 0 
AG, 0.373239, 2.281472, 0 
Linear 2 Backward: 2.917, second_gemm: 2.908
AG, 0.415625, 2.590720, 0 
Linear 2 Backward: 3.275, second_gemm: 3.267
Linear 2 Backward: 4.119, second_gemm: 4.111
GA, 0.221154, 1.052672, 0 
Linear 2 Backward: 4.543, second_gemm: 4.535
GA, 0.240909, 1.795072, 0 
GA, 0.373239, 2.127872, 0 
GA, 0.415625, 2.493440, 0 
perpare first backward gemm: 0.027,  fisrt gemm backward duration: 4.297,  weight grad: 1.422,  other: 0.417
Linear 1 Backward:  6.2
perpare first backward gemm: 0.026,  fisrt gemm backward duration: 4.088,  weight grad: 1.37,  other: 0.496
Linear 1 Backward:  6.041
perpare first backward gemm: 0.035,  fisrt gemm backward duration: 3.062,  weight grad: 2.016,  other: 0.491
Linear 1 Backward:  5.669
perpare first backward gemm: 0.038,  fisrt gemm backward duration: 2.545,  weight grad: 2.22,  other: 0.446
Linear 1 Backward:  5.29
STEP-2: step_time = 29.418273 ms, foward_time = 16.622369, backward_time = 12.695552, perf = 28.03 tflops.
start
start
start
start
block_info 220 53
block_info 284 106
block_info 208 46
cuda:1 process time:3.638744354248047, a: 0.9305477142333984, b: 1.1227130889892578, c: 0.12159347534179688, d: 1.4638900756835938
cuda:2 process time:4.066944122314453, a: 0.7681846618652344, b: 1.4772415161132812, c: 0.11157989501953125, d: 1.7099380493164062
cuda:3 process time:4.143714904785156, a: 0.9789466857910156, b: 1.2297630310058594, c: 0.16164779663085938, d: 1.7733573913574219
1 wait time: 1.259
220
2 wait time: 1.318
284
block_info 320 133
3 wait time: 1.839
208
cuda:0 process time:5.278587341308594, a: 1.1391639709472656, b: 1.2972354888916016, c: 0.213623046875, d: 2.6285648345947266
0 wait time: 2.75
320
AG, 0.221154, 1.519616, 0 
perpare first forward gemm: 0.288,  fisrt gemm forward duration: 2.751
AG, 0.240909, 1.840128, 0 
perpare first forward gemm: 0.296,  fisrt gemm forward duration: 3.335
AG, 0.373239, 2.280448, 0 
perpare first forward gemm: 0.329,  fisrt gemm forward duration: 3.584
AG, 0.415625, 2.583552, 0 
perpare first forward gemm: 0.303,  fisrt gemm forward duration: 2.634
GA, 0.221154, 1.056768, 0 
GA, 0.240909, 1.817600, 0 
GA, 0.373239, 2.232320, 0 
GA, 0.415625, 2.567168, 0 
forward:  13.896
forward:  13.732
forward:  14.029
forward:  12.602
AG, 0.221154, 1.546240, 0 
AG, 0.240909, 1.842176, 0 
AG, 0.373239, 2.279424, 0 
AG, 0.415625, 2.598912, 0 
Linear 2 Backward: 3.148, second_gemm: 3.134
Linear 2 Backward: 3.297, second_gemm: 3.283
Linear 2 Backward: 4.182, second_gemm: 4.174
GA, 0.221154, 1.062912, 0 
Linear 2 Backward: 4.723, second_gemm: 4.707
GA, 0.240909, 1.767424, 0 
GA, 0.373239, 2.085888, 0 
GA, 0.415625, 2.463744, 0 
perpare first backward gemm: 0.04,  fisrt gemm backward duration: 4.301,  weight grad: 1.449,  other: 0.421
Linear 1 Backward:  6.261
perpare first backward gemm: 0.038,  fisrt gemm backward duration: 4.123,  weight grad: 1.376,  other: 0.419
Linear 1 Backward:  6.002
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 3.251,  weight grad: 1.998,  other: 0.423
Linear 1 Backward:  5.748
perpare first backward gemm: 0.055,  fisrt gemm backward duration: 2.534,  weight grad: 2.25,  other: 0.432
Linear 1 Backward:  5.324
STEP-3: step_time = 29.494272 ms, foward_time = 16.386048, backward_time = 13.008896, perf = 27.96 tflops.
start
start
start
start
block_info 284 106
block_info 208 46
cuda:2 process time:3.5581588745117188, a: 0.7545948028564453, b: 1.0974407196044922, c: 0.10824203491210938, d: 1.5978813171386719
block_info 220 53
2 wait time: 1.362
284
cuda:3 process time:4.376411437988281, a: 0.9531974792480469, b: 1.237630844116211, c: 0.171661376953125, d: 2.0139217376708984
block_info 320 133
cuda:1 process time:4.427433013916016, a: 0.9942054748535156, b: 1.3740062713623047, c: 0.2040863037109375, d: 1.8551349639892578
3 wait time: 1.765
208
1 wait time: 2.467
220
cuda:0 process time:4.947185516357422, a: 0.8492469787597656, b: 1.2691020965576172, c: 0.21314620971679688, d: 2.615690231323242
0 wait time: 2.796
320
AG, 0.221154, 1.518592, 0 
perpare first forward gemm: 0.314,  fisrt gemm forward duration: 2.427
AG, 0.240909, 1.837056, 0 
perpare first forward gemm: 0.246,  fisrt gemm forward duration: 2.467
AG, 0.373239, 2.275328, 0 
perpare first forward gemm: 0.331,  fisrt gemm forward duration: 3.519
AG, 0.415625, 2.607104, 0 
perpare first forward gemm: 0.297,  fisrt gemm forward duration: 2.657
GA, 0.221154, 1.052672, 0 
GA, 0.240909, 1.809408, 0 
GA, 0.373239, 2.124800, 0 
GA, 0.415625, 2.499584, 0 
forward:  13.079
forward:  13.387
forward:  13.815
forward:  12.509
AG, 0.221154, 1.518592, 0 
AG, 0.240909, 1.823744, 0 
AG, 0.373239, 2.297856, 0 
Linear 2 Backward: 3.224, second_gemm: 3.216
AG, 0.415625, 2.571264, 0 
Linear 2 Backward: 3.488, second_gemm: 3.479
Linear 2 Backward: 4.286, second_gemm: 4.278
GA, 0.221154, 1.059840, 0 
Linear 2 Backward: 4.702, second_gemm: 4.687
GA, 0.240909, 1.792000, 0 
GA, 0.373239, 2.106368, 0 
GA, 0.415625, 2.595840, 0 
perpare first backward gemm: 0.025,  fisrt gemm backward duration: 4.613,  weight grad: 1.419,  other: 0.409
Linear 1 Backward:  6.503
perpare first backward gemm: 0.027,  fisrt gemm backward duration: 4.402,  weight grad: 1.376,  other: 0.409
Linear 1 Backward:  6.249
perpare first backward gemm: 0.033,  fisrt gemm backward duration: 3.355,  weight grad: 2,  other: 0.411
Linear 1 Backward:  5.841
perpare first backward gemm: 0.054,  fisrt gemm backward duration: 2.672,  weight grad: 2.25,  other: 0.425
Linear 1 Backward:  5.453
STEP-4: step_time = 29.472768 ms, foward_time = 16.244737, backward_time = 13.129728, perf = 27.98 tflops.
start
start
start
start
block_info 320 133
block_info 220 53
block_info 284 106
cuda:0 process time:3.5092830657958984, a: 0.8103847503662109, b: 1.0197162628173828, c: 0.10704994201660156, d: 1.5721321105957031
cuda:1 process time:3.807544708251953, a: 0.7300376892089844, b: 1.4688968658447266, c: 0.11181831359863281, d: 1.4967918395996094
block_info 208 46
cuda:2 process time:4.033088684082031, a: 0.7188320159912109, b: 1.5456676483154297, c: 0.10824203491210938, d: 1.6603469848632812
0 wait time: 1.398
320
1 wait time: 1.07
220
cuda:3 process time:4.354953765869141, a: 0.9438991546630859, b: 1.2297630310058594, c: 0.1704692840576172, d: 2.010822296142578
2 wait time: 1.48
284
3 wait time: 1.716
208
AG, 0.221154, 1.515520, 0 
perpare first forward gemm: 0.239,  fisrt gemm forward duration: 1.59
AG, 0.240909, 1.835008, 0 
perpare first forward gemm: 0.289,  fisrt gemm forward duration: 2.181
AG, 0.373239, 2.284544, 0 
perpare first forward gemm: 0.304,  fisrt gemm forward duration: 2.486
AG, 0.415625, 2.597888, 0 
perpare first forward gemm: 0.359,  fisrt gemm forward duration: 2.996
GA, 0.221154, 1.068032, 0 
GA, 0.240909, 1.807360, 0 
GA, 0.373239, 2.189312, 0 
GA, 0.415625, 2.475008, 0 
forward:  12.859
forward:  12.742
forward:  12.477
forward:  12.983
AG, 0.221154, 1.507328, 0 
AG, 0.240909, 1.804288, 0 
AG, 0.373239, 2.274304, 0 
Linear 2 Backward: 3.365, second_gemm: 3.357
AG, 0.415625, 2.582528, 0 
Linear 2 Backward: 3.575, second_gemm: 3.567
Linear 2 Backward: 4.469, second_gemm: 4.462
GA, 0.221154, 1.056768, 0 
Linear 2 Backward: 4.719, second_gemm: 4.704
GA, 0.240909, 1.814528, 0 
GA, 0.373239, 2.118656, 0 
GA, 0.415625, 2.565120, 0 
perpare first backward gemm: 0.026,  fisrt gemm backward duration: 4.412,  weight grad: 1.374,  other: 0.41
Linear 1 Backward:  6.256
perpare first backward gemm: 0.026,  fisrt gemm backward duration: 4.625,  weight grad: 1.421,  other: 0.412
Linear 1 Backward:  6.52
perpare first backward gemm: 0.034,  fisrt gemm backward duration: 3.346,  weight grad: 2.001,  other: 0.414
Linear 1 Backward:  5.838
perpare first backward gemm: 0.052,  fisrt gemm backward duration: 2.633,  weight grad: 2.282,  other: 0.426
Linear 1 Backward:  5.444
STEP-5: step_time = 28.867584 ms, foward_time = 15.329280, backward_time = 13.441024, perf = 28.57 tflops.
start
start
start
start
block_info 284 106
block_info 220 53
block_info 320 133
block_info 208 46
cuda:2 process time:4.162073135375977, a: 0.7245540618896484, b: 1.676321029663086, c: 0.10800361633300781, d: 1.6531944274902344
cuda:1 process time:3.8466453552246094, a: 0.7672309875488281, b: 1.2052059173583984, c: 0.13899803161621094, d: 1.7352104187011719
2 wait time: 1.468
284
cuda:3 process time:4.210948944091797, a: 0.9109973907470703, b: 1.146554946899414, c: 0.17142295837402344, d: 1.981973648071289
cuda:0 process time:4.148960113525391, a: 0.782012939453125, b: 1.1699199676513672, c: 0.14281272888183594, d: 2.0542144775390625
1 wait time: 1.479
220
0 wait time: 1.63
320
3 wait time: 1.916
208
AG, 0.221154, 1.511424, 0 
perpare first forward gemm: 0.249,  fisrt gemm forward duration: 1.674
AG, 0.240909, 1.835008, 0 
perpare first forward gemm: 0.25,  fisrt gemm forward duration: 2.279
AG, 0.373239, 2.296832, 0 
perpare first forward gemm: 0.281,  fisrt gemm forward duration: 2.84
AG, 0.415625, 2.587648, 0 
perpare first forward gemm: 0.304,  fisrt gemm forward duration: 2.639
GA, 0.221154, 1.052672, 0 
GA, 0.240909, 1.814528, 0 
GA, 0.373239, 2.123776, 0 
GA, 0.415625, 2.573312, 0 
forward:  12.634
forward:  13.122
forward:  12.952
forward:  12.666
AG, 0.221154, 1.534976, 0 
AG, 0.240909, 1.843200, 0 
AG, 0.373239, 2.276352, 0 
Linear 2 Backward: 3.091, second_gemm: 3.076
AG, 0.415625, 2.605056, 0 
Linear 2 Backward: 3.245, second_gemm: 3.23
Linear 2 Backward: 4.232, second_gemm: 4.225
GA, 0.221154, 1.060864, 0 
Linear 2 Backward: 4.708, second_gemm: 4.693
GA, 0.240909, 1.800192, 0 
GA, 0.373239, 2.062336, 0 
GA, 0.415625, 2.589696, 0 
perpare first backward gemm: 0.041,  fisrt gemm backward duration: 4.25,  weight grad: 1.376,  other: 0.421
Linear 1 Backward:  6.135
perpare first backward gemm: 0.039,  fisrt gemm backward duration: 4.479,  weight grad: 1.442,  other: 0.421
Linear 1 Backward:  6.431
perpare first backward gemm: 0.034,  fisrt gemm backward duration: 3.407,  weight grad: 2.023,  other: 0.415
Linear 1 Backward:  5.918
perpare first backward gemm: 0.053,  fisrt gemm backward duration: 2.691,  weight grad: 2.264,  other: 0.434
Linear 1 Backward:  5.493
STEP-6: step_time = 28.751872 ms, foward_time = 15.518719, backward_time = 13.139968, perf = 28.68 tflops.
start
start
start
start
block_info 284 106
block_info 220 53
block_info 320 133
cuda:2 process time:3.5507678985595703, a: 0.7631778717041016, b: 1.0483264923095703, c: 0.10943412780761719, d: 1.6298294067382812
block_info 208 46
cuda:1 process time:3.8177967071533203, a: 0.7526874542236328, b: 1.232147216796875, c: 0.1385211944580078, d: 1.6944408416748047
2 wait time: 1.485
284
cuda:0 process time:3.8454532623291016, a: 0.7588863372802734, b: 1.123666763305664, c: 0.1308917999267578, d: 1.8320083618164062
cuda:3 process time:4.153728485107422, a: 0.8046627044677734, b: 1.1603832244873047, c: 0.17213821411132812, d: 2.0165443420410156
1 wait time: 1.481
220
0 wait time: 1.585
320
3 wait time: 1.743
208
AG, 0.221154, 1.515520, 0 
perpare first forward gemm: 0.238,  fisrt gemm forward duration: 1.624
AG, 0.240909, 1.829888, 0 
perpare first forward gemm: 0.322,  fisrt gemm forward duration: 2.062
AG, 0.373239, 2.291712, 0 
perpare first forward gemm: 0.346,  fisrt gemm forward duration: 2.746
AG, 0.415625, 2.591744, 0 
perpare first forward gemm: 0.305,  fisrt gemm forward duration: 2.645
GA, 0.221154, 1.047552, 0 
GA, 0.240909, 1.758208, 0 
GA, 0.373239, 2.192384, 0 
GA, 0.415625, 2.604032, 0 
forward:  13.144
forward:  12.616
forward:  12.86
forward:  12.708
AG, 0.221154, 1.523712, 0 
AG, 0.240909, 1.811456, 0 
AG, 0.373239, 2.297856, 0 
Linear 2 Backward: 3.205, second_gemm: 3.197
AG, 0.415625, 2.604032, 0 
Linear 2 Backward: 3.404, second_gemm: 3.396
Linear 2 Backward: 4.246, second_gemm: 4.232
GA, 0.221154, 1.057792, 0 
Linear 2 Backward: 4.745, second_gemm: 4.73
GA, 0.240909, 1.807360, 0 
GA, 0.373239, 2.159616, 0 
GA, 0.415625, 2.467840, 0 
perpare first backward gemm: 0.026,  fisrt gemm backward duration: 4.566,  weight grad: 1.419,  other: 0.411
Linear 1 Backward:  6.458
perpare first backward gemm: 0.026,  fisrt gemm backward duration: 4.361,  weight grad: 1.386,  other: 0.414
Linear 1 Backward:  6.223
perpare first backward gemm: 0.051,  fisrt gemm backward duration: 3.082,  weight grad: 2.061,  other: 0.419
Linear 1 Backward:  5.666
perpare first backward gemm: 0.056,  fisrt gemm backward duration: 2.555,  weight grad: 2.294,  other: 0.429
Linear 1 Backward:  5.386
STEP-7: step_time = 28.488704 ms, foward_time = 15.281152, backward_time = 13.109248, perf = 28.95 tflops.
start
start
start
start
block_info 284 106
block_info 208 46
block_info 320 133
cuda:2 process time:3.7457942962646484, a: 0.7221698760986328, b: 1.306295394897461, c: 0.110626220703125, d: 1.6067028045654297
block_info 220 53
cuda:0 process time:4.007816314697266, a: 0.9286403656005859, b: 1.0547637939453125, c: 0.1385211944580078, d: 1.8858909606933594
2 wait time: 1.492
284
cuda:3 process time:4.279136657714844, a: 0.9620189666748047, b: 1.2302398681640625, c: 0.1735687255859375, d: 1.913309097290039
cuda:1 process time:4.417896270751953, a: 0.9334087371826172, b: 1.2154579162597656, c: 0.18310546875, d: 2.0859241485595703
3 wait time: 1.907
208
0 wait time: 1.72
320
1 wait time: 2.157
220
AG, 0.221154, 1.518592, 0 
perpare first forward gemm: 0.317,  fisrt gemm forward duration: 1.791
AG, 0.240909, 1.824768, 0 
perpare first forward gemm: 0.247,  fisrt gemm forward duration: 1.876
AG, 0.373239, 2.310144, 0 
perpare first forward gemm: 0.333,  fisrt gemm forward duration: 2.857
AG, 0.415625, 2.597888, 0 
perpare first forward gemm: 0.373,  fisrt gemm forward duration: 2.725
GA, 0.221154, 1.061888, 0 
GA, 0.240909, 1.811456, 0 
GA, 0.373239, 2.104320, 0 
GA, 0.415625, 2.553856, 0 
forward:  12.559
forward:  13.216
forward:  12.842
forward:  12.836
AG, 0.221154, 1.509376, 0 
AG, 0.240909, 1.861632, 0 
AG, 0.373239, 2.281472, 0 
Linear 2 Backward: 3.251, second_gemm: 3.243
AG, 0.415625, 2.609152, 0 
Linear 2 Backward: 3.393, second_gemm: 3.378
Linear 2 Backward: 4.358, second_gemm: 4.35
GA, 0.221154, 1.046528, 0 
Linear 2 Backward: 4.759, second_gemm: 4.744
GA, 0.240909, 1.804288, 0 
GA, 0.373239, 2.174976, 0 
GA, 0.415625, 2.490368, 0 
perpare first backward gemm: 0.041,  fisrt gemm backward duration: 4.141,  weight grad: 1.377,  other: 0.41
Linear 1 Backward:  6.015
perpare first backward gemm: 0.028,  fisrt gemm backward duration: 4.579,  weight grad: 1.419,  other: 0.41
Linear 1 Backward:  6.472
perpare first backward gemm: 0.038,  fisrt gemm backward duration: 3.324,  weight grad: 2.014,  other: 0.415
Linear 1 Backward:  5.83
perpare first backward gemm: 0.054,  fisrt gemm backward duration: 2.561,  weight grad: 2.265,  other: 0.426
Linear 1 Backward:  5.36
STEP-8: step_time = 28.864512 ms, foward_time = 15.556607, backward_time = 13.210624, perf = 28.57 tflops.
start
start
start
start
block_info 208 46
block_info 220 53
block_info 284 106
cuda:3 process time:3.947019577026367, a: 0.7326602935791016, b: 1.6472339630126953, c: 0.10991096496582031, d: 1.45721435546875
cuda:1 process time:3.935575485229492, a: 0.8411407470703125, b: 1.4696121215820312, c: 0.11229515075683594, d: 1.5125274658203125
cuda:2 process time:4.0435791015625, a: 0.7064342498779297, b: 1.5866756439208984, c: 0.10824203491210938, d: 1.6422271728515625
1 wait time: 0.969
220
3 wait time: 1.029
208
2 wait time: 1.412
284
block_info 320 133
cuda:0 process time:5.034685134887695, a: 0.9691715240478516, b: 1.2042522430419922, c: 0.2143383026123047, d: 2.646923065185547
0 wait time: 2.736
320
AG, 0.221154, 1.520640, 0 
perpare first forward gemm: 0.292,  fisrt gemm forward duration: 3.01
AG, 0.240909, 1.838080, 0 
perpare first forward gemm: 0.296,  fisrt gemm forward duration: 3.327
AG, 0.373239, 2.292736, 0 
perpare first forward gemm: 0.351,  fisrt gemm forward duration: 3.508
AG, 0.415625, 2.597888, 0 
perpare first forward gemm: 0.301,  fisrt gemm forward duration: 2.648
GA, 0.221154, 1.051648, 0 
GA, 0.240909, 1.766400, 0 
GA, 0.373239, 2.131968, 0 
GA, 0.415625, 2.564096, 0 
forward:  14.04
forward:  13.874
forward:  14.058
forward:  12.639
AG, 0.221154, 1.520640, 0 
AG, 0.240909, 1.838080, 0 
AG, 0.373239, 2.285568, 0 
Linear 2 Backward: 3.119, second_gemm: 3.108
AG, 0.415625, 2.581504, 0 
Linear 2 Backward: 3.33, second_gemm: 3.318
Linear 2 Backward: 4.271, second_gemm: 4.263
GA, 0.221154, 1.059840, 0 
Linear 2 Backward: 4.739, second_gemm: 4.723
GA, 0.240909, 1.798144, 0 
GA, 0.373239, 2.096128, 0 
GA, 0.415625, 2.545664, 0 
perpare first backward gemm: 0.035,  fisrt gemm backward duration: 4.28,  weight grad: 1.389,  other: 0.432
Linear 1 Backward:  6.186
perpare first backward gemm: 0.032,  fisrt gemm backward duration: 4.537,  weight grad: 1.42,  other: 0.412
Linear 1 Backward:  6.444
perpare first backward gemm: 0.035,  fisrt gemm backward duration: 3.371,  weight grad: 2.022,  other: 0.413
Linear 1 Backward:  5.879
perpare first backward gemm: 0.056,  fisrt gemm backward duration: 2.622,  weight grad: 2.272,  other: 0.425
Linear 1 Backward:  5.428
STEP-9: step_time = 29.688830 ms, foward_time = 16.391167, backward_time = 13.198336, perf = 27.78 tflops.
start
start
start
start
block_info 220 53
block_info 284 106
block_info 320 133
cuda:1 process time:3.6149024963378906, a: 0.7717609405517578, b: 1.1506080627441406, c: 0.11897087097167969, d: 1.5735626220703125
cuda:2 process time:3.5486221313476562, a: 0.7202625274658203, b: 1.0590553283691406, c: 0.10824203491210938, d: 1.661062240600586
cuda:0 process time:3.829479217529297, a: 0.75531005859375, b: 1.19781494140625, c: 0.11801719665527344, d: 1.7583370208740234
block_info 208 46
1 wait time: 1.154
220
2 wait time: 1.347
284
0 wait time: 1.372
320
cuda:3 process time:4.749298095703125, a: 0.9744167327880859, b: 1.1973381042480469, c: 0.2105236053466797, d: 2.3670196533203125
3 wait time: 2.107
208
AG, 0.221154, 1.527808, 0 
perpare first forward gemm: 0.289,  fisrt gemm forward duration: 1.624
AG, 0.240909, 1.829888, 0 
perpare first forward gemm: 0.296,  fisrt gemm forward duration: 2.749
AG, 0.373239, 2.294784, 0 
perpare first forward gemm: 0.336,  fisrt gemm forward duration: 2.989
AG, 0.415625, 2.609152, 0 
perpare first forward gemm: 0.352,  fisrt gemm forward duration: 3.201
GA, 0.221154, 1.065984, 0 
GA, 0.240909, 1.754112, 0 
GA, 0.373239, 2.206720, 0 
GA, 0.415625, 2.619392, 0 
forward:  13.676
forward:  12.835
forward:  13.553
forward:  13.456
AG, 0.221154, 1.506304, 0 
AG, 0.240909, 1.867776, 0 
AG, 0.373239, 2.279424, 0 
Linear 2 Backward: 3.199, second_gemm: 3.191
AG, 0.415625, 2.621440, 0 
Linear 2 Backward: 3.353, second_gemm: 3.339
Linear 2 Backward: 4.371, second_gemm: 4.362
GA, 0.221154, 1.043456, 0 
Linear 2 Backward: 4.742, second_gemm: 4.727
GA, 0.240909, 1.796096, 0 
GA, 0.373239, 2.203648, 0 
GA, 0.415625, 2.578432, 0 
perpare first backward gemm: 0.027,  fisrt gemm backward duration: 4.643,  weight grad: 1.42,  other: 0.42
Linear 1 Backward:  6.548
perpare first backward gemm: 0.038,  fisrt gemm backward duration: 4.228,  weight grad: 1.373,  other: 0.407
Linear 1 Backward:  6.094
perpare first backward gemm: 0.032,  fisrt gemm backward duration: 3.384,  weight grad: 1.994,  other: 0.412
Linear 1 Backward:  5.858
perpare first backward gemm: 0.053,  fisrt gemm backward duration: 2.635,  weight grad: 2.261,  other: 0.425
Linear 1 Backward:  5.424
STEP-10: step_time = 29.103104 ms, foward_time = 15.815680, backward_time = 13.187072, perf = 28.33 tflops.
start
start
start
start
block_info 284 106
block_info 208 46
block_info 220 53
block_info 320 133
cuda:2 process time:3.7496089935302734, a: 0.759124755859375, b: 1.3964176177978516, c: 0.11444091796875, d: 1.4796257019042969
cuda:3 process time:3.490924835205078, a: 0.8087158203125, b: 1.0993480682373047, c: 0.1327991485595703, d: 1.4500617980957031
cuda:1 process time:3.766775131225586, a: 0.7395744323730469, b: 1.3659000396728516, c: 0.14734268188476562, d: 1.5139579772949219
3 wait time: 1.564
208
cuda:0 process time:3.8001537322998047, a: 0.8134841918945312, b: 1.0600090026855469, c: 0.13113021850585938, d: 1.7955303192138672
2 wait time: 1.651
284
1 wait time: 1.646
220
0 wait time: 1.711
320
AG, 0.221154, 1.525760, 0 
perpare first forward gemm: 0.249,  fisrt gemm forward duration: 2.309
AG, 0.240909, 1.835008, 0 
perpare first forward gemm: 0.254,  fisrt gemm forward duration: 2.415
AG, 0.373239, 2.274304, 0 
perpare first forward gemm: 0.282,  fisrt gemm forward duration: 2.948
AG, 0.415625, 2.595840, 0 
perpare first forward gemm: 0.351,  fisrt gemm forward duration: 2.699
GA, 0.221154, 1.050624, 0 
GA, 0.240909, 1.813504, 0 
GA, 0.373239, 2.083840, 0 
GA, 0.415625, 2.506752, 0 
forward:  13.136
forward:  13.307
forward:  13.26
forward:  12.843
AG, 0.221154, 1.504256, 0 
AG, 0.240909, 1.854464, 0 
AG, 0.373239, 2.274304, 0 
Linear 2 Backward: 3.106, second_gemm: 3.098
AG, 0.415625, 2.601984, 0 
Linear 2 Backward: 3.258, second_gemm: 3.243
Linear 2 Backward: 4.278, second_gemm: 4.27
GA, 0.221154, 1.059840, 0 
Linear 2 Backward: 4.685, second_gemm: 4.671
GA, 0.240909, 1.759232, 0 
GA, 0.373239, 2.095104, 0 
GA, 0.415625, 2.492416, 0 
perpare first backward gemm: 0.026,  fisrt gemm backward duration: 4.529,  weight grad: 1.416,  other: 0.41
Linear 1 Backward:  6.416
perpare first backward gemm: 0.043,  fisrt gemm backward duration: 4.081,  weight grad: 1.372,  other: 0.42
Linear 1 Backward:  5.966
perpare first backward gemm: 0.032,  fisrt gemm backward duration: 3.259,  weight grad: 1.994,  other: 0.406
Linear 1 Backward:  5.728
perpare first backward gemm: 0.05,  fisrt gemm backward duration: 2.562,  weight grad: 2.236,  other: 0.425
Linear 1 Backward:  5.322
STEP-11: step_time = 28.561408 ms, foward_time = 15.469567, backward_time = 12.994560, perf = 28.87 tflops.
start
start
start
start
block_info 208 46
block_info 220 53
block_info 284 106
cuda:3 process time:4.158258438110352, a: 0.7891654968261719, b: 1.6868114471435547, c: 0.13756752014160156, d: 1.5447139739990234
cuda:1 process time:4.081487655639648, a: 0.7686614990234375, b: 1.651763916015625, c: 0.13113021850585938, d: 1.5299320220947266
block_info 320 133
1 wait time: 1.6
220
3 wait time: 1.624
208
cuda:2 process time:4.500389099121094, a: 0.81634521484375, b: 1.4123916625976562, c: 0.1804828643798828, d: 2.0911693572998047
cuda:0 process time:4.503011703491211, a: 0.9613037109375, b: 1.0800361633300781, c: 0.16880035400390625, d: 2.2928714752197266
2 wait time: 2.196
284
0 wait time: 2.005
320
AG, 0.221154, 1.528832, 0 
perpare first forward gemm: 0.29,  fisrt gemm forward duration: 2.312
AG, 0.240909, 1.847296, 0 
perpare first forward gemm: 0.295,  fisrt gemm forward duration: 2.657
AG, 0.373239, 2.278400, 0 
perpare first forward gemm: 0.28,  fisrt gemm forward duration: 2.616
AG, 0.415625, 2.610176, 0 
perpare first forward gemm: 0.349,  fisrt gemm forward duration: 2.682
GA, 0.221154, 1.067008, 0 
GA, 0.240909, 1.784832, 0 
GA, 0.373239, 2.054144, 0 
GA, 0.415625, 2.500608, 0 
forward:  13.374
forward:  12.858
forward:  13.406
forward:  12.732
AG, 0.221154, 1.511424, 0 
AG, 0.240909, 1.825792, 0 
AG, 0.373239, 2.292736, 0 
Linear 2 Backward: 3.343, second_gemm: 3.335
AG, 0.415625, 2.577408, 0 
Linear 2 Backward: 3.66, second_gemm: 3.653
Linear 2 Backward: 4.524, second_gemm: 4.516
GA, 0.221154, 1.048576, 0 
Linear 2 Backward: 4.759, second_gemm: 4.744
GA, 0.240909, 1.796096, 0 
GA, 0.373239, 2.192384, 0 
GA, 0.415625, 2.540544, 0 
perpare first backward gemm: 0.026,  fisrt gemm backward duration: 4.407,  weight grad: 1.375,  other: 0.411
Linear 1 Backward:  6.254
perpare first backward gemm: 0.026,  fisrt gemm backward duration: 4.624,  weight grad: 1.421,  other: 0.411
Linear 1 Backward:  6.519
perpare first backward gemm: 0.036,  fisrt gemm backward duration: 3.322,  weight grad: 2.026,  other: 0.42
Linear 1 Backward:  5.844
perpare first backward gemm: 0.056,  fisrt gemm backward duration: 2.599,  weight grad: 2.238,  other: 0.424
Linear 1 Backward:  5.368
STEP-12: step_time = 29.156353 ms, foward_time = 15.779840, backward_time = 13.279232, perf = 28.28 tflops.
start
start
start
start
block_info 220 53
block_info 208 46
block_info 320 133
cuda:3 process time:3.996610641479492, a: 0.8981227874755859, b: 1.2269020080566406, c: 0.17023086547851562, d: 1.70135498046875
cuda:1 process time:4.366397857666016, a: 0.8711814880371094, b: 1.5974044799804688, c: 0.1709461212158203, d: 1.7268657684326172
1 wait time: 2.348
220
3 wait time: 2.217
208
block_info 284 106
cuda:2 process time:4.846096038818359, a: 0.8225440979003906, b: 1.3439655303955078, c: 0.2067089080810547, d: 2.4728775024414062
2 wait time: 2.549
284
cuda:0 process time:4.559040069580078, a: 0.8370876312255859, b: 1.3360977172851562, c: 0.21982192993164062, d: 2.1660327911376953
0 wait time: 2.12
320
AG, 0.221154, 1.520640, 0 
perpare first forward gemm: 0.246,  fisrt gemm forward duration: 2.574
AG, 0.240909, 1.811456, 0 
perpare first forward gemm: 0.244,  fisrt gemm forward duration: 2.722
AG, 0.373239, 2.300928, 0 
perpare first forward gemm: 0.331,  fisrt gemm forward duration: 2.366
AG, 0.415625, 2.578432, 0 
perpare first forward gemm: 0.35,  fisrt gemm forward duration: 3.085
GA, 0.221154, 1.063936, 0 
GA, 0.240909, 1.792000, 0 
GA, 0.373239, 2.112512, 0 
GA, 0.415625, 2.597888, 0 
forward:  13.514
forward:  12.727
forward:  13.177
forward:  13.407
AG, 0.221154, 1.517568, 0 
AG, 0.240909, 1.817600, 0 
AG, 0.373239, 2.284544, 0 
Linear 2 Backward: 3.423, second_gemm: 3.415
AG, 0.415625, 2.574336, 0 
Linear 2 Backward: 3.482, second_gemm: 3.474
Linear 2 Backward: 4.529, second_gemm: 4.52
GA, 0.221154, 1.058816, 0 
Linear 2 Backward: 4.722, second_gemm: 4.706
GA, 0.240909, 1.782784, 0 
GA, 0.373239, 2.040832, 0 
GA, 0.415625, 2.531328, 0 
perpare first backward gemm: 0.029,  fisrt gemm backward duration: 4.368,  weight grad: 1.373,  other: 0.407
Linear 1 Backward:  6.211
perpare first backward gemm: 0.026,  fisrt gemm backward duration: 4.576,  weight grad: 1.417,  other: 0.41
Linear 1 Backward:  6.465
perpare first backward gemm: 0.033,  fisrt gemm backward duration: 3.318,  weight grad: 2.023,  other: 0.446
Linear 1 Backward:  5.86
perpare first backward gemm: 0.056,  fisrt gemm backward duration: 2.604,  weight grad: 2.282,  other: 0.479
Linear 1 Backward:  5.474
STEP-13: step_time = 29.778945 ms, foward_time = 16.290816, backward_time = 13.388800, perf = 27.69 tflops.
start
start
start
start
block_info 320 133
block_info 208 46
block_info 220 53
cuda:0 process time:4.180192947387695, a: 0.8006095886230469, b: 1.5163421630859375, c: 0.11873245239257812, d: 1.7445087432861328
block_info 284 106
cuda:3 process time:4.143238067626953, a: 0.9355545043945312, b: 1.0814666748046875, c: 0.17142295837402344, d: 1.954793930053711
0 wait time: 1.23
320
cuda:1 process time:4.666566848754883, a: 0.8075237274169922, b: 1.6400814056396484, c: 0.1728534698486328, d: 2.0461082458496094
3 wait time: 1.756
208
cuda:2 process time:4.738330841064453, a: 0.7870197296142578, b: 1.5556812286376953, c: 0.179290771484375, d: 2.216339111328125
1 wait time: 1.807
220
2 wait time: 2.102
284
AG, 0.221154, 1.524736, 0 
perpare first forward gemm: 0.288,  fisrt gemm forward duration: 2.119
AG, 0.240909, 1.830912, 0 
perpare first forward gemm: 0.293,  fisrt gemm forward duration: 2.124
AG, 0.373239, 2.287616, 0 
perpare first forward gemm: 0.331,  fisrt gemm forward duration: 2.354
AG, 0.415625, 2.595840, 0 
perpare first forward gemm: 0.349,  fisrt gemm forward duration: 3.331
GA, 0.221154, 1.064960, 0 
GA, 0.240909, 1.784832, 0 
GA, 0.373239, 2.096128, 0 
GA, 0.415625, 2.488320, 0 
forward:  12.782
forward:  12.636
forward:  13.058
forward:  13.305
AG, 0.221154, 1.522688, 0 
AG, 0.240909, 1.830912, 0 
AG, 0.373239, 2.293760, 0 
Linear 2 Backward: 3.099, second_gemm: 3.09
AG, 0.415625, 2.604032, 0 
Linear 2 Backward: 3.331, second_gemm: 3.323
Linear 2 Backward: 4.151, second_gemm: 4.143
GA, 0.221154, 1.046528, 0 
Linear 2 Backward: 4.572, second_gemm: 4.563
GA, 0.240909, 1.731584, 0 
GA, 0.373239, 2.123776, 0 
GA, 0.415625, 2.608128, 0 
perpare first backward gemm: 0.026,  fisrt gemm backward duration: 4.224,  weight grad: 1.376,  other: 0.406
Linear 1 Backward:  6.066
perpare first backward gemm: 0.027,  fisrt gemm backward duration: 4.453,  weight grad: 1.415,  other: 0.409
Linear 1 Backward:  6.339
perpare first backward gemm: 0.032,  fisrt gemm backward duration: 3.199,  weight grad: 2.015,  other: 0.412
Linear 1 Backward:  5.695
perpare first backward gemm: 0.038,  fisrt gemm backward duration: 2.659,  weight grad: 2.257,  other: 0.452
Linear 1 Backward:  5.445
STEP-14: step_time = 28.486656 ms, foward_time = 15.537151, backward_time = 12.851200, perf = 28.95 tflops.
start
start
start
start
block_info 220 53
block_info 320 133
cuda:1 process time:3.7326812744140625, a: 0.9539127349853516, b: 1.3191699981689453, c: 0.11706352233886719, d: 1.3425350189208984
block_info 284 106
block_info 208 46
1 wait time: 1.375
220
cuda:0 process time:3.808259963989258, a: 0.8833408355712891, b: 1.016378402709961, c: 0.125885009765625, d: 1.7826557159423828
cuda:2 process time:4.223346710205078, a: 0.9179115295410156, b: 1.291036605834961, c: 0.209808349609375, d: 1.8045902252197266
0 wait time: 1.469
320
cuda:3 process time:4.441022872924805, a: 0.9319782257080078, b: 1.3396739959716797, c: 0.1704692840576172, d: 1.9989013671875
2 wait time: 1.859
284
3 wait time: 1.664
208
AG, 0.221154, 1.539072, 0 
perpare first forward gemm: 0.291,  fisrt gemm forward duration: 1.666
AG, 0.240909, 1.842176, 0 
perpare first forward gemm: 0.296,  fisrt gemm forward duration: 2.549
AG, 0.373239, 2.286592, 0 
perpare first forward gemm: 0.329,  fisrt gemm forward duration: 2.352
AG, 0.415625, 2.613248, 0 
perpare first forward gemm: 0.339,  fisrt gemm forward duration: 2.919
GA, 0.221154, 1.060864, 0 
GA, 0.240909, 1.783808, 0 
GA, 0.373239, 2.054144, 0 
GA, 0.415625, 2.576384, 0 
forward:  12.725
forward:  12.738
forward:  13.375
forward:  13.072
AG, 0.221154, 1.520640, 0 
AG, 0.240909, 1.831936, 0 
AG, 0.373239, 2.267136, 0 
Linear 2 Backward: 3.01, second_gemm: 3.002
AG, 0.415625, 2.599936, 0 
Linear 2 Backward: 3.243, second_gemm: 3.235
Linear 2 Backward: 4.225, second_gemm: 4.217
GA, 0.221154, 1.054720, 0 
Linear 2 Backward: 4.568, second_gemm: 4.559
GA, 0.240909, 1.801216, 0 
GA, 0.373239, 2.085888, 0 
GA, 0.415625, 2.581504, 0 
perpare first backward gemm: 0.026,  fisrt gemm backward duration: 4.202,  weight grad: 1.374,  other: 0.419
Linear 1 Backward:  6.058
perpare first backward gemm: 0.026,  fisrt gemm backward duration: 4.423,  weight grad: 1.43,  other: 0.41
Linear 1 Backward:  6.326
perpare first backward gemm: 0.032,  fisrt gemm backward duration: 3.198,  weight grad: 1.993,  other: 0.409
Linear 1 Backward:  5.668
perpare first backward gemm: 0.038,  fisrt gemm backward duration: 2.634,  weight grad: 2.249,  other: 0.428
Linear 1 Backward:  5.389
STEP-15: step_time = 28.489728 ms, foward_time = 15.720449, backward_time = 12.668928, perf = 28.94 tflops.
start
start
start
start
block_info 320 133
block_info 220 53
block_info 208 46
cuda:1 process time:4.183053970336914, a: 0.7648468017578125, b: 1.6391277313232422, c: 0.1418590545654297, d: 1.6372203826904297
cuda:0 process time:4.209995269775391, a: 0.7381439208984375, b: 1.5645027160644531, c: 0.1418590545654297, d: 1.7654895782470703
1 wait time: 1.255
220
block_info 284 106
cuda:3 process time:4.336118698120117, a: 0.9629726409912109, b: 1.2230873107910156, c: 0.18262863159179688, d: 1.9674301147460938
0 wait time: 1.503
320
3 wait time: 1.681
208
cuda:2 process time:4.751920700073242, a: 0.9176731109619141, b: 1.15966796875, c: 0.2200603485107422, d: 2.454519271850586
2 wait time: 2.629
284
AG, 0.221154, 1.533952, 0 
perpare first forward gemm: 0.289,  fisrt gemm forward duration: 2.356
AG, 0.240909, 1.837056, 0 
perpare first forward gemm: 0.292,  fisrt gemm forward duration: 2.946
AG, 0.373239, 2.298880, 0 
perpare first forward gemm: 0.331,  fisrt gemm forward duration: 2.364
AG, 0.415625, 2.592768, 0 
perpare first forward gemm: 0.316,  fisrt gemm forward duration: 3.556
GA, 0.221154, 1.068032, 0 
GA, 0.240909, 1.787904, 0 
GA, 0.373239, 2.037760, 0 
GA, 0.415625, 2.504704, 0 
forward:  13.672
forward:  12.661
forward:  13.347
forward:  13.574
AG, 0.221154, 1.516544, 0 
AG, 0.240909, 1.820672, 0 
AG, 0.373239, 2.269184, 0 
Linear 2 Backward: 3.059, second_gemm: 3.051
AG, 0.415625, 2.601984, 0 
Linear 2 Backward: 3.266, second_gemm: 3.258
Linear 2 Backward: 4.155, second_gemm: 4.141
GA, 0.221154, 1.052672, 0 
Linear 2 Backward: 4.631, second_gemm: 4.622
GA, 0.240909, 1.785856, 0 
GA, 0.373239, 2.195456, 0 
GA, 0.415625, 2.583552, 0 
perpare first backward gemm: 0.025,  fisrt gemm backward duration: 4.22,  weight grad: 1.373,  other: 0.412
Linear 1 Backward:  6.065
perpare first backward gemm: 0.026,  fisrt gemm backward duration: 4.421,  weight grad: 1.415,  other: 0.409
Linear 1 Backward:  6.307
perpare first backward gemm: 0.043,  fisrt gemm backward duration: 3.036,  weight grad: 2.001,  other: 0.411
Linear 1 Backward:  5.545
perpare first backward gemm: 0.037,  fisrt gemm backward duration: 2.635,  weight grad: 2.232,  other: 0.428
Linear 1 Backward:  5.372
STEP-16: step_time = 28.980226 ms, foward_time = 16.142337, backward_time = 12.738560, perf = 28.46 tflops.
start
start
start
start
block_info 220 53
cuda:1 process time:3.869295120239258, a: 0.9329319000244141, b: 1.2269020080566406, c: 0.13637542724609375, d: 1.5730857849121094
block_info 208 46
block_info 320 133
1 wait time: 1.275
220
block_info 284 106
cuda:3 process time:4.426717758178711, a: 0.9589195251464844, b: 1.2784004211425781, c: 0.1704692840576172, d: 2.0189285278320312
cuda:0 process time:4.445314407348633, a: 0.9086132049560547, b: 1.1429786682128906, c: 0.17595291137695312, d: 2.2177696228027344
3 wait time: 1.775
208
0 wait time: 2.368
cuda:2 process time:4.832267761230469, a: 0.9887218475341797, b: 1.3585090637207031, c: 0.21028518676757812, d: 2.274751663208008
320
2 wait time: 2.923
284
AG, 0.221154, 1.529856, 0 
perpare first forward gemm: 0.289,  fisrt gemm forward duration: 2.408
AG, 0.240909, 1.854464, 0 
perpare first forward gemm: 0.293,  fisrt gemm forward duration: 3.295
AG, 0.373239, 2.283520, 0 
perpare first forward gemm: 0.332,  fisrt gemm forward duration: 2.35
AG, 0.415625, 2.599936, 0 
perpare first forward gemm: 0.334,  fisrt gemm forward duration: 3.087
GA, 0.221154, 1.056768, 0 
GA, 0.240909, 1.787904, 0 
GA, 0.373239, 2.081792, 0 
GA, 0.415625, 2.539520, 0 
forward:  12.747
forward:  13.428
forward:  14.033
forward:  13.149
AG, 0.221154, 1.522688, 0 
AG, 0.240909, 1.804288, 0 
AG, 0.373239, 2.291712, 0 
Linear 2 Backward: 3.376, second_gemm: 3.368
AG, 0.415625, 2.579456, 0 
Linear 2 Backward: 3.466, second_gemm: 3.458
Linear 2 Backward: 4.366, second_gemm: 4.356
GA, 0.221154, 1.065984, 0 
Linear 2 Backward: 4.745, second_gemm: 4.73
GA, 0.240909, 1.794048, 0 
GA, 0.373239, 2.105344, 0 
GA, 0.415625, 2.592768, 0 
perpare first backward gemm: 0.027,  fisrt gemm backward duration: 4.454,  weight grad: 1.375,  other: 0.41
Linear 1 Backward:  6.305
perpare first backward gemm: 0.026,  fisrt gemm backward duration: 4.662,  weight grad: 1.416,  other: 0.413
Linear 1 Backward:  6.553
perpare first backward gemm: 0.037,  fisrt gemm backward duration: 3.356,  weight grad: 2.013,  other: 0.424
Linear 1 Backward:  5.872
perpare first backward gemm: 0.056,  fisrt gemm backward duration: 2.666,  weight grad: 2.296,  other: 0.428
Linear 1 Backward:  5.505
STEP-17: step_time = 29.995008 ms, foward_time = 16.477184, backward_time = 13.419520, perf = 27.49 tflops.
start
start
start
start
block_info 208 46
block_info 220 53
block_info 320 133
block_info 284 106
cuda:3 process time:4.532575607299805, a: 0.8063316345214844, b: 1.522064208984375, c: 0.17261505126953125, d: 2.031564712524414
cuda:1 process time:4.729032516479492, a: 0.7989406585693359, b: 1.7285346984863281, c: 0.171661376953125, d: 2.029895782470703
cuda:0 process time:4.7149658203125, a: 0.9059906005859375, b: 1.4047622680664062, c: 0.16999244689941406, d: 2.234220504760742
1 wait time: 1.598
220
3 wait time: 1.673
208
cuda:2 process time:4.752635955810547, a: 0.9372234344482422, b: 1.1544227600097656, c: 0.20933151245117188, d: 2.451658248901367
0 wait time: 2.108
320
2 wait time: 2.59
284
AG, 0.221154, 1.529856, 0 
perpare first forward gemm: 0.286,  fisrt gemm forward duration: 2.286
AG, 0.240909, 1.831936, 0 
perpare first forward gemm: 0.292,  fisrt gemm forward duration: 2.567
AG, 0.373239, 2.293760, 0 
perpare first forward gemm: 0.33,  fisrt gemm forward duration: 2.358
AG, 0.415625, 2.595840, 0 
perpare first forward gemm: 0.352,  fisrt gemm forward duration: 2.827
GA, 0.221154, 1.047552, 0 
GA, 0.240909, 1.778688, 0 
GA, 0.373239, 2.071552, 0 
GA, 0.415625, 2.515968, 0 
forward:  12.653
forward:  13.245
forward:  13.26
forward:  12.89
AG, 0.221154, 1.513472, 0 
AG, 0.240909, 1.848320, 0 
AG, 0.373239, 2.287616, 0 
Linear 2 Backward: 3.313, second_gemm: 3.305
AG, 0.415625, 2.594816, 0 
Linear 2 Backward: 3.437, second_gemm: 3.429
Linear 2 Backward: 4.254, second_gemm: 4.246
GA, 0.221154, 1.061888, 0 
Linear 2 Backward: 4.723, second_gemm: 4.707
GA, 0.240909, 1.808384, 0 
GA, 0.373239, 2.160640, 0 
GA, 0.415625, 2.409472, 0 
perpare first backward gemm: 0.027,  fisrt gemm backward duration: 4.195,  weight grad: 1.37,  other: 0.398
Linear 1 Backward:  6.024
perpare first backward gemm: 0.026,  fisrt gemm backward duration: 4.475,  weight grad: 1.416,  other: 0.423
Linear 1 Backward:  6.378
perpare first backward gemm: 0.031,  fisrt gemm backward duration: 3.222,  weight grad: 2.021,  other: 0.413
Linear 1 Backward:  5.725
perpare first backward gemm: 0.056,  fisrt gemm backward duration: 2.483,  weight grad: 2.277,  other: 0.436
Linear 1 Backward:  5.305
STEP-18: step_time = 29.294592 ms, foward_time = 16.105471, backward_time = 13.089792, perf = 28.15 tflops.
start
start
start
start
block_info 220 53
block_info 208 46
cuda:1 process time:3.984212875366211, a: 0.7455348968505859, b: 1.6560554504394531, c: 0.11157989501953125, d: 1.4710426330566406
cuda:3 process time:3.7894248962402344, a: 0.7386207580566406, b: 1.4028549194335938, c: 0.11396408081054688, d: 1.5339851379394531
block_info 320 133
1 wait time: 1.011
220
3 wait time: 1.063
208
block_info 284 106
cuda:0 process time:4.5566558837890625, a: 0.9715557098388672, b: 1.2543201446533203, c: 0.1766681671142578, d: 2.154111862182617
0 wait time: 2.257
320
cuda:2 process time:4.810094833374023, a: 0.9853839874267578, b: 1.3196468353271484, c: 0.20647048950195312, d: 2.298593521118164
2 wait time: 2.943
284
AG, 0.221154, 1.524736, 0 
perpare first forward gemm: 0.286,  fisrt gemm forward duration: 2.927
AG, 0.240909, 1.828864, 0 
perpare first forward gemm: 0.292,  fisrt gemm forward duration: 3.215
AG, 0.373239, 2.281472, 0 
perpare first forward gemm: 0.283,  fisrt gemm forward duration: 2.334
AG, 0.415625, 2.598912, 0 
perpare first forward gemm: 0.332,  fisrt gemm forward duration: 3.177
GA, 0.221154, 1.064960, 0 
GA, 0.240909, 1.784832, 0 
GA, 0.373239, 2.145280, 0 
GA, 0.415625, 2.603008, 0 
forward:  14.002
forward:  12.705
forward:  13.979
forward:  13.23
AG, 0.221154, 1.525760, 0 
AG, 0.240909, 1.818624, 0 
AG, 0.373239, 2.275328, 0 
Linear 2 Backward: 3.436, second_gemm: 3.428
AG, 0.415625, 2.584576, 0 
Linear 2 Backward: 3.538, second_gemm: 3.532
Linear 2 Backward: 4.582, second_gemm: 4.574
GA, 0.221154, 1.053696, 0 
Linear 2 Backward: 4.73, second_gemm: 4.715
GA, 0.240909, 1.763328, 0 
GA, 0.373239, 2.110464, 0 
GA, 0.415625, 2.538496, 0 
perpare first backward gemm: 0.023,  fisrt gemm backward duration: 4.434,  weight grad: 1.373,  other: 0.399
Linear 1 Backward:  6.258
perpare first backward gemm: 0.026,  fisrt gemm backward duration: 4.599,  weight grad: 1.426,  other: 0.411
Linear 1 Backward:  6.499
perpare first backward gemm: 0.032,  fisrt gemm backward duration: 3.353,  weight grad: 2.016,  other: 0.412
Linear 1 Backward:  5.851
perpare first backward gemm: 0.056,  fisrt gemm backward duration: 2.63,  weight grad: 2.3,  other: 0.424
Linear 1 Backward:  5.462
STEP-19: step_time = 29.995009 ms, foward_time = 16.505856, backward_time = 13.388800, perf = 27.49 tflops.
start
start
start
start
block_info 208 46
block_info 320 133
block_info 220 53
cuda:3 process time:3.748178482055664, a: 0.7660388946533203, b: 1.3322830200195312, c: 0.12254714965820312, d: 1.5273094177246094
cuda:0 process time:3.813505172729492, a: 0.7302761077880859, b: 1.3470649719238281, c: 0.11396408081054688, d: 1.6222000122070312
cuda:1 process time:3.837108612060547, a: 0.7674694061279297, b: 1.363515853881836, c: 0.12326240539550781, d: 1.5828609466552734
3 wait time: 1.293
208
0 wait time: 1.358
320
1 wait time: 1.24
220
block_info 284 106
cuda:2 process time:4.796743392944336, a: 0.9601116180419922, b: 1.1525154113769531, c: 0.20647048950195312, d: 2.4776458740234375
2 wait time: 2.572
284
AG, 0.221154, 1.523712, 0 
perpare first forward gemm: 0.289,  fisrt gemm forward duration: 2.819
AG, 0.240909, 1.829888, 0 
perpare first forward gemm: 0.287,  fisrt gemm forward duration: 2.842
AG, 0.373239, 2.289664, 0 
perpare first forward gemm: 0.281,  fisrt gemm forward duration: 2.341
AG, 0.415625, 2.596864, 0 
perpare first forward gemm: 0.359,  fisrt gemm forward duration: 3.734
GA, 0.221154, 1.059840, 0 
GA, 0.240909, 1.790976, 0 
GA, 0.373239, 2.143232, 0 
GA, 0.415625, 2.537472, 0 
forward:  13.547
forward:  12.557
forward:  13.81
forward:  13.781
AG, 0.221154, 1.513472, 0 
AG, 0.240909, 1.807360, 0 
AG, 0.373239, 2.269184, 0 
Linear 2 Backward: 3.194, second_gemm: 3.186
AG, 0.415625, 2.584576, 0 
Linear 2 Backward: 3.515, second_gemm: 3.508
Linear 2 Backward: 4.443, second_gemm: 4.434
GA, 0.221154, 1.055744, 0 
Linear 2 Backward: 4.741, second_gemm: 4.725
GA, 0.240909, 1.778688, 0 
GA, 0.373239, 2.134016, 0 
GA, 0.415625, 2.421760, 0 
perpare first backward gemm: 0.026,  fisrt gemm backward duration: 4.316,  weight grad: 1.369,  other: 0.397
Linear 1 Backward:  6.14
perpare first backward gemm: 0.026,  fisrt gemm backward duration: 4.484,  weight grad: 1.429,  other: 0.411
Linear 1 Backward:  6.388
perpare first backward gemm: 0.031,  fisrt gemm backward duration: 3.254,  weight grad: 2.001,  other: 0.41
Linear 1 Backward:  5.733
perpare first backward gemm: 0.055,  fisrt gemm backward duration: 2.487,  weight grad: 2.237,  other: 0.423
Linear 1 Backward:  5.255
STEP-20: step_time = 29.208575 ms, foward_time = 16.059392, backward_time = 13.048832, perf = 28.23 tflops.
start
start
start
start
block_info 220 53
block_info 320 133
block_info 208 46
cuda:1 process time:4.389762878417969, a: 0.7579326629638672, b: 1.7597675323486328, c: 0.13518333435058594, d: 1.7368793487548828
block_info 284 106
cuda:0 process time:4.380464553833008, a: 0.8232593536376953, b: 1.5230178833007812, c: 0.1399517059326172, d: 1.894235610961914
1 wait time: 1.386
220
cuda:3 process time:4.386186599731445, a: 0.9896755218505859, b: 1.1074542999267578, c: 0.1823902130126953, d: 2.1066665649414062
0 wait time: 1.666
320
3 wait time: 1.788
208
cuda:2 process time:4.981279373168945, a: 0.9355545043945312, b: 1.3175010681152344, c: 0.23889541625976562, d: 2.489328384399414
2 wait time: 2.521
284
AG, 0.221154, 1.522688, 0 
perpare first forward gemm: 0.252,  fisrt gemm forward duration: 2.087
AG, 0.240909, 1.833984, 0 
perpare first forward gemm: 0.242,  fisrt gemm forward duration: 2.711
AG, 0.373239, 2.272256, 0 
perpare first forward gemm: 0.28,  fisrt gemm forward duration: 2.324
AG, 0.415625, 2.595840, 0 
perpare first forward gemm: 0.301,  fisrt gemm forward duration: 3.202
GA, 0.221154, 1.054720, 0 
GA, 0.240909, 1.705984, 0 
GA, 0.373239, 2.243584, 0 
GA, 0.415625, 2.477056, 0 
forward:  13.281
forward:  12.493
forward:  12.968
forward:  13.134
AG, 0.221154, 1.522688, 0 
AG, 0.240909, 1.830912, 0 
AG, 0.373239, 2.289664, 0 
Linear 2 Backward: 3.197, second_gemm: 3.189
AG, 0.415625, 2.599936, 0 
Linear 2 Backward: 3.234, second_gemm: 3.228
Linear 2 Backward: 4.335, second_gemm: 4.327
GA, 0.221154, 1.061888, 0 
Linear 2 Backward: 4.74, second_gemm: 4.724
GA, 0.240909, 1.780736, 0 
GA, 0.373239, 2.188288, 0 
GA, 0.415625, 2.442240, 0 
perpare first backward gemm: 0.022,  fisrt gemm backward duration: 4.322,  weight grad: 1.369,  other: 0.401
Linear 1 Backward:  6.144
perpare first backward gemm: 0.026,  fisrt gemm backward duration: 4.498,  weight grad: 1.414,  other: 0.412
Linear 1 Backward:  6.386
perpare first backward gemm: 0.032,  fisrt gemm backward duration: 3.267,  weight grad: 1.997,  other: 0.432
Linear 1 Backward:  5.766
perpare first backward gemm: 0.056,  fisrt gemm backward duration: 2.502,  weight grad: 2.239,  other: 0.425
Linear 1 Backward:  5.273
STEP-21: step_time = 28.879872 ms, foward_time = 15.811585, backward_time = 12.968960, perf = 28.55 tflops.
start
start
start
start
block_info 220 53
block_info 208 46
cuda:1 process time:4.246711730957031, a: 0.7379055023193359, b: 1.7883777618408203, c: 0.12946128845214844, d: 1.5909671783447266
block_info 320 133
1 wait time: 1.252
220
block_info 284 106
cuda:3 process time:4.59599494934082, a: 0.9336471557617188, b: 1.5141963958740234, c: 0.18596649169921875, d: 1.9621849060058594
cuda:0 process time:4.801273345947266, a: 0.9608268737792969, b: 1.4088153839111328, c: 0.17142295837402344, d: 2.2602081298828125
3 wait time: 1.951
208
0 wait time: 2.067
320
cuda:2 process time:4.799127578735352, a: 0.9326934814453125, b: 1.1692047119140625, c: 0.20694732666015625, d: 2.4902820587158203
2 wait time: 2.579
284
AG, 0.221154, 1.512448, 0 
perpare first forward gemm: 0.26,  fisrt gemm forward duration: 2.464
AG, 0.240909, 1.838080, 0 
perpare first forward gemm: 0.292,  fisrt gemm forward duration: 3.02
AG, 0.373239, 2.298880, 0 
perpare first forward gemm: 0.332,  fisrt gemm forward duration: 2.364
AG, 0.415625, 2.596864, 0 
perpare first forward gemm: 0.35,  fisrt gemm forward duration: 3.071
GA, 0.221154, 1.076224, 0 
GA, 0.240909, 1.801216, 0 
GA, 0.373239, 2.239488, 0 
GA, 0.415625, 2.614272, 0 
forward:  13.796
forward:  12.77
forward:  13.475
forward:  13.183
AG, 0.221154, 1.525760, 0 
AG, 0.240909, 1.816576, 0 
AG, 0.373239, 2.272256, 0 
Linear 2 Backward: 3.206, second_gemm: 3.198
Linear 2 Backward: 3.335, second_gemm: 3.328
AG, 0.415625, 2.966528, 0 
Linear 2 Backward: 4.145, second_gemm: 4.138
GA, 0.221154, 1.053696, 0 
Linear 2 Backward: 5.095, second_gemm: 5.08
GA, 0.240909, 1.784832, 0 
GA, 0.373239, 2.083840, 0 
GA, 0.415625, 2.483200, 0 
perpare first backward gemm: 0.022,  fisrt gemm backward duration: 4.708,  weight grad: 1.416,  other: 0.4
Linear 1 Backward:  6.576
perpare first backward gemm: 0.022,  fisrt gemm backward duration: 4.74,  weight grad: 1.365,  other: 0.404
Linear 1 Backward:  6.558
perpare first backward gemm: 0.031,  fisrt gemm backward duration: 3.661,  weight grad: 2.019,  other: 0.411
Linear 1 Backward:  6.158
perpare first backward gemm: 0.056,  fisrt gemm backward duration: 2.543,  weight grad: 2.236,  other: 0.434
Linear 1 Backward:  5.321
STEP-22: step_time = 29.693950 ms, foward_time = 16.122881, backward_time = 13.473792, perf = 27.77 tflops.
start
start
start
start
block_info 208 46
block_info 220 53
cuda:3 process time:3.9637088775634766, a: 0.7469654083251953, b: 1.4972686767578125, c: 0.1380443572998047, d: 1.581430435180664
block_info 320 133
cuda:1 process time:3.858327865600586, a: 0.6356239318847656, b: 1.4965534210205078, c: 0.12135505676269531, d: 1.6047954559326172
3 wait time: 1.086
208
1 wait time: 0.621
220
block_info 284 106
cuda:0 process time:4.296302795410156, a: 0.8990764617919922, b: 1.2385845184326172, c: 0.17571449279785156, d: 1.9829273223876953
0 wait time: 2.466
320
cuda:2 process time:4.740476608276367, a: 0.8475780487060547, b: 1.218557357788086, c: 0.209808349609375, d: 2.4645328521728516
2 wait time: 2.548
284
AG, 0.221154, 1.533952, 0 
perpare first forward gemm: 0.29,  fisrt gemm forward duration: 2.844
AG, 0.240909, 1.847296, 0 
perpare first forward gemm: 0.292,  fisrt gemm forward duration: 3.001
AG, 0.373239, 2.302976, 0 
perpare first forward gemm: 0.331,  fisrt gemm forward duration: 2.368
AG, 0.415625, 2.610176, 0 
perpare first forward gemm: 0.306,  fisrt gemm forward duration: 3.262
GA, 0.221154, 1.054720, 0 
GA, 0.240909, 1.806336, 0 
GA, 0.373239, 2.211840, 0 
GA, 0.415625, 2.599936, 0 
forward:  13.763
forward:  13.891
forward:  12.748
forward:  13.248
AG, 0.221154, 1.526784, 0 
AG, 0.240909, 1.833984, 0 
AG, 0.373239, 2.284544, 0 
Linear 2 Backward: 3.225, second_gemm: 3.219
AG, 0.415625, 2.614272, 0 
Linear 2 Backward: 3.291, second_gemm: 3.284
Linear 2 Backward: 4.339, second_gemm: 4.331
GA, 0.221154, 1.052672, 0 
Linear 2 Backward: 4.763, second_gemm: 4.747
GA, 0.240909, 1.781760, 0 
GA, 0.373239, 2.160640, 0 
GA, 0.415625, 2.504704, 0 
perpare first backward gemm: 0.023,  fisrt gemm backward duration: 4.4,  weight grad: 1.366,  other: 0.4
Linear 1 Backward:  6.221
perpare first backward gemm: 0.023,  fisrt gemm backward duration: 4.633,  weight grad: 1.408,  other: 0.4
Linear 1 Backward:  6.493
perpare first backward gemm: 0.032,  fisrt gemm backward duration: 3.345,  weight grad: 2.013,  other: 0.45
Linear 1 Backward:  5.878
perpare first backward gemm: 0.056,  fisrt gemm backward duration: 2.579,  weight grad: 2.275,  other: 0.428
Linear 1 Backward:  5.39
STEP-23: step_time = 29.887266 ms, foward_time = 16.658209, backward_time = 13.128704, perf = 27.59 tflops.
start
start
start
start
block_info 208 46
block_info 220 53
cuda:3 process time:3.747701644897461, a: 0.8616447448730469, b: 1.1873245239257812, c: 0.13303756713867188, d: 1.565694808959961
cuda:1 process time:3.6935806274414062, a: 0.7905960083007812, b: 1.1894702911376953, c: 0.1239776611328125, d: 1.5895366668701172
block_info 320 133
3 wait time: 1.367
208
1 wait time: 1.17
220
block_info 284 106
cuda:0 process time:4.454612731933594, a: 0.949859619140625, b: 1.3666152954101562, c: 0.17333030700683594, d: 1.9648075103759766
cuda:2 process time:4.68134880065918, a: 0.888824462890625, b: 1.1298656463623047, c: 0.20742416381835938, d: 2.4552345275878906
0 wait time: 2.514
320
2 wait time: 2.497
284
AG, 0.221154, 1.517568, 0 
perpare first forward gemm: 0.28,  fisrt gemm forward duration: 2.679
AG, 0.240909, 1.832960, 0 
perpare first forward gemm: 0.286,  fisrt gemm forward duration: 2.966
AG, 0.373239, 2.293760, 0 
perpare first forward gemm: 0.323,  fisrt gemm forward duration: 2.356
AG, 0.415625, 2.594816, 0 
perpare first forward gemm: 0.344,  fisrt gemm forward duration: 2.847
GA, 0.221154, 1.064960, 0 
GA, 0.240909, 1.821696, 0 
GA, 0.373239, 2.034688, 0 
GA, 0.415625, 2.604032, 0 
forward:  13.729
forward:  12.72
forward:  13.769
forward:  12.981
AG, 0.221154, 1.523712, 0 
AG, 0.240909, 1.865728, 0 
AG, 0.373239, 2.283520, 0 
Linear 2 Backward: 3.437, second_gemm: 3.425
AG, 0.415625, 2.603008, 0 
Linear 2 Backward: 3.554, second_gemm: 3.539
Linear 2 Backward: 4.607, second_gemm: 4.599
GA, 0.221154, 1.048576, 0 
Linear 2 Backward: 4.76, second_gemm: 4.745
GA, 0.240909, 1.798144, 0 
GA, 0.373239, 2.094080, 0 
GA, 0.415625, 2.545664, 0 
perpare first backward gemm: 0.041,  fisrt gemm backward duration: 4.186,  weight grad: 1.412,  other: 0.473
perpare first backward gemm: 0.034,  fisrt gemm backward duration: 4.487,  weight grad: 1.44,  other: 0.428
Linear 1 Backward:  6.438
Linear 1 Backward:  6.178
perpare first backward gemm: 0.032,  fisrt gemm backward duration: 3.394,  weight grad: 2.018,  other: 0.413
Linear 1 Backward:  5.893
perpare first backward gemm: 0.055,  fisrt gemm backward duration: 2.62,  weight grad: 2.282,  other: 0.427
Linear 1 Backward:  5.436
STEP-24: step_time = 29.996929 ms, foward_time = 16.392063, backward_time = 13.504512, perf = 27.49 tflops.
start
start
start
start
block_info 220 53
cuda:1 process time:4.19926643371582, a: 0.7662773132324219, b: 1.6150474548339844, c: 0.1308917999267578, d: 1.6870498657226562
block_info 208 46
block_info 320 133
block_info 284 106
1 wait time: 1.326
220
cuda:3 process time:4.7626495361328125, a: 0.7879734039306641, b: 1.7061233520507812, c: 0.1819133758544922, d: 2.086639404296875
cuda:0 process time:4.592180252075195, a: 0.9517669677734375, b: 1.1074542999267578, c: 0.17118453979492188, d: 2.361774444580078
3 wait time: 1.877
208
cuda:2 process time:5.105018615722656, a: 0.9641647338867188, b: 1.6510486602783203, c: 0.20599365234375, d: 2.283811569213867
0 wait time: 2.143
320
2 wait time: 2.875
284
AG, 0.221154, 1.528832, 0 
perpare first forward gemm: 0.289,  fisrt gemm forward duration: 2.022
AG, 0.240909, 1.835008, 0 
perpare first forward gemm: 0.295,  fisrt gemm forward duration: 2.849
AG, 0.373239, 2.275328, 0 
perpare first forward gemm: 0.347,  fisrt gemm forward duration: 2.329
AG, 0.415625, 2.589696, 0 
perpare first forward gemm: 0.306,  fisrt gemm forward duration: 2.957
GA, 0.221154, 1.060864, 0 
GA, 0.240909, 1.790976, 0 
GA, 0.373239, 2.052096, 0 
GA, 0.415625, 2.546688, 0 
forward:  13.606
forward:  13.057
forward:  12.731
forward:  12.948
AG, 0.221154, 1.515520, 0 
AG, 0.240909, 1.827840, 0 
AG, 0.373239, 2.284544, 0 
Linear 2 Backward: 3.342, second_gemm: 3.336
AG, 0.415625, 2.584576, 0 
Linear 2 Backward: 3.541, second_gemm: 3.535
Linear 2 Backward: 4.501, second_gemm: 4.493
GA, 0.221154, 1.048576, 0 
Linear 2 Backward: 4.696, second_gemm: 4.681
GA, 0.240909, 1.767424, 0 
GA, 0.373239, 2.189312, 0 
GA, 0.415625, 2.502656, 0 
perpare first backward gemm: 0.026,  fisrt gemm backward duration: 4.543,  weight grad: 1.419,  other: 0.402
Linear 1 Backward:  6.423
perpare first backward gemm: 0.023,  fisrt gemm backward duration: 4.351,  weight grad: 1.366,  other: 0.408
Linear 1 Backward:  6.177
perpare first backward gemm: 0.031,  fisrt gemm backward duration: 3.272,  weight grad: 2.023,  other: 0.413
Linear 1 Backward:  5.783
perpare first backward gemm: 0.053,  fisrt gemm backward duration: 2.573,  weight grad: 2.269,  other: 0.434
Linear 1 Backward:  5.38
STEP-25: step_time = 29.384704 ms, foward_time = 16.144384, backward_time = 13.133824, perf = 28.06 tflops.
start
start
start
start
block_info 284 106
block_info 220 53
block_info 208 46
block_info 320 133
cuda:1 process time:4.665851593017578, a: 0.797271728515625, b: 1.6312599182128906, c: 0.1728534698486328, d: 2.0644664764404297
cuda:2 process time:4.4422149658203125, a: 0.9677410125732422, b: 1.058816909790039, c: 0.18310546875, d: 2.2325515747070312
cuda:3 process time:4.805564880371094, a: 0.9965896606445312, b: 1.3091564178466797, c: 0.21457672119140625, d: 2.2852420806884766
2 wait time: 2.051
284
1 wait time: 1.746
220
cuda:0 process time:5.036592483520508, a: 0.9558200836181641, b: 1.3072490692138672, c: 0.21219253540039062, d: 2.561330795288086
3 wait time: 2.35
208
0 wait time: 2.552
320
AG, 0.221154, 1.519616, 0 
perpare first forward gemm: 0.285,  fisrt gemm forward duration: 1.844
AG, 0.240909, 1.821696, 0 
perpare first forward gemm: 0.328,  fisrt gemm forward duration: 2.355
AG, 0.373239, 2.288640, 0 
perpare first forward gemm: 0.332,  fisrt gemm forward duration: 2.761
AG, 0.415625, 2.593792, 0 
perpare first forward gemm: 0.315,  fisrt gemm forward duration: 2.646
GA, 0.221154, 1.059840, 0 
GA, 0.240909, 1.790976, 0 
GA, 0.373239, 1.973248, 0 
GA, 0.415625, 2.548736, 0 
forward:  13.137
forward:  13.132
forward:  12.861
forward:  12.683
AG, 0.221154, 1.536000, 0 
AG, 0.240909, 1.802240, 0 
AG, 0.373239, 2.305024, 0 
AG, 0.415625, 2.591744, 0 
Linear 2 Backward: 3.228, second_gemm: 3.215
Linear 2 Backward: 3.489, second_gemm: 3.482
Linear 2 Backward: 4.518, second_gemm: 4.51
GA, 0.221154, 1.058816, 0 
Linear 2 Backward: 4.739, second_gemm: 4.723
GA, 0.240909, 1.764352, 0 
GA, 0.373239, 2.040832, 0 
GA, 0.415625, 2.388992, 0 
perpare first backward gemm: 0.022,  fisrt gemm backward duration: 4.309,  weight grad: 1.377,  other: 0.401
Linear 1 Backward:  6.138
perpare first backward gemm: 0.042,  fisrt gemm backward duration: 4.227,  weight grad: 1.46,  other: 0.416
Linear 1 Backward:  6.196
perpare first backward gemm: 0.032,  fisrt gemm backward duration: 3.175,  weight grad: 2.015,  other: 0.412
Linear 1 Backward:  5.671
perpare first backward gemm: 0.055,  fisrt gemm backward duration: 2.482,  weight grad: 2.266,  other: 0.424
Linear 1 Backward:  5.285
STEP-26: step_time = 29.476866 ms, foward_time = 16.296961, backward_time = 13.080576, perf = 27.98 tflops.
start
start
start
block_info 320 133
block_info 220 53
cuda:1 process time:4.083871841430664, a: 0.8006095886230469, b: 1.7237663269042969, c: 0.10848045349121094, d: 1.4510154724121094
start
cuda:0 process time:4.135370254516602, a: 0.7424354553222656, b: 1.653432846069336, c: 0.1087188720703125, d: 1.6307830810546875
block_info 208 46
1 wait time: 1.096
220
0 wait time: 0.385
320
block_info 284 106
cuda:3 process time:4.535436630249023, a: 0.9884834289550781, b: 1.123189926147461, c: 0.1990795135498047, d: 2.2246837615966797
cuda:2 process time:4.921674728393555, a: 0.9434223175048828, b: 1.2857913970947266, c: 0.20813941955566406, d: 2.4843215942382812
3 wait time: 2.006
208
2 wait time: 2.574
284
AG, 0.221154, 1.516544, 0 
perpare first forward gemm: 0.24,  fisrt gemm forward duration: 2.013
AG, 0.240909, 1.822720, 0 
perpare first forward gemm: 0.329,  fisrt gemm forward duration: 2.912
AG, 0.373239, 2.321408, 0 
perpare first forward gemm: 0.281,  fisrt gemm forward duration: 2.371
AG, 0.415625, 2.584576, 0 
perpare first forward gemm: 0.355,  fisrt gemm forward duration: 3.505
GA, 0.221154, 1.056768, 0 
GA, 0.240909, 1.761280, 0 
GA, 0.373239, 2.048000, 0 
GA, 0.415625, 2.531328, 0 
forward:  12.956
forward:  12.603
forward:  13.681
forward:  13.637
AG, 0.221154, 1.529856, 0 
AG, 0.240909, 1.808384, 0 
AG, 0.373239, 2.304000, 0 
Linear 2 Backward: 3.32, second_gemm: 3.307
AG, 0.415625, 2.613248, 0 
Linear 2 Backward: 3.596, second_gemm: 3.589
Linear 2 Backward: 4.603, second_gemm: 4.595
GA, 0.221154, 1.052672, 0 
Linear 2 Backward: 4.754, second_gemm: 4.739
GA, 0.240909, 1.758208, 0 
GA, 0.373239, 2.107392, 0 
GA, 0.415625, 2.610176, 0 
perpare first backward gemm: 0.023,  fisrt gemm backward duration: 4.41,  weight grad: 1.368,  other: 0.403
Linear 1 Backward:  6.234
perpare first backward gemm: 0.044,  fisrt gemm backward duration: 4.342,  weight grad: 1.422,  other: 0.4
Linear 1 Backward:  6.255
perpare first backward gemm: 0.031,  fisrt gemm backward duration: 3.291,  weight grad: 2.015,  other: 0.413
Linear 1 Backward:  5.788
perpare first backward gemm: 0.041,  fisrt gemm backward duration: 2.663,  weight grad: 2.263,  other: 0.435
Linear 1 Backward:  5.444
STEP-27: step_time = 28.623870 ms, foward_time = 15.148033, backward_time = 13.377536, perf = 28.81 tflops.
start
start
start
start
block_info 220 53
block_info 320 133
cuda:1 process time:4.155874252319336, a: 0.7379055023193359, b: 1.603841781616211, c: 0.12993812561035156, d: 1.6841888427734375
block_info 208 46
cuda:0 process time:4.264116287231445, a: 0.7593631744384766, b: 1.5137195587158203, c: 0.13375282287597656, d: 1.8572807312011719
block_info 284 106
1 wait time: 1.209
220
0 wait time: 1.398
320
cuda:3 process time:4.46629524230957, a: 0.9455680847167969, b: 1.1928081512451172, c: 0.1971721649169922, d: 2.130746841430664
cuda:2 process time:4.957437515258789, a: 0.9396076202392578, b: 1.2879371643066406, c: 0.20575523376464844, d: 2.524137496948242
3 wait time: 2.182
208
2 wait time: 2.264
284
AG, 0.221154, 1.529856, 0 
perpare first forward gemm: 0.289,  fisrt gemm forward duration: 1.901
AG, 0.240909, 1.838080, 0 
perpare first forward gemm: 0.294,  fisrt gemm forward duration: 2.774
AG, 0.373239, 2.288640, 0 
perpare first forward gemm: 0.334,  fisrt gemm forward duration: 2.363
AG, 0.415625, 2.624512, 0 
perpare first forward gemm: 0.353,  fisrt gemm forward duration: 3.277
GA, 0.221154, 1.053696, 0 
GA, 0.240909, 1.813504, 0 
GA, 0.373239, 2.037760, 0 
GA, 0.415625, 2.503680, 0 
forward:  12.682
forward:  12.875
forward:  13.467
forward:  13.311
AG, 0.221154, 1.527808, 0 
AG, 0.240909, 1.828864, 0 
AG, 0.373239, 2.300928, 0 
AG, 0.415625, 2.581504, 0 
Linear 2 Backward: 2.983, second_gemm: 2.97
Linear 2 Backward: 3.303, second_gemm: 3.297
Linear 2 Backward: 4.291, second_gemm: 4.283
Linear 2 Backward: 4.611, second_gemm: 4.602
GA, 0.221154, 1.069056, 0 
GA, 0.240909, 1.797120, 0 
GA, 0.373239, 2.096128, 0 
GA, 0.415625, 2.592768, 0 
perpare first backward gemm: 0.023,  fisrt gemm backward duration: 4.248,  weight grad: 1.368,  other: 0.399
Linear 1 Backward:  6.065
perpare first backward gemm: 0.045,  fisrt gemm backward duration: 4.192,  weight grad: 1.419,  other: 0.402
Linear 1 Backward:  6.103
perpare first backward gemm: 0.031,  fisrt gemm backward duration: 3.172,  weight grad: 2.012,  other: 0.409
Linear 1 Backward:  5.66
perpare first backward gemm: 0.038,  fisrt gemm backward duration: 2.644,  weight grad: 2.234,  other: 0.427
Linear 1 Backward:  5.38
STEP-28: step_time = 28.604416 ms, foward_time = 15.650816, backward_time = 12.854272, perf = 28.83 tflops.
start
start
start
start
block_info 208 46
block_info 220 53
block_info 320 133
cuda:3 process time:3.976583480834961, a: 0.8647441864013672, b: 1.2726783752441406, c: 0.1704692840576172, d: 1.668691635131836
block_info 284 106
cuda:1 process time:4.272937774658203, a: 0.7951259613037109, b: 1.3263225555419922, c: 0.1735687255859375, d: 1.9779205322265625
3 wait time: 2.261
208
cuda:0 process time:4.497528076171875, a: 0.7987022399902344, b: 1.222848892211914, c: 0.17452239990234375, d: 2.301454544067383
1 wait time: 1.778
220
cuda:2 process time:4.762887954711914, a: 0.8535385131835938, b: 1.1854171752929688, c: 0.2110004425048828, d: 2.5129318237304688
0 wait time: 2.128
320
2 wait time: 2.704
284
AG, 0.221154, 1.528832, 0 
perpare first forward gemm: 0.24,  fisrt gemm forward duration: 2.471
AG, 0.240909, 1.868800, 0 
perpare first forward gemm: 0.298,  fisrt gemm forward duration: 2.44
AG, 0.373239, 2.286592, 0 
perpare first forward gemm: 0.288,  fisrt gemm forward duration: 2.426
AG, 0.415625, 2.618368, 0 
perpare first forward gemm: 0.353,  fisrt gemm forward duration: 2.692
GA, 0.221154, 1.061888, 0 
GA, 0.240909, 1.762304, 0 
GA, 0.373239, 2.173952, 0 
GA, 0.415625, 2.627584, 0 
forward:  12.885
forward:  13.582
forward:  13.0
forward:  13.514
AG, 0.221154, 1.530880, 0 
AG, 0.240909, 1.813504, 0 
AG, 0.373239, 2.295808, 0 
Linear 2 Backward: 3.097, second_gemm: 3.083
AG, 0.415625, 2.591744, 0 
Linear 2 Backward: 3.241, second_gemm: 3.235
Linear 2 Backward: 4.384, second_gemm: 4.376
GA, 0.221154, 1.058816, 0 
Linear 2 Backward: 4.716, second_gemm: 4.701
GA, 0.240909, 1.792000, 0 
GA, 0.373239, 1.993728, 0 
GA, 0.415625, 2.579456, 0 
perpare first backward gemm: 0.043,  fisrt gemm backward duration: 4.402,  weight grad: 1.417,  other: 0.402
perpare first backward gemm: 0.023,  fisrt gemm backward duration: 4.442,  weight grad: 1.367,  other: 0.399
Linear 1 Backward:  6.259
Linear 1 Backward:  6.309
perpare first backward gemm: 0.032,  fisrt gemm backward duration: 3.352,  weight grad: 2,  other: 0.419
Linear 1 Backward:  5.84
perpare first backward gemm: 0.052,  fisrt gemm backward duration: 2.637,  weight grad: 2.258,  other: 0.429
Linear 1 Backward:  5.425
STEP-29: step_time = 29.246464 ms, foward_time = 16.047104, backward_time = 13.099008, perf = 28.20 tflops.
start
start
start
start
block_info 220 53
block_info 208 46
block_info 320 133
cuda:1 process time:4.123687744140625, a: 0.84686279296875, b: 1.3837814331054688, c: 0.1709461212158203, d: 1.722097396850586
block_info 284 106
cuda:3 process time:4.005193710327148, a: 0.8547306060791016, b: 1.2812614440917969, c: 0.17642974853515625, d: 1.6927719116210938
1 wait time: 2.24
220
cuda:0 process time:4.253625869750977, a: 0.9016990661621094, b: 1.2164115905761719, c: 0.18525123596191406, d: 1.9502639770507812
3 wait time: 2.246
208
0 wait time: 2.43
320
cuda:2 process time:4.665374755859375, a: 0.8547306060791016, b: 1.184225082397461, c: 0.2071857452392578, d: 2.4192333221435547
2 wait time: 2.607
284
AG, 0.221154, 1.530880, 0 
perpare first forward gemm: 0.246,  fisrt gemm forward duration: 2.22
AG, 0.240909, 1.826816, 0 
perpare first forward gemm: 0.239,  fisrt gemm forward duration: 2.665
AG, 0.373239, 2.281472, 0 
perpare first forward gemm: 0.288,  fisrt gemm forward duration: 2.334
AG, 0.415625, 2.587648, 0 
perpare first forward gemm: 0.312,  fisrt gemm forward duration: 2.926
GA, 0.221154, 1.071104, 0 
GA, 0.240909, 1.810432, 0 
GA, 0.373239, 1.996800, 0 
GA, 0.415625, 2.564096, 0 
forward:  13.286
forward:  13.145
forward:  12.945
forward:  12.607
AG, 0.221154, 1.532928, 0 
AG, 0.240909, 1.812480, 0 
AG, 0.373239, 2.266112, 0 
AG, 0.415625, 2.595840, 0 
Linear 2 Backward: 3.311, second_gemm: 3.297
Linear 2 Backward: 3.876, second_gemm: 3.87
Linear 2 Backward: 4.591, second_gemm: 4.583
Linear 2 Backward: 4.673, second_gemm: 4.659
GA, 0.221154, 1.056768, 0 
GA, 0.240909, 1.720320, 0 
GA, 0.373239, 2.043904, 0 
GA, 0.415625, 2.443264, 0 
perpare first backward gemm: 0.028,  fisrt gemm backward duration: 4.127,  weight grad: 1.372,  other: 0.399
Linear 1 Backward:  5.959
perpare first backward gemm: 0.043,  fisrt gemm backward duration: 4.103,  weight grad: 1.421,  other: 0.402
Linear 1 Backward:  6.015
perpare first backward gemm: 0.031,  fisrt gemm backward duration: 3.109,  weight grad: 2.015,  other: 0.411
Linear 1 Backward:  5.602
perpare first backward gemm: 0.041,  fisrt gemm backward duration: 2.498,  weight grad: 2.241,  other: 0.433
Linear 1 Backward:  5.255
STEP-30: step_time = 29.559616 ms, foward_time = 16.225088, backward_time = 13.234176, perf = 27.90 tflops.
start
start
start
start
block_info 208 46
block_info 220 53
cuda:3 process time:3.6590099334716797, a: 0.7586479187011719, b: 1.2307167053222656, c: 0.11491775512695312, d: 1.554727554321289
block_info 284 106
3 wait time: 1.118
208
block_info 320 133
cuda:1 process time:4.581212997436523, a: 0.8664131164550781, b: 1.7590522766113281, c: 0.17976760864257812, d: 1.775979995727539
1 wait time: 2.182
220
cuda:0 process time:4.45246696472168, a: 0.8435249328613281, b: 1.089334487915039, c: 0.17309188842773438, d: 2.346515655517578
cuda:2 process time:4.869937896728516, a: 0.8802413940429688, b: 1.3878345489501953, c: 0.20837783813476562, d: 2.393484115600586
2 wait time: 2.526
284
0 wait time: 1.966
320
AG, 0.221154, 1.524736, 0 
perpare first forward gemm: 0.29,  fisrt gemm forward duration: 2.614
AG, 0.240909, 1.830912, 0 
perpare first forward gemm: 0.247,  fisrt gemm forward duration: 2.685
AG, 0.373239, 2.280448, 0 
perpare first forward gemm: 0.287,  fisrt gemm forward duration: 2.529
AG, 0.415625, 2.582528, 0 
perpare first forward gemm: 0.35,  fisrt gemm forward duration: 2.647
GA, 0.221154, 1.059840, 0 
GA, 0.240909, 1.792000, 0 
GA, 0.373239, 2.104320, 0 
GA, 0.415625, 2.488320, 0 
forward:  13.2
forward:  12.629
forward:  12.69
forward:  13.544
AG, 0.221154, 1.519616, 0 
AG, 0.240909, 1.827840, 0 
AG, 0.373239, 2.280448, 0 
AG, 0.415625, 2.585600, 0 
Linear 2 Backward: 3.131, second_gemm: 3.118
Linear 2 Backward: 3.666, second_gemm: 3.659
Linear 2 Backward: 4.448, second_gemm: 4.441
Linear 2 Backward: 4.55, second_gemm: 4.541
GA, 0.221154, 1.065984, 0 
GA, 0.240909, 1.806336, 0 
GA, 0.373239, 2.110464, 0 
GA, 0.415625, 2.531328, 0 
perpare first backward gemm: 0.043,  fisrt gemm backward duration: 4.17,  weight grad: 1.422,  other: 0.4
perpare first backward gemm: 0.023,  fisrt gemm backward duration: 4.176,  weight grad: 1.364,  other: 0.396
Linear 1 Backward:  5.987
Linear 1 Backward:  6.082
perpare first backward gemm: 0.031,  fisrt gemm backward duration: 3.093,  weight grad: 2.015,  other: 0.411
Linear 1 Backward:  5.586
perpare first backward gemm: 0.038,  fisrt gemm backward duration: 2.583,  weight grad: 2.234,  other: 0.423
Linear 1 Backward:  5.318
STEP-31: step_time = 28.721152 ms, foward_time = 15.689729, backward_time = 12.933120, perf = 28.71 tflops.
start
start
start
start
block_info 220 53
cuda:1 process time:4.159212112426758, a: 0.8080005645751953, b: 2.01416015625, c: 0.12755393981933594, d: 1.2094974517822266
block_info 208 46
cuda:3 process time:4.037141799926758, a: 0.7605552673339844, b: 1.4531612396240234, c: 0.13875961303710938, d: 1.6846656799316406
1 wait time: 1.763
220
block_info 284 106
3 wait time: 1.354
208
block_info 320 133
cuda:2 process time:5.090951919555664, a: 0.8533000946044922, b: 1.6477108001708984, c: 0.21600723266601562, d: 2.373933792114258
2 wait time: 2.542
284
cuda:0 process time:5.016803741455078, a: 0.9851455688476562, b: 1.115560531616211, c: 0.2129077911376953, d: 2.7031898498535156
0 wait time: 2.501
320
AG, 0.221154, 1.540096, 0 
perpare first forward gemm: 0.289,  fisrt gemm forward duration: 2.824
AG, 0.240909, 1.815552, 0 
perpare first forward gemm: 0.248,  fisrt gemm forward duration: 3.479
AG, 0.373239, 2.296832, 0 
perpare first forward gemm: 0.284,  fisrt gemm forward duration: 2.945
AG, 0.415625, 2.595840, 0 
perpare first forward gemm: 0.352,  fisrt gemm forward duration: 2.664
GA, 0.221154, 1.063936, 0 
GA, 0.240909, 1.818624, 0 
GA, 0.373239, 1.946624, 0 
GA, 0.415625, 2.485248, 0 
forward:  14.074
forward:  13.784
forward:  12.71
forward:  13.125
AG, 0.221154, 1.527808, 0 
AG, 0.240909, 1.801216, 0 
AG, 0.373239, 2.307072, 0 
Linear 2 Backward: 3.305, second_gemm: 3.296
AG, 0.415625, 2.594816, 0 
Linear 2 Backward: 3.683, second_gemm: 3.677
Linear 2 Backward: 4.537, second_gemm: 4.529
GA, 0.221154, 1.062912, 0 
Linear 2 Backward: 4.709, second_gemm: 4.695
GA, 0.240909, 1.794048, 0 
GA, 0.373239, 2.118656, 0 
GA, 0.415625, 2.537472, 0 
perpare first backward gemm: 0.033,  fisrt gemm backward duration: 4.506,  weight grad: 1.434,  other: 0.43
Linear 1 Backward:  6.452
perpare first backward gemm: 0.023,  fisrt gemm backward duration: 4.423,  weight grad: 1.367,  other: 0.398
Linear 1 Backward:  6.239
perpare first backward gemm: 0.031,  fisrt gemm backward duration: 3.297,  weight grad: 2.008,  other: 0.408
Linear 1 Backward:  5.781
perpare first backward gemm: 0.053,  fisrt gemm backward duration: 2.609,  weight grad: 2.297,  other: 0.477
Linear 1 Backward:  5.486
STEP-32: step_time = 29.731839 ms, foward_time = 16.350209, backward_time = 13.282304, perf = 27.74 tflops.
start
start
start
start
block_info 208 46
cuda:3 process time:3.7288665771484375, a: 0.93841552734375, b: 1.3802051544189453, c: 0.15282630920410156, d: 1.2574195861816406
block_info 220 53
3 wait time: 1.748
208
cuda:1 process time:4.739522933959961, a: 0.8189678192138672, b: 2.010345458984375, c: 0.17404556274414062, d: 1.7361640930175781
block_info 284 106
block_info 320 133
1 wait time: 2.174
220
cuda:2 process time:5.186319351196289, a: 0.8275508880615234, b: 1.6598701477050781, c: 0.23865699768066406, d: 2.4602413177490234
cuda:0 process time:5.057334899902344, a: 0.9851455688476562, b: 1.1548995971679688, c: 0.21219253540039062, d: 2.705097198486328
2 wait time: 2.417
284
0 wait time: 2.428
320
AG, 0.221154, 1.541120, 0 
perpare first forward gemm: 0.252,  fisrt gemm forward duration: 3.104
AG, 0.240909, 1.803264, 0 
perpare first forward gemm: 0.231,  fisrt gemm forward duration: 3.073
AG, 0.373239, 2.295808, 0 
perpare first forward gemm: 0.332,  fisrt gemm forward duration: 2.572
AG, 0.415625, 2.591744, 0 
perpare first forward gemm: 0.35,  fisrt gemm forward duration: 2.658
GA, 0.221154, 1.070080, 0 
GA, 0.240909, 1.802240, 0 
GA, 0.373239, 2.149376, 0 
GA, 0.415625, 2.450432, 0 
forward:  13.557
forward:  12.639
forward:  13.955
forward:  12.788
AG, 0.221154, 1.524736, 0 
AG, 0.240909, 1.821696, 0 
AG, 0.373239, 2.293760, 0 
Linear 2 Backward: 3.042, second_gemm: 3.035
AG, 0.415625, 2.583552, 0 
Linear 2 Backward: 3.51, second_gemm: 3.505
Linear 2 Backward: 4.172, second_gemm: 4.164
GA, 0.221154, 1.060864, 0 
Linear 2 Backward: 4.552, second_gemm: 4.543
GA, 0.240909, 1.814528, 0 
GA, 0.373239, 2.015232, 0 
GA, 0.415625, 2.586624, 0 
perpare first backward gemm: 0.023,  fisrt gemm backward duration: 4.246,  weight grad: 1.369,  other: 0.4
Linear 1 Backward:  6.067
perpare first backward gemm: 0.022,  fisrt gemm backward duration: 4.453,  weight grad: 1.408,  other: 0.4
Linear 1 Backward:  6.314
perpare first backward gemm: 0.031,  fisrt gemm backward duration: 3.164,  weight grad: 2.026,  other: 0.412
Linear 1 Backward:  5.67
perpare first backward gemm: 0.037,  fisrt gemm backward duration: 2.638,  weight grad: 2.236,  other: 0.429
Linear 1 Backward:  5.379
STEP-33: step_time = 28.910593 ms, foward_time = 16.111616, backward_time = 12.698624, perf = 28.52 tflops.
start
start
start
start
block_info 208 46
cuda:3 process time:3.8154125213623047, a: 0.8883476257324219, b: 1.51824951171875, c: 0.1323223114013672, d: 1.2764930725097656
block_info 284 106
3 wait time: 1.73
208
cuda:2 process time:4.262685775756836, a: 0.9353160858154297, b: 1.2631416320800781, c: 0.1494884490966797, d: 1.9147396087646484
2 wait time: 1.6
284
block_info 320 133
block_info 220 53
cuda:0 process time:5.31005859375, a: 0.9949207305908203, b: 1.2922286987304688, c: 0.2486705780029297, d: 2.7742385864257812
cuda:1 process time:5.86247444152832, a: 0.8723735809326172, b: 2.629995346069336, c: 0.29206275939941406, d: 2.068042755126953
0 wait time: 2.832
320
1 wait time: 3.615
220
AG, 0.221154, 1.524736, 0 
perpare first forward gemm: 0.25,  fisrt gemm forward duration: 4.021
AG, 0.240909, 1.830912, 0 
perpare first forward gemm: 0.253,  fisrt gemm forward duration: 1.887
AG, 0.373239, 2.291712, 0 
perpare first forward gemm: 0.337,  fisrt gemm forward duration: 4.17
AG, 0.415625, 2.578432, 0 
perpare first forward gemm: 0.361,  fisrt gemm forward duration: 3.086
GA, 0.221154, 1.059840, 0 
GA, 0.240909, 1.817600, 0 
GA, 0.373239, 2.258944, 0 
GA, 0.415625, 2.496512, 0 
forward:  12.56
forward:  14.894
forward:  14.452
forward:  13.105
AG, 0.221154, 1.521664, 0 
AG, 0.240909, 1.822720, 0 
AG, 0.373239, 2.284544, 0 
Linear 2 Backward: 3.266, second_gemm: 3.259
AG, 0.415625, 2.583552, 0 
Linear 2 Backward: 3.307, second_gemm: 3.301
Linear 2 Backward: 4.418, second_gemm: 4.41
GA, 0.221154, 1.048576, 0 
Linear 2 Backward: 4.707, second_gemm: 4.693
GA, 0.240909, 1.745920, 0 
GA, 0.373239, 2.176000, 0 
GA, 0.415625, 2.591744, 0 
perpare first backward gemm: 0.023,  fisrt gemm backward duration: 4.653,  weight grad: 1.41,  other: 0.402
Linear 1 Backward:  6.517
perpare first backward gemm: 0.023,  fisrt gemm backward duration: 4.429,  weight grad: 1.366,  other: 0.407
Linear 1 Backward:  6.254
perpare first backward gemm: 0.031,  fisrt gemm backward duration: 3.348,  weight grad: 2.009,  other: 0.413
Linear 1 Backward:  5.838
perpare first backward gemm: 0.053,  fisrt gemm backward duration: 2.661,  weight grad: 2.259,  other: 0.428
Linear 1 Backward:  5.451
STEP-34: step_time = 30.481409 ms, foward_time = 17.100799, backward_time = 13.278208, perf = 27.05 tflops.
start
start
start
start
block_info 220 53
block_info 208 46
cuda:3 process time:4.5337677001953125, a: 0.9262561798095703, b: 1.7473697662353516, c: 0.17595291137695312, d: 1.6841888427734375
cuda:1 process time:4.752635955810547, a: 0.7498264312744141, b: 2.0105838775634766, c: 0.18262863159179688, d: 1.8095970153808594
block_info 284 106
block_info 320 133
1 wait time: 1.974
220
3 wait time: 2.254
208
cuda:2 process time:4.832983016967773, a: 0.9672641754150391, b: 1.1792182922363281, c: 0.2071857452392578, d: 2.4793148040771484
cuda:0 process time:5.1517486572265625, a: 1.0101795196533203, b: 1.2049674987792969, c: 0.2143383026123047, d: 2.7222633361816406
2 wait time: 2.569
284
0 wait time: 2.466
320
AG, 0.221154, 1.521664, 0 
perpare first forward gemm: 0.241,  fisrt gemm forward duration: 2.574
AG, 0.240909, 1.829888, 0 
perpare first forward gemm: 0.239,  fisrt gemm forward duration: 2.964
AG, 0.373239, 2.275328, 0 
perpare first forward gemm: 0.284,  fisrt gemm forward duration: 2.638
AG, 0.415625, 2.599936, 0 
perpare first forward gemm: 0.304,  fisrt gemm forward duration: 2.652
GA, 0.221154, 1.061888, 0 
GA, 0.240909, 1.780736, 0 
GA, 0.373239, 2.177024, 0 
GA, 0.415625, 2.580480, 0 
forward:  13.62
forward:  12.741
forward:  12.909
forward:  13.588
AG, 0.221154, 1.481728, 0 
AG, 0.240909, 1.846272, 0 
AG, 0.373239, 2.283520, 0 
Linear 2 Backward: 3.598, second_gemm: 3.591
AG, 0.415625, 2.611200, 0 
Linear 2 Backward: 3.738, second_gemm: 3.723
Linear 2 Backward: 4.668, second_gemm: 4.66
GA, 0.221154, 1.048576, 0 
Linear 2 Backward: 4.764, second_gemm: 4.749
GA, 0.240909, 1.720320, 0 
GA, 0.373239, 2.078720, 0 
GA, 0.415625, 2.535424, 0 
perpare first backward gemm: 0.042,  fisrt gemm backward duration: 4.194,  weight grad: 1.366,  other: 0.402
Linear 1 Backward:  6.047
perpare first backward gemm: 0.022,  fisrt gemm backward duration: 4.691,  weight grad: 1.408,  other: 0.4
Linear 1 Backward:  6.55
perpare first backward gemm: 0.032,  fisrt gemm backward duration: 3.37,  weight grad: 1.995,  other: 0.408
Linear 1 Backward:  5.841
perpare first backward gemm: 0.055,  fisrt gemm backward duration: 2.595,  weight grad: 2.262,  other: 0.431
Linear 1 Backward:  5.396
STEP-35: step_time = 29.856768 ms, foward_time = 16.324608, backward_time = 13.431808, perf = 27.62 tflops.
start
start
start
start
block_info 208 46
block_info 284 106
block_info 220 53
cuda:3 process time:4.449129104614258, a: 0.8656978607177734, b: 1.3880729675292969, c: 0.18286705017089844, d: 2.012491226196289
block_info 320 133
cuda:2 process time:4.550695419311523, a: 0.8883476257324219, b: 1.079559326171875, c: 0.21982192993164062, d: 2.362966537475586
3 wait time: 1.697
208
cuda:1 process time:5.217075347900391, a: 0.8902549743652344, b: 1.7957687377929688, c: 0.20885467529296875, d: 2.3221969604492188
2 wait time: 2.469
284
cuda:0 process time:5.225181579589844, a: 0.9894371032714844, b: 1.619577407836914, c: 0.21266937255859375, d: 2.4034976959228516
1 wait time: 3.136
220
0 wait time: 3.091
320
AG, 0.221154, 1.534976, 0 
perpare first forward gemm: 0.285,  fisrt gemm forward duration: 2.592
AG, 0.240909, 1.815552, 0 
perpare first forward gemm: 0.249,  fisrt gemm forward duration: 2.526
AG, 0.373239, 2.285568, 0 
perpare first forward gemm: 0.301,  fisrt gemm forward duration: 3.025
AG, 0.415625, 2.589696, 0 
perpare first forward gemm: 0.356,  fisrt gemm forward duration: 2.656
GA, 0.221154, 1.049600, 0 
GA, 0.240909, 1.765376, 0 
GA, 0.373239, 2.213888, 0 
GA, 0.415625, 2.501632, 0 
forward:  13.101
forward:  13.2
forward:  13.528
forward:  12.734
AG, 0.221154, 1.518592, 0 
AG, 0.240909, 1.813504, 0 
AG, 0.373239, 2.358272, 0 
Linear 2 Backward: 3.22, second_gemm: 3.214
AG, 0.415625, 2.582528, 0 
Linear 2 Backward: 3.551, second_gemm: 3.545
Linear 2 Backward: 4.513, second_gemm: 4.506
GA, 0.221154, 1.046528, 0 
Linear 2 Backward: 4.717, second_gemm: 4.702
GA, 0.240909, 1.820672, 0 
GA, 0.373239, 2.248704, 0 
GA, 0.415625, 2.514944, 0 
perpare first backward gemm: 0.023,  fisrt gemm backward duration: 4.404,  weight grad: 1.365,  other: 0.399
Linear 1 Backward:  6.219
perpare first backward gemm: 0.023,  fisrt gemm backward duration: 4.612,  weight grad: 1.409,  other: 0.398
Linear 1 Backward:  6.469
perpare first backward gemm: 0.034,  fisrt gemm backward duration: 3.215,  weight grad: 1.997,  other: 0.417
Linear 1 Backward:  5.7
perpare first backward gemm: 0.055,  fisrt gemm backward duration: 2.587,  weight grad: 2.279,  other: 0.431
Linear 1 Backward:  5.404
STEP-36: step_time = 29.948351 ms, foward_time = 16.752064, backward_time = 13.095936, perf = 27.54 tflops.
start
start
start
start
block_info 320 133
block_info 220 53
cuda:0 process time:4.429101943969727, a: 0.7634162902832031, b: 1.6667842864990234, c: 0.12969970703125, d: 1.86920166015625
block_info 284 106
block_info 208 46
cuda:1 process time:4.992961883544922, a: 1.0211467742919922, b: 1.6465187072753906, c: 0.20837783813476562, d: 2.1169185638427734
0 wait time: 1.473
320
1 wait time: 2.89
220
cuda:2 process time:4.760265350341797, a: 0.9198188781738281, b: 1.1730194091796875, c: 0.20885467529296875, d: 2.4585723876953125
cuda:3 process time:5.007028579711914, a: 0.9467601776123047, b: 1.1250972747802734, c: 0.17213821411132812, d: 2.763032913208008
2 wait time: 2.484
284
3 wait time: 2.646
208
AG, 0.221154, 1.539072, 0 
perpare first forward gemm: 0.288,  fisrt gemm forward duration: 1.627
AG, 0.240909, 1.801216, 0 
perpare first forward gemm: 0.246,  fisrt gemm forward duration: 2.502
AG, 0.373239, 2.295808, 0 
perpare first forward gemm: 0.333,  fisrt gemm forward duration: 2.531
AG, 0.415625, 2.596864, 0 
perpare first forward gemm: 0.353,  fisrt gemm forward duration: 3.45
GA, 0.221154, 1.045504, 0 
GA, 0.240909, 1.781760, 0 
GA, 0.373239, 2.158592, 0 
GA, 0.415625, 2.613248, 0 
forward:  13.308
forward:  13.637
forward:  12.715
forward:  12.978
AG, 0.221154, 1.521664, 0 
AG, 0.240909, 1.819648, 0 
AG, 0.373239, 2.297856, 0 
Linear 2 Backward: 3.192, second_gemm: 3.186
AG, 0.415625, 2.598912, 0 
Linear 2 Backward: 3.182, second_gemm: 3.175
Linear 2 Backward: 4.254, second_gemm: 4.246
GA, 0.221154, 1.046528, 0 
Linear 2 Backward: 4.582, second_gemm: 4.573
GA, 0.240909, 1.788928, 0 
GA, 0.373239, 2.009088, 0 
GA, 0.415625, 2.527232, 0 
perpare first backward gemm: 0.023,  fisrt gemm backward duration: 4.21,  weight grad: 1.365,  other: 0.407
Linear 1 Backward:  6.035
perpare first backward gemm: 0.022,  fisrt gemm backward duration: 4.422,  weight grad: 1.414,  other: 0.4
Linear 1 Backward:  6.287
perpare first backward gemm: 0.032,  fisrt gemm backward duration: 3.122,  weight grad: 2.016,  other: 0.412
Linear 1 Backward:  5.617
perpare first backward gemm: 0.039,  fisrt gemm backward duration: 2.579,  weight grad: 2.257,  other: 0.428
Linear 1 Backward:  5.343
STEP-37: step_time = 28.912638 ms, foward_time = 16.027648, backward_time = 12.785664, perf = 28.52 tflops.
start
start
start
start
block_info 284 106
block_info 320 133
cuda:2 process time:4.022121429443359, a: 0.8208751678466797, b: 1.2929439544677734, c: 0.232696533203125, d: 1.6756057739257812
cuda:0 process time:3.9987564086914062, a: 0.7662773132324219, b: 1.359701156616211, c: 0.11968612670898438, d: 1.753091812133789
block_info 208 46
block_info 220 53
2 wait time: 1.759
284
0 wait time: 1.355
320
cuda:3 process time:4.799842834472656, a: 0.9636878967285156, b: 1.3651847839355469, c: 0.21338462829589844, d: 2.2575855255126953
cuda:1 process time:4.706859588623047, a: 0.9784698486328125, b: 1.2407302856445312, c: 0.21386146545410156, d: 2.2737979888916016
3 wait time: 2.36
1 wait time: 2.335
220
208
AG, 0.221154, 1.521664, 0 
perpare first forward gemm: 0.288,  fisrt gemm forward duration: 1.614
AG, 0.240909, 1.832960, 0 
perpare first forward gemm: 0.296,  fisrt gemm forward duration: 1.899
AG, 0.373239, 2.291712, 0 
perpare first forward gemm: 0.333,  fisrt gemm forward duration: 2.9
AG, 0.415625, 2.595840, 0 
perpare first forward gemm: 0.348,  fisrt gemm forward duration: 3.102
GA, 0.221154, 1.048576, 0 
GA, 0.240909, 1.799168, 0 
GA, 0.373239, 2.006016, 0 
GA, 0.415625, 2.603008, 0 
forward:  12.689
forward:  13.291
forward:  12.674
forward:  13.221
AG, 0.221154, 1.510400, 0 
AG, 0.240909, 1.820672, 0 
AG, 0.373239, 2.295808, 0 
Linear 2 Backward: 3.103, second_gemm: 3.097
AG, 0.415625, 2.592768, 0 
Linear 2 Backward: 3.232, second_gemm: 3.217
Linear 2 Backward: 4.117, second_gemm: 4.109
GA, 0.221154, 1.055744, 0 
Linear 2 Backward: 4.672, second_gemm: 4.663
GA, 0.240909, 1.731584, 0 
GA, 0.373239, 2.111488, 0 
GA, 0.415625, 2.434048, 0 
perpare first backward gemm: 0.041,  fisrt gemm backward duration: 3.873,  weight grad: 1.403,  other: 0.473
Linear 1 Backward:  5.855
perpare first backward gemm: 0.022,  fisrt gemm backward duration: 4.361,  weight grad: 1.407,  other: 0.414
Linear 1 Backward:  6.235
perpare first backward gemm: 0.032,  fisrt gemm backward duration: 3.049,  weight grad: 2.005,  other: 0.404
Linear 1 Backward:  5.522
perpare first backward gemm: 0.046,  fisrt gemm backward duration: 2.486,  weight grad: 2.238,  other: 0.426
Linear 1 Backward:  5.236
STEP-38: step_time = 28.367871 ms, foward_time = 15.622144, backward_time = 12.648448, perf = 29.07 tflops.
start
start
start
start
block_info 208 46
block_info 320 133
cuda:3 process time:3.44085693359375, a: 0.9510517120361328, b: 0.9963512420654297, c: 0.11301040649414062, d: 1.3804435729980469
cuda:0 process time:3.7610530853271484, a: 0.9825229644775391, b: 1.0867118835449219, c: 0.1201629638671875, d: 1.5716552734375
3 wait time: 1.257
208
block_info 284 106
0 wait time: 1.596
320
block_info 220 53
cuda:2 process time:4.675626754760742, a: 0.9255409240722656, b: 1.1970996856689453, c: 0.18978118896484375, d: 2.3632049560546875
cuda:1 process time:4.855871200561523, a: 0.9808540344238281, b: 1.3284683227539062, c: 0.213623046875, d: 2.332925796508789
2 wait time: 2.243
284
1 wait time: 2.363
220
AG, 0.221154, 1.540096, 0 
perpare first forward gemm: 0.287,  fisrt gemm forward duration: 2.885
AG, 0.240909, 1.842176, 0 
perpare first forward gemm: 0.295,  fisrt gemm forward duration: 1.909
AG, 0.373239, 2.283520, 0 
perpare first forward gemm: 0.33,  fisrt gemm forward duration: 2.381
AG, 0.415625, 2.626560, 0 
perpare first forward gemm: 0.353,  fisrt gemm forward duration: 3.579
GA, 0.221154, 1.067008, 0 
GA, 0.240909, 1.802240, 0 
GA, 0.373239, 2.105344, 0 
GA, 0.415625, 2.549760, 0 
forward:  12.654
forward:  12.751
forward:  13.906
forward:  13.621
AG, 0.221154, 1.516544, 0 
AG, 0.240909, 1.835008, 0 
AG, 0.373239, 2.273280, 0 
Linear 2 Backward: 3.06, second_gemm: 3.054
AG, 0.415625, 2.641920, 0 
Linear 2 Backward: 3.239, second_gemm: 3.224
Linear 2 Backward: 4.4, second_gemm: 4.394
GA, 0.221154, 1.047552, 0 
Linear 2 Backward: 4.859, second_gemm: 4.85
GA, 0.240909, 1.831936, 0 
GA, 0.373239, 2.068480, 0 
GA, 0.415625, 2.459648, 0 
perpare first backward gemm: 0.041,  fisrt gemm backward duration: 3.933,  weight grad: 1.408,  other: 0.452
Linear 1 Backward:  5.879
perpare first backward gemm: 0.022,  fisrt gemm backward duration: 4.423,  weight grad: 1.411,  other: 0.399
Linear 1 Backward:  6.285
perpare first backward gemm: 0.028,  fisrt gemm backward duration: 3.191,  weight grad: 1.986,  other: 0.398
Linear 1 Backward:  5.631
perpare first backward gemm: 0.039,  fisrt gemm backward duration: 2.511,  weight grad: 2.237,  other: 0.425
Linear 1 Backward:  5.25
STEP-39: step_time = 29.239295 ms, foward_time = 16.296959, backward_time = 12.843008, perf = 28.20 tflops.
start
start
start
start
block_info 208 46
block_info 284 106
block_info 320 133
cuda:3 process time:3.899097442626953, a: 0.7953643798828125, b: 1.2903213500976562, c: 0.13828277587890625, d: 1.6751289367675781
block_info 220 53
cuda:0 process time:4.151344299316406, a: 0.7815361022949219, b: 1.424551010131836, c: 0.12564659118652344, d: 1.819610595703125
cuda:2 process time:4.234075546264648, a: 0.9200572967529297, b: 1.3461112976074219, c: 0.1761913299560547, d: 1.7917156219482422
3 wait time: 1.495
208
cuda:1 process time:4.305601119995117, a: 0.8585453033447266, b: 1.3263225555419922, c: 0.2186298370361328, d: 1.9021034240722656
0 wait time: 1.408
320
2 wait time: 1.989
284
1 wait time: 1.906
220
AG, 0.221154, 1.530880, 0 
perpare first forward gemm: 0.286,  fisrt gemm forward duration: 2.038
AG, 0.240909, 1.837056, 0 
perpare first forward gemm: 0.295,  fisrt gemm forward duration: 1.905
AG, 0.373239, 2.288640, 0 
perpare first forward gemm: 0.329,  fisrt gemm forward duration: 2.494
AG, 0.415625, 2.606080, 0 
perpare first forward gemm: 0.355,  fisrt gemm forward duration: 2.781
GA, 0.221154, 1.049600, 0 
GA, 0.240909, 1.811456, 0 
GA, 0.373239, 2.226176, 0 
GA, 0.415625, 2.554880, 0 
forward:  12.722
forward:  12.895
forward:  13.115
forward:  12.979
AG, 0.221154, 1.487872, 0 
AG, 0.240909, 1.854464, 0 
AG, 0.373239, 2.277376, 0 
Linear 2 Backward: 3.116, second_gemm: 3.109
AG, 0.415625, 2.621440, 0 
Linear 2 Backward: 3.262, second_gemm: 3.247
Linear 2 Backward: 4.348, second_gemm: 4.341
GA, 0.221154, 1.044480, 0 
Linear 2 Backward: 4.737, second_gemm: 4.728
GA, 0.240909, 1.838080, 0 
GA, 0.373239, 2.227200, 0 
GA, 0.415625, 2.459648, 0 
perpare first backward gemm: 0.022,  fisrt gemm backward duration: 4.459,  weight grad: 1.408,  other: 0.398
Linear 1 Backward:  6.326
perpare first backward gemm: 0.041,  fisrt gemm backward duration: 3.93,  weight grad: 1.407,  other: 0.475
Linear 1 Backward:  5.92
perpare first backward gemm: 0.029,  fisrt gemm backward duration: 3.187,  weight grad: 2.022,  other: 0.405
Linear 1 Backward:  5.672
perpare first backward gemm: 0.045,  fisrt gemm backward duration: 2.511,  weight grad: 2.285,  other: 0.431
Linear 1 Backward:  5.311
STEP-40: step_time = 28.218369 ms, foward_time = 15.293440, backward_time = 12.826624, perf = 29.22 tflops.
start
start
start
start
block_info 208 46
cuda:3 process time:3.6804676055908203, a: 0.9224414825439453, b: 1.1620521545410156, c: 0.12063980102539062, d: 1.4753341674804688
block_info 320 133
block_info 284 106
block_info 220 53
3 wait time: 1.256
208
cuda:0 process time:4.065036773681641, a: 0.7672309875488281, b: 1.4209747314453125, c: 0.11920928955078125, d: 1.7576217651367188
cuda:2 process time:4.26483154296875, a: 0.9074211120605469, b: 1.2879371643066406, c: 0.17642974853515625, d: 1.8930435180664062
cuda:1 process time:4.2514801025390625, a: 0.8633136749267578, b: 1.2445449829101562, c: 0.17452239990234375, d: 1.9690990447998047
0 wait time: 1.262
320
2 wait time: 1.747
284
1 wait time: 1.739
220
AG, 0.221154, 1.530880, 0 
perpare first forward gemm: 0.285,  fisrt gemm forward duration: 2.386
AG, 0.240909, 1.836032, 0 
perpare first forward gemm: 0.294,  fisrt gemm forward duration: 1.976
AG, 0.373239, 2.289664, 0 
perpare first forward gemm: 0.334,  fisrt gemm forward duration: 2.354
AG, 0.415625, 2.607104, 0 
perpare first forward gemm: 0.356,  fisrt gemm forward duration: 2.848
GA, 0.221154, 1.067008, 0 
GA, 0.240909, 1.756160, 0 
GA, 0.373239, 2.104320, 0 
GA, 0.415625, 2.460672, 0 
forward:  12.688
forward:  12.653
forward:  13.338
forward:  12.916
AG, 0.221154, 1.503232, 0 
AG, 0.240909, 1.856512, 0 
AG, 0.373239, 2.281472, 0 
Linear 2 Backward: 3.01, second_gemm: 3.004
AG, 0.415625, 2.619392, 0 
Linear 2 Backward: 3.274, second_gemm: 3.267
Linear 2 Backward: 4.214, second_gemm: 4.207
GA, 0.221154, 1.043456, 0 
Linear 2 Backward: 4.624, second_gemm: 4.615
GA, 0.240909, 1.736704, 0 
GA, 0.373239, 2.008064, 0 
GA, 0.415625, 2.515968, 0 
perpare first backward gemm: 0.023,  fisrt gemm backward duration: 4.202,  weight grad: 1.364,  other: 0.399
Linear 1 Backward:  6.017
perpare first backward gemm: 0.022,  fisrt gemm backward duration: 4.475,  weight grad: 1.413,  other: 0.4
Linear 1 Backward:  6.34
perpare first backward gemm: 0.027,  fisrt gemm backward duration: 3.215,  weight grad: 2.008,  other: 0.4
Linear 1 Backward:  5.679
perpare first backward gemm: 0.038,  fisrt gemm backward duration: 2.568,  weight grad: 2.261,  other: 0.428
Linear 1 Backward:  5.333
STEP-41: step_time = 27.994113 ms, foward_time = 15.159297, backward_time = 12.735488, perf = 29.46 tflops.
start
start
start
start
block_info 320 133
block_info 220 53
block_info 208 46
cuda:0 process time:4.136085510253906, a: 0.7610321044921875, b: 1.5056133270263672, c: 0.118255615234375, d: 1.7511844635009766
cuda:1 process time:4.170417785644531, a: 0.9756088256835938, b: 1.1806488037109375, c: 0.15354156494140625, d: 1.8606185913085938
block_info 284 106
cuda:3 process time:4.555463790893555, a: 0.7693767547607422, b: 1.6160011291503906, c: 0.1862049102783203, d: 1.9838809967041016
0 wait time: 1.377
320
1 wait time: 1.483
220
3 wait time: 2.096
208
cuda:2 process time:4.932403564453125, a: 0.9763240814208984, b: 1.4829635620117188, c: 0.20623207092285156, d: 2.2668838500976562
2 wait time: 2.913
284
AG, 0.221154, 1.529856, 0 
perpare first forward gemm: 0.287,  fisrt gemm forward duration: 2.217
AG, 0.240909, 1.839104, 0 
perpare first forward gemm: 0.295,  fisrt gemm forward duration: 2.865
AG, 0.373239, 2.300928, 0 
perpare first forward gemm: 0.334,  fisrt gemm forward duration: 2.366
AG, 0.415625, 2.616320, 0 
perpare first forward gemm: 0.354,  fisrt gemm forward duration: 3.536
GA, 0.221154, 1.051648, 0 
GA, 0.240909, 1.747968, 0 
GA, 0.373239, 2.208768, 0 
GA, 0.415625, 2.622464, 0 
forward:  13.374
forward:  12.906
forward:  13.749
forward:  13.8
AG, 0.221154, 1.528832, 0 
AG, 0.240909, 1.840128, 0 
AG, 0.373239, 2.300928, 0 
Linear 2 Backward: 3.097, second_gemm: 3.09
AG, 0.415625, 2.611200, 0 
Linear 2 Backward: 3.285, second_gemm: 3.278
Linear 2 Backward: 4.23, second_gemm: 4.224
GA, 0.221154, 1.036288, 0 
Linear 2 Backward: 4.586, second_gemm: 4.577
GA, 0.240909, 1.794048, 0 
GA, 0.373239, 2.170880, 0 
GA, 0.415625, 2.499584, 0 
perpare first backward gemm: 0.023,  fisrt gemm backward duration: 4.15,  weight grad: 1.363,  other: 0.399
Linear 1 Backward:  5.964
perpare first backward gemm: 0.022,  fisrt gemm backward duration: 4.383,  weight grad: 1.408,  other: 0.394
Linear 1 Backward:  6.237
perpare first backward gemm: 0.028,  fisrt gemm backward duration: 3.134,  weight grad: 2.006,  other: 0.405
Linear 1 Backward:  5.602
perpare first backward gemm: 0.037,  fisrt gemm backward duration: 2.551,  weight grad: 2.256,  other: 0.43
Linear 1 Backward:  5.313
STEP-42: step_time = 28.893185 ms, foward_time = 16.082943, backward_time = 12.709888, perf = 28.54 tflops.
start
start
start
start
block_info 208 46
block_info 320 133
block_info 220 53
block_info 284 106
cuda:3 process time:4.324436187744141, a: 1.0020732879638672, b: 1.3670921325683594, c: 0.18286705017089844, d: 1.7724037170410156
cuda:0 process time:4.859447479248047, a: 0.7965564727783203, b: 1.680135726928711, c: 0.1728534698486328, d: 2.209901809692383
3 wait time: 2.355
cuda:1 process time:4.874706268310547, a: 0.9813308715820312, b: 1.383066177368164, c: 0.21338462829589844, d: 2.296924591064453
208
cuda:2 process time:5.249738693237305, a: 0.9748935699462891, b: 1.7840862274169922, c: 0.20623207092285156, d: 2.284526824951172
0 wait time: 2.141
320
1 wait time: 2.479
220
2 wait time: 2.974
284
AG, 0.221154, 1.528832, 0 
perpare first forward gemm: 0.29,  fisrt gemm forward duration: 2.285
AG, 0.240909, 1.827840, 0 
perpare first forward gemm: 0.312,  fisrt gemm forward duration: 2.074
AG, 0.373239, 2.297856, 0 
perpare first forward gemm: 0.357,  fisrt gemm forward duration: 2.352
AG, 0.415625, 2.589696, 0 
perpare first forward gemm: 0.353,  fisrt gemm forward duration: 2.955
GA, 0.221154, 1.060864, 0 
GA, 0.240909, 1.727488, 0 
GA, 0.373239, 2.210816, 0 
GA, 0.415625, 2.593792, 0 
forward:  12.782
forward:  13.356
forward:  12.857
forward:  13.099
AG, 0.221154, 1.536000, 0 
AG, 0.240909, 1.844224, 0 
AG, 0.373239, 2.292736, 0 
Linear 2 Backward: 3.051, second_gemm: 3.045
AG, 0.415625, 2.607104, 0 
Linear 2 Backward: 3.213, second_gemm: 3.198
Linear 2 Backward: 4.424, second_gemm: 4.418
GA, 0.221154, 1.048576, 0 
Linear 2 Backward: 4.783, second_gemm: 4.775
GA, 0.240909, 1.748992, 0 
GA, 0.373239, 2.109440, 0 
GA, 0.415625, 2.480128, 0 
perpare first backward gemm: 0.021,  fisrt gemm backward duration: 4.364,  weight grad: 1.406,  other: 0.4
Linear 1 Backward:  6.22
perpare first backward gemm: 0.04,  fisrt gemm backward duration: 3.932,  weight grad: 1.401,  other: 0.401
Linear 1 Backward:  5.819
perpare first backward gemm: 0.028,  fisrt gemm backward duration: 3.123,  weight grad: 2.019,  other: 0.404
Linear 1 Backward:  5.609
perpare first backward gemm: 0.038,  fisrt gemm backward duration: 2.531,  weight grad: 2.235,  other: 0.438
Linear 1 Backward:  5.282
STEP-43: step_time = 29.051903 ms, foward_time = 16.150528, backward_time = 12.802048, perf = 28.38 tflops.
start
start
start
start
block_info 320 133
block_info 208 46
cuda:0 process time:4.047870635986328, a: 0.7665157318115234, b: 1.5375614166259766, c: 0.11110305786132812, d: 1.6326904296875
block_info 220 53
block_info 284 106
cuda:3 process time:4.375457763671875, a: 0.9448528289794922, b: 1.2676715850830078, c: 0.171661376953125, d: 1.99127197265625
0 wait time: 1.195
320
cuda:1 process time:4.577398300170898, a: 0.972747802734375, b: 1.2328624725341797, c: 0.19621849060058594, d: 2.175569534301758
3 wait time: 1.846
208
cuda:2 process time:4.932165145874023, a: 0.92315673828125, b: 1.3279914855957031, c: 0.20837783813476562, d: 2.4726390838623047
1 wait time: 2.323
220
2 wait time: 2.553
284
AG, 0.221154, 1.522688, 0 
perpare first forward gemm: 0.308,  fisrt gemm forward duration: 2.117
AG, 0.240909, 1.831936, 0 
perpare first forward gemm: 0.252,  fisrt gemm forward duration: 2.171
AG, 0.373239, 2.298880, 0 
perpare first forward gemm: 0.281,  fisrt gemm forward duration: 2.352
AG, 0.415625, 2.598912, 0 
perpare first forward gemm: 0.349,  fisrt gemm forward duration: 3.395
GA, 0.221154, 1.052672, 0 
GA, 0.240909, 1.790976, 0 
GA, 0.373239, 2.166784, 0 
GA, 0.415625, 2.551808, 0 
forward:  13.149
forward:  12.616
forward:  12.845
forward:  13.448
AG, 0.221154, 1.530880, 0 
AG, 0.240909, 1.821696, 0 
AG, 0.373239, 2.270208, 0 
Linear 2 Backward: 3.043, second_gemm: 3.036
AG, 0.415625, 2.579456, 0 
Linear 2 Backward: 3.239, second_gemm: 3.232
Linear 2 Backward: 4.207, second_gemm: 4.2
GA, 0.221154, 1.042432, 0 
Linear 2 Backward: 4.544, second_gemm: 4.535
GA, 0.240909, 1.803264, 0 
GA, 0.373239, 2.109440, 0 
GA, 0.415625, 2.478080, 0 
perpare first backward gemm: 0.022,  fisrt gemm backward duration: 4.134,  weight grad: 1.365,  other: 0.407
Linear 1 Backward:  5.958
perpare first backward gemm: 0.022,  fisrt gemm backward duration: 4.342,  weight grad: 1.408,  other: 0.401
Linear 1 Backward:  6.202
perpare first backward gemm: 0.028,  fisrt gemm backward duration: 3.132,  weight grad: 1.99,  other: 0.4
Linear 1 Backward:  5.58
perpare first backward gemm: 0.038,  fisrt gemm backward duration: 2.539,  weight grad: 2.235,  other: 0.429
Linear 1 Backward:  5.281
STEP-44: step_time = 28.446719 ms, foward_time = 15.697921, backward_time = 12.649472, perf = 28.99 tflops.
start
start
start
start
block_info 320 133
block_info 284 106
cuda:0 process time:3.6461353302001953, a: 0.6434917449951172, b: 1.2159347534179688, c: 0.11420249938964844, d: 1.672506332397461
block_info 220 53
block_info 208 46
cuda:2 process time:4.149675369262695, a: 0.92315673828125, b: 1.1692047119140625, c: 0.15807151794433594, d: 1.8992424011230469
0 wait time: 1.368
320
2 wait time: 2.006
284
cuda:3 process time:4.641056060791016, a: 0.9043216705322266, b: 1.314401626586914, c: 0.24175643920898438, d: 2.1805763244628906
cuda:1 process time:4.699230194091797, a: 0.9438991546630859, b: 1.4235973358154297, c: 0.20837783813476562, d: 2.1233558654785156
3 wait time: 2.265
208
1 wait time: 2.812
220
AG, 0.221154, 1.518592, 0 
perpare first forward gemm: 0.287,  fisrt gemm forward duration: 1.607
AG, 0.240909, 1.831936, 0 
perpare first forward gemm: 0.267,  fisrt gemm forward duration: 1.965
AG, 0.373239, 2.293760, 0 
perpare first forward gemm: 0.353,  fisrt gemm forward duration: 2.777
AG, 0.415625, 2.605056, 0 
perpare first forward gemm: 0.359,  fisrt gemm forward duration: 3.309
GA, 0.221154, 1.053696, 0 
GA, 0.240909, 1.792000, 0 
GA, 0.373239, 2.148352, 0 
GA, 0.415625, 2.533376, 0 
forward:  12.703
forward:  12.689
forward:  13.192
forward:  13.521
AG, 0.221154, 1.539072, 0 
AG, 0.240909, 1.821696, 0 
AG, 0.373239, 2.298880, 0 
Linear 2 Backward: 3.06, second_gemm: 3.054
AG, 0.415625, 2.604032, 0 
Linear 2 Backward: 3.246, second_gemm: 3.24
Linear 2 Backward: 4.227, second_gemm: 4.22
GA, 0.221154, 1.052672, 0 
Linear 2 Backward: 4.598, second_gemm: 4.59
GA, 0.240909, 1.806336, 0 
GA, 0.373239, 2.171904, 0 
GA, 0.415625, 2.603008, 0 
perpare first backward gemm: 0.022,  fisrt gemm backward duration: 4.515,  weight grad: 1.405,  other: 0.411
Linear 1 Backward:  6.383
perpare first backward gemm: 0.022,  fisrt gemm backward duration: 4.318,  weight grad: 1.377,  other: 0.401
Linear 1 Backward:  6.149
perpare first backward gemm: 0.028,  fisrt gemm backward duration: 3.258,  weight grad: 2.031,  other: 0.404
Linear 1 Backward:  5.75
perpare first backward gemm: 0.038,  fisrt gemm backward duration: 2.667,  weight grad: 2.279,  other: 0.429
Linear 1 Backward:  5.453
STEP-45: step_time = 28.881920 ms, foward_time = 15.931393, backward_time = 12.849152, perf = 28.55 tflops.
start
start
start
start
block_info 320 133
cuda:0 process time:4.329919815063477, a: 0.7581710815429688, b: 1.6703605651855469, c: 0.12373924255371094, d: 1.77764892578125
block_info 220 53
block_info 284 106
0 wait time: 1.385
320
block_info 208 46
cuda:1 process time:4.614830017089844, a: 0.9779930114746094, b: 1.2166500091552734, c: 0.19979476928710938, d: 2.2203922271728516
cuda:2 process time:4.952669143676758, a: 0.9355545043945312, b: 1.329183578491211, c: 0.20647048950195312, d: 2.4814605712890625
1 wait time: 2.243
220
cuda:3 process time:5.400896072387695, a: 0.7560253143310547, b: 1.9097328186035156, c: 0.2257823944091797, d: 2.5093555450439453
2 wait time: 2.574
284
3 wait time: 2.626
208
AG, 0.221154, 1.526784, 0 
perpare first forward gemm: 0.237,  fisrt gemm forward duration: 1.6
AG, 0.240909, 1.830912, 0 
perpare first forward gemm: 0.257,  fisrt gemm forward duration: 2.283
AG, 0.373239, 2.294784, 0 
perpare first forward gemm: 0.283,  fisrt gemm forward duration: 2.463
AG, 0.415625, 2.612224, 0 
perpare first forward gemm: 0.39,  fisrt gemm forward duration: 3.507
GA, 0.221154, 1.071104, 0 
GA, 0.240909, 1.790976, 0 
GA, 0.373239, 2.119680, 0 
GA, 0.415625, 2.604032, 0 
forward:  13.073
forward:  12.632
forward:  12.866
forward:  13.753
AG, 0.221154, 1.514496, 0 
AG, 0.240909, 1.824768, 0 
AG, 0.373239, 2.299904, 0 
Linear 2 Backward: 3.035, second_gemm: 3.028
AG, 0.415625, 2.589696, 0 
Linear 2 Backward: 3.242, second_gemm: 3.235
Linear 2 Backward: 4.253, second_gemm: 4.246
GA, 0.221154, 1.042432, 0 
Linear 2 Backward: 4.596, second_gemm: 4.588
GA, 0.240909, 1.734656, 0 
GA, 0.373239, 2.231296, 0 
GA, 0.415625, 2.451456, 0 
perpare first backward gemm: 0.022,  fisrt gemm backward duration: 4.377,  weight grad: 1.41,  other: 0.401
Linear 1 Backward:  6.239
perpare first backward gemm: 0.023,  fisrt gemm backward duration: 4.142,  weight grad: 1.375,  other: 0.406
Linear 1 Backward:  5.979
perpare first backward gemm: 0.028,  fisrt gemm backward duration: 3.09,  weight grad: 2.003,  other: 0.401
Linear 1 Backward:  5.552
perpare first backward gemm: 0.038,  fisrt gemm backward duration: 2.502,  weight grad: 2.259,  other: 0.426
Linear 1 Backward:  5.264
STEP-46: step_time = 28.830722 ms, foward_time = 16.050175, backward_time = 12.681216, perf = 28.60 tflops.
start
start
start
start
block_info 220 53
block_info 320 133
cuda:1 process time:3.9184093475341797, a: 0.8525848388671875, b: 1.505136489868164, c: 0.12612342834472656, d: 1.4345645904541016
cuda:0 process time:3.8726329803466797, a: 0.7371902465820312, b: 1.3766288757324219, c: 0.10967254638671875, d: 1.6491413116455078
1 wait time: 1.543
220
block_info 208 46
0 wait time: 1.258
320
block_info 284 106
cuda:3 process time:4.699468612670898, a: 0.957489013671875, b: 1.201629638671875, c: 0.21910667419433594, d: 2.3212432861328125
cuda:2 process time:5.135774612426758, a: 0.911712646484375, b: 1.5425682067871094, c: 0.2086162567138672, d: 2.4728775024414062
3 wait time: 2.367
208
2 wait time: 2.563
284
AG, 0.221154, 1.517568, 0 
perpare first forward gemm: 0.241,  fisrt gemm forward duration: 1.791
AG, 0.240909, 1.823744, 0 
perpare first forward gemm: 0.268,  fisrt gemm forward duration: 3.181
AG, 0.373239, 2.293760, 0 
perpare first forward gemm: 0.281,  fisrt gemm forward duration: 2.346
AG, 0.415625, 2.598912, 0 
perpare first forward gemm: 0.359,  fisrt gemm forward duration: 3.541
GA, 0.221154, 1.054720, 0 
GA, 0.240909, 1.799168, 0 
GA, 0.373239, 2.070528, 0 
GA, 0.415625, 2.532352, 0 
forward:  12.756
forward:  12.632
forward:  13.864
forward:  13.653
AG, 0.221154, 1.491968, 0 
AG, 0.240909, 1.852416, 0 
AG, 0.373239, 2.273280, 0 
Linear 2 Backward: 2.92, second_gemm: 2.913
AG, 0.415625, 2.610176, 0 
Linear 2 Backward: 3.219, second_gemm: 3.208
Linear 2 Backward: 4.106, second_gemm: 4.099
GA, 0.221154, 1.048576, 0 
Linear 2 Backward: 4.599, second_gemm: 4.59
GA, 0.240909, 1.735680, 0 
GA, 0.373239, 2.099200, 0 
GA, 0.415625, 2.509824, 0 
perpare first backward gemm: 0.034,  fisrt gemm backward duration: 4.128,  weight grad: 1.383,  other: 0.398
Linear 1 Backward:  5.974
perpare first backward gemm: 0.022,  fisrt gemm backward duration: 4.452,  weight grad: 1.408,  other: 0.399
Linear 1 Backward:  6.31
perpare first backward gemm: 0.028,  fisrt gemm backward duration: 3.179,  weight grad: 2.002,  other: 0.403
Linear 1 Backward:  5.641
perpare first backward gemm: 0.038,  fisrt gemm backward duration: 2.562,  weight grad: 2.258,  other: 0.431
Linear 1 Backward:  5.327
STEP-47: step_time = 28.830720 ms, foward_time = 15.972352, backward_time = 12.758016, perf = 28.60 tflops.
start
start
start
start
block_info 284 106
block_info 220 53
cuda:2 process time:3.881216049194336, a: 0.7627010345458984, b: 1.4274120330810547, c: 0.1163482666015625, d: 1.5747547149658203
block_info 320 133
cuda:1 process time:3.7682056427001953, a: 0.7770061492919922, b: 1.1913776397705078, c: 0.1399517059326172, d: 1.6598701477050781
block_info 208 46
2 wait time: 1.389
284
cuda:0 process time:4.037618637084961, a: 0.7550716400146484, b: 1.2111663818359375, c: 0.13899803161621094, d: 1.932382583618164
1 wait time: 1.447
220
cuda:3 process time:4.642248153686523, a: 0.9675025939941406, b: 1.3213157653808594, c: 0.20003318786621094, d: 2.1533966064453125
0 wait time: 1.689
320
3 wait time: 2.216
208
AG, 0.221154, 1.514496, 0 
perpare first forward gemm: 0.237,  fisrt gemm forward duration: 1.587
AG, 0.240909, 1.847296, 0 
perpare first forward gemm: 0.253,  fisrt gemm forward duration: 2.552
AG, 0.373239, 2.276352, 0 
perpare first forward gemm: 0.282,  fisrt gemm forward duration: 3.08
AG, 0.415625, 2.613248, 0 
perpare first forward gemm: 0.302,  fisrt gemm forward duration: 2.811
GA, 0.221154, 1.068032, 0 
GA, 0.240909, 1.810432, 0 
GA, 0.373239, 2.080768, 0 
GA, 0.415625, 2.571264, 0 
forward:  13.173
forward:  12.567
forward:  12.839
forward:  13.458
AG, 0.221154, 1.542144, 0 
AG, 0.240909, 1.817600, 0 
AG, 0.373239, 2.300928, 0 
Linear 2 Backward: 3.155, second_gemm: 3.148
AG, 0.415625, 2.596864, 0 
Linear 2 Backward: 3.352, second_gemm: 3.345
Linear 2 Backward: 4.229, second_gemm: 4.223
GA, 0.221154, 1.053696, 0 
Linear 2 Backward: 4.558, second_gemm: 4.549
GA, 0.240909, 1.823744, 0 
GA, 0.373239, 2.099200, 0 
GA, 0.415625, 2.581504, 0 
perpare first backward gemm: 0.022,  fisrt gemm backward duration: 4.431,  weight grad: 1.407,  other: 0.402
Linear 1 Backward:  6.292
perpare first backward gemm: 0.023,  fisrt gemm backward duration: 4.251,  weight grad: 1.363,  other: 0.397
Linear 1 Backward:  6.063
perpare first backward gemm: 0.028,  fisrt gemm backward duration: 3.181,  weight grad: 2.012,  other: 0.403
Linear 1 Backward:  5.652
perpare first backward gemm: 0.038,  fisrt gemm backward duration: 2.633,  weight grad: 2.235,  other: 0.433
Linear 1 Backward:  5.385
STEP-48: step_time = 28.363777 ms, foward_time = 15.590400, backward_time = 12.674048, perf = 29.07 tflops.
start
start
start
start
block_info 220 53
block_info 320 133
cuda:1 process time:4.039764404296875, a: 0.8082389831542969, b: 1.5821456909179688, c: 0.14591217041015625, d: 1.5034675598144531
block_info 208 46
block_info 284 106
1 wait time: 1.729
220
cuda:0 process time:4.413843154907227, a: 0.7426738739013672, b: 1.6875267028808594, c: 0.13446807861328125, d: 1.8491744995117188
cuda:3 process time:4.343509674072266, a: 0.9989738464355469, b: 1.0879039764404297, c: 0.18548965454101562, d: 2.0711421966552734
cuda:2 process time:4.685163497924805, a: 0.7643699645996094, b: 1.6679763793945312, c: 0.1678466796875, d: 2.084970474243164
0 wait time: 1.488
320
3 wait time: 1.859
208
2 wait time: 2.019
284
AG, 0.221154, 1.528832, 0 
perpare first forward gemm: 0.249,  fisrt gemm forward duration: 1.844
AG, 0.240909, 1.833984, 0 
perpare first forward gemm: 0.257,  fisrt gemm forward duration: 2.745
AG, 0.373239, 2.288640, 0 
perpare first forward gemm: 0.283,  fisrt gemm forward duration: 2.341
AG, 0.415625, 2.595840, 0 
perpare first forward gemm: 0.333,  fisrt gemm forward duration: 2.968
GA, 0.221154, 1.051648, 0 
GA, 0.240909, 1.758208, 0 
GA, 0.373239, 2.182144, 0 
GA, 0.415625, 2.566144, 0 
forward:  13.379
forward:  12.665
forward:  12.808
forward:  13.018
AG, 0.221154, 1.527808, 0 
AG, 0.240909, 1.822720, 0 
AG, 0.373239, 2.279424, 0 
Linear 2 Backward: 3.248, second_gemm: 3.242
AG, 0.415625, 2.580480, 0 
Linear 2 Backward: 3.468, second_gemm: 3.461
Linear 2 Backward: 4.449, second_gemm: 4.442
GA, 0.221154, 1.059840, 0 
Linear 2 Backward: 4.554, second_gemm: 4.545
GA, 0.240909, 1.802240, 0 
GA, 0.373239, 2.128896, 0 
GA, 0.415625, 2.576384, 0 
perpare first backward gemm: 0.023,  fisrt gemm backward duration: 4.265,  weight grad: 1.365,  other: 0.397
Linear 1 Backward:  6.078
perpare first backward gemm: 0.022,  fisrt gemm backward duration: 4.479,  weight grad: 1.418,  other: 0.399
Linear 1 Backward:  6.349
perpare first backward gemm: 0.028,  fisrt gemm backward duration: 3.244,  weight grad: 1.985,  other: 0.399
Linear 1 Backward:  5.685
perpare first backward gemm: 0.042,  fisrt gemm backward duration: 2.644,  weight grad: 2.236,  other: 0.426
Linear 1 Backward:  5.388
STEP-49: step_time = 28.510208 ms, foward_time = 15.481855, backward_time = 12.929024, perf = 28.92 tflops.
start
start
start
start
block_info 320 133
block_info 284 106
block_info 220 53
block_info 208 46
cuda:2 process time:4.1103363037109375, a: 0.7512569427490234, b: 1.581430435180664, c: 0.12040138244628906, d: 1.657247543334961
cuda:0 process time:4.016399383544922, a: 0.9844303131103516, b: 1.0840892791748047, c: 0.13113021850585938, d: 1.8167495727539062
cuda:1 process time:4.331111907958984, a: 0.7886886596679688, b: 1.405954360961914, c: 0.17023086547851562, d: 1.966238021850586
2 wait time: 1.241
284
0 wait time: 1.617
320
cuda:3 process time:4.31513786315918, a: 0.9353160858154297, b: 1.0936260223388672, c: 0.1983642578125, d: 2.087831497192383
1 wait time: 1.842
220
3 wait time: 2.182
208
AG, 0.221154, 1.518592, 0 
perpare first forward gemm: 0.24,  fisrt gemm forward duration: 1.593
AG, 0.240909, 1.835008, 0 
perpare first forward gemm: 0.245,  fisrt gemm forward duration: 1.984
AG, 0.373239, 2.295808, 0 
perpare first forward gemm: 0.324,  fisrt gemm forward duration: 2.614
AG, 0.415625, 2.579456, 0 
perpare first forward gemm: 0.35,  fisrt gemm forward duration: 2.827
GA, 0.221154, 1.048576, 0 
GA, 0.240909, 1.752064, 0 
GA, 0.373239, 2.130944, 0 
GA, 0.415625, 2.527232, 0 
forward:  12.616
forward:  12.453
forward:  12.928
forward:  12.85
AG, 0.221154, 1.522688, 0 
AG, 0.240909, 1.830912, 0 
AG, 0.373239, 2.307072, 0 
Linear 2 Backward: 3.039, second_gemm: 3.033
AG, 0.415625, 2.574336, 0 
Linear 2 Backward: 3.251, second_gemm: 3.245
Linear 2 Backward: 4.235, second_gemm: 4.229
GA, 0.221154, 1.055744, 0 
Linear 2 Backward: 4.555, second_gemm: 4.546
GA, 0.240909, 1.759232, 0 
GA, 0.373239, 2.012160, 0 
GA, 0.415625, 2.439168, 0 
perpare first backward gemm: 0.023,  fisrt gemm backward duration: 4.295,  weight grad: 1.405,  other: 0.4
Linear 1 Backward:  6.154
perpare first backward gemm: 0.023,  fisrt gemm backward duration: 4.077,  weight grad: 1.365,  other: 0.401
Linear 1 Backward:  5.895
perpare first backward gemm: 0.028,  fisrt gemm backward duration: 3.031,  weight grad: 2.027,  other: 0.404
Linear 1 Backward:  5.518
perpare first backward gemm: 0.037,  fisrt gemm backward duration: 2.489,  weight grad: 2.239,  other: 0.423
Linear 1 Backward:  5.229
STEP-50: step_time = 28.100607 ms, foward_time = 15.412224, backward_time = 12.590080, perf = 29.35 tflops.
start
start
start
start
block_info 284 106
block_info 208 46
block_info 320 133
block_info 220 53
cuda:2 process time:3.662586212158203, a: 0.9403228759765625, b: 1.0211467742919922, c: 0.1277923583984375, d: 1.573324203491211
cuda:3 process time:4.292488098144531, a: 0.9610652923583984, b: 1.2669563293457031, c: 0.1647472381591797, d: 1.89971923828125
cuda:0 process time:4.0416717529296875, a: 0.759124755859375, b: 1.2545585632324219, c: 0.12993812561035156, d: 1.898050308227539
cuda:1 process time:4.45103645324707, a: 0.9794235229492188, b: 1.3043880462646484, c: 0.17070770263671875, d: 1.9965171813964844
2 wait time: 1.689
284
0 wait time: 1.446
320
3 wait time: 1.73
208
1 wait time: 1.852
220
AG, 0.221154, 1.524736, 0 
perpare first forward gemm: 0.307,  fisrt gemm forward duration: 1.648
AG, 0.240909, 1.830912, 0 
perpare first forward gemm: 0.303,  fisrt gemm forward duration: 1.898
AG, 0.373239, 2.316288, 0 
perpare first forward gemm: 0.335,  fisrt gemm forward duration: 2.67
AG, 0.415625, 2.601984, 0 
perpare first forward gemm: 0.368,  fisrt gemm forward duration: 2.695
GA, 0.221154, 1.057792, 0 
GA, 0.240909, 1.779712, 0 
GA, 0.373239, 2.003968, 0 
GA, 0.415625, 2.562048, 0 
forward:  12.728
forward:  13.034
forward:  12.653
forward:  12.769
AG, 0.221154, 1.532928, 0 
AG, 0.240909, 1.841152, 0 
AG, 0.373239, 2.286592, 0 
Linear 2 Backward: 2.955, second_gemm: 2.944
AG, 0.415625, 2.600960, 0 
Linear 2 Backward: 3.29, second_gemm: 3.283
Linear 2 Backward: 4.006, second_gemm: 4.0
GA, 0.221154, 1.063936, 0 
Linear 2 Backward: 4.596, second_gemm: 4.587
GA, 0.240909, 1.812480, 0 
GA, 0.373239, 2.098176, 0 
GA, 0.415625, 2.589696, 0 
perpare first backward gemm: 0.023,  fisrt gemm backward duration: 4.229,  weight grad: 1.366,  other: 0.401
Linear 1 Backward:  6.047
perpare first backward gemm: 0.031,  fisrt gemm backward duration: 4.336,  weight grad: 1.419,  other: 0.411
Linear 1 Backward:  6.24
perpare first backward gemm: 0.028,  fisrt gemm backward duration: 3.228,  weight grad: 2.007,  other: 0.41
Linear 1 Backward:  5.702
perpare first backward gemm: 0.038,  fisrt gemm backward duration: 2.639,  weight grad: 2.237,  other: 0.424
Linear 1 Backward:  5.377
STEP-51: step_time = 28.122112 ms, foward_time = 15.256576, backward_time = 12.766208, perf = 29.32 tflops.
start
start
start
start
block_info 284 106
block_info 220 53
block_info 320 133
cuda:2 process time:4.062891006469727, a: 0.7560253143310547, b: 1.5993118286132812, c: 0.11324882507324219, d: 1.5943050384521484
cuda:1 process time:3.973722457885742, a: 0.7174015045166016, b: 1.6474723815917969, c: 0.11086463928222656, d: 1.4979839324951172
block_info 208 46
cuda:0 process time:4.026889801025391, a: 0.7653236389160156, b: 1.4374256134033203, c: 0.1163482666015625, d: 1.7077922821044922
2 wait time: 1.144
284
1 wait time: 1.046
220
cuda:3 process time:4.280328750610352, a: 0.9782314300537109, b: 1.1746883392333984, c: 0.1747608184814453, d: 1.9526481628417969
0 wait time: 1.325
320
3 wait time: 2.029
208
AG, 0.221154, 1.524736, 0 
perpare first forward gemm: 0.294,  fisrt gemm forward duration: 1.613
AG, 0.240909, 1.852416, 0 
perpare first forward gemm: 0.303,  fisrt gemm forward duration: 2.402
AG, 0.373239, 2.286592, 0 
perpare first forward gemm: 0.288,  fisrt gemm forward duration: 2.985
AG, 0.415625, 2.625536, 0 
perpare first forward gemm: 0.358,  fisrt gemm forward duration: 2.824
GA, 0.221154, 1.052672, 0 
GA, 0.240909, 1.817600, 0 
GA, 0.373239, 2.216960, 0 
GA, 0.415625, 2.499584, 0 
forward:  13.352
forward:  12.716
forward:  13.221
forward:  13.058
AG, 0.221154, 1.530880, 0 
AG, 0.240909, 1.818624, 0 
AG, 0.373239, 2.325504, 0 
AG, 0.415625, 2.620416, 0 
Linear 2 Backward: 3.024, second_gemm: 3.01
Linear 2 Backward: 3.228, second_gemm: 3.221
Linear 2 Backward: 4.276, second_gemm: 4.27
GA, 0.221154, 1.071104, 0 
Linear 2 Backward: 4.624, second_gemm: 4.616
GA, 0.240909, 1.803264, 0 
GA, 0.373239, 2.113536, 0 
GA, 0.415625, 2.544640, 0 
perpare first backward gemm: 0.039,  fisrt gemm backward duration: 4.251,  weight grad: 1.457,  other: 0.43
Linear 1 Backward:  6.222
perpare first backward gemm: 0.022,  fisrt gemm backward duration: 4.28,  weight grad: 1.367,  other: 0.409
Linear 1 Backward:  6.107
perpare first backward gemm: 0.027,  fisrt gemm backward duration: 3.191,  weight grad: 2.026,  other: 0.407
Linear 1 Backward:  5.681
perpare first backward gemm: 0.038,  fisrt gemm backward duration: 2.595,  weight grad: 2.277,  other: 0.441
Linear 1 Backward:  5.391
STEP-52: step_time = 28.340223 ms, foward_time = 15.475712, backward_time = 12.763136, perf = 29.10 tflops.
start
start
start
start
block_info 220 53
block_info 320 133
block_info 208 46
block_info 284 106
cuda:1 process time:3.8983821868896484, a: 0.7345676422119141, b: 1.4522075653076172, c: 0.11777877807617188, d: 1.5938282012939453
cuda:0 process time:4.061698913574219, a: 0.7905960083007812, b: 1.3883113861083984, c: 0.11873245239257812, d: 1.764059066772461
cuda:3 process time:4.158973693847656, a: 0.988006591796875, b: 1.2235641479492188, c: 0.16450881958007812, d: 1.7828941345214844
1 wait time: 1.124
220
cuda:2 process time:4.358053207397461, a: 0.835418701171875, b: 1.3849735260009766, c: 0.16760826110839844, d: 1.970052719116211
0 wait time: 1.374
320
2 wait time: 1.983
284
3 wait time: 1.919
208
AG, 0.221154, 1.542144, 0 
perpare first forward gemm: 0.289,  fisrt gemm forward duration: 1.63
AG, 0.240909, 1.841152, 0 
perpare first forward gemm: 0.296,  fisrt gemm forward duration: 2.308
AG, 0.373239, 2.290688, 0 
perpare first forward gemm: 0.303,  fisrt gemm forward duration: 2.456
AG, 0.415625, 2.609152, 0 
perpare first forward gemm: 0.352,  fisrt gemm forward duration: 2.747
GA, 0.221154, 1.056768, 0 
GA, 0.240909, 1.809408, 0 
GA, 0.373239, 2.092032, 0 
GA, 0.415625, 2.621440, 0 
forward:  12.758
forward:  13.159
forward:  12.877
forward:  12.967
AG, 0.221154, 1.523712, 0 
AG, 0.240909, 1.821696, 0 
AG, 0.373239, 2.294784, 0 
Linear 2 Backward: 3.008, second_gemm: 3.001
AG, 0.415625, 2.601984, 0 
Linear 2 Backward: 3.213, second_gemm: 3.206
Linear 2 Backward: 4.171, second_gemm: 4.164
GA, 0.221154, 1.046528, 0 
Linear 2 Backward: 4.575, second_gemm: 4.567
GA, 0.240909, 1.759232, 0 
GA, 0.373239, 1.981440, 0 
GA, 0.415625, 2.573312, 0 
perpare first backward gemm: 0.022,  fisrt gemm backward duration: 4.477,  weight grad: 1.408,  other: 0.409
Linear 1 Backward:  6.345
perpare first backward gemm: 0.022,  fisrt gemm backward duration: 4.265,  weight grad: 1.365,  other: 0.405
Linear 1 Backward:  6.087
perpare first backward gemm: 0.027,  fisrt gemm backward duration: 3.222,  weight grad: 2.005,  other: 0.402
Linear 1 Backward:  5.685
perpare first backward gemm: 0.037,  fisrt gemm backward duration: 2.632,  weight grad: 2.258,  other: 0.427
Linear 1 Backward:  5.394
STEP-53: step_time = 28.293120 ms, foward_time = 15.387648, backward_time = 12.806144, perf = 29.15 tflops.
start
start
start
start
block_info 220 53
block_info 320 133
cuda:1 process time:3.880739212036133, a: 0.8449554443359375, b: 1.2912750244140625, c: 0.12373924255371094, d: 1.6207695007324219
block_info 208 46
block_info 284 106
cuda:0 process time:3.6509037017822266, a: 0.8356571197509766, b: 0.9710788726806641, c: 0.11754035949707031, d: 1.7266273498535156
1 wait time: 1.181
220
cuda:3 process time:4.348516464233398, a: 0.7729530334472656, b: 1.4832019805908203, c: 0.16260147094726562, d: 1.9297599792480469
0 wait time: 1.391
320
cuda:2 process time:4.335641860961914, a: 0.8795261383056641, b: 1.2135505676269531, c: 0.16832351684570312, d: 2.0742416381835938
2 wait time: 1.818
3 wait time: 1.612
208
284
AG, 0.221154, 1.530880, 0 
perpare first forward gemm: 0.289,  fisrt gemm forward duration: 1.672
AG, 0.240909, 1.839104, 0 
perpare first forward gemm: 0.296,  fisrt gemm forward duration: 2.387
AG, 0.373239, 2.289664, 0 
perpare first forward gemm: 0.33,  fisrt gemm forward duration: 2.356
AG, 0.415625, 2.613248, 0 
perpare first forward gemm: 0.353,  fisrt gemm forward duration: 2.901
GA, 0.221154, 1.060864, 0 
GA, 0.240909, 1.809408, 0 
GA, 0.373239, 2.192384, 0 
GA, 0.415625, 2.512896, 0 
forward:  12.71
forward:  12.693
forward:  13.131
forward:  12.979
AG, 0.221154, 1.525760, 0 
AG, 0.240909, 1.821696, 0 
AG, 0.373239, 2.300928, 0 
Linear 2 Backward: 3.045, second_gemm: 3.039
AG, 0.415625, 2.619392, 0 
Linear 2 Backward: 3.25, second_gemm: 3.244
Linear 2 Backward: 4.25, second_gemm: 4.244
GA, 0.221154, 1.052672, 0 
Linear 2 Backward: 4.623, second_gemm: 4.614
GA, 0.240909, 1.709056, 0 
GA, 0.373239, 2.101248, 0 
GA, 0.415625, 2.460672, 0 
perpare first backward gemm: 0.022,  fisrt gemm backward duration: 4.395,  weight grad: 1.409,  other: 0.403
Linear 1 Backward:  6.258
perpare first backward gemm: 0.023,  fisrt gemm backward duration: 4.178,  weight grad: 1.368,  other: 0.399
Linear 1 Backward:  5.995
perpare first backward gemm: 0.028,  fisrt gemm backward duration: 3.128,  weight grad: 2.002,  other: 0.402
Linear 1 Backward:  5.588
perpare first backward gemm: 0.038,  fisrt gemm backward duration: 2.511,  weight grad: 2.277,  other: 0.431
Linear 1 Backward:  5.297
STEP-54: step_time = 28.233729 ms, foward_time = 15.428608, backward_time = 12.708864, perf = 29.21 tflops.
start
start
start
start
block_info 220 53
block_info 320 133
block_info 208 46
block_info 284 106
cuda:1 process time:3.5448074340820312, a: 0.7493495941162109, b: 1.0662078857421875, c: 0.12254714965820312, d: 1.6067028045654297
cuda:0 process time:3.9520263671875, a: 0.7529258728027344, b: 1.264810562133789, c: 0.12540817260742188, d: 1.8088817596435547
cuda:3 process time:4.058837890625, a: 0.9639263153076172, b: 1.2373924255371094, c: 0.21338462829589844, d: 1.644134521484375
1 wait time: 1.228
220
cuda:2 process time:4.459142684936523, a: 0.8232593536376953, b: 1.645803451538086, c: 0.1659393310546875, d: 1.8241405487060547
3 wait time: 1.699
208
0 wait time: 1.432
320
2 wait time: 2.265
284
AG, 0.221154, 1.537024, 0 
perpare first forward gemm: 0.288,  fisrt gemm forward duration: 1.793
AG, 0.240909, 1.847296, 0 
perpare first forward gemm: 0.297,  fisrt gemm forward duration: 2.29
AG, 0.373239, 2.292736, 0 
perpare first forward gemm: 0.285,  fisrt gemm forward duration: 2.49
AG, 0.415625, 2.613248, 0 
perpare first forward gemm: 0.353,  fisrt gemm forward duration: 2.678
GA, 0.221154, 1.053696, 0 
GA, 0.240909, 1.794048, 0 
GA, 0.373239, 2.105344, 0 
GA, 0.415625, 2.509824, 0 
forward:  13.024
forward:  12.714
forward:  12.787
forward:  12.784
AG, 0.221154, 1.512448, 0 
AG, 0.240909, 1.829888, 0 
AG, 0.373239, 2.298880, 0 
Linear 2 Backward: 2.977, second_gemm: 2.97
AG, 0.415625, 2.595840, 0 
Linear 2 Backward: 3.205, second_gemm: 3.199
Linear 2 Backward: 4.211, second_gemm: 4.205
GA, 0.221154, 1.047552, 0 
Linear 2 Backward: 4.584, second_gemm: 4.575
GA, 0.240909, 1.746944, 0 
GA, 0.373239, 1.994752, 0 
GA, 0.415625, 2.432000, 0 
perpare first backward gemm: 0.023,  fisrt gemm backward duration: 4.096,  weight grad: 1.364,  other: 0.399
Linear 1 Backward:  5.91
perpare first backward gemm: 0.022,  fisrt gemm backward duration: 4.332,  weight grad: 1.411,  other: 0.399
Linear 1 Backward:  6.193
perpare first backward gemm: 0.028,  fisrt gemm backward duration: 3.058,  weight grad: 2.005,  other: 0.4
Linear 1 Backward:  5.519
perpare first backward gemm: 0.037,  fisrt gemm backward duration: 2.481,  weight grad: 2.257,  other: 0.425
Linear 1 Backward:  5.24
STEP-55: step_time = 27.808767 ms, foward_time = 15.129601, backward_time = 12.579840, perf = 29.65 tflops.
start
start
start
start
block_info 320 133
block_info 220 53
block_info 284 106
cuda:0 process time:3.752470016479492, a: 0.8320808410644531, b: 1.0459423065185547, c: 0.12636184692382812, d: 1.7480850219726562
cuda:1 process time:3.650665283203125, a: 0.7479190826416016, b: 1.1038780212402344, c: 0.12946128845214844, d: 1.6694068908691406
block_info 208 46
0 wait time: 1.592
1 wait time: 1.322
220
320
cuda:2 process time:4.483699798583984, a: 0.9129047393798828, b: 1.537322998046875, c: 0.1862049102783203, d: 1.8472671508789062
cuda:3 process time:4.444122314453125, a: 0.8699893951416016, b: 1.2090206146240234, c: 0.19788742065429688, d: 2.167224884033203
2 wait time: 2.311
284
3 wait time: 2.221
208
AG, 0.221154, 1.516544, 0 
perpare first forward gemm: 0.288,  fisrt gemm forward duration: 1.615
AG, 0.240909, 1.837056, 0 
perpare first forward gemm: 0.296,  fisrt gemm forward duration: 2.524
AG, 0.373239, 2.286592, 0 
perpare first forward gemm: 0.334,  fisrt gemm forward duration: 2.533
AG, 0.415625, 2.619392, 0 
perpare first forward gemm: 0.352,  fisrt gemm forward duration: 3.186
GA, 0.221154, 1.059840, 0 
GA, 0.240909, 1.789952, 0 
GA, 0.373239, 2.135040, 0 
GA, 0.415625, 2.571264, 0 
forward:  13.049
forward:  12.766
forward:  13.392
forward:  13.404
AG, 0.221154, 1.536000, 0 
AG, 0.240909, 1.838080, 0 
AG, 0.373239, 2.295808, 0 
AG, 0.415625, 2.616320, 0 
Linear 2 Backward: 3.035, second_gemm: 3.022
Linear 2 Backward: 3.183, second_gemm: 3.169
Linear 2 Backward: 4.404, second_gemm: 4.398
GA, 0.221154, 1.072128, 0 
Linear 2 Backward: 4.766, second_gemm: 4.757
GA, 0.240909, 1.814528, 0 
GA, 0.373239, 2.100224, 0 
GA, 0.415625, 2.588672, 0 
perpare first backward gemm: 0.038,  fisrt gemm backward duration: 4.283,  weight grad: 1.422,  other: 0.406
Linear 1 Backward:  6.193
perpare first backward gemm: 0.038,  fisrt gemm backward duration: 4.091,  weight grad: 1.368,  other: 0.415
Linear 1 Backward:  5.956
perpare first backward gemm: 0.028,  fisrt gemm backward duration: 3.251,  weight grad: 2.006,  other: 0.408
Linear 1 Backward:  5.722
perpare first backward gemm: 0.037,  fisrt gemm backward duration: 2.643,  weight grad: 2.285,  other: 0.444
Linear 1 Backward:  5.449
STEP-56: step_time = 29.000705 ms, foward_time = 15.906816, backward_time = 12.995584, perf = 28.43 tflops.
start
start
start
start
block_info 320 133
block_info 220 53
block_info 208 46
block_info 284 106
cuda:1 process time:3.7338733673095703, a: 0.7457733154296875, b: 1.2218952178955078, c: 0.1323223114013672, d: 1.6338825225830078
cuda:0 process time:3.9284229278564453, a: 0.8177757263183594, b: 1.1920928955078125, c: 0.13184547424316406, d: 1.7867088317871094
cuda:3 process time:4.093170166015625, a: 0.9748935699462891, b: 1.2259483337402344, c: 0.213623046875, d: 1.6787052154541016
cuda:2 process time:4.174470901489258, a: 0.8599758148193359, b: 1.3017654418945312, c: 0.1652240753173828, d: 1.8475055694580078
1 wait time: 1.408
220
0 wait time: 1.695
320
3 wait time: 1.707
208
2 wait time: 2.376
284
AG, 0.221154, 1.537024, 0 
perpare first forward gemm: 0.292,  fisrt gemm forward duration: 1.681
AG, 0.240909, 1.848320, 0 
perpare first forward gemm: 0.297,  fisrt gemm forward duration: 2.182
AG, 0.373239, 2.296832, 0 
perpare first forward gemm: 0.29,  fisrt gemm forward duration: 2.37
AG, 0.415625, 2.612224, 0 
perpare first forward gemm: 0.353,  fisrt gemm forward duration: 2.687
GA, 0.221154, 1.052672, 0 
GA, 0.240909, 1.802240, 0 
GA, 0.373239, 2.158592, 0 
GA, 0.415625, 2.567168, 0 
forward:  12.777
forward:  12.868
forward:  13.066
forward:  12.977
AG, 0.221154, 1.523712, 0 
AG, 0.240909, 1.826816, 0 
AG, 0.373239, 2.284544, 0 
AG, 0.415625, 2.595840, 0 
Linear 2 Backward: 2.974, second_gemm: 2.96
Linear 2 Backward: 3.238, second_gemm: 3.231
Linear 2 Backward: 4.226, second_gemm: 4.22
Linear 2 Backward: 4.584, second_gemm: 4.575
GA, 0.221154, 1.064960, 0 
GA, 0.240909, 1.756160, 0 
GA, 0.373239, 2.186240, 0 
GA, 0.415625, 2.511872, 0 
perpare first backward gemm: 0.024,  fisrt gemm backward duration: 4.186,  weight grad: 1.368,  other: 0.4
Linear 1 Backward:  6.008
perpare first backward gemm: 0.04,  fisrt gemm backward duration: 4.218,  weight grad: 1.409,  other: 0.408
Linear 1 Backward:  6.12
perpare first backward gemm: 0.028,  fisrt gemm backward duration: 3.182,  weight grad: 2.006,  other: 0.403
Linear 1 Backward:  5.647
perpare first backward gemm: 0.038,  fisrt gemm backward duration: 2.578,  weight grad: 2.264,  other: 0.427
Linear 1 Backward:  5.346
STEP-57: step_time = 28.445695 ms, foward_time = 15.608833, backward_time = 12.737536, perf = 28.99 tflops.
start
start
start
start
block_info 320 133
block_info 284 106
cuda:0 process time:3.9069652557373047, a: 0.7321834564208984, b: 1.4007091522216797, c: 0.14066696166992188, d: 1.6334056854248047
block_info 220 53
block_info 208 46
cuda:2 process time:4.2552947998046875, a: 0.8294582366943359, b: 1.3041496276855469, c: 0.1671314239501953, d: 1.9545555114746094
0 wait time: 1.799
320
cuda:1 process time:4.536867141723633, a: 0.8597373962402344, b: 1.4660358428955078, c: 0.1842975616455078, d: 2.026796340942383
2 wait time: 2.243
284
cuda:3 process time:4.66465950012207, a: 0.9653568267822266, b: 1.4109611511230469, c: 0.21076202392578125, d: 2.0775794982910156
1 wait time: 2.114
220
3 wait time: 2.744
208
AG, 0.221154, 1.529856, 0 
perpare first forward gemm: 0.29,  fisrt gemm forward duration: 1.628
AG, 0.240909, 1.847296, 0 
perpare first forward gemm: 0.297,  fisrt gemm forward duration: 2.304
AG, 0.373239, 2.280448, 0 
perpare first forward gemm: 0.288,  fisrt gemm forward duration: 2.973
AG, 0.415625, 2.607104, 0 
perpare first forward gemm: 0.306,  fisrt gemm forward duration: 3.61
GA, 0.221154, 1.047552, 0 
GA, 0.240909, 1.832960, 0 
GA, 0.373239, 2.168832, 0 
GA, 0.415625, 2.589696, 0 
forward:  13.123
forward:  12.767
forward:  13.316
forward:  13.67
AG, 0.221154, 1.532928, 0 
AG, 0.240909, 1.833984, 0 
AG, 0.373239, 2.271232, 0 
Linear 2 Backward: 3.083, second_gemm: 3.07
AG, 0.415625, 2.594816, 0 
Linear 2 Backward: 3.41, second_gemm: 3.403
Linear 2 Backward: 4.392, second_gemm: 4.386
GA, 0.221154, 1.062912, 0 
Linear 2 Backward: 4.637, second_gemm: 4.626
GA, 0.240909, 1.793024, 0 
GA, 0.373239, 2.033664, 0 
GA, 0.415625, 2.591744, 0 
perpare first backward gemm: 0.038,  fisrt gemm backward duration: 4.377,  weight grad: 1.412,  other: 0.401
Linear 1 Backward:  6.27
perpare first backward gemm: 0.023,  fisrt gemm backward duration: 4.33,  weight grad: 1.366,  other: 0.401
Linear 1 Backward:  6.148
perpare first backward gemm: 0.028,  fisrt gemm backward duration: 3.32,  weight grad: 2.002,  other: 0.404
Linear 1 Backward:  5.783
perpare first backward gemm: 0.045,  fisrt gemm backward duration: 2.65,  weight grad: 2.238,  other: 0.426
Linear 1 Backward:  5.402
STEP-58: step_time = 29.498369 ms, foward_time = 16.390144, backward_time = 13.009920, perf = 27.96 tflops.
start
start
start
start
block_info 208 46
block_info 220 53
block_info 284 106
block_info 320 133
cuda:3 process time:3.5369396209716797, a: 0.8399486541748047, b: 1.3027191162109375, c: 0.14400482177734375, d: 1.2502670288085938
cuda:2 process time:3.8008689880371094, a: 0.7295608520507812, b: 1.3246536254882812, c: 0.12087821960449219, d: 1.6257762908935547
cuda:0 process time:3.786325454711914, a: 0.8265972137451172, b: 1.0311603546142578, c: 0.1316070556640625, d: 1.7969608306884766
cuda:1 process time:3.9823055267333984, a: 1.0213851928710938, b: 0.9529590606689453, c: 0.17881393432617188, d: 1.8291473388671875
3 wait time: 1.757
208
2 wait time: 1.396
284
1 wait time: 2.643
220
0 wait time: 1.703
320
AG, 0.221154, 1.520640, 0 
perpare first forward gemm: 0.247,  fisrt gemm forward duration: 2.156
AG, 0.240909, 1.813504, 0 
perpare first forward gemm: 0.236,  fisrt gemm forward duration: 2.087
AG, 0.373239, 2.287616, 0 
perpare first forward gemm: 0.337,  fisrt gemm forward duration: 2.483
AG, 0.415625, 2.586624, 0 
perpare first forward gemm: 0.349,  fisrt gemm forward duration: 2.688
GA, 0.221154, 1.061888, 0 
GA, 0.240909, 1.753088, 0 
GA, 0.373239, 2.181120, 0 
GA, 0.415625, 2.580480, 0 
forward:  12.801
forward:  12.813
forward:  13.2
forward:  12.963
AG, 0.221154, 1.540096, 0 
AG, 0.240909, 1.810432, 0 
AG, 0.373239, 2.317312, 0 
AG, 0.415625, 2.575360, 0 
Linear 2 Backward: 3.336, second_gemm: 3.322
Linear 2 Backward: 3.454, second_gemm: 3.448
Linear 2 Backward: 4.677, second_gemm: 4.671
GA, 0.221154, 1.059840, 0 
Linear 2 Backward: 4.722, second_gemm: 4.706
GA, 0.240909, 1.793024, 0 
GA, 0.373239, 2.067456, 0 
GA, 0.415625, 2.527232, 0 
perpare first backward gemm: 0.023,  fisrt gemm backward duration: 4.269,  weight grad: 1.366,  other: 0.398
Linear 1 Backward:  6.085
perpare first backward gemm: 0.041,  fisrt gemm backward duration: 4.228,  weight grad: 1.411,  other: 0.401
Linear 1 Backward:  6.126
perpare first backward gemm: 0.028,  fisrt gemm backward duration: 3.167,  weight grad: 2.028,  other: 0.404
Linear 1 Backward:  5.657
perpare first backward gemm: 0.038,  fisrt gemm backward duration: 2.578,  weight grad: 2.229,  other: 0.423
Linear 1 Backward:  5.308
STEP-59: step_time = 28.562432 ms, foward_time = 15.404032, backward_time = 13.056000, perf = 28.87 tflops.
start
start
start
start
block_info 284 106
block_info 208 46
block_info 220 53
block_info 320 133
cuda:2 process time:4.313468933105469, a: 0.8294582366943359, b: 1.3914108276367188, c: 0.16832351684570312, d: 1.924276351928711
cuda:3 process time:4.139900207519531, a: 0.8637905120849609, b: 1.1692047119140625, c: 0.18548965454101562, d: 1.9214153289794922
2 wait time: 1.949
284
3 wait time: 2.007
208
cuda:1 process time:4.467248916625977, a: 0.8807182312011719, b: 1.2745857238769531, c: 0.20551681518554688, d: 2.1064281463623047
cuda:0 process time:4.540443420410156, a: 0.7693767547607422, b: 1.2831687927246094, c: 0.1735687255859375, d: 2.314329147338867
0 wait time: 1.936
320
1 wait time: 2.791
220
AG, 0.221154, 1.522688, 0 
perpare first forward gemm: 0.258,  fisrt gemm forward duration: 2.201
AG, 0.240909, 1.830912, 0 
perpare first forward gemm: 0.256,  fisrt gemm forward duration: 2.037
AG, 0.373239, 2.281472, 0 
perpare first forward gemm: 0.297,  fisrt gemm forward duration: 3.056
AG, 0.415625, 2.583552, 0 
perpare first forward gemm: 0.35,  fisrt gemm forward duration: 2.658
GA, 0.221154, 1.089536, 0 
GA, 0.240909, 1.793024, 0 
GA, 0.373239, 2.018304, 0 
GA, 0.415625, 2.570240, 0 
forward:  13.397
forward:  12.734
forward:  12.768
forward:  13.28
AG, 0.221154, 1.521664, 0 
AG, 0.240909, 1.816576, 0 
AG, 0.373239, 2.284544, 0 
Linear 2 Backward: 3.049, second_gemm: 3.035
AG, 0.415625, 2.623488, 0 
Linear 2 Backward: 3.498, second_gemm: 3.49
Linear 2 Backward: 4.452, second_gemm: 4.445
GA, 0.221154, 1.057792, 0 
Linear 2 Backward: 4.723, second_gemm: 4.708
GA, 0.240909, 1.838080, 0 
GA, 0.373239, 2.215936, 0 
GA, 0.415625, 2.455552, 0 
perpare first backward gemm: 0.026,  fisrt gemm backward duration: 4.328,  weight grad: 1.372,  other: 0.41
Linear 1 Backward:  6.167
perpare first backward gemm: 0.042,  fisrt gemm backward duration: 4.33,  weight grad: 1.423,  other: 0.413
Linear 1 Backward:  6.261
perpare first backward gemm: 0.028,  fisrt gemm backward duration: 3.307,  weight grad: 2.007,  other: 0.402
Linear 1 Backward:  5.773
perpare first backward gemm: 0.049,  fisrt gemm backward duration: 2.515,  weight grad: 2.221,  other: 0.413
Linear 1 Backward:  5.246
STEP-60: step_time = 28.767233 ms, foward_time = 15.651840, backward_time = 13.014016, perf = 28.67 tflops.
start
start
start
start
block_info 284 106
cuda:2 process time:3.931283950805664, a: 0.6639957427978516, b: 1.7800331115722656, c: 0.10514259338378906, d: 1.3821125030517578
block_info 320 133
block_info 220 53
2 wait time: 1.42
284
cuda:0 process time:4.2476654052734375, a: 0.7536411285400391, b: 1.519918441772461, c: 0.12230873107910156, d: 1.851797103881836
block_info 208 46
cuda:1 process time:4.609346389770508, a: 0.9338855743408203, b: 1.4929771423339844, c: 0.17023086547851562, d: 2.0122528076171875
0 wait time: 1.373
320
1 wait time: 1.8
220
cuda:3 process time:4.824638366699219, a: 1.0199546813964844, b: 1.2967586517333984, c: 0.21338462829589844, d: 2.2945404052734375
3 wait time: 2.486
208
AG, 0.221154, 1.531904, 0 
perpare first forward gemm: 0.305,  fisrt gemm forward duration: 1.641
AG, 0.240909, 1.838080, 0 
perpare first forward gemm: 0.292,  fisrt gemm forward duration: 2.588
AG, 0.373239, 2.289664, 0 
perpare first forward gemm: 0.305,  fisrt gemm forward duration: 3.724
AG, 0.415625, 2.618368, 0 
perpare first forward gemm: 0.357,  fisrt gemm forward duration: 3.474
GA, 0.221154, 1.076224, 0 
GA, 0.240909, 1.802240, 0 
GA, 0.373239, 2.149376, 0 
GA, 0.415625, 2.528256, 0 
forward:  14.097
forward:  12.795
forward:  13.393
forward:  13.652
AG, 0.221154, 1.526784, 0 
AG, 0.240909, 1.827840, 0 
AG, 0.373239, 2.280448, 0 
Linear 2 Backward: 2.989, second_gemm: 2.971
AG, 0.415625, 2.617344, 0 
Linear 2 Backward: 3.522, second_gemm: 3.515
Linear 2 Backward: 4.312, second_gemm: 4.305
GA, 0.221154, 1.062912, 0 
Linear 2 Backward: 4.847, second_gemm: 4.838
GA, 0.240909, 1.794048, 0 
GA, 0.373239, 2.163712, 0 
GA, 0.415625, 2.574336, 0 
perpare first backward gemm: 0.023,  fisrt gemm backward duration: 4.258,  weight grad: 1.364,  other: 0.4
Linear 1 Backward:  6.075
perpare first backward gemm: 0.044,  fisrt gemm backward duration: 4.262,  weight grad: 1.458,  other: 0.456
Linear 1 Backward:  6.285
perpare first backward gemm: 0.028,  fisrt gemm backward duration: 3.238,  weight grad: 2.01,  other: 0.411
Linear 1 Backward:  5.717
perpare first backward gemm: 0.035,  fisrt gemm backward duration: 2.623,  weight grad: 2.271,  other: 0.419
Linear 1 Backward:  5.385
STEP-61: step_time = 29.249536 ms, foward_time = 16.105472, backward_time = 13.035520, perf = 28.19 tflops.
start
start
start
start
block_info 284 106
block_info 208 46
block_info 320 133
cuda:2 process time:4.110097885131836, a: 0.6835460662841797, b: 1.8489360809326172, c: 0.10442733764648438, d: 1.4731884002685547
block_info 220 53
cuda:3 process time:3.8988590240478516, a: 0.8864402770996094, b: 1.1782646179199219, c: 0.16021728515625, d: 1.6739368438720703
cuda:0 process time:4.0721893310546875, a: 0.7719993591308594, b: 1.3928413391113281, c: 0.12683868408203125, d: 1.7805099487304688
2 wait time: 0.695
284
cuda:1 process time:4.502296447753906, a: 0.8265972137451172, b: 1.5807151794433594, c: 0.17189979553222656, d: 1.9230842590332031
3 wait time: 1.831
208
0 wait time: 1.528
320
1 wait time: 1.996
220
AG, 0.221154, 1.502208, 0 
perpare first forward gemm: 0.246,  fisrt gemm forward duration: 1.991
AG, 0.240909, 1.863680, 0 
perpare first forward gemm: 0.293,  fisrt gemm forward duration: 1.942
AG, 0.373239, 2.293760, 0 
perpare first forward gemm: 0.332,  fisrt gemm forward duration: 2.886
AG, 0.415625, 2.610176, 0 
perpare first forward gemm: 0.355,  fisrt gemm forward duration: 2.738
GA, 0.221154, 1.076224, 0 
GA, 0.240909, 1.730560, 0 
GA, 0.373239, 2.084864, 0 
GA, 0.415625, 2.573312, 0 
forward:  13.301
forward:  12.714
forward:  13.049
forward:  12.939
AG, 0.221154, 1.521664, 0 
AG, 0.240909, 1.830912, 0 
AG, 0.373239, 2.304000, 0 
AG, 0.415625, 2.599936, 0 
Linear 2 Backward: 2.987, second_gemm: 2.968
Linear 2 Backward: 3.4, second_gemm: 3.392
Linear 2 Backward: 4.386, second_gemm: 4.379
GA, 0.221154, 1.052672, 0 
Linear 2 Backward: 4.817, second_gemm: 4.808
GA, 0.240909, 1.818624, 0 
GA, 0.373239, 2.091008, 0 
GA, 0.415625, 2.583552, 0 
perpare first backward gemm: 0.023,  fisrt gemm backward duration: 4.214,  weight grad: 1.364,  other: 0.399
Linear 1 Backward:  6.028
perpare first backward gemm: 0.039,  fisrt gemm backward duration: 4.221,  weight grad: 1.42,  other: 0.409
Linear 1 Backward:  6.139
perpare first backward gemm: 0.03,  fisrt gemm backward duration: 3.157,  weight grad: 1.995,  other: 0.4
Linear 1 Backward:  5.613
perpare first backward gemm: 0.035,  fisrt gemm backward duration: 2.632,  weight grad: 2.246,  other: 0.414
Linear 1 Backward:  5.373
STEP-62: step_time = 28.399616 ms, foward_time = 15.522816, backward_time = 12.773376, perf = 29.04 tflops.
start
start
start
start
block_info 284 106
block_info 220 53
block_info 320 133
cuda:2 process time:3.9412975311279297, a: 0.6728172302246094, b: 1.6973018646240234, c: 0.10466575622558594, d: 1.466512680053711
cuda:1 process time:4.020214080810547, a: 0.7421970367431641, b: 1.5630722045898438, c: 0.11873245239257812, d: 1.596212387084961
block_info 208 46
cuda:0 process time:4.199743270874023, a: 0.9295940399169922, b: 1.3513565063476562, c: 0.12969970703125, d: 1.789093017578125
2 wait time: 1.034
284
1 wait time: 1.17
220
cuda:3 process time:4.38690185546875, a: 0.9236335754394531, b: 1.176595687866211, c: 0.1952648162841797, d: 2.0914077758789062
0 wait time: 1.646
320
3 wait time: 2.187
208
AG, 0.221154, 1.527808, 0 
perpare first forward gemm: 0.29,  fisrt gemm forward duration: 1.659
AG, 0.240909, 1.831936, 0 
perpare first forward gemm: 0.292,  fisrt gemm forward duration: 2.524
AG, 0.373239, 2.284544, 0 
perpare first forward gemm: 0.328,  fisrt gemm forward duration: 3.06
AG, 0.415625, 2.614272, 0 
perpare first forward gemm: 0.355,  fisrt gemm forward duration: 2.914
GA, 0.221154, 1.069056, 0 
GA, 0.240909, 1.813504, 0 
GA, 0.373239, 2.030592, 0 
GA, 0.415625, 2.603008, 0 
forward:  12.739
forward:  13.364
forward:  13.48
forward:  13.1
AG, 0.221154, 1.525760, 0 
AG, 0.240909, 1.829888, 0 
AG, 0.373239, 2.277376, 0 
AG, 0.415625, 2.593792, 0 
Linear 2 Backward: 2.994, second_gemm: 2.974
Linear 2 Backward: 3.398, second_gemm: 3.392
Linear 2 Backward: 4.236, second_gemm: 4.23
Linear 2 Backward: 4.822, second_gemm: 4.813
GA, 0.221154, 1.070080, 0 
GA, 0.240909, 1.746944, 0 
GA, 0.373239, 2.202624, 0 
GA, 0.415625, 2.556928, 0 
perpare first backward gemm: 0.04,  fisrt gemm backward duration: 4.182,  weight grad: 1.418,  other: 0.408
Linear 1 Backward:  6.099
perpare first backward gemm: 0.022,  fisrt gemm backward duration: 4.179,  weight grad: 1.367,  other: 0.399
Linear 1 Backward:  5.996
perpare first backward gemm: 0.03,  fisrt gemm backward duration: 3.159,  weight grad: 1.993,  other: 0.4
Linear 1 Backward:  5.613
perpare first backward gemm: 0.034,  fisrt gemm backward duration: 2.606,  weight grad: 2.257,  other: 0.417
Linear 1 Backward:  5.35
STEP-63: step_time = 28.723201 ms, foward_time = 15.818751, backward_time = 12.800000, perf = 28.71 tflops.
start
start
start
start
block_info 284 106
block_info 220 53
block_info 320 133
cuda:2 process time:3.9908885955810547, a: 0.5929470062255859, b: 1.8265247344970703, c: 0.10395050048828125, d: 1.4674663543701172
block_info 208 46
cuda:1 process time:4.2724609375, a: 0.7596015930175781, b: 1.7251968383789062, c: 0.13303756713867188, d: 1.6546249389648438
cuda:0 process time:4.030466079711914, a: 0.7624626159667969, b: 1.352071762084961, c: 0.12350082397460938, d: 1.7924308776855469
2 wait time: 0.691
284
1 wait time: 1.393
220
cuda:3 process time:4.345893859863281, a: 0.9229183197021484, b: 1.1661052703857422, c: 0.1957416534423828, d: 2.061128616333008
0 wait time: 1.412
320
3 wait time: 2.107
208
AG, 0.221154, 1.555456, 0 
perpare first forward gemm: 0.29,  fisrt gemm forward duration: 1.654
AG, 0.240909, 1.838080, 0 
perpare first forward gemm: 0.296,  fisrt gemm forward duration: 2.327
AG, 0.373239, 2.278400, 0 
perpare first forward gemm: 0.33,  fisrt gemm forward duration: 3.056
AG, 0.415625, 2.595840, 0 
perpare first forward gemm: 0.352,  fisrt gemm forward duration: 2.936
GA, 0.221154, 1.062912, 0 
GA, 0.240909, 1.744896, 0 
GA, 0.373239, 2.105344, 0 
GA, 0.415625, 2.553856, 0 
forward:  13.094
forward:  13.376
forward:  12.651
forward:  13.005
AG, 0.221154, 1.541120, 0 
AG, 0.240909, 1.818624, 0 
AG, 0.373239, 2.299904, 0 
AG, 0.415625, 2.594816, 0 
Linear 2 Backward: 3.007, second_gemm: 2.989
Linear 2 Backward: 3.366, second_gemm: 3.36
Linear 2 Backward: 4.367, second_gemm: 4.361
Linear 2 Backward: 4.802, second_gemm: 4.794
GA, 0.221154, 1.060864, 0 
GA, 0.240909, 1.754112, 0 
GA, 0.373239, 2.141184, 0 
GA, 0.415625, 2.564096, 0 
perpare first backward gemm: 0.039,  fisrt gemm backward duration: 4.163,  weight grad: 1.418,  other: 0.408
Linear 1 Backward:  6.08
perpare first backward gemm: 0.022,  fisrt gemm backward duration: 4.197,  weight grad: 1.364,  other: 0.397
Linear 1 Backward:  6.008
perpare first backward gemm: 0.03,  fisrt gemm backward duration: 3.104,  weight grad: 2.026,  other: 0.406
Linear 1 Backward:  5.597
perpare first backward gemm: 0.034,  fisrt gemm backward duration: 2.613,  weight grad: 2.229,  other: 0.411
Linear 1 Backward:  5.322
STEP-64: step_time = 28.359681 ms, foward_time = 15.497216, backward_time = 12.763136, perf = 29.08 tflops.
start
start
start
start
block_info 220 53
block_info 284 106
cuda:1 process time:4.083395004272461, a: 0.7216930389404297, b: 1.8491744995117188, c: 0.1304149627685547, d: 1.3821125030517578
cuda:2 process time:3.858804702758789, a: 0.6921291351318359, b: 1.589059829711914, c: 0.10466575622558594, d: 1.4729499816894531
block_info 208 46
2 wait time: 0.694
1 wait time: 1.511
220
284
cuda:3 process time:4.455804824829102, a: 1.0199546813964844, b: 1.3620853424072266, c: 0.19311904907226562, d: 1.880645751953125
block_info 320 133
3 wait time: 2.48
208
cuda:0 process time:5.301713943481445, a: 0.965118408203125, b: 1.7108917236328125, c: 0.2167224884033203, d: 2.4089813232421875
0 wait time: 3.142
320
AG, 0.221154, 1.542144, 0 
perpare first forward gemm: 0.292,  fisrt gemm forward duration: 2.568
AG, 0.240909, 1.805312, 0 
perpare first forward gemm: 0.249,  fisrt gemm forward duration: 3.808
AG, 0.373239, 2.316288, 0 
perpare first forward gemm: 0.335,  fisrt gemm forward duration: 4.112
AG, 0.415625, 2.580480, 0 
perpare first forward gemm: 0.352,  fisrt gemm forward duration: 2.648
GA, 0.221154, 1.067008, 0 
GA, 0.240909, 1.810432, 0 
GA, 0.373239, 2.145280, 0 
GA, 0.415625, 2.598912, 0 
forward:  14.509
forward:  13.643
forward:  12.793
forward:  14.526
AG, 0.221154, 1.522688, 0 
AG, 0.240909, 1.826816, 0 
AG, 0.373239, 2.301952, 0 
AG, 0.415625, 2.596864, 0 
Linear 2 Backward: 2.992, second_gemm: 2.973
Linear 2 Backward: 3.15, second_gemm: 3.143
Linear 2 Backward: 4.342, second_gemm: 4.334
Linear 2 Backward: 4.763, second_gemm: 4.755
GA, 0.221154, 1.059840, 0 
GA, 0.240909, 1.792000, 0 
GA, 0.373239, 2.113536, 0 
GA, 0.415625, 2.417664, 0 
perpare first backward gemm: 0.04,  fisrt gemm backward duration: 4.037,  weight grad: 1.417,  other: 0.411
Linear 1 Backward:  5.954
perpare first backward gemm: 0.022,  fisrt gemm backward duration: 4.044,  weight grad: 1.364,  other: 0.397
Linear 1 Backward:  5.855
perpare first backward gemm: 0.031,  fisrt gemm backward duration: 2.947,  weight grad: 2.019,  other: 0.427
Linear 1 Backward:  5.461
perpare first backward gemm: 0.034,  fisrt gemm backward duration: 2.465,  weight grad: 2.229,  other: 0.415
Linear 1 Backward:  5.18
STEP-65: step_time = 29.546559 ms, foward_time = 16.991295, backward_time = 12.454912, perf = 27.91 tflops.
start
start
block_info 284 106
start
block_info 320 133
start
block_info 208 46
cuda:2 process time:7.249355316162109, a: 0.7326602935791016, b: 4.896640777587891, c: 0.102996826171875, d: 1.5170574188232422
cuda:0 process time:7.534980773925781, a: 0.9374618530273438, b: 5.091428756713867, c: 0.10728836059570312, d: 1.3988018035888672
block_info 220 53
2 wait time: 0.502
284
cuda:3 process time:7.546186447143555, a: 0.9171962738037109, b: 4.731416702270508, c: 0.15163421630859375, d: 1.7459392547607422
0 wait time: 1.526
cuda:1 process time:7.328510284423828, a: 0.8671283721923828, b: 4.513263702392578, c: 0.1380443572998047, d: 1.8100738525390625
320
3 wait time: 1.534
208
1 wait time: 1.381
220
AG, 0.221154, 1.526784, 0 
perpare first forward gemm: 0.248,  fisrt gemm forward duration: 1.873
AG, 0.240909, 1.838080, 0 
perpare first forward gemm: 0.251,  fisrt gemm forward duration: 1.892
AG, 0.373239, 2.299904, 0 
perpare first forward gemm: 0.286,  fisrt gemm forward duration: 2.901
AG, 0.415625, 2.600960, 0 
perpare first forward gemm: 0.318,  fisrt gemm forward duration: 2.898
GA, 0.221154, 1.074176, 0 
GA, 0.240909, 1.781760, 0 
GA, 0.373239, 2.141184, 0 
GA, 0.415625, 2.576384, 0 
forward:  12.944
forward:  12.727
forward:  13.334
forward:  13.192
AG, 0.221154, 1.526784, 0 
AG, 0.240909, 1.828864, 0 
AG, 0.373239, 2.295808, 0 
AG, 0.415625, 2.610176, 0 
Linear 2 Backward: 2.998, second_gemm: 2.979
Linear 2 Backward: 3.401, second_gemm: 3.394
Linear 2 Backward: 4.374, second_gemm: 4.366
Linear 2 Backward: 4.67, second_gemm: 4.661
GA, 0.221154, 1.068032, 0 
GA, 0.240909, 1.827840, 0 
GA, 0.373239, 2.016256, 0 
GA, 0.415625, 2.601984, 0 
perpare first backward gemm: 0.039,  fisrt gemm backward duration: 4.188,  weight grad: 1.415,  other: 0.41
Linear 1 Backward:  6.103
perpare first backward gemm: 0.022,  fisrt gemm backward duration: 4.186,  weight grad: 1.364,  other: 0.396
Linear 1 Backward:  5.997
perpare first backward gemm: 0.032,  fisrt gemm backward duration: 3.104,  weight grad: 2.014,  other: 0.41
Linear 1 Backward:  5.594
perpare first backward gemm: 0.031,  fisrt gemm backward duration: 2.645,  weight grad: 2.237,  other: 0.405
Linear 1 Backward:  5.348
STEP-66: step_time = 28.463103 ms, foward_time = 15.839232, backward_time = 12.518400, perf = 28.97 tflops.
start
start
start
start
block_info 284 106
block_info 220 53
cuda:2 process time:3.2868385314941406, a: 0.7238388061523438, b: 1.0607242584228516, c: 0.1049041748046875, d: 1.3973712921142578
cuda:1 process time:3.814697265625, a: 0.6418228149414062, b: 1.5490055084228516, c: 0.11968612670898438, d: 1.5041828155517578
2 wait time: 1.232
284
block_info 320 133
1 wait time: 1.028
220
block_info 208 46
cuda:0 process time:4.533290863037109, a: 0.9500980377197266, b: 1.3051033020019531, c: 0.1842975616455078, d: 2.093791961669922
cuda:3 process time:4.466533660888672, a: 0.8203983306884766, b: 1.1818408966064453, c: 0.21338462829589844, d: 2.2509098052978516
3 wait time: 2.315
208
0 wait time: 2.759
320
AG, 0.221154, 1.525760, 0 
perpare first forward gemm: 0.294,  fisrt gemm forward duration: 1.763
AG, 0.240909, 1.845248, 0 
perpare first forward gemm: 0.293,  fisrt gemm forward duration: 3.019
AG, 0.373239, 2.296832, 0 
perpare first forward gemm: 0.324,  fisrt gemm forward duration: 3.666
AG, 0.415625, 2.607104, 0 
perpare first forward gemm: 0.334,  fisrt gemm forward duration: 2.668
GA, 0.221154, 1.081344, 0 
GA, 0.240909, 1.795072, 0 
GA, 0.373239, 2.097152, 0 
GA, 0.415625, 2.520064, 0 
forward:  14.024
forward:  12.819
forward:  13.789
forward:  12.813
AG, 0.221154, 1.543168, 0 
AG, 0.240909, 1.821696, 0 
AG, 0.373239, 2.285568, 0 
AG, 0.415625, 2.605056, 0 
Linear 2 Backward: 3.008, second_gemm: 2.989
Linear 2 Backward: 3.412, second_gemm: 3.405
Linear 2 Backward: 4.423, second_gemm: 4.415
Linear 2 Backward: 4.729, second_gemm: 4.722
GA, 0.221154, 1.070080, 0 
GA, 0.240909, 1.810432, 0 
GA, 0.373239, 1.981440, 0 
GA, 0.415625, 2.593792, 0 
perpare first backward gemm: 0.022,  fisrt gemm backward duration: 4.199,  weight grad: 1.366,  other: 0.399
Linear 1 Backward:  6.015
perpare first backward gemm: 0.039,  fisrt gemm backward duration: 4.171,  weight grad: 1.419,  other: 0.409
Linear 1 Backward:  6.088
perpare first backward gemm: 0.032,  fisrt gemm backward duration: 3.083,  weight grad: 2.016,  other: 0.413
Linear 1 Backward:  5.593
perpare first backward gemm: 0.031,  fisrt gemm backward duration: 2.638,  weight grad: 2.243,  other: 0.408
Linear 1 Backward:  5.349
STEP-67: step_time = 29.275841 ms, foward_time = 16.665280, backward_time = 12.508160, perf = 28.17 tflops.
start
start
start
start
block_info 284 106
block_info 220 53
cuda:2 process time:3.6067962646484375, a: 0.7033348083496094, b: 1.348257064819336, c: 0.10442733764648438, d: 1.4507770538330078
cuda:1 process time:3.9625167846679688, a: 0.7405281066894531, b: 1.4448165893554688, c: 0.1327991485595703, d: 1.6443729400634766
2 wait time: 1.067
284
block_info 208 46
1 wait time: 1.409
220
block_info 320 133
cuda:3 process time:4.5757293701171875, a: 0.9522438049316406, b: 1.3735294342041016, c: 0.21028518676757812, d: 2.039670944213867
cuda:0 process time:5.104541778564453, a: 0.9863376617431641, b: 1.4989376068115234, c: 0.21123886108398438, d: 2.4080276489257812
3 wait time: 2.663
208
0 wait time: 3.15
320
AG, 0.221154, 1.529856, 0 
perpare first forward gemm: 0.293,  fisrt gemm forward duration: 2.119
AG, 0.240909, 1.840128, 0 
perpare first forward gemm: 0.294,  fisrt gemm forward duration: 3.152
AG, 0.373239, 2.317312, 0 
perpare first forward gemm: 0.337,  fisrt gemm forward duration: 3.946
AG, 0.415625, 2.617344, 0 
perpare first forward gemm: 0.308,  fisrt gemm forward duration: 2.672
GA, 0.221154, 1.064960, 0 
GA, 0.240909, 1.757184, 0 
GA, 0.373239, 2.152448, 0 
GA, 0.415625, 2.563072, 0 
forward:  14.363
forward:  13.268
forward:  13.97
forward:  12.825
AG, 0.221154, 1.532928, 0 
AG, 0.240909, 1.819648, 0 
AG, 0.373239, 2.296832, 0 
AG, 0.415625, 2.587648, 0 
Linear 2 Backward: 3.015, second_gemm: 2.995
Linear 2 Backward: 3.49, second_gemm: 3.484
Linear 2 Backward: 4.44, second_gemm: 4.432
Linear 2 Backward: 4.858, second_gemm: 4.851
GA, 0.221154, 1.065984, 0 
GA, 0.240909, 1.807360, 0 
GA, 0.373239, 2.074624, 0 
GA, 0.415625, 2.480128, 0 
perpare first backward gemm: 0.024,  fisrt gemm backward duration: 4.065,  weight grad: 1.362,  other: 0.399
Linear 1 Backward:  5.879
perpare first backward gemm: 0.04,  fisrt gemm backward duration: 4.029,  weight grad: 1.42,  other: 0.41
Linear 1 Backward:  5.949
perpare first backward gemm: 0.032,  fisrt gemm backward duration: 2.964,  weight grad: 2.012,  other: 0.413
Linear 1 Backward:  5.457
perpare first backward gemm: 0.031,  fisrt gemm backward duration: 2.528,  weight grad: 2.221,  other: 0.402
Linear 1 Backward:  5.211
STEP-68: step_time = 29.561856 ms, foward_time = 17.060864, backward_time = 12.397568, perf = 27.90 tflops.
start
start
start
start
block_info 220 53
block_info 284 106
cuda:1 process time:3.8623809814453125, a: 0.8325576782226562, b: 1.374959945678711, c: 0.12564659118652344, d: 1.5292167663574219
block_info 208 46
cuda:2 process time:3.720998764038086, a: 0.6761550903320312, b: 1.4960765838623047, c: 0.10466575622558594, d: 1.444101333618164
1 wait time: 1.449
220
cuda:3 process time:4.039287567138672, a: 0.9558200836181641, b: 1.148223876953125, c: 0.21147727966308594, d: 1.7237663269042969
2 wait time: 1.111
284
block_info 320 133
3 wait time: 1.786
208
cuda:0 process time:5.323886871337891, a: 0.8966922760009766, b: 1.8198490142822266, c: 0.20837783813476562, d: 2.398967742919922
0 wait time: 3.324
320
AG, 0.221154, 1.534976, 0 
perpare first forward gemm: 0.292,  fisrt gemm forward duration: 2.61
AG, 0.240909, 1.839104, 0 
perpare first forward gemm: 0.296,  fisrt gemm forward duration: 3.211
AG, 0.373239, 2.298880, 0 
perpare first forward gemm: 0.33,  fisrt gemm forward duration: 3.631
AG, 0.415625, 2.617344, 0 
perpare first forward gemm: 0.311,  fisrt gemm forward duration: 2.671
GA, 0.221154, 1.058816, 0 
GA, 0.240909, 1.756160, 0 
GA, 0.373239, 1.976320, 0 
GA, 0.415625, 2.464768, 0 
forward:  14.008
forward:  13.985
forward:  13.64
forward:  12.702
AG, 0.221154, 1.529856, 0 
AG, 0.240909, 1.799168, 0 
AG, 0.373239, 2.290688, 0 
AG, 0.415625, 2.605056, 0 
Linear 2 Backward: 3.135, second_gemm: 3.116
Linear 2 Backward: 3.563, second_gemm: 3.557
Linear 2 Backward: 4.545, second_gemm: 4.537
GA, 0.221154, 1.055744, 0 
Linear 2 Backward: 4.772, second_gemm: 4.756
GA, 0.240909, 1.788928, 0 
GA, 0.373239, 2.091008, 0 
GA, 0.415625, 2.577408, 0 
perpare first backward gemm: 0.022,  fisrt gemm backward duration: 4.522,  weight grad: 1.363,  other: 0.397
Linear 1 Backward:  6.334
perpare first backward gemm: 0.04,  fisrt gemm backward duration: 4.471,  weight grad: 1.419,  other: 0.413
Linear 1 Backward:  6.396
perpare first backward gemm: 0.032,  fisrt gemm backward duration: 3.418,  weight grad: 2.013,  other: 0.414
Linear 1 Backward:  5.912
perpare first backward gemm: 0.057,  fisrt gemm backward duration: 2.636,  weight grad: 2.277,  other: 0.435
Linear 1 Backward:  5.458
STEP-69: step_time = 30.321665 ms, foward_time = 16.796673, backward_time = 13.442048, perf = 27.20 tflops.
start
start
start
start
block_info 284 106
cuda:2 process time:3.9691925048828125, a: 0.7073879241943359, b: 1.7080307006835938, c: 0.10347366333007812, d: 1.4503002166748047
block_info 220 53
2 wait time: 1.03
284
block_info 208 46
cuda:1 process time:4.523038864135742, a: 0.9975433349609375, b: 1.6357898712158203, c: 0.17070770263671875, d: 1.7189979553222656
block_info 320 133
cuda:3 process time:4.578113555908203, a: 0.9908676147460938, b: 1.3315677642822266, c: 0.2110004425048828, d: 2.044677734375
1 wait time: 2.339
220
3 wait time: 2.606
208
cuda:0 process time:5.214452743530273, a: 0.9758472442626953, b: 1.5997886657714844, c: 0.2300739288330078, d: 2.408742904663086
0 wait time: 3.036
320
AG, 0.221154, 1.524736, 0 
perpare first forward gemm: 0.248,  fisrt gemm forward duration: 2.215
AG, 0.240909, 1.832960, 0 
perpare first forward gemm: 0.301,  fisrt gemm forward duration: 2.64
AG, 0.373239, 2.305024, 0 
perpare first forward gemm: 0.333,  fisrt gemm forward duration: 3.849
AG, 0.415625, 2.613248, 0 
perpare first forward gemm: 0.307,  fisrt gemm forward duration: 2.664
GA, 0.221154, 1.063936, 0 
GA, 0.240909, 1.788928, 0 
GA, 0.373239, 2.053120, 0 
GA, 0.415625, 2.583552, 0 
forward:  13.501
forward:  13.243
forward:  14.26
forward:  12.807
AG, 0.221154, 1.520640, 0 
AG, 0.240909, 1.804288, 0 
AG, 0.373239, 2.297856, 0 
Linear 2 Backward: 3.346, second_gemm: 3.326
AG, 0.415625, 2.606080, 0 
Linear 2 Backward: 3.646, second_gemm: 3.639
Linear 2 Backward: 4.613, second_gemm: 4.605
GA, 0.221154, 1.062912, 0 
Linear 2 Backward: 4.799, second_gemm: 4.783
GA, 0.240909, 1.788928, 0 
GA, 0.373239, 2.053120, 0 
GA, 0.415625, 2.593792, 0 
perpare first backward gemm: 0.039,  fisrt gemm backward duration: 4.537,  weight grad: 1.423,  other: 0.416
Linear 1 Backward:  6.467
perpare first backward gemm: 0.022,  fisrt gemm backward duration: 4.534,  weight grad: 1.366,  other: 0.399
Linear 1 Backward:  6.351
perpare first backward gemm: 0.031,  fisrt gemm backward duration: 3.463,  weight grad: 2.02,  other: 0.414
Linear 1 Backward:  5.964
perpare first backward gemm: 0.056,  fisrt gemm backward duration: 2.655,  weight grad: 2.259,  other: 0.429
Linear 1 Backward:  5.451
STEP-70: step_time = 30.314817 ms, foward_time = 16.731456, backward_time = 13.484032, perf = 27.20 tflops.
start
start
start
start
block_info 220 53
block_info 284 106
cuda:1 process time:3.763437271118164, a: 0.78582763671875, b: 1.4240741729736328, c: 0.11229515075683594, d: 1.4412403106689453
cuda:2 process time:3.895998001098633, a: 0.6418228149414062, b: 1.5981197357177734, c: 0.10371208190917969, d: 1.5523433685302734
1 wait time: 1.227
220
block_info 208 46
2 wait time: 0.714
284
block_info 320 133
cuda:3 process time:4.543781280517578, a: 0.9233951568603516, b: 1.1603832244873047, c: 0.21076202392578125, d: 2.2492408752441406
3 wait time: 2.349
208
cuda:0 process time:5.340576171875, a: 0.9834766387939453, b: 1.5025138854980469, c: 0.2148151397705078, d: 2.6397705078125
0 wait time: 2.747
320
AG, 0.221154, 1.509376, 0 
perpare first forward gemm: 0.249,  fisrt gemm forward duration: 2.279
AG, 0.240909, 1.861632, 0 
perpare first forward gemm: 0.296,  fisrt gemm forward duration: 3.654
AG, 0.373239, 2.285568, 0 
perpare first forward gemm: 0.332,  fisrt gemm forward duration: 3.85
AG, 0.415625, 2.609152, 0 
perpare first forward gemm: 0.353,  fisrt gemm forward duration: 2.675
GA, 0.221154, 1.065984, 0 
GA, 0.240909, 1.793024, 0 
GA, 0.373239, 2.032640, 0 
GA, 0.415625, 2.524160, 0 
forward:  14.196
forward:  14.361
forward:  12.756
forward:  13.253
AG, 0.221154, 1.524736, 0 
AG, 0.240909, 1.809408, 0 
AG, 0.373239, 2.265088, 0 
AG, 0.415625, 2.582528, 0 
Linear 2 Backward: 3.136, second_gemm: 3.117
Linear 2 Backward: 3.49, second_gemm: 3.484
Linear 2 Backward: 4.433, second_gemm: 4.425
GA, 0.221154, 1.059840, 0 
Linear 2 Backward: 4.687, second_gemm: 4.671
GA, 0.240909, 1.783808, 0 
GA, 0.373239, 2.083840, 0 
GA, 0.415625, 2.560000, 0 
perpare first backward gemm: 0.029,  fisrt gemm backward duration: 4.367,  weight grad: 1.427,  other: 0.42
Linear 1 Backward:  6.288
perpare first backward gemm: 0.023,  fisrt gemm backward duration: 4.277,  weight grad: 1.365,  other: 0.401
Linear 1 Backward:  6.097
perpare first backward gemm: 0.031,  fisrt gemm backward duration: 3.253,  weight grad: 1.995,  other: 0.407
Linear 1 Backward:  5.72
perpare first backward gemm: 0.042,  fisrt gemm backward duration: 2.617,  weight grad: 2.245,  other: 0.439
Linear 1 Backward:  5.389
STEP-71: step_time = 29.742082 ms, foward_time = 16.418817, backward_time = 13.220864, perf = 27.73 tflops.
start
start
start
start
block_info 284 106
block_info 208 46
cuda:2 process time:3.942728042602539, a: 0.6909370422363281, b: 1.6815662384033203, c: 0.10442733764648438, d: 1.4657974243164062
block_info 320 133
cuda:3 process time:3.8957595825195312, a: 0.9472370147705078, b: 1.142740249633789, c: 0.14829635620117188, d: 1.6574859619140625
block_info 220 53
2 wait time: 1.112
284
cuda:0 process time:4.520893096923828, a: 0.9646415710449219, b: 1.4979839324951172, c: 0.19884109497070312, d: 1.859426498413086
3 wait time: 1.713
208
cuda:1 process time:4.622697830200195, a: 0.988006591796875, b: 1.3871192932128906, c: 0.18477439880371094, d: 2.0627975463867188
0 wait time: 1.942
320
1 wait time: 2.087
220
AG, 0.221154, 1.486848, 0 
perpare first forward gemm: 0.242,  fisrt gemm forward duration: 2.205
AG, 0.240909, 1.859584, 0 
perpare first forward gemm: 0.298,  fisrt gemm forward duration: 1.925
AG, 0.373239, 2.268160, 0 
perpare first forward gemm: 0.322,  fisrt gemm forward duration: 3.102
AG, 0.415625, 2.605056, 0 
perpare first forward gemm: 0.354,  fisrt gemm forward duration: 2.791
GA, 0.221154, 1.059840, 0 
GA, 0.240909, 1.801216, 0 
GA, 0.373239, 2.113536, 0 
GA, 0.415625, 2.596864, 0 
forward:  13.466
forward:  12.666
forward:  13.237
forward:  12.859
AG, 0.221154, 1.527808, 0 
AG, 0.240909, 1.851392, 0 
AG, 0.373239, 2.294784, 0 
AG, 0.415625, 2.609152, 0 
Linear 2 Backward: 3.094, second_gemm: 3.076
Linear 2 Backward: 3.528, second_gemm: 3.521
Linear 2 Backward: 4.453, second_gemm: 4.445
GA, 0.221154, 1.060864, 0 
Linear 2 Backward: 4.711, second_gemm: 4.695
GA, 0.240909, 1.777664, 0 
GA, 0.373239, 2.177024, 0 
GA, 0.415625, 2.493440, 0 
perpare first backward gemm: 0.023,  fisrt gemm backward duration: 4.212,  weight grad: 1.363,  other: 0.402
Linear 1 Backward:  6.031
perpare first backward gemm: 0.04,  fisrt gemm backward duration: 4.205,  weight grad: 1.447,  other: 0.452
Linear 1 Backward:  6.213
perpare first backward gemm: 0.031,  fisrt gemm backward duration: 3.178,  weight grad: 2.012,  other: 0.41
Linear 1 Backward:  5.667
perpare first backward gemm: 0.042,  fisrt gemm backward duration: 2.55,  weight grad: 2.247,  other: 0.441
Linear 1 Backward:  5.326
STEP-72: step_time = 28.973056 ms, foward_time = 15.694849, backward_time = 13.192192, perf = 28.46 tflops.
start
start
start
start
block_info 284 106
cuda:2 process time:3.6520957946777344, a: 0.6740093231201172, b: 1.6162395477294922, c: 0.10442733764648438, d: 1.2574195861816406
block_info 220 53
2 wait time: 1.435
284
cuda:1 process time:3.852367401123047, a: 0.7545948028564453, b: 1.4684200286865234, c: 0.11491775512695312, d: 1.514434814453125
block_info 208 46
1 wait time: 1.012
220
block_info 320 133
cuda:3 process time:4.640817642211914, a: 0.9007453918457031, b: 1.3034343719482422, c: 0.209808349609375, d: 2.2268295288085938
cuda:0 process time:5.007743835449219, a: 0.95367431640625, b: 1.2216567993164062, c: 0.21338462829589844, d: 2.619028091430664
3 wait time: 2.405
208
0 wait time: 2.733
320
AG, 0.221154, 1.534976, 0 
perpare first forward gemm: 0.284,  fisrt gemm forward duration: 2.17
AG, 0.240909, 1.846272, 0 
perpare first forward gemm: 0.296,  fisrt gemm forward duration: 3.348
AG, 0.373239, 2.310144, 0 
perpare first forward gemm: 0.298,  fisrt gemm forward duration: 4.238
AG, 0.415625, 2.601984, 0 
perpare first forward gemm: 0.35,  fisrt gemm forward duration: 2.665
GA, 0.221154, 1.043456, 0 
GA, 0.240909, 1.762304, 0 
GA, 0.373239, 2.190336, 0 
GA, 0.415625, 2.456576, 0 
forward:  13.966
forward:  14.37
forward:  12.602
forward:  13.068
AG, 0.221154, 1.539072, 0 
AG, 0.240909, 1.826816, 0 
AG, 0.373239, 2.279424, 0 
AG, 0.415625, 2.572288, 0 
Linear 2 Backward: 3.224, second_gemm: 3.201
Linear 2 Backward: 3.348, second_gemm: 3.341
Linear 2 Backward: 4.414, second_gemm: 4.406
Linear 2 Backward: 4.812, second_gemm: 4.793
GA, 0.221154, 1.083392, 0 
GA, 0.240909, 1.811456, 0 
GA, 0.373239, 2.057216, 0 
GA, 0.415625, 2.515968, 0 
perpare first backward gemm: 0.023,  fisrt gemm backward duration: 4.502,  weight grad: 1.364,  other: 0.401
Linear 1 Backward:  6.318
perpare first backward gemm: 0.054,  fisrt gemm backward duration: 4.308,  weight grad: 1.445,  other: 0.43
Linear 1 Backward:  6.309
perpare first backward gemm: 0.031,  fisrt gemm backward duration: 3.459,  weight grad: 2.014,  other: 0.414
Linear 1 Backward:  5.955
perpare first backward gemm: 0.062,  fisrt gemm backward duration: 2.584,  weight grad: 2.254,  other: 0.447
Linear 1 Backward:  5.416
STEP-73: step_time = 30.025730 ms, foward_time = 16.408576, backward_time = 13.527040, perf = 27.46 tflops.
start
start
start
block_info 208 46
block_info 284 106
block_info 220 53
cuda:3 process time:3.4456253051757812, a: 0.7107257843017578, b: 1.2860298156738281, c: 0.10347366333007812, d: 1.3453960418701172
start
cuda:2 process time:3.758668899536133, a: 0.7061958312988281, b: 1.4331340789794922, c: 0.10323524475097656, d: 1.516103744506836
cuda:1 process time:3.996133804321289, a: 0.736236572265625, b: 1.535177230834961, c: 0.12302398681640625, d: 1.6016960144042969
3 wait time: 1.013
208
2 wait time: 0.482
284
1 wait time: 1.269
220
block_info 320 133
cuda:0 process time:5.018472671508789, a: 0.9758472442626953, b: 1.2295246124267578, c: 0.21314620971679688, d: 2.599954605102539
0 wait time: 2.616
320
AG, 0.221154, 1.524736, 0 
perpare first forward gemm: 0.288,  fisrt gemm forward duration: 3.173
AG, 0.240909, 1.841152, 0 
perpare first forward gemm: 0.294,  fisrt gemm forward duration: 3.076
AG, 0.373239, 2.304000, 0 
perpare first forward gemm: 0.374,  fisrt gemm forward duration: 3.473
AG, 0.415625, 2.605056, 0 
perpare first forward gemm: 0.298,  fisrt gemm forward duration: 2.656
GA, 0.221154, 1.048576, 0 
GA, 0.240909, 1.780736, 0 
GA, 0.373239, 2.220032, 0 
GA, 0.415625, 2.622464, 0 
forward:  14.279
forward:  13.893
forward:  12.75
forward:  13.979
AG, 0.221154, 1.537024, 0 
AG, 0.240909, 1.775616, 0 
AG, 0.373239, 2.296832, 0 
AG, 0.415625, 2.567168, 0 
Linear 2 Backward: 3.796, second_gemm: 3.789
Linear 2 Backward: 3.224, second_gemm: 3.2
Linear 2 Backward: 4.683, second_gemm: 4.676
Linear 2 Backward: 4.808, second_gemm: 4.792
GA, 0.221154, 1.070080, 0 
GA, 0.240909, 1.715200, 0 
GA, 0.373239, 2.046976, 0 
GA, 0.415625, 2.635776, 0 
perpare first backward gemm: 0.054,  fisrt gemm backward duration: 4.417,  weight grad: 1.441,  other: 0.428
perpare first backward gemm: 0.023,  fisrt gemm backward duration: 4.669,  weight grad: 1.367,  other: 0.398
Linear 1 Backward:  6.484
Linear 1 Backward:  6.412
perpare first backward gemm: 0.031,  fisrt gemm backward duration: 3.533,  weight grad: 2.016,  other: 0.411
Linear 1 Backward:  6.027
perpare first backward gemm: 0.06,  fisrt gemm backward duration: 2.702,  weight grad: 2.271,  other: 0.45
Linear 1 Backward:  5.552
STEP-74: step_time = 30.492671 ms, foward_time = 16.503808, backward_time = 13.896704, perf = 27.04 tflops.
start
start
start
start
block_info 220 53
block_info 284 106
cuda:1 process time:3.873109817504883, a: 0.7510185241699219, b: 1.3933181762695312, c: 0.11754035949707031, d: 1.6112327575683594
cuda:2 process time:3.9739608764648438, a: 0.6859302520751953, b: 1.6281604766845703, c: 0.10323524475097656, d: 1.5566349029541016
block_info 208 46
2 wait time: 0.694
284
1 wait time: 1.186
220
block_info 320 133
cuda:3 process time:4.622459411621094, a: 0.9639263153076172, b: 1.3997554779052734, c: 0.22530555725097656, d: 2.0334720611572266
3 wait time: 2.703
208
cuda:0 process time:5.051374435424805, a: 1.0027885437011719, b: 1.4216899871826172, c: 0.2262592315673828, d: 2.400636672973633
0 wait time: 3.139
320
AG, 0.221154, 1.515520, 0 
perpare first forward gemm: 0.254,  fisrt gemm forward duration: 2.26
AG, 0.240909, 1.860608, 0 
perpare first forward gemm: 0.294,  fisrt gemm forward duration: 3.38
AG, 0.373239, 2.310144, 0 
perpare first forward gemm: 0.307,  fisrt gemm forward duration: 3.865
AG, 0.415625, 2.627584, 0 
perpare first forward gemm: 0.356,  fisrt gemm forward duration: 2.691
GA, 0.221154, 1.059840, 0 
GA, 0.240909, 1.704960, 0 
GA, 0.373239, 2.080768, 0 
GA, 0.415625, 2.590720, 0 
forward:  14.142
forward:  13.311
forward:  14.174
forward:  12.802
AG, 0.221154, 1.526784, 0 
AG, 0.240909, 1.810432, 0 
AG, 0.373239, 2.299904, 0 
AG, 0.415625, 2.590720, 0 
Linear 2 Backward: 3.092, second_gemm: 3.072
Linear 2 Backward: 3.51, second_gemm: 3.504
Linear 2 Backward: 4.512, second_gemm: 4.505
Linear 2 Backward: 4.751, second_gemm: 4.734
GA, 0.221154, 1.068032, 0 
GA, 0.240909, 1.805312, 0 
GA, 0.373239, 2.208768, 0 
GA, 0.415625, 2.582528, 0 
perpare first backward gemm: 0.022,  fisrt gemm backward duration: 4.493,  weight grad: 1.362,  other: 0.405
Linear 1 Backward:  6.311
perpare first backward gemm: 0.046,  fisrt gemm backward duration: 4.388,  weight grad: 1.442,  other: 0.429
Linear 1 Backward:  6.37
perpare first backward gemm: 0.031,  fisrt gemm backward duration: 3.388,  weight grad: 2.012,  other: 0.411
Linear 1 Backward:  5.878
perpare first backward gemm: 0.053,  fisrt gemm backward duration: 2.647,  weight grad: 2.247,  other: 0.446
Linear 1 Backward:  5.457
STEP-75: step_time = 30.595967 ms, foward_time = 16.968577, backward_time = 13.536256, perf = 26.95 tflops.
start
start
start
block_info 284 106
start
block_info 220 53
block_info 208 46
cuda:2 process time:3.785371780395508, a: 0.6880760192871094, b: 1.499176025390625, c: 0.10228157043457031, d: 1.4958381652832031
cuda:1 process time:4.05430793762207, a: 0.7548332214355469, b: 1.4827251434326172, c: 0.12969970703125, d: 1.6870498657226562
cuda:3 process time:4.0035247802734375, a: 0.9181499481201172, b: 1.2011528015136719, c: 0.15997886657714844, d: 1.7242431640625
2 wait time: 0.502
284
1 wait time: 1.262
220
block_info 320 133
3 wait time: 1.797
208
cuda:0 process time:5.186796188354492, a: 0.8437633514404297, b: 1.5218257904052734, c: 0.2124309539794922, d: 2.608776092529297
0 wait time: 2.773
320
AG, 0.221154, 1.528832, 0 
perpare first forward gemm: 0.291,  fisrt gemm forward duration: 2.697
AG, 0.240909, 1.833984, 0 
perpare first forward gemm: 0.296,  fisrt gemm forward duration: 3.105
AG, 0.373239, 2.296832, 0 
perpare first forward gemm: 0.371,  fisrt gemm forward duration: 3.645
AG, 0.415625, 2.588672, 0 
perpare first forward gemm: 0.38,  fisrt gemm forward duration: 2.655
GA, 0.221154, 1.048576, 0 
GA, 0.240909, 1.746944, 0 
GA, 0.373239, 1.982464, 0 
GA, 0.415625, 2.512896, 0 
forward:  13.774
forward:  13.659
forward:  13.993
forward:  12.675
AG, 0.221154, 1.542144, 0 
AG, 0.240909, 1.815552, 0 
AG, 0.373239, 2.280448, 0 
AG, 0.415625, 2.588672, 0 
Linear 2 Backward: 3.191, second_gemm: 3.169
Linear 2 Backward: 3.756, second_gemm: 3.75
Linear 2 Backward: 4.573, second_gemm: 4.565
Linear 2 Backward: 4.785, second_gemm: 4.766
GA, 0.221154, 1.061888, 0 
GA, 0.240909, 1.805312, 0 
GA, 0.373239, 2.100224, 0 
GA, 0.415625, 2.587648, 0 
perpare first backward gemm: 0.023,  fisrt gemm backward duration: 4.388,  weight grad: 1.365,  other: 0.4
Linear 1 Backward:  6.207
perpare first backward gemm: 0.052,  fisrt gemm backward duration: 4.205,  weight grad: 1.44,  other: 0.432
Linear 1 Backward:  6.198
perpare first backward gemm: 0.031,  fisrt gemm backward duration: 3.312,  weight grad: 2.017,  other: 0.415
Linear 1 Backward:  5.811
perpare first backward gemm: 0.041,  fisrt gemm backward duration: 2.643,  weight grad: 2.25,  other: 0.445
Linear 1 Backward:  5.431
STEP-76: step_time = 29.987838 ms, foward_time = 16.292863, backward_time = 13.605888, perf = 27.50 tflops.
start
start
start
block_info 284 106
block_info 220 53
start
cuda:1 process time:3.938436508178711, a: 0.7851123809814453, b: 1.5330314636230469, c: 0.12111663818359375, d: 1.499176025390625
cuda:2 process time:3.791332244873047, a: 0.7092952728271484, b: 1.4543533325195312, c: 0.10228157043457031, d: 1.5254020690917969
1 wait time: 1.377
220
2 wait time: 0.528
284
block_info 208 46
block_info 320 133
cuda:3 process time:4.769086837768555, a: 0.9279251098632812, b: 1.3687610626220703, c: 0.21147727966308594, d: 2.260923385620117
3 wait time: 2.359
208
cuda:0 process time:5.142927169799805, a: 0.8738040924072266, b: 1.4488697052001953, c: 0.2124309539794922, d: 2.6078224182128906
0 wait time: 2.78
320
AG, 0.221154, 1.527808, 0 
perpare first forward gemm: 0.246,  fisrt gemm forward duration: 2.152
AG, 0.240909, 1.838080, 0 
perpare first forward gemm: 0.297,  fisrt gemm forward duration: 3.447
AG, 0.373239, 2.291712, 0 
perpare first forward gemm: 0.37,  fisrt gemm forward duration: 3.703
AG, 0.415625, 2.597888, 0 
perpare first forward gemm: 0.301,  fisrt gemm forward duration: 2.649
GA, 0.221154, 1.068032, 0 
GA, 0.240909, 1.782784, 0 
GA, 0.373239, 2.084864, 0 
GA, 0.415625, 2.563072, 0 
forward:  14.244
forward:  13.128
forward:  12.684
forward:  14.143
AG, 0.221154, 1.525760, 0 
AG, 0.240909, 1.810432, 0 
AG, 0.373239, 2.312192, 0 
Linear 2 Backward: 2.984, second_gemm: 2.968
AG, 0.415625, 2.598912, 0 
Linear 2 Backward: 3.249, second_gemm: 3.242
Linear 2 Backward: 4.179, second_gemm: 4.171
GA, 0.221154, 1.059840, 0 
Linear 2 Backward: 4.615, second_gemm: 4.605
GA, 0.240909, 1.823744, 0 
GA, 0.373239, 2.070528, 0 
GA, 0.415625, 2.476032, 0 
perpare first backward gemm: 0.03,  fisrt gemm backward duration: 4.217,  weight grad: 1.368,  other: 0.399
Linear 1 Backward:  6.043
perpare first backward gemm: 0.032,  fisrt gemm backward duration: 4.288,  weight grad: 1.44,  other: 0.444
Linear 1 Backward:  6.257
perpare first backward gemm: 0.031,  fisrt gemm backward duration: 3.096,  weight grad: 2.035,  other: 0.411
Linear 1 Backward:  5.61
perpare first backward gemm: 0.04,  fisrt gemm backward duration: 2.534,  weight grad: 2.275,  other: 0.463
Linear 1 Backward:  5.363
STEP-77: step_time = 29.488126 ms, foward_time = 16.465919, backward_time = 12.928000, perf = 27.96 tflops.
start
start
start
start
block_info 284 106
cuda:2 process time:3.680706024169922, a: 0.7991790771484375, b: 1.4255046844482422, c: 0.1621246337890625, d: 1.2938976287841797
block_info 220 53
2 wait time: 1.501
284
block_info 208 46
cuda:1 process time:4.378080368041992, a: 0.8332729339599609, b: 1.4574527740478516, c: 0.17404556274414062, d: 1.913309097290039
block_info 320 133
cuda:3 process time:4.67681884765625, a: 0.9136199951171875, b: 1.4884471893310547, c: 0.20813941955566406, d: 2.0666122436523438
1 wait time: 2.018
220
3 wait time: 2.723
208
cuda:0 process time:5.172967910766602, a: 1.1065006256103516, b: 1.2249946594238281, c: 0.21386146545410156, d: 2.6276111602783203
0 wait time: 2.804
320
AG, 0.221154, 1.527808, 0 
perpare first forward gemm: 0.28,  fisrt gemm forward duration: 2.168
AG, 0.240909, 1.823744, 0 
perpare first forward gemm: 0.245,  fisrt gemm forward duration: 2.845
AG, 0.373239, 2.297856, 0 
perpare first forward gemm: 0.284,  fisrt gemm forward duration: 4.085
AG, 0.415625, 2.591744, 0 
perpare first forward gemm: 0.352,  fisrt gemm forward duration: 2.657
GA, 0.221154, 1.067008, 0 
GA, 0.240909, 1.806336, 0 
GA, 0.373239, 2.029568, 0 
GA, 0.415625, 2.610176, 0 
forward:  14.366
forward:  12.758
forward:  13.56
forward:  13.208
AG, 0.221154, 1.528832, 0 
AG, 0.240909, 1.819648, 0 
AG, 0.373239, 2.293760, 0 
Linear 2 Backward: 2.916, second_gemm: 2.9
AG, 0.415625, 2.600960, 0 
Linear 2 Backward: 3.255, second_gemm: 3.248
Linear 2 Backward: 4.223, second_gemm: 4.215
GA, 0.221154, 1.063936, 0 
Linear 2 Backward: 4.701, second_gemm: 4.691
GA, 0.240909, 1.793024, 0 
GA, 0.373239, 2.210816, 0 
GA, 0.415625, 2.573312, 0 
perpare first backward gemm: 0.023,  fisrt gemm backward duration: 4.284,  weight grad: 1.365,  other: 0.398
Linear 1 Backward:  6.1
perpare first backward gemm: 0.032,  fisrt gemm backward duration: 4.383,  weight grad: 1.441,  other: 0.441
Linear 1 Backward:  6.349
perpare first backward gemm: 0.031,  fisrt gemm backward duration: 3.214,  weight grad: 2.016,  other: 0.409
Linear 1 Backward:  5.707
perpare first backward gemm: 0.039,  fisrt gemm backward duration: 2.63,  weight grad: 2.247,  other: 0.464
Linear 1 Backward:  5.431
STEP-78: step_time = 29.489152 ms, foward_time = 16.381953, backward_time = 13.018112, perf = 27.96 tflops.
start
start
start
block_info 284 106
block_info 220 53
start
cuda:1 process time:4.065513610839844, a: 0.7965564727783203, b: 1.5571117401123047, c: 0.12826919555664062, d: 1.5835762023925781
cuda:2 process time:3.8633346557617188, a: 0.6880760192871094, b: 1.6050338745117188, c: 0.11301040649414062, d: 1.45721435546875
block_info 208 46
block_info 320 133
2 wait time: 0.476
284
1 wait time: 1.391
220
cuda:0 process time:4.763126373291016, a: 0.988006591796875, b: 1.589059829711914, c: 0.2181529998779297, d: 1.9679069519042969
cuda:3 process time:4.389762878417969, a: 0.9284019470214844, b: 1.1615753173828125, c: 0.209808349609375, d: 2.089977264404297
0 wait time: 2.156
3 wait time: 2.131
208
320
AG, 0.221154, 1.521664, 0 
perpare first forward gemm: 0.248,  fisrt gemm forward duration: 1.896
AG, 0.240909, 1.833984, 0 
perpare first forward gemm: 0.297,  fisrt gemm forward duration: 2.697
AG, 0.373239, 2.319360, 0 
perpare first forward gemm: 0.33,  fisrt gemm forward duration: 3.218
AG, 0.415625, 2.607104, 0 
perpare first forward gemm: 0.354,  fisrt gemm forward duration: 2.672
GA, 0.221154, 1.075200, 0 
GA, 0.240909, 1.763328, 0 
GA, 0.373239, 2.079744, 0 
GA, 0.415625, 2.588672, 0 
forward:  13.554
forward:  12.778
forward:  13.488
forward:  12.829
AG, 0.221154, 1.528832, 0 
AG, 0.240909, 1.819648, 0 
AG, 0.373239, 2.305024, 0 
AG, 0.415625, 2.605056, 0 
Linear 2 Backward: 2.948, second_gemm: 2.933
Linear 2 Backward: 3.434, second_gemm: 3.427
Linear 2 Backward: 4.387, second_gemm: 4.379
GA, 0.221154, 1.054720, 0 
Linear 2 Backward: 4.642, second_gemm: 4.631
GA, 0.240909, 1.837056, 0 
GA, 0.373239, 2.046976, 0 
GA, 0.415625, 2.539520, 0 
perpare first backward gemm: 0.023,  fisrt gemm backward duration: 4.351,  weight grad: 1.366,  other: 0.4
Linear 1 Backward:  6.169
perpare first backward gemm: 0.041,  fisrt gemm backward duration: 4.369,  weight grad: 1.44,  other: 0.429
Linear 1 Backward:  6.337
perpare first backward gemm: 0.031,  fisrt gemm backward duration: 3.271,  weight grad: 2.013,  other: 0.42
Linear 1 Backward:  5.772
perpare first backward gemm: 0.046,  fisrt gemm backward duration: 2.613,  weight grad: 2.252,  other: 0.446
Linear 1 Backward:  5.415
STEP-79: step_time = 29.215742 ms, foward_time = 15.822848, backward_time = 13.292544, perf = 28.23 tflops.
start
start
start
start
block_info 284 106
cuda:2 process time:3.904581069946289, a: 0.6794929504394531, b: 1.7595291137695312, c: 0.10275840759277344, d: 1.3628005981445312
block_info 220 53
block_info 320 133
2 wait time: 1.098
284
block_info 208 46
cuda:1 process time:4.441261291503906, a: 0.7610321044921875, b: 1.6965866088867188, c: 0.1723766326904297, d: 1.8112659454345703
cuda:0 process time:4.259586334228516, a: 0.9677410125732422, b: 1.2469291687011719, c: 0.213623046875, d: 1.8312931060791016
1 wait time: 1.918
220
cuda:3 process time:4.625558853149414, a: 0.9331703186035156, b: 1.1942386627197266, c: 0.24390220642089844, d: 2.2542476654052734
0 wait time: 1.963
320
3 wait time: 2.352
208
AG, 0.221154, 1.544192, 0 
perpare first forward gemm: 0.288,  fisrt gemm forward duration: 1.636
AG, 0.240909, 1.817600, 0 
perpare first forward gemm: 0.251,  fisrt gemm forward duration: 2.525
AG, 0.373239, 2.273280, 0 
perpare first forward gemm: 0.297,  fisrt gemm forward duration: 3.397
AG, 0.415625, 2.611200, 0 
perpare first forward gemm: 0.356,  fisrt gemm forward duration: 2.877
GA, 0.221154, 1.070080, 0 
GA, 0.240909, 1.805312, 0 
GA, 0.373239, 2.142208, 0 
GA, 0.415625, 2.600960, 0 
forward:  13.267
forward:  12.745
forward:  13.769
forward:  13.086
AG, 0.221154, 1.534976, 0 
AG, 0.240909, 1.846272, 0 
AG, 0.373239, 2.273280, 0 
Linear 2 Backward: 2.95, second_gemm: 2.934
AG, 0.415625, 2.624512, 0 
Linear 2 Backward: 3.258, second_gemm: 3.251
Linear 2 Backward: 4.261, second_gemm: 4.253
GA, 0.221154, 1.053696, 0 
Linear 2 Backward: 4.67, second_gemm: 4.659
GA, 0.240909, 1.819648, 0 
GA, 0.373239, 2.096128, 0 
GA, 0.415625, 2.637824, 0 
perpare first backward gemm: 0.023,  fisrt gemm backward duration: 4.378,  weight grad: 1.367,  other: 0.397
Linear 1 Backward:  6.194
perpare first backward gemm: 0.032,  fisrt gemm backward duration: 4.466,  weight grad: 1.44,  other: 0.428
Linear 1 Backward:  6.438
perpare first backward gemm: 0.031,  fisrt gemm backward duration: 3.351,  weight grad: 2.018,  other: 0.413
Linear 1 Backward:  5.85
perpare first backward gemm: 0.04,  fisrt gemm backward duration: 2.695,  weight grad: 2.295,  other: 0.453
Linear 1 Backward:  5.535
STEP-80: step_time = 29.333503 ms, foward_time = 16.031744, backward_time = 13.219840, perf = 28.11 tflops.
start
start
start
start
block_info 208 46
block_info 284 106
cuda:3 process time:3.5936832427978516, a: 0.6830692291259766, b: 1.444101333618164, c: 0.10395050048828125, d: 1.3625621795654297
cuda:2 process time:3.747701644897461, a: 0.6701946258544922, b: 1.512765884399414, c: 0.10275840759277344, d: 1.4619827270507812
block_info 220 53
block_info 320 133
3 wait time: 0.665
208
2 wait time: 0.686
284
cuda:1 process time:4.21595573425293, a: 0.934600830078125, b: 1.2290477752685547, c: 0.17261505126953125, d: 1.8796920776367188
cuda:0 process time:4.548788070678711, a: 0.9505748748779297, b: 1.2867450714111328, c: 0.16260147094726562, d: 2.148866653442383
1 wait time: 1.973
220
0 wait time: 1.965
320
AG, 0.221154, 1.530880, 0 
perpare first forward gemm: 0.29,  fisrt gemm forward duration: 2.57
AG, 0.240909, 1.838080, 0 
perpare first forward gemm: 0.298,  fisrt gemm forward duration: 2.254
AG, 0.373239, 2.304000, 0 
perpare first forward gemm: 0.33,  fisrt gemm forward duration: 3.178
AG, 0.415625, 2.610176, 0 
perpare first forward gemm: 0.355,  fisrt gemm forward duration: 2.675
GA, 0.221154, 1.064960, 0 
GA, 0.240909, 1.803264, 0 
GA, 0.373239, 2.130944, 0 
GA, 0.415625, 2.605056, 0 
forward:  13.58
forward:  12.854
forward:  13.058
forward:  13.665
AG, 0.221154, 1.542144, 0 
AG, 0.240909, 1.805312, 0 
AG, 0.373239, 2.301952, 0 
AG, 0.415625, 2.593792, 0 
Linear 2 Backward: 3.712, second_gemm: 3.705
Linear 2 Backward: 3.2, second_gemm: 3.178
Linear 2 Backward: 4.727, second_gemm: 4.719
Linear 2 Backward: 4.833, second_gemm: 4.813
GA, 0.221154, 1.068032, 0 
GA, 0.240909, 1.804288, 0 
GA, 0.373239, 2.092032, 0 
GA, 0.415625, 2.451456, 0 
perpare first backward gemm: 0.023,  fisrt gemm backward duration: 4.469,  weight grad: 1.368,  other: 0.403
Linear 1 Backward:  6.292
perpare first backward gemm: 0.054,  fisrt gemm backward duration: 4.244,  weight grad: 1.442,  other: 0.428
Linear 1 Backward:  6.238
perpare first backward gemm: 0.032,  fisrt gemm backward duration: 3.351,  weight grad: 2.011,  other: 0.411
Linear 1 Backward:  5.842
perpare first backward gemm: 0.062,  fisrt gemm backward duration: 2.513,  weight grad: 2.272,  other: 0.449
Linear 1 Backward:  5.366
STEP-81: step_time = 29.521921 ms, foward_time = 15.769600, backward_time = 13.665280, perf = 27.93 tflops.
start
start
start
start
block_info 208 46
block_info 220 53
block_info 284 106
cuda:3 process time:3.412485122680664, a: 0.7421970367431641, b: 1.1699199676513672, c: 0.10824203491210938, d: 1.3921260833740234
cuda:1 process time:3.931760787963867, a: 0.8099079132080078, b: 1.4073848724365234, c: 0.1239776611328125, d: 1.5904903411865234
cuda:2 process time:3.748655319213867, a: 0.7183551788330078, b: 1.2683868408203125, c: 0.17404556274414062, d: 1.5878677368164062
3 wait time: 0.677
208
block_info 320 133
1 wait time: 1.231
2 wait time: 1.407
284
220
cuda:0 process time:4.564046859741211, a: 0.9822845458984375, b: 1.401662826538086, c: 0.1742839813232422, d: 2.0058155059814453
0 wait time: 2.621
320
AG, 0.221154, 1.515520, 0 
perpare first forward gemm: 0.293,  fisrt gemm forward duration: 2.68
AG, 0.240909, 1.839104, 0 
perpare first forward gemm: 0.295,  fisrt gemm forward duration: 2.81
AG, 0.373239, 2.282496, 0 
perpare first forward gemm: 0.333,  fisrt gemm forward duration: 3.194
AG, 0.415625, 2.591744, 0 
perpare first forward gemm: 0.323,  fisrt gemm forward duration: 2.64
GA, 0.221154, 1.061888, 0 
GA, 0.240909, 1.812480, 0 
GA, 0.373239, 2.172928, 0 
GA, 0.415625, 2.585600, 0 
forward:  13.598
forward:  13.78
forward:  13.591
forward:  12.809
AG, 0.221154, 1.537024, 0 
AG, 0.240909, 1.787904, 0 
AG, 0.373239, 2.288640, 0 
AG, 0.415625, 2.590720, 0 
Linear 2 Backward: 3.153, second_gemm: 3.13
Linear 2 Backward: 3.735, second_gemm: 3.728
Linear 2 Backward: 4.754, second_gemm: 4.747
Linear 2 Backward: 4.836, second_gemm: 4.817
GA, 0.221154, 1.080320, 0 
GA, 0.240909, 1.826816, 0 
GA, 0.373239, 2.091008, 0 
GA, 0.415625, 2.472960, 0 
perpare first backward gemm: 0.022,  fisrt gemm backward duration: 4.523,  weight grad: 1.365,  other: 0.409
Linear 1 Backward:  6.349
perpare first backward gemm: 0.053,  fisrt gemm backward duration: 4.313,  weight grad: 1.519,  other: 0.442
Linear 1 Backward:  6.4
perpare first backward gemm: 0.031,  fisrt gemm backward duration: 3.388,  weight grad: 2.012,  other: 0.41
Linear 1 Backward:  5.878
perpare first backward gemm: 0.059,  fisrt gemm backward duration: 2.556,  weight grad: 2.35,  other: 0.462
Linear 1 Backward:  5.496
STEP-82: step_time = 30.150014 ms, foward_time = 16.267648, backward_time = 13.792256, perf = 27.35 tflops.
start
start
start
start
block_info 220 53
block_info 284 106
cuda:1 process time:3.580331802368164, a: 0.7708072662353516, b: 1.1959075927734375, c: 0.12063980102539062, d: 1.4929771423339844
cuda:2 process time:3.7841796875, a: 0.7038116455078125, b: 1.5153884887695312, c: 0.10275840759277344, d: 1.4622211456298828
1 wait time: 1.39
2 wait time: 1.201
220
284
block_info 208 46
block_info 320 133
cuda:3 process time:4.598379135131836, a: 0.9148120880126953, b: 1.241445541381836, c: 0.21195411682128906, d: 2.2301673889160156
cuda:0 process time:4.874706268310547, a: 0.9734630584716797, b: 1.2276172637939453, c: 0.19860267639160156, d: 2.4750232696533203
3 wait time: 2.282
208
0 wait time: 2.523
320
AG, 0.221154, 1.527808, 0 
perpare first forward gemm: 0.249,  fisrt gemm forward duration: 1.959
AG, 0.240909, 1.843200, 0 
perpare first forward gemm: 0.297,  fisrt gemm forward duration: 3.172
AG, 0.373239, 2.293760, 0 
perpare first forward gemm: 0.328,  fisrt gemm forward duration: 3.551
AG, 0.415625, 2.605056, 0 
perpare first forward gemm: 0.299,  fisrt gemm forward duration: 2.66
GA, 0.221154, 1.074176, 0 
GA, 0.240909, 1.725440, 0 
GA, 0.373239, 2.108416, 0 
GA, 0.415625, 2.611200, 0 
forward:  13.955
forward:  13.958
forward:  12.977
forward:  12.676
AG, 0.221154, 1.539072, 0 
AG, 0.240909, 1.783808, 0 
AG, 0.373239, 2.298880, 0 
AG, 0.415625, 2.591744, 0 
Linear 2 Backward: 3.099, second_gemm: 3.078
Linear 2 Backward: 3.553, second_gemm: 3.546
Linear 2 Backward: 4.594, second_gemm: 4.586
Linear 2 Backward: 4.802, second_gemm: 4.784
GA, 0.221154, 1.063936, 0 
GA, 0.240909, 1.753088, 0 
GA, 0.373239, 2.191360, 0 
GA, 0.415625, 2.548736, 0 
perpare first backward gemm: 0.049,  fisrt gemm backward duration: 4.373,  weight grad: 1.443,  other: 0.428
perpare first backward gemm: 0.023,  fisrt gemm backward duration: 4.533,  weight grad: 1.373,  other: 0.399
Linear 1 Backward:  6.357
Linear 1 Backward:  6.359
perpare first backward gemm: 0.032,  fisrt gemm backward duration: 3.395,  weight grad: 2.017,  other: 0.412
Linear 1 Backward:  5.891
perpare first backward gemm: 0.056,  fisrt gemm backward duration: 2.633,  weight grad: 2.245,  other: 0.449
Linear 1 Backward:  5.448
STEP-83: step_time = 29.936641 ms, foward_time = 16.307201, backward_time = 13.538304, perf = 27.55 tflops.
start
start
start
start
block_info 284 106
block_info 208 46
block_info 220 53
cuda:2 process time:3.5169124603271484, a: 0.690460205078125, b: 1.268148422241211, c: 0.10323524475097656, d: 1.455068588256836
cuda:3 process time:3.4122467041015625, a: 0.7178783416748047, b: 1.1773109436035156, c: 0.11777877807617188, d: 1.3992786407470703
cuda:1 process time:3.6802291870117188, a: 0.7905960083007812, b: 1.1763572692871094, c: 0.14829635620117188, d: 1.5649795532226562
2 wait time: 1.057
284
3 wait time: 0.954
208
1 wait time: 1.631
220
block_info 320 133
cuda:0 process time:5.069971084594727, a: 0.9591579437255859, b: 1.463174819946289, c: 0.23412704467773438, d: 2.413511276245117
0 wait time: 3.025
320
AG, 0.221154, 1.545216, 0 
perpare first forward gemm: 0.286,  fisrt gemm forward duration: 3.167
AG, 0.240909, 1.848320, 0 
perpare first forward gemm: 0.297,  fisrt gemm forward duration: 3.276
AG, 0.373239, 2.271232, 0 
perpare first forward gemm: 0.291,  fisrt gemm forward duration: 4.036
AG, 0.415625, 2.596864, 0 
perpare first forward gemm: 0.354,  fisrt gemm forward duration: 2.661
GA, 0.221154, 1.059840, 0 
GA, 0.240909, 1.798144, 0 
GA, 0.373239, 2.136064, 0 
GA, 0.415625, 2.480128, 0 
forward:  14.208
forward:  14.09
forward:  12.66
forward:  13.908
AG, 0.221154, 1.543168, 0 
AG, 0.240909, 1.827840, 0 
AG, 0.373239, 2.293760, 0 
AG, 0.415625, 2.614272, 0 
Linear 2 Backward: 2.977, second_gemm: 2.961
Linear 2 Backward: 3.236, second_gemm: 3.229
Linear 2 Backward: 4.199, second_gemm: 4.192
GA, 0.221154, 1.048576, 0 
Linear 2 Backward: 4.631, second_gemm: 4.62
GA, 0.240909, 1.802240, 0 
GA, 0.373239, 2.199552, 0 
GA, 0.415625, 2.509824, 0 
perpare first backward gemm: 0.032,  fisrt gemm backward duration: 4.298,  weight grad: 1.44,  other: 0.426
perpare first backward gemm: 0.023,  fisrt gemm backward duration: 4.227,  weight grad: 1.363,  other: 0.397
Linear 1 Backward:  6.039
Linear 1 Backward:  6.25
perpare first backward gemm: 0.032,  fisrt gemm backward duration: 3.163,  weight grad: 2.015,  other: 0.411
Linear 1 Backward:  5.658
perpare first backward gemm: 0.04,  fisrt gemm backward duration: 2.566,  weight grad: 2.249,  other: 0.469
Linear 1 Backward:  5.376
STEP-84: step_time = 29.585922 ms, foward_time = 16.580097, backward_time = 12.916736, perf = 27.87 tflops.
start
start
start
start
block_info 284 106
block_info 220 53
cuda:2 process time:3.7996768951416016, a: 0.6837844848632812, b: 1.5757083892822266, c: 0.102996826171875, d: 1.4371871948242188
cuda:1 process time:3.9806365966796875, a: 0.7593631744384766, b: 1.4061927795410156, c: 0.12946128845214844, d: 1.6856193542480469
2 wait time: 0.702
284
block_info 208 46
1 wait time: 1.233
220
block_info 320 133
cuda:3 process time:4.577875137329102, a: 0.9527206420898438, b: 1.3689994812011719, c: 0.2090930938720703, d: 2.0470619201660156
cuda:0 process time:5.083560943603516, a: 0.9658336639404297, b: 1.2011528015136719, c: 0.2117156982421875, d: 2.7048587799072266
3 wait time: 2.723
208
0 wait time: 2.557
320
AG, 0.221154, 1.525760, 0 
perpare first forward gemm: 0.292,  fisrt gemm forward duration: 2.101
AG, 0.240909, 1.835008, 0 
perpare first forward gemm: 0.294,  fisrt gemm forward duration: 3.17
AG, 0.373239, 2.307072, 0 
perpare first forward gemm: 0.331,  fisrt gemm forward duration: 3.973
AG, 0.415625, 2.612224, 0 
perpare first forward gemm: 0.354,  fisrt gemm forward duration: 2.677
GA, 0.221154, 1.057792, 0 
GA, 0.240909, 1.818624, 0 
GA, 0.373239, 2.113536, 0 
GA, 0.415625, 2.406400, 0 
forward:  14.175
forward:  13.781
forward:  12.621
forward:  13.034
AG, 0.221154, 1.541120, 0 
AG, 0.240909, 1.828864, 0 
AG, 0.373239, 2.310144, 0 
Linear 2 Backward: 2.952, second_gemm: 2.937
AG, 0.415625, 2.613248, 0 
Linear 2 Backward: 3.238, second_gemm: 3.232
Linear 2 Backward: 4.216, second_gemm: 4.208
GA, 0.221154, 1.054720, 0 
Linear 2 Backward: 4.653, second_gemm: 4.643
GA, 0.240909, 1.812480, 0 
GA, 0.373239, 2.396160, 0 
GA, 0.415625, 2.581504, 0 
perpare first backward gemm: 0.023,  fisrt gemm backward duration: 4.329,  weight grad: 1.363,  other: 0.4
Linear 1 Backward:  6.143
perpare first backward gemm: 0.032,  fisrt gemm backward duration: 4.403,  weight grad: 1.438,  other: 0.45
Linear 1 Backward:  6.376
perpare first backward gemm: 0.032,  fisrt gemm backward duration: 3.24,  weight grad: 2.032,  other: 0.416
Linear 1 Backward:  5.759
perpare first backward gemm: 0.04,  fisrt gemm backward duration: 2.637,  weight grad: 2.272,  other: 0.45
Linear 1 Backward:  5.449
STEP-85: step_time = 29.293570 ms, foward_time = 16.179199, backward_time = 13.027328, perf = 28.15 tflops.
start
start
start
start
block_info 284 106
block_info 220 53
cuda:2 process time:3.9856433868408203, a: 0.7040500640869141, b: 1.7352104187011719, c: 0.1010894775390625, d: 1.4452934265136719
cuda:1 process time:4.230976104736328, a: 0.75531005859375, b: 1.7321109771728516, c: 0.12540817260742188, d: 1.6181468963623047
2 wait time: 0.677
284
block_info 208 46
1 wait time: 1.219
220
block_info 320 133
cuda:3 process time:4.535436630249023, a: 0.9400844573974609, b: 1.1639595031738281, c: 0.20885467529296875, d: 2.2225379943847656
3 wait time: 2.324
208
cuda:0 process time:5.288124084472656, a: 1.0161399841308594, b: 1.6374588012695312, c: 0.21219253540039062, d: 2.422332763671875
0 wait time: 3.087
320
AG, 0.221154, 1.522688, 0 
perpare first forward gemm: 0.251,  fisrt gemm forward duration: 2.35
AG, 0.240909, 1.836032, 0 
perpare first forward gemm: 0.293,  fisrt gemm forward duration: 3.259
AG, 0.373239, 2.285568, 0 
perpare first forward gemm: 0.331,  fisrt gemm forward duration: 3.911
AG, 0.415625, 2.591744, 0 
perpare first forward gemm: 0.35,  fisrt gemm forward duration: 2.642
GA, 0.221154, 1.058816, 0 
GA, 0.240909, 1.797120, 0 
GA, 0.373239, 2.008064, 0 
GA, 0.415625, 2.522112, 0 
forward:  14.238
forward:  13.94
forward:  12.704
forward:  13.225
AG, 0.221154, 1.529856, 0 
AG, 0.240909, 1.813504, 0 
AG, 0.373239, 2.300928, 0 
Linear 2 Backward: 2.944, second_gemm: 2.928
AG, 0.415625, 2.592768, 0 
Linear 2 Backward: 3.228, second_gemm: 3.221
Linear 2 Backward: 4.214, second_gemm: 4.206
GA, 0.221154, 1.058816, 0 
Linear 2 Backward: 4.595, second_gemm: 4.584
GA, 0.240909, 1.793024, 0 
GA, 0.373239, 2.191360, 0 
GA, 0.415625, 2.576384, 0 
perpare first backward gemm: 0.023,  fisrt gemm backward duration: 4.296,  weight grad: 1.364,  other: 0.402
Linear 1 Backward:  6.113
perpare first backward gemm: 0.032,  fisrt gemm backward duration: 4.373,  weight grad: 1.442,  other: 0.428
Linear 1 Backward:  6.328
perpare first backward gemm: 0.032,  fisrt gemm backward duration: 3.199,  weight grad: 2.014,  other: 0.42
Linear 1 Backward:  5.704
perpare first backward gemm: 0.04,  fisrt gemm backward duration: 2.632,  weight grad: 2.246,  other: 0.46
Linear 1 Backward:  5.43
STEP-86: step_time = 29.687265 ms, foward_time = 16.643553, backward_time = 12.951552, perf = 27.78 tflops.
start
start
start
start
block_info 284 106
block_info 220 53
cuda:2 process time:3.8018226623535156, a: 0.7061958312988281, b: 1.5368461608886719, c: 0.10251998901367188, d: 1.4562606811523438
block_info 208 46
cuda:1 process time:4.138469696044922, a: 0.7822513580322266, b: 1.6033649444580078, c: 0.12135505676269531, d: 1.6314983367919922
2 wait time: 0.71
284
1 wait time: 1.383
220
block_info 320 133
cuda:3 process time:4.432916641235352, a: 0.9584426879882812, b: 1.3585090637207031, c: 0.19240379333496094, d: 1.9235610961914062
3 wait time: 2.495
208
cuda:0 process time:5.060672760009766, a: 0.9949207305908203, b: 1.222848892211914, c: 0.2129077911376953, d: 2.629995346069336
0 wait time: 2.806
320
AG, 0.221154, 1.524736, 0 
perpare first forward gemm: 0.264,  fisrt gemm forward duration: 2.483
AG, 0.240909, 1.837056, 0 
perpare first forward gemm: 0.305,  fisrt gemm forward duration: 3.094
AG, 0.373239, 2.286592, 0 
perpare first forward gemm: 0.331,  fisrt gemm forward duration: 3.831
AG, 0.415625, 2.586624, 0 
perpare first forward gemm: 0.297,  fisrt gemm forward duration: 2.638
GA, 0.221154, 1.064960, 0 
GA, 0.240909, 1.790976, 0 
GA, 0.373239, 2.114560, 0 
GA, 0.415625, 2.531328, 0 
forward:  14.133
forward:  13.806
forward:  12.579
forward:  13.402
AG, 0.221154, 1.527808, 0 
AG, 0.240909, 1.817600, 0 
AG, 0.373239, 2.296832, 0 
Linear 2 Backward: 2.969, second_gemm: 2.953
AG, 0.415625, 2.590720, 0 
Linear 2 Backward: 3.225, second_gemm: 3.218
Linear 2 Backward: 4.22, second_gemm: 4.212
GA, 0.221154, 1.050624, 0 
Linear 2 Backward: 4.607, second_gemm: 4.597
GA, 0.240909, 1.792000, 0 
GA, 0.373239, 2.126848, 0 
GA, 0.415625, 2.574336, 0 
perpare first backward gemm: 0.024,  fisrt gemm backward duration: 4.297,  weight grad: 1.368,  other: 0.411
Linear 1 Backward:  6.129
perpare first backward gemm: 0.031,  fisrt gemm backward duration: 4.37,  weight grad: 1.437,  other: 0.444
Linear 1 Backward:  6.334
perpare first backward gemm: 0.032,  fisrt gemm backward duration: 3.212,  weight grad: 2.019,  other: 0.41
Linear 1 Backward:  5.708
perpare first backward gemm: 0.04,  fisrt gemm backward duration: 2.632,  weight grad: 2.253,  other: 0.449
Linear 1 Backward:  5.424
STEP-87: step_time = 29.571073 ms, foward_time = 16.454656, backward_time = 13.024256, perf = 27.89 tflops.
start
start
start
start
block_info 284 106
cuda:2 process time:4.141330718994141, a: 0.7050037384033203, b: 1.8606185913085938, c: 0.10251998901367188, d: 1.4731884002685547
block_info 208 46
2 wait time: 0.633
284
block_info 220 53
block_info 320 133
cuda:3 process time:4.483938217163086, a: 0.9200572967529297, b: 1.2128353118896484, c: 0.19860267639160156, d: 2.1524429321289062
3 wait time: 2.039
208
cuda:1 process time:5.327463150024414, a: 0.8933544158935547, b: 1.8873214721679688, c: 0.21338462829589844, d: 2.333402633666992
cuda:0 process time:5.01704216003418, a: 0.9539127349853516, b: 1.2180805206298828, c: 0.2148151397705078, d: 2.6302337646484375
1 wait time: 2.4
220
0 wait time: 2.751
320
AG, 0.221154, 1.530880, 0 
perpare first forward gemm: 0.247,  fisrt gemm forward duration: 2.401
AG, 0.240909, 1.829888, 0 
perpare first forward gemm: 0.247,  fisrt gemm forward duration: 2.187
AG, 0.373239, 2.292736, 0 
perpare first forward gemm: 0.336,  fisrt gemm forward duration: 3.886
AG, 0.415625, 2.610176, 0 
perpare first forward gemm: 0.301,  fisrt gemm forward duration: 2.661
GA, 0.221154, 1.058816, 0 
GA, 0.240909, 1.778688, 0 
GA, 0.373239, 2.153472, 0 
GA, 0.415625, 2.583552, 0 
forward:  14.322
forward:  13.458
forward:  12.946
forward:  12.785
AG, 0.221154, 1.539072, 0 
AG, 0.240909, 1.812480, 0 
AG, 0.373239, 2.282496, 0 
Linear 2 Backward: 2.977, second_gemm: 2.963
AG, 0.415625, 2.601984, 0 
Linear 2 Backward: 3.198, second_gemm: 3.191
Linear 2 Backward: 4.166, second_gemm: 4.158
GA, 0.221154, 1.057792, 0 
Linear 2 Backward: 4.651, second_gemm: 4.641
GA, 0.240909, 1.792000, 0 
GA, 0.373239, 2.078720, 0 
GA, 0.415625, 2.572288, 0 
perpare first backward gemm: 0.032,  fisrt gemm backward duration: 4.401,  weight grad: 1.439,  other: 0.427
Linear 1 Backward:  6.352
perpare first backward gemm: 0.023,  fisrt gemm backward duration: 4.344,  weight grad: 1.367,  other: 0.4
Linear 1 Backward:  6.162
perpare first backward gemm: 0.032,  fisrt gemm backward duration: 3.253,  weight grad: 2.012,  other: 0.411
Linear 1 Backward:  5.744
perpare first backward gemm: 0.04,  fisrt gemm backward duration: 2.629,  weight grad: 2.289,  other: 0.457
Linear 1 Backward:  5.466
STEP-88: step_time = 29.790208 ms, foward_time = 16.606208, backward_time = 13.091840, perf = 27.68 tflops.
start
start
start
block_info 284 106
block_info 208 46
block_info 220 53
cuda:2 process time:3.771066665649414, a: 0.6086826324462891, b: 1.7244815826416016, c: 0.10895729064941406, d: 1.3289451599121094
cuda:3 process time:3.3080577850341797, a: 0.6763935089111328, b: 1.1816024780273438, c: 0.11396408081054688, d: 1.3360977172851562
cuda:1 process time:3.976583480834961, a: 0.7600784301757812, b: 1.5833377838134766, c: 0.11467933654785156, d: 1.5184879302978516
start
3 wait time: 0.656
208
2 wait time: 0.176
284
1 wait time: 1.12
220
block_info 320 133
cuda:0 process time:4.908323287963867, a: 1.0004043579101562, b: 1.2464523315429688, c: 0.20074844360351562, d: 2.4607181549072266
0 wait time: 2.564
320
AG, 0.221154, 1.536000, 0 
perpare first forward gemm: 0.288,  fisrt gemm forward duration: 3.194
AG, 0.240909, 1.830912, 0 
perpare first forward gemm: 0.294,  fisrt gemm forward duration: 3.224
AG, 0.373239, 2.301952, 0 
perpare first forward gemm: 0.331,  fisrt gemm forward duration: 3.719
AG, 0.415625, 2.604032, 0 
perpare first forward gemm: 0.357,  fisrt gemm forward duration: 2.673
GA, 0.221154, 1.056768, 0 
GA, 0.240909, 1.789952, 0 
GA, 0.373239, 2.144256, 0 
GA, 0.415625, 2.572288, 0 
forward:  13.997
forward:  14.261
forward:  14.084
forward:  12.822
AG, 0.221154, 1.548288, 0 
AG, 0.240909, 1.806336, 0 
AG, 0.373239, 2.310144, 0 
AG, 0.415625, 2.611200, 0 
Linear 2 Backward: 2.993, second_gemm: 2.977
Linear 2 Backward: 3.235, second_gemm: 3.229
Linear 2 Backward: 4.094, second_gemm: 4.087
GA, 0.221154, 1.034240, 0 
Linear 2 Backward: 4.67, second_gemm: 4.659
GA, 0.240909, 1.784832, 0 
GA, 0.373239, 2.082816, 0 
GA, 0.415625, 2.549760, 0 
perpare first backward gemm: 0.023,  fisrt gemm backward duration: 4.3,  weight grad: 1.362,  other: 0.398
Linear 1 Backward:  6.111
perpare first backward gemm: 0.032,  fisrt gemm backward duration: 4.327,  weight grad: 1.435,  other: 0.426
Linear 1 Backward:  6.271
perpare first backward gemm: 0.032,  fisrt gemm backward duration: 3.174,  weight grad: 2.014,  other: 0.412
Linear 1 Backward:  5.667
perpare first backward gemm: 0.04,  fisrt gemm backward duration: 2.607,  weight grad: 2.269,  other: 0.45
Linear 1 Backward:  5.417
STEP-89: step_time = 29.576194 ms, foward_time = 16.435200, backward_time = 13.053952, perf = 27.88 tflops.
start
start
start
start
block_info 284 106
block_info 220 53
cuda:2 process time:4.106044769287109, a: 0.690460205078125, b: 1.8754005432128906, c: 0.102996826171875, d: 1.4371871948242188
block_info 320 133
2 wait time: 0.663
284
cuda:1 process time:4.059791564941406, a: 0.7770061492919922, b: 1.4727115631103516, c: 0.14495849609375, d: 1.6651153564453125
block_info 208 46
1 wait time: 1.295
220
cuda:0 process time:4.3888092041015625, a: 0.9722709655761719, b: 1.2235641479492188, c: 0.21386146545410156, d: 1.9791126251220703
cuda:3 process time:4.699945449829102, a: 0.9095668792724609, b: 1.3141632080078125, c: 0.23245811462402344, d: 2.2437572479248047
0 wait time: 2.112
320
3 wait time: 2.339
208
AG, 0.221154, 1.532928, 0 
perpare first forward gemm: 0.287,  fisrt gemm forward duration: 1.621
AG, 0.240909, 1.842176, 0 
perpare first forward gemm: 0.296,  fisrt gemm forward duration: 2.632
AG, 0.373239, 2.285568, 0 
perpare first forward gemm: 0.333,  fisrt gemm forward duration: 3.398
AG, 0.415625, 2.614272, 0 
perpare first forward gemm: 0.354,  fisrt gemm forward duration: 2.832
GA, 0.221154, 1.054720, 0 
GA, 0.240909, 1.761280, 0 
GA, 0.373239, 2.142208, 0 
GA, 0.415625, 2.605056, 0 
forward:  12.964
forward:  13.81
forward:  12.711
forward:  13.432
AG, 0.221154, 1.541120, 0 
AG, 0.240909, 1.826816, 0 
AG, 0.373239, 2.289664, 0 
AG, 0.415625, 2.597888, 0 
Linear 2 Backward: 2.953, second_gemm: 2.937
Linear 2 Backward: 3.216, second_gemm: 3.21
Linear 2 Backward: 4.162, second_gemm: 4.154
GA, 0.221154, 1.047552, 0 
Linear 2 Backward: 4.636, second_gemm: 4.625
GA, 0.240909, 1.800192, 0 
GA, 0.373239, 1.960960, 0 
GA, 0.415625, 2.608128, 0 
perpare first backward gemm: 0.023,  fisrt gemm backward duration: 4.335,  weight grad: 1.365,  other: 0.397
Linear 1 Backward:  6.149
perpare first backward gemm: 0.031,  fisrt gemm backward duration: 4.401,  weight grad: 1.439,  other: 0.429
Linear 1 Backward:  6.355
perpare first backward gemm: 0.032,  fisrt gemm backward duration: 3.262,  weight grad: 2.015,  other: 0.412
Linear 1 Backward:  5.758
perpare first backward gemm: 0.04,  fisrt gemm backward duration: 2.68,  weight grad: 2.27,  other: 0.452
Linear 1 Backward:  5.492
STEP-90: step_time = 29.210624 ms, foward_time = 16.054271, backward_time = 13.072384, perf = 28.23 tflops.
start
start
start
start
block_info 220 53
block_info 284 106
cuda:2 process time:3.9687156677246094, a: 0.7002353668212891, b: 1.7158985137939453, c: 0.10347366333007812, d: 1.4491081237792969
cuda:1 process time:4.008054733276367, a: 0.7822513580322266, b: 1.5206336975097656, c: 0.125885009765625, d: 1.57928466796875
block_info 320 133
2 wait time: 1.027
284
block_info 208 46
1 wait time: 1.37
220
cuda:0 process time:4.604578018188477, a: 0.9996891021728516, b: 1.617431640625, c: 0.16379356384277344, d: 1.8236637115478516
cuda:3 process time:4.566669464111328, a: 0.9894371032714844, b: 1.142740249633789, c: 0.21004676818847656, d: 2.224445343017578
0 wait time: 2.435
320
3 wait time: 2.34
208
AG, 0.221154, 1.514496, 0 
perpare first forward gemm: 0.288,  fisrt gemm forward duration: 1.614
AG, 0.240909, 1.803264, 0 
perpare first forward gemm: 0.295,  fisrt gemm forward duration: 2.784
AG, 0.373239, 2.289664, 0 
perpare first forward gemm: 0.331,  fisrt gemm forward duration: 3.293
AG, 0.415625, 2.564096, 0 
perpare first forward gemm: 0.372,  fisrt gemm forward duration: 2.701
GA, 0.221154, 1.046528, 0 
GA, 0.240909, 1.790976, 0 
GA, 0.373239, 2.210816, 0 
GA, 0.415625, 2.577408, 0 
forward:  12.915
forward:  13.637
forward:  13.7
forward:  12.724
AG, 0.221154, 1.525760, 0 
AG, 0.240909, 1.816576, 0 
AG, 0.373239, 2.301952, 0 
Linear 2 Backward: 2.919, second_gemm: 2.903
AG, 0.415625, 2.615296, 0 
Linear 2 Backward: 3.224, second_gemm: 3.217
Linear 2 Backward: 4.216, second_gemm: 4.208
GA, 0.221154, 1.052672, 0 
Linear 2 Backward: 4.722, second_gemm: 4.712
GA, 0.240909, 1.808384, 0 
GA, 0.373239, 2.071552, 0 
GA, 0.415625, 2.496512, 0 
perpare first backward gemm: 0.023,  fisrt gemm backward duration: 4.254,  weight grad: 1.363,  other: 0.4
Linear 1 Backward:  6.069
perpare first backward gemm: 0.032,  fisrt gemm backward duration: 4.332,  weight grad: 1.447,  other: 0.429
Linear 1 Backward:  6.292
perpare first backward gemm: 0.031,  fisrt gemm backward duration: 3.158,  weight grad: 2.009,  other: 0.401
Linear 1 Backward:  5.63
perpare first backward gemm: 0.04,  fisrt gemm backward duration: 2.552,  weight grad: 2.25,  other: 0.448
Linear 1 Backward:  5.343
STEP-91: step_time = 29.207936 ms, foward_time = 16.152961, backward_time = 12.975104, perf = 28.23 tflops.
start
start
start
start
block_info 284 106
block_info 220 53
block_info 208 46
cuda:2 process time:4.023313522338867, a: 0.7078647613525391, b: 1.77001953125, c: 0.102996826171875, d: 1.4424324035644531
block_info 320 133
cuda:1 process time:4.080772399902344, a: 0.7288455963134766, b: 1.6417503356933594, c: 0.12278556823730469, d: 1.5873908996582031
2 wait time: 0.679
284
cuda:3 process time:4.090309143066406, a: 0.9050369262695312, b: 1.1553764343261719, c: 0.17023086547851562, d: 1.8596649169921875
1 wait time: 1.238
220
cuda:0 process time:4.396915435791016, a: 0.9424686431884766, b: 1.3937950134277344, c: 0.16236305236816406, d: 1.8982887268066406
3 wait time: 1.918
208
0 wait time: 2.054
320
AG, 0.221154, 1.525760, 0 
perpare first forward gemm: 0.285,  fisrt gemm forward duration: 1.724
AG, 0.240909, 1.841152, 0 
perpare first forward gemm: 0.296,  fisrt gemm forward duration: 2.363
AG, 0.373239, 2.301952, 0 
perpare first forward gemm: 0.332,  fisrt gemm forward duration: 2.908
AG, 0.415625, 2.598912, 0 
perpare first forward gemm: 0.334,  fisrt gemm forward duration: 2.659
GA, 0.221154, 1.049600, 0 
GA, 0.240909, 1.796096, 0 
GA, 0.373239, 2.054144, 0 
GA, 0.415625, 2.585600, 0 
forward:  13.245
forward:  13.098
forward:  12.665
forward:  12.771
AG, 0.221154, 1.530880, 0 
AG, 0.240909, 1.824768, 0 
AG, 0.373239, 2.281472, 0 
AG, 0.415625, 2.582528, 0 
Linear 2 Backward: 2.975, second_gemm: 2.959
Linear 2 Backward: 3.026, second_gemm: 3.02
Linear 2 Backward: 4.02, second_gemm: 4.014
GA, 0.221154, 1.052672, 0 
Linear 2 Backward: 4.637, second_gemm: 4.627
GA, 0.240909, 1.788928, 0 
GA, 0.373239, 2.113536, 0 
GA, 0.415625, 2.502656, 0 
perpare first backward gemm: 0.022,  fisrt gemm backward duration: 4.201,  weight grad: 1.368,  other: 0.398
Linear 1 Backward:  6.017
perpare first backward gemm: 0.032,  fisrt gemm backward duration: 4.283,  weight grad: 1.436,  other: 0.427
Linear 1 Backward:  6.23
perpare first backward gemm: 0.028,  fisrt gemm backward duration: 3.192,  weight grad: 1.988,  other: 0.407
Linear 1 Backward:  5.644
perpare first backward gemm: 0.04,  fisrt gemm backward duration: 2.56,  weight grad: 2.248,  other: 0.446
Linear 1 Backward:  5.345
STEP-92: step_time = 28.623873 ms, foward_time = 15.653888, backward_time = 12.882944, perf = 28.81 tflops.
start
start
start
start
block_info 220 53
block_info 284 106
cuda:2 process time:3.986835479736328, a: 0.6184577941894531, b: 1.8048286437988281, c: 0.1068115234375, d: 1.4567375183105469
cuda:1 process time:3.894329071044922, a: 0.7624626159667969, b: 1.5118122100830078, c: 0.12087821960449219, d: 1.499176025390625
2 wait time: 1.029
284
1 wait time: 1.326
220
block_info 208 46
block_info 320 133
cuda:3 process time:4.602909088134766, a: 0.9646415710449219, b: 1.3477802276611328, c: 0.2288818359375, d: 2.061605453491211
cuda:0 process time:5.307912826538086, a: 0.9675025939941406, b: 1.5070438385009766, c: 0.21409988403320312, d: 2.6192665100097656
3 wait time: 2.721
208
0 wait time: 2.778
320
AG, 0.221154, 1.530880, 0 
perpare first forward gemm: 0.296,  fisrt gemm forward duration: 2.08
AG, 0.240909, 1.838080, 0 
perpare first forward gemm: 0.295,  fisrt gemm forward duration: 3.511
AG, 0.373239, 2.302976, 0 
perpare first forward gemm: 0.333,  fisrt gemm forward duration: 3.966
AG, 0.415625, 2.606080, 0 
perpare first forward gemm: 0.39,  fisrt gemm forward duration: 2.671
GA, 0.221154, 1.052672, 0 
GA, 0.240909, 1.815552, 0 
GA, 0.373239, 2.093056, 0 
GA, 0.415625, 2.647040, 0 
forward:  14.446
forward:  14.392
forward:  13.331
forward:  12.966
AG, 0.221154, 1.531904, 0 
AG, 0.240909, 1.815552, 0 
AG, 0.373239, 2.313216, 0 
Linear 2 Backward: 2.946, second_gemm: 2.93
AG, 0.415625, 2.616320, 0 
Linear 2 Backward: 3.229, second_gemm: 3.222
Linear 2 Backward: 4.215, second_gemm: 4.209
GA, 0.221154, 1.058816, 0 
Linear 2 Backward: 4.652, second_gemm: 4.642
GA, 0.240909, 1.710080, 0 
GA, 0.373239, 2.124800, 0 
GA, 0.415625, 2.521088, 0 
perpare first backward gemm: 0.023,  fisrt gemm backward duration: 4.292,  weight grad: 1.364,  other: 0.4
Linear 1 Backward:  6.108
perpare first backward gemm: 0.031,  fisrt gemm backward duration: 4.361,  weight grad: 1.439,  other: 0.429
Linear 1 Backward:  6.314
perpare first backward gemm: 0.029,  fisrt gemm backward duration: 3.191,  weight grad: 2.024,  other: 0.403
Linear 1 Backward:  5.678
perpare first backward gemm: 0.039,  fisrt gemm backward duration: 2.578,  weight grad: 2.292,  other: 0.454
Linear 1 Backward:  5.416
STEP-93: step_time = 29.664254 ms, foward_time = 16.574464, backward_time = 12.998656, perf = 27.80 tflops.
start
start
start
start
block_info 220 53
block_info 284 106
cuda:1 process time:3.5452842712402344, a: 0.8175373077392578, b: 1.046895980834961, c: 0.12540817260742188, d: 1.5554428100585938
cuda:2 process time:4.107952117919922, a: 0.6880760192871094, b: 1.8680095672607422, c: 0.10371208190917969, d: 1.4481544494628906
block_info 208 46
1 wait time: 1.357
220
2 wait time: 1.107
284
block_info 320 133
cuda:3 process time:4.821300506591797, a: 0.8499622344970703, b: 1.7099380493164062, c: 0.2071857452392578, d: 2.0542144775390625
3 wait time: 2.673
208
cuda:0 process time:5.251169204711914, a: 0.9915828704833984, b: 1.4138221740722656, c: 0.2148151397705078, d: 2.630949020385742
0 wait time: 2.697
320
AG, 0.221154, 1.521664, 0 
perpare first forward gemm: 0.26,  fisrt gemm forward duration: 2.253
AG, 0.240909, 1.838080, 0 
perpare first forward gemm: 0.295,  fisrt gemm forward duration: 3.35
AG, 0.373239, 2.295808, 0 
perpare first forward gemm: 0.334,  fisrt gemm forward duration: 3.733
AG, 0.415625, 2.609152, 0 
perpare first forward gemm: 0.304,  fisrt gemm forward duration: 2.66
GA, 0.221154, 1.071104, 0 
GA, 0.240909, 1.784832, 0 
GA, 0.373239, 2.205696, 0 
GA, 0.415625, 2.621440, 0 
forward:  14.21
forward:  14.19
forward:  12.806
forward:  13.322
AG, 0.221154, 1.547264, 0 
AG, 0.240909, 1.817600, 0 
AG, 0.373239, 2.293760, 0 
AG, 0.415625, 2.606080, 0 
Linear 2 Backward: 2.955, second_gemm: 2.94
Linear 2 Backward: 3.261, second_gemm: 3.254
Linear 2 Backward: 4.268, second_gemm: 4.261
GA, 0.221154, 1.054720, 0 
Linear 2 Backward: 4.626, second_gemm: 4.616
GA, 0.240909, 1.789952, 0 
GA, 0.373239, 2.136064, 0 
GA, 0.415625, 2.597888, 0 
perpare first backward gemm: 0.022,  fisrt gemm backward duration: 4.341,  weight grad: 1.366,  other: 0.399
Linear 1 Backward:  6.158
perpare first backward gemm: 0.031,  fisrt gemm backward duration: 4.382,  weight grad: 1.459,  other: 0.434
Linear 1 Backward:  6.36
perpare first backward gemm: 0.028,  fisrt gemm backward duration: 3.277,  weight grad: 2.006,  other: 0.399
Linear 1 Backward:  5.739
perpare first backward gemm: 0.039,  fisrt gemm backward duration: 2.656,  weight grad: 2.272,  other: 0.449
Linear 1 Backward:  5.468
STEP-94: step_time = 29.607936 ms, foward_time = 16.461824, backward_time = 13.048832, perf = 27.85 tflops.
start
start
start
block_info 284 106
start
cuda:2 process time:4.124879837036133, a: 0.6022453308105469, b: 1.9321441650390625, c: 0.10347366333007812, d: 1.4870166778564453
block_info 220 53
block_info 208 46
2 wait time: 0.48
284
block_info 320 133
cuda:1 process time:4.406929016113281, a: 0.9481906890869141, b: 1.2090206146240234, c: 0.18668174743652344, d: 2.0630359649658203
cuda:3 process time:4.615545272827148, a: 0.9367465972900391, b: 1.1820793151855469, c: 0.21219253540039062, d: 2.284526824951172
1 wait time: 2.112
220
3 wait time: 2.329
208
cuda:0 process time:5.3462982177734375, a: 0.9968280792236328, b: 1.680135726928711, c: 0.21409988403320312, d: 2.4552345275878906
0 wait time: 3.164
320
AG, 0.221154, 1.563648, 0 
perpare first forward gemm: 0.293,  fisrt gemm forward duration: 2.352
AG, 0.240909, 1.819648, 0 
perpare first forward gemm: 0.246,  fisrt gemm forward duration: 2.813
AG, 0.373239, 2.322432, 0 
perpare first forward gemm: 0.28,  fisrt gemm forward duration: 4.017
AG, 0.415625, 2.595840, 0 
perpare first forward gemm: 0.352,  fisrt gemm forward duration: 2.662
GA, 0.221154, 1.071104, 0 
GA, 0.240909, 1.766400, 0 
GA, 0.373239, 2.076672, 0 
GA, 0.415625, 2.562048, 0 
forward:  13.517
forward:  14.272
forward:  12.809
forward:  13.385
AG, 0.221154, 1.560576, 0 
AG, 0.240909, 1.812480, 0 
AG, 0.373239, 2.307072, 0 
AG, 0.415625, 2.594816, 0 
Linear 2 Backward: 2.967, second_gemm: 2.952
Linear 2 Backward: 3.245, second_gemm: 3.239
Linear 2 Backward: 4.246, second_gemm: 4.24
GA, 0.221154, 1.059840, 0 
Linear 2 Backward: 4.609, second_gemm: 4.598
GA, 0.240909, 1.787904, 0 
GA, 0.373239, 2.099200, 0 
GA, 0.415625, 2.601984, 0 
perpare first backward gemm: 0.023,  fisrt gemm backward duration: 4.326,  weight grad: 1.366,  other: 0.397
Linear 1 Backward:  6.14
perpare first backward gemm: 0.032,  fisrt gemm backward duration: 4.355,  weight grad: 1.454,  other: 0.434
Linear 1 Backward:  6.328
perpare first backward gemm: 0.028,  fisrt gemm backward duration: 3.247,  weight grad: 2.003,  other: 0.399
Linear 1 Backward:  5.712
perpare first backward gemm: 0.039,  fisrt gemm backward duration: 2.658,  weight grad: 2.244,  other: 0.444
Linear 1 Backward:  5.436
STEP-95: step_time = 29.978241 ms, foward_time = 16.834177, backward_time = 13.049856, perf = 27.51 tflops.
start
start
start
block_info 284 106
start
block_info 208 46
cuda:2 process time:4.244565963745117, a: 0.7135868072509766, b: 1.9686222076416016, c: 0.10752677917480469, d: 1.4548301696777344
block_info 320 133
cuda:3 process time:4.232645034790039, a: 0.9248256683349609, b: 1.6965866088867188, c: 0.20956993103027344, d: 1.401662826538086
2 wait time: 0.68
284
3 wait time: 1.98
208
cuda:0 process time:4.35948371887207, a: 0.9484291076660156, b: 1.1906623840332031, c: 0.1647472381591797, d: 2.055644989013672
block_info 220 53
0 wait time: 2.128
320
cuda:1 process time:5.444049835205078, a: 0.7638931274414062, b: 2.6547908782958984, c: 0.2052783966064453, d: 1.8200874328613281
1 wait time: 2.108
220
AG, 0.221154, 1.528832, 0 
perpare first forward gemm: 0.285,  fisrt gemm forward duration: 3.087
AG, 0.240909, 1.856512, 0 
perpare first forward gemm: 0.307,  fisrt gemm forward duration: 1.944
AG, 0.373239, 2.296832, 0 
perpare first forward gemm: 0.354,  fisrt gemm forward duration: 4.066
AG, 0.415625, 2.644992, 0 
perpare first forward gemm: 0.353,  fisrt gemm forward duration: 3.639
GA, 0.221154, 1.055744, 0 
GA, 0.240909, 1.756160, 0 
GA, 0.373239, 2.077696, 0 
GA, 0.415625, 2.608128, 0 
forward:  14.524
forward:  13.772
forward:  12.865
forward:  14.262
AG, 0.221154, 1.546240, 0 
AG, 0.240909, 1.810432, 0 
AG, 0.373239, 2.312192, 0 
AG, 0.415625, 2.604032, 0 
Linear 2 Backward: 2.955, second_gemm: 2.941
Linear 2 Backward: 3.083, second_gemm: 3.076
Linear 2 Backward: 4.247, second_gemm: 4.241
GA, 0.221154, 1.078272, 0 
Linear 2 Backward: 4.69, second_gemm: 4.679
GA, 0.240909, 1.786880, 0 
GA, 0.373239, 1.984512, 0 
GA, 0.415625, 2.603008, 0 
perpare first backward gemm: 0.023,  fisrt gemm backward duration: 4.352,  weight grad: 1.368,  other: 0.402
Linear 1 Backward:  6.175
perpare first backward gemm: 0.032,  fisrt gemm backward duration: 4.393,  weight grad: 1.468,  other: 0.435
Linear 1 Backward:  6.383
perpare first backward gemm: 0.028,  fisrt gemm backward duration: 3.278,  weight grad: 2.003,  other: 0.414
Linear 1 Backward:  5.754
perpare first backward gemm: 0.04,  fisrt gemm backward duration: 2.661,  weight grad: 2.272,  other: 0.451
Linear 1 Backward:  5.474
STEP-96: step_time = 30.187521 ms, foward_time = 16.975872, backward_time = 13.127680, perf = 27.32 tflops.
start
start
start
start
block_info 284 106
cuda:2 process time:4.00090217590332, a: 0.6883144378662109, b: 1.7697811126708984, c: 0.10251998901367188, d: 1.440286636352539
block_info 220 53
block_info 320 133
block_info 208 46
2 wait time: 1.096
284
cuda:1 process time:4.252910614013672, a: 0.9436607360839844, b: 1.2125968933105469, c: 0.17714500427246094, d: 1.9195079803466797
cuda:0 process time:4.234552383422852, a: 0.8008480072021484, b: 1.2161731719970703, c: 0.1633167266845703, d: 2.0542144775390625
cuda:3 process time:4.636526107788086, a: 0.9398460388183594, b: 1.4104843139648438, c: 0.1964569091796875, d: 2.0897388458251953
1 wait time: 2.034
220
3 wait time: 2.072
208
0 wait time: 2.197
320
AG, 0.221154, 1.528832, 0 
perpare first forward gemm: 0.293,  fisrt gemm forward duration: 1.762
AG, 0.240909, 1.843200, 0 
perpare first forward gemm: 0.295,  fisrt gemm forward duration: 2.137
AG, 0.373239, 2.295808, 0 
perpare first forward gemm: 0.33,  fisrt gemm forward duration: 3.265
AG, 0.415625, 2.605056, 0 
perpare first forward gemm: 0.351,  fisrt gemm forward duration: 2.668
GA, 0.221154, 1.055744, 0 
GA, 0.240909, 1.804288, 0 
GA, 0.373239, 2.023424, 0 
GA, 0.415625, 2.476032, 0 
forward:  12.663
forward:  12.795
forward:  13.528
forward:  12.726
AG, 0.221154, 1.532928, 0 
AG, 0.240909, 1.814528, 0 
AG, 0.373239, 2.271232, 0 
Linear 2 Backward: 2.933, second_gemm: 2.918
AG, 0.415625, 2.595840, 0 
Linear 2 Backward: 3.013, second_gemm: 3.006
Linear 2 Backward: 4.207, second_gemm: 4.2
GA, 0.221154, 1.062912, 0 
Linear 2 Backward: 4.655, second_gemm: 4.645
GA, 0.240909, 1.799168, 0 
GA, 0.373239, 2.010112, 0 
GA, 0.415625, 2.445312, 0 
perpare first backward gemm: 0.023,  fisrt gemm backward duration: 4.164,  weight grad: 1.371,  other: 0.399
Linear 1 Backward:  5.986
perpare first backward gemm: 0.032,  fisrt gemm backward duration: 4.239,  weight grad: 1.439,  other: 0.447
Linear 1 Backward:  6.21
perpare first backward gemm: 0.028,  fisrt gemm backward duration: 3.157,  weight grad: 1.986,  other: 0.399
Linear 1 Backward:  5.599
perpare first backward gemm: 0.038,  fisrt gemm backward duration: 2.502,  weight grad: 2.252,  other: 0.445
Linear 1 Backward:  5.287
STEP-97: step_time = 28.860416 ms, foward_time = 15.878145, backward_time = 12.895232, perf = 28.57 tflops.
start
start
start
block_info 284 106
start
block_info 220 53
block_info 320 133
cuda:2 process time:3.873109817504883, a: 0.7090568542480469, b: 1.567840576171875, c: 0.10251998901367188, d: 1.493692398071289
cuda:1 process time:4.0874481201171875, a: 0.7638931274414062, b: 1.6846656799316406, c: 0.11563301086425781, d: 1.5232563018798828
cuda:0 process time:3.741025924682617, a: 0.7355213165283203, b: 1.1894702911376953, c: 0.11658668518066406, d: 1.6994476318359375
2 wait time: 0.421
284
block_info 208 46
1 wait time: 1.08
220
0 wait time: 1.205
320
cuda:3 process time:4.492759704589844, a: 0.9272098541259766, b: 1.1432170867919922, c: 0.2105236053466797, d: 2.2118091583251953
3 wait time: 2.333
208
AG, 0.221154, 1.523712, 0 
perpare first forward gemm: 0.282,  fisrt gemm forward duration: 1.611
AG, 0.240909, 1.848320, 0 
perpare first forward gemm: 0.298,  fisrt gemm forward duration: 2.597
AG, 0.373239, 2.304000, 0 
perpare first forward gemm: 0.334,  fisrt gemm forward duration: 3.236
AG, 0.415625, 2.612224, 0 
perpare first forward gemm: 0.354,  fisrt gemm forward duration: 3.181
GA, 0.221154, 1.050624, 0 
GA, 0.240909, 1.770496, 0 
GA, 0.373239, 1.981440, 0 
GA, 0.415625, 2.591744, 0 
forward:  13.37
forward:  13.446
forward:  12.727
forward:  13.698
AG, 0.221154, 1.525760, 0 
AG, 0.240909, 1.813504, 0 
AG, 0.373239, 2.305024, 0 
Linear 2 Backward: 2.922, second_gemm: 2.906
AG, 0.415625, 2.625536, 0 
Linear 2 Backward: 3.45, second_gemm: 3.443
Linear 2 Backward: 4.193, second_gemm: 4.187
GA, 0.221154, 1.058816, 0 
Linear 2 Backward: 4.76, second_gemm: 4.75
GA, 0.240909, 1.780736, 0 
GA, 0.373239, 2.078720, 0 
GA, 0.415625, 2.525184, 0 
perpare first backward gemm: 0.022,  fisrt gemm backward duration: 4.306,  weight grad: 1.364,  other: 0.397
Linear 1 Backward:  6.119
perpare first backward gemm: 0.034,  fisrt gemm backward duration: 4.378,  weight grad: 1.444,  other: 0.432
Linear 1 Backward:  6.339
perpare first backward gemm: 0.028,  fisrt gemm backward duration: 3.224,  weight grad: 2.029,  other: 0.406
Linear 1 Backward:  5.717
perpare first backward gemm: 0.04,  fisrt gemm backward duration: 2.581,  weight grad: 2.293,  other: 0.451
Linear 1 Backward:  5.416
STEP-98: step_time = 28.921854 ms, foward_time = 15.571969, backward_time = 13.268992, perf = 28.51 tflops.
start
start
start
start
block_info 284 106
block_info 220 53
cuda:2 process time:3.6792755126953125, a: 0.6906986236572266, b: 1.458883285522461, c: 0.102996826171875, d: 1.42669677734375
block_info 320 133
cuda:1 process time:3.7615299224853516, a: 0.7352828979492188, b: 1.3551712036132812, c: 0.12159347534179688, d: 1.5494823455810547
2 wait time: 1.153
284
cuda:0 process time:4.132747650146484, a: 0.6589889526367188, b: 1.561880111694336, c: 0.1239776611328125, d: 1.7879009246826172
block_info 208 46
1 wait time: 1.229
220
0 wait time: 1.45
320
cuda:3 process time:4.57763671875, a: 0.9391307830810547, b: 1.1653900146484375, c: 0.21004676818847656, d: 2.2630691528320312
3 wait time: 2.291
208
AG, 0.221154, 1.522688, 0 
perpare first forward gemm: 0.301,  fisrt gemm forward duration: 1.611
AG, 0.240909, 1.841152, 0 
perpare first forward gemm: 0.294,  fisrt gemm forward duration: 2.694
AG, 0.373239, 2.296832, 0 
perpare first forward gemm: 0.323,  fisrt gemm forward duration: 3.264
AG, 0.415625, 2.604032, 0 
perpare first forward gemm: 0.355,  fisrt gemm forward duration: 2.982
GA, 0.221154, 1.053696, 0 
GA, 0.240909, 1.769472, 0 
GA, 0.373239, 2.150400, 0 
GA, 0.415625, 2.550784, 0 
forward:  13.426
forward:  13.127
forward:  13.623
forward:  12.64
AG, 0.221154, 1.529856, 0 
AG, 0.240909, 1.820672, 0 
AG, 0.373239, 2.301952, 0 
Linear 2 Backward: 2.922, second_gemm: 2.906
AG, 0.415625, 2.600960, 0 
Linear 2 Backward: 3.211, second_gemm: 3.205
Linear 2 Backward: 4.235, second_gemm: 4.229
GA, 0.221154, 1.060864, 0 
Linear 2 Backward: 4.654, second_gemm: 4.644
GA, 0.240909, 1.781760, 0 
GA, 0.373239, 2.139136, 0 
GA, 0.415625, 2.587648, 0 
perpare first backward gemm: 0.023,  fisrt gemm backward duration: 4.333,  weight grad: 1.363,  other: 0.4
Linear 1 Backward:  6.148
perpare first backward gemm: 0.032,  fisrt gemm backward duration: 4.41,  weight grad: 1.436,  other: 0.43
Linear 1 Backward:  6.36
perpare first backward gemm: 0.028,  fisrt gemm backward duration: 3.28,  weight grad: 2.009,  other: 0.403
Linear 1 Backward:  5.749
perpare first backward gemm: 0.041,  fisrt gemm backward duration: 2.643,  weight grad: 2.274,  other: 0.453
Linear 1 Backward:  5.463
STEP-99: step_time = 28.542977 ms, foward_time = 15.419392, backward_time = 13.038592, perf = 28.89 tflops.

[Summary] Average synchronized step_time = 29.280563259124754 ms, forward = 16.15769624710083, backward = 13.035827350616454.

 end end end
