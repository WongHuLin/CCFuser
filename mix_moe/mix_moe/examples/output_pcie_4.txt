cuda:0
cuda:2
cuda:3
cuda:1
[Benchmark] world_size = 4, dtype = float16, model_dim = 1024, hidden_size = 4096, samples = 8192, num_local_experts = 8, topK = 2, a2a_ffn_overlap_degree = 1, device = `cuda:0`
STEP-0: step_time = 43.185547 ms, foward_time = 17.716797, backward_time = 25.093121, perf = 19.10 tflops.
STEP-1: step_time = 20.974912 ms, foward_time = 9.848128, backward_time = 10.998784, perf = 39.32 tflops.
STEP-2: step_time = 21.281769 ms, foward_time = 9.877502, backward_time = 11.304960, perf = 38.75 tflops.
STEP-3: step_time = 20.361567 ms, foward_time = 9.820512, backward_time = 10.442752, perf = 40.50 tflops.
STEP-4: step_time = 20.146177 ms, foward_time = 9.520128, backward_time = 10.526720, perf = 40.93 tflops.
STEP-5: step_time = 20.565439 ms, foward_time = 9.799104, backward_time = 10.668032, perf = 40.10 tflops.
STEP-6: step_time = 20.534432 ms, foward_time = 9.397408, backward_time = 11.028480, perf = 40.16 tflops.
STEP-7: step_time = 21.175009 ms, foward_time = 10.282720, backward_time = 10.721280, perf = 38.94 tflops.
STEP-8: step_time = 19.522561 ms, foward_time = 9.037824, backward_time = 10.385408, perf = 42.24 tflops.
STEP-9: step_time = 19.879935 ms, foward_time = 9.225216, backward_time = 10.556416, perf = 41.48 tflops.
STEP-10: step_time = 19.730431 ms, foward_time = 9.126912, backward_time = 10.505216, perf = 41.80 tflops.
STEP-11: step_time = 20.099488 ms, foward_time = 9.589152, backward_time = 10.408960, perf = 41.03 tflops.
STEP-12: step_time = 20.175871 ms, foward_time = 9.249792, backward_time = 10.813440, perf = 40.87 tflops.
STEP-13: step_time = 19.547137 ms, foward_time = 8.966144, backward_time = 10.480640, perf = 42.19 tflops.
STEP-14: step_time = 19.858431 ms, foward_time = 9.210880, backward_time = 10.546176, perf = 41.53 tflops.
STEP-15: step_time = 20.225920 ms, foward_time = 9.745280, backward_time = 10.381312, perf = 40.77 tflops.
STEP-16: step_time = 19.533825 ms, foward_time = 9.088000, backward_time = 10.346496, perf = 42.22 tflops.
STEP-17: step_time = 19.544063 ms, foward_time = 9.180160, backward_time = 10.265600, perf = 42.19 tflops.
STEP-18: step_time = 20.584448 ms, foward_time = 9.661440, backward_time = 10.820608, perf = 40.06 tflops.
STEP-19: step_time = 20.105889 ms, foward_time = 9.809568, backward_time = 10.144768, perf = 41.01 tflops.
STEP-20: step_time = 19.874816 ms, foward_time = 9.273344, backward_time = 10.501120, perf = 41.49 tflops.
STEP-21: step_time = 20.047328 ms, foward_time = 9.413088, backward_time = 10.498048, perf = 41.13 tflops.
STEP-22: step_time = 20.242432 ms, foward_time = 9.694207, backward_time = 10.447872, perf = 40.74 tflops.
STEP-23: step_time = 20.262527 ms, foward_time = 9.635456, backward_time = 10.523648, perf = 40.70 tflops.
STEP-24: step_time = 20.453952 ms, foward_time = 9.932352, backward_time = 10.419200, perf = 40.32 tflops.
STEP-25: step_time = 20.539393 ms, foward_time = 9.286656, backward_time = 11.153408, perf = 40.15 tflops.
STEP-26: step_time = 19.374080 ms, foward_time = 9.251840, backward_time = 10.020864, perf = 42.56 tflops.
STEP-27: step_time = 20.295072 ms, foward_time = 9.817504, backward_time = 10.377216, perf = 40.63 tflops.
STEP-28: step_time = 20.245503 ms, foward_time = 9.752576, backward_time = 10.376192, perf = 40.73 tflops.
STEP-29: step_time = 19.871744 ms, foward_time = 9.441280, backward_time = 10.328064, perf = 41.50 tflops.
STEP-30: step_time = 20.226399 ms, foward_time = 9.781600, backward_time = 10.314752, perf = 40.77 tflops.
STEP-31: step_time = 20.466656 ms, foward_time = 9.530336, backward_time = 10.834944, perf = 40.29 tflops.
STEP-32: step_time = 20.222976 ms, foward_time = 9.622528, backward_time = 10.497024, perf = 40.78 tflops.
STEP-33: step_time = 20.352288 ms, foward_time = 9.900320, backward_time = 10.314752, perf = 40.52 tflops.
STEP-34: step_time = 20.022272 ms, foward_time = 9.581568, backward_time = 10.340352, perf = 41.19 tflops.
STEP-35: step_time = 20.449632 ms, foward_time = 9.744736, backward_time = 10.603520, perf = 40.33 tflops.
STEP-36: step_time = 19.612672 ms, foward_time = 9.190400, backward_time = 10.320896, perf = 42.05 tflops.
STEP-37: step_time = 20.051455 ms, foward_time = 9.358848, backward_time = 10.591232, perf = 41.13 tflops.
STEP-38: step_time = 20.295424 ms, foward_time = 9.724672, backward_time = 10.442752, perf = 40.63 tflops.
STEP-39: step_time = 19.487743 ms, foward_time = 8.912896, backward_time = 10.474496, perf = 42.32 tflops.
STEP-40: step_time = 20.097377 ms, foward_time = 9.737568, backward_time = 10.259456, perf = 41.03 tflops.
STEP-41: step_time = 19.724289 ms, foward_time = 9.034752, backward_time = 10.589184, perf = 41.81 tflops.
STEP-42: step_time = 20.514816 ms, foward_time = 9.838592, backward_time = 10.571776, perf = 40.20 tflops.
STEP-43: step_time = 19.981567 ms, foward_time = 9.436416, backward_time = 10.438656, perf = 41.27 tflops.
STEP-44: step_time = 20.633599 ms, foward_time = 9.680896, backward_time = 10.832896, perf = 39.97 tflops.
STEP-45: step_time = 20.433921 ms, foward_time = 9.641984, backward_time = 10.691584, perf = 40.36 tflops.
STEP-46: step_time = 20.406272 ms, foward_time = 9.647104, backward_time = 10.648576, perf = 40.41 tflops.
STEP-47: step_time = 20.013567 ms, foward_time = 9.467392, backward_time = 10.413056, perf = 41.20 tflops.
STEP-48: step_time = 20.258815 ms, foward_time = 9.360384, backward_time = 10.796032, perf = 40.70 tflops.
STEP-49: step_time = 20.961281 ms, foward_time = 10.097664, backward_time = 10.765312, perf = 39.34 tflops.
STEP-50: step_time = 20.459520 ms, foward_time = 9.567231, backward_time = 10.791936, perf = 40.31 tflops.
STEP-51: step_time = 20.490528 ms, foward_time = 9.686304, backward_time = 10.698752, perf = 40.24 tflops.
STEP-52: step_time = 19.937407 ms, foward_time = 9.609344, backward_time = 10.224640, perf = 41.36 tflops.
STEP-53: step_time = 20.104672 ms, foward_time = 9.397728, backward_time = 10.606592, perf = 41.02 tflops.
STEP-54: step_time = 19.712224 ms, foward_time = 9.350368, backward_time = 10.260480, perf = 41.83 tflops.
STEP-55: step_time = 20.257888 ms, foward_time = 9.635936, backward_time = 10.522624, perf = 40.71 tflops.
STEP-56: step_time = 20.463616 ms, foward_time = 9.763839, backward_time = 10.599424, perf = 40.30 tflops.
STEP-57: step_time = 20.587520 ms, foward_time = 9.588736, backward_time = 10.898432, perf = 40.06 tflops.
STEP-58: step_time = 20.141535 ms, foward_time = 9.545184, backward_time = 10.444800, perf = 40.94 tflops.
STEP-59: step_time = 20.417025 ms, foward_time = 9.863680, backward_time = 10.452992, perf = 40.39 tflops.
STEP-60: step_time = 20.428801 ms, foward_time = 9.562112, backward_time = 10.765312, perf = 40.37 tflops.
STEP-61: step_time = 20.451328 ms, foward_time = 9.550848, backward_time = 10.799104, perf = 40.32 tflops.
STEP-62: step_time = 20.481024 ms, foward_time = 9.915392, backward_time = 10.421248, perf = 40.26 tflops.
STEP-63: step_time = 20.256769 ms, foward_time = 9.771008, backward_time = 10.384384, perf = 40.71 tflops.
STEP-64: step_time = 20.062209 ms, foward_time = 9.509888, backward_time = 10.450944, perf = 41.10 tflops.
STEP-65: step_time = 20.396031 ms, foward_time = 9.547776, backward_time = 10.738688, perf = 40.43 tflops.
STEP-66: step_time = 20.285792 ms, foward_time = 9.928032, backward_time = 10.221568, perf = 40.65 tflops.
STEP-67: step_time = 20.168704 ms, foward_time = 9.579520, backward_time = 10.488832, perf = 40.89 tflops.
STEP-68: step_time = 20.429952 ms, foward_time = 9.733248, backward_time = 10.595328, perf = 40.36 tflops.
STEP-69: step_time = 20.896769 ms, foward_time = 9.600000, backward_time = 11.184128, perf = 39.46 tflops.
STEP-70: step_time = 20.184064 ms, foward_time = 9.522176, backward_time = 10.560512, perf = 40.86 tflops.
STEP-71: step_time = 20.072351 ms, foward_time = 9.526176, backward_time = 10.447872, perf = 41.08 tflops.
STEP-72: step_time = 20.129279 ms, foward_time = 9.670144, backward_time = 10.359808, perf = 40.97 tflops.
STEP-73: step_time = 19.726336 ms, foward_time = 9.066496, backward_time = 10.561536, perf = 41.80 tflops.
STEP-74: step_time = 20.098464 ms, foward_time = 9.366944, backward_time = 10.633216, perf = 41.03 tflops.
STEP-75: step_time = 20.623968 ms, foward_time = 9.818720, backward_time = 10.705920, perf = 39.98 tflops.
STEP-76: step_time = 20.268031 ms, foward_time = 9.391104, backward_time = 10.777600, perf = 40.69 tflops.
STEP-77: step_time = 19.881984 ms, foward_time = 9.366528, backward_time = 10.404864, perf = 41.48 tflops.
STEP-78: step_time = 20.477952 ms, foward_time = 10.003456, backward_time = 10.347520, perf = 40.27 tflops.
STEP-79: step_time = 19.559424 ms, foward_time = 9.321472, backward_time = 10.138624, perf = 42.16 tflops.
STEP-80: step_time = 20.053824 ms, foward_time = 9.690944, backward_time = 10.263552, perf = 41.12 tflops.
STEP-81: step_time = 20.285439 ms, foward_time = 9.532416, backward_time = 10.653696, perf = 40.65 tflops.
STEP-82: step_time = 20.524449 ms, foward_time = 9.672096, backward_time = 10.753024, perf = 40.18 tflops.
STEP-83: step_time = 20.242431 ms, foward_time = 9.495552, backward_time = 10.648576, perf = 40.74 tflops.
STEP-84: step_time = 20.973567 ms, foward_time = 10.648576, backward_time = 10.225664, perf = 39.32 tflops.
STEP-85: step_time = 20.075360 ms, foward_time = 9.444192, backward_time = 10.530816, perf = 41.08 tflops.
STEP-86: step_time = 20.163233 ms, foward_time = 9.508512, backward_time = 10.543104, perf = 40.90 tflops.
STEP-87: step_time = 19.233792 ms, foward_time = 8.977408, backward_time = 10.161152, perf = 42.87 tflops.
STEP-88: step_time = 20.137983 ms, foward_time = 9.125888, backward_time = 10.904576, perf = 40.95 tflops.
STEP-89: step_time = 20.153343 ms, foward_time = 9.745408, backward_time = 10.304512, perf = 40.92 tflops.
STEP-90: step_time = 19.553279 ms, foward_time = 8.899584, backward_time = 10.554368, perf = 42.17 tflops.
STEP-91: step_time = 20.400127 ms, foward_time = 9.464832, backward_time = 10.834944, perf = 40.42 tflops.
STEP-92: step_time = 19.789409 ms, foward_time = 9.448032, backward_time = 10.207232, perf = 41.67 tflops.
STEP-93: step_time = 20.563232 ms, foward_time = 9.770272, backward_time = 10.694656, perf = 40.10 tflops.
STEP-94: step_time = 20.303871 ms, foward_time = 9.556992, backward_time = 10.647552, perf = 40.61 tflops.
STEP-95: step_time = 20.467713 ms, foward_time = 9.570304, backward_time = 10.797056, perf = 40.29 tflops.
STEP-96: step_time = 20.221185 ms, foward_time = 9.691392, backward_time = 10.431488, perf = 40.78 tflops.
STEP-97: step_time = 20.325665 ms, foward_time = 9.593120, backward_time = 10.634240, perf = 40.57 tflops.
STEP-98: step_time = 20.529151 ms, foward_time = 9.678848, backward_time = 10.750976, perf = 40.17 tflops.
STEP-99: step_time = 20.321281 ms, foward_time = 9.493504, backward_time = 10.728448, perf = 40.58 tflops.

[Summary] Average synchronized step_time = 20.24749126434326 ms, forward = 9.516687965393066, backward = 10.628096008300782.
cuda:1
cuda:2
cuda:0
cuda:3
[Benchmark] world_size = 4, dtype = float16, model_dim = 1024, hidden_size = 4096, samples = 8192, num_local_experts = 16, topK = 2, a2a_ffn_overlap_degree = 1, device = `cuda:0`
STEP-0: step_time = 71.957520 ms, foward_time = 33.780762, backward_time = 37.774338, perf = 11.46 tflops.
STEP-1: step_time = 22.575520 ms, foward_time = 10.537376, backward_time = 11.916288, perf = 36.53 tflops.
STEP-2: step_time = 23.126016 ms, foward_time = 11.121665, backward_time = 11.907072, perf = 35.66 tflops.
STEP-3: step_time = 23.821311 ms, foward_time = 11.295744, backward_time = 12.428288, perf = 34.62 tflops.
STEP-4: step_time = 23.270176 ms, foward_time = 11.087647, backward_time = 12.085248, perf = 35.44 tflops.
STEP-5: step_time = 23.604224 ms, foward_time = 11.318272, backward_time = 12.182528, perf = 34.94 tflops.
STEP-6: step_time = 23.359488 ms, foward_time = 10.728448, backward_time = 12.529664, perf = 35.30 tflops.
STEP-7: step_time = 23.391233 ms, foward_time = 11.411456, backward_time = 11.864064, perf = 35.25 tflops.
STEP-8: step_time = 22.910784 ms, foward_time = 11.163456, backward_time = 11.648000, perf = 35.99 tflops.
STEP-9: step_time = 23.044097 ms, foward_time = 11.206656, backward_time = 11.737088, perf = 35.79 tflops.
STEP-10: step_time = 23.150304 ms, foward_time = 11.262687, backward_time = 11.789312, perf = 35.62 tflops.
STEP-11: step_time = 22.881280 ms, foward_time = 10.926080, backward_time = 11.856896, perf = 36.04 tflops.
STEP-12: step_time = 23.293953 ms, foward_time = 11.180032, backward_time = 12.013568, perf = 35.40 tflops.
STEP-13: step_time = 23.127104 ms, foward_time = 11.058240, backward_time = 11.968512, perf = 35.66 tflops.
STEP-14: step_time = 23.348223 ms, foward_time = 11.193344, backward_time = 12.054528, perf = 35.32 tflops.
STEP-15: step_time = 23.296000 ms, foward_time = 11.163648, backward_time = 12.033024, perf = 35.40 tflops.
STEP-16: step_time = 23.332864 ms, foward_time = 11.183104, backward_time = 12.051456, perf = 35.34 tflops.
STEP-17: step_time = 22.958560 ms, foward_time = 10.959328, backward_time = 11.895808, perf = 35.92 tflops.
STEP-18: step_time = 22.951935 ms, foward_time = 10.771456, backward_time = 12.081152, perf = 35.93 tflops.
STEP-19: step_time = 23.727969 ms, foward_time = 11.542368, backward_time = 12.084224, perf = 34.75 tflops.
STEP-20: step_time = 23.126528 ms, foward_time = 11.143680, backward_time = 11.885568, perf = 35.66 tflops.
STEP-21: step_time = 23.600129 ms, foward_time = 11.239424, backward_time = 12.260352, perf = 34.94 tflops.
STEP-22: step_time = 23.180289 ms, foward_time = 11.094016, backward_time = 11.969536, perf = 35.57 tflops.
STEP-23: step_time = 23.165952 ms, foward_time = 11.246592, backward_time = 11.817984, perf = 35.60 tflops.
STEP-24: step_time = 23.621632 ms, foward_time = 11.459584, backward_time = 12.062720, perf = 34.91 tflops.
STEP-25: step_time = 23.782400 ms, foward_time = 11.630592, backward_time = 12.049408, perf = 34.67 tflops.
STEP-26: step_time = 23.777280 ms, foward_time = 11.575296, backward_time = 12.100608, perf = 34.68 tflops.
STEP-27: step_time = 23.700481 ms, foward_time = 11.599872, backward_time = 11.986944, perf = 34.79 tflops.
STEP-28: step_time = 23.532544 ms, foward_time = 11.392000, backward_time = 11.976704, perf = 35.04 tflops.
STEP-29: step_time = 23.442432 ms, foward_time = 11.445248, backward_time = 11.885568, perf = 35.18 tflops.
STEP-30: step_time = 23.993344 ms, foward_time = 12.017664, backward_time = 11.872256, perf = 34.37 tflops.
STEP-31: step_time = 23.508895 ms, foward_time = 11.670432, backward_time = 11.740160, perf = 35.08 tflops.
STEP-32: step_time = 23.982080 ms, foward_time = 12.067840, backward_time = 11.803648, perf = 34.39 tflops.
STEP-33: step_time = 23.739040 ms, foward_time = 11.596448, backward_time = 12.044288, perf = 34.74 tflops.
STEP-34: step_time = 23.347200 ms, foward_time = 11.452416, backward_time = 11.797504, perf = 35.32 tflops.
STEP-35: step_time = 23.330753 ms, foward_time = 11.533248, backward_time = 11.697152, perf = 35.35 tflops.
STEP-36: step_time = 23.386112 ms, foward_time = 11.493376, backward_time = 11.793408, perf = 35.26 tflops.
STEP-37: step_time = 23.671712 ms, foward_time = 11.717536, backward_time = 11.851776, perf = 34.84 tflops.
STEP-38: step_time = 23.417889 ms, foward_time = 11.413536, backward_time = 11.907072, perf = 35.21 tflops.
STEP-39: step_time = 24.101887 ms, foward_time = 11.864064, backward_time = 12.139520, perf = 34.21 tflops.
STEP-40: step_time = 24.348671 ms, foward_time = 11.428864, backward_time = 12.808192, perf = 33.87 tflops.
STEP-41: step_time = 24.159232 ms, foward_time = 11.388928, backward_time = 12.646400, perf = 34.13 tflops.
STEP-42: step_time = 23.712768 ms, foward_time = 11.170816, backward_time = 12.423168, perf = 34.78 tflops.
STEP-43: step_time = 23.767040 ms, foward_time = 10.938368, backward_time = 12.705792, perf = 34.70 tflops.
STEP-44: step_time = 23.785471 ms, foward_time = 11.209728, backward_time = 12.452864, perf = 34.67 tflops.
STEP-45: step_time = 24.159232 ms, foward_time = 11.281408, backward_time = 12.761088, perf = 34.13 tflops.
STEP-46: step_time = 24.162305 ms, foward_time = 11.331584, backward_time = 12.719104, perf = 34.13 tflops.
STEP-47: step_time = 24.866816 ms, foward_time = 11.909120, backward_time = 12.848128, perf = 33.16 tflops.
STEP-48: step_time = 24.141825 ms, foward_time = 11.368448, backward_time = 12.647424, perf = 34.16 tflops.
STEP-49: step_time = 26.962944 ms, foward_time = 14.331905, backward_time = 12.517376, perf = 30.58 tflops.
STEP-50: step_time = 23.923712 ms, foward_time = 11.274240, backward_time = 12.538880, perf = 34.47 tflops.
STEP-51: step_time = 24.584193 ms, foward_time = 11.710464, backward_time = 12.766208, perf = 33.54 tflops.
STEP-52: step_time = 24.304640 ms, foward_time = 11.304960, backward_time = 12.879872, perf = 33.93 tflops.
STEP-53: step_time = 24.176992 ms, foward_time = 11.707744, backward_time = 12.338176, perf = 34.11 tflops.
STEP-54: step_time = 23.766017 ms, foward_time = 11.244544, backward_time = 12.407808, perf = 34.70 tflops.
STEP-55: step_time = 22.875136 ms, foward_time = 10.773504, backward_time = 11.990016, perf = 36.05 tflops.
STEP-56: step_time = 23.621633 ms, foward_time = 11.264000, backward_time = 12.249088, perf = 34.91 tflops.
STEP-57: step_time = 23.584353 ms, foward_time = 11.441760, backward_time = 12.030976, perf = 34.97 tflops.
STEP-58: step_time = 23.966720 ms, foward_time = 11.330560, backward_time = 12.524544, perf = 34.41 tflops.
STEP-59: step_time = 23.807072 ms, foward_time = 11.631712, backward_time = 12.050432, perf = 34.64 tflops.
STEP-60: step_time = 23.834816 ms, foward_time = 11.751616, backward_time = 11.984896, perf = 34.60 tflops.
STEP-61: step_time = 23.755775 ms, foward_time = 11.230208, backward_time = 12.426240, perf = 34.71 tflops.
STEP-62: step_time = 23.553024 ms, foward_time = 11.236352, backward_time = 12.216320, perf = 35.01 tflops.
STEP-63: step_time = 23.964672 ms, foward_time = 11.410432, backward_time = 12.453888, perf = 34.41 tflops.
STEP-64: step_time = 23.335936 ms, foward_time = 11.327488, backward_time = 11.910144, perf = 35.34 tflops.
STEP-65: step_time = 22.742016 ms, foward_time = 11.112448, backward_time = 11.531264, perf = 36.26 tflops.
STEP-66: step_time = 23.403552 ms, foward_time = 11.269152, backward_time = 12.033024, perf = 35.24 tflops.
STEP-67: step_time = 23.274497 ms, foward_time = 10.865664, backward_time = 12.309504, perf = 35.43 tflops.
STEP-68: step_time = 23.863295 ms, foward_time = 11.630592, backward_time = 12.131328, perf = 34.56 tflops.
STEP-69: step_time = 23.319552 ms, foward_time = 11.480064, backward_time = 11.715584, perf = 35.36 tflops.
STEP-70: step_time = 22.989824 ms, foward_time = 11.080704, backward_time = 11.806720, perf = 35.87 tflops.
STEP-71: step_time = 22.946815 ms, foward_time = 11.019264, backward_time = 11.829248, perf = 35.94 tflops.
STEP-72: step_time = 23.512960 ms, foward_time = 11.443072, backward_time = 11.969536, perf = 35.07 tflops.
STEP-73: step_time = 23.306240 ms, foward_time = 11.293696, backward_time = 11.912192, perf = 35.38 tflops.
STEP-74: step_time = 23.445023 ms, foward_time = 11.461152, backward_time = 11.881472, perf = 35.17 tflops.
STEP-75: step_time = 23.339008 ms, foward_time = 11.172864, backward_time = 12.065792, perf = 35.33 tflops.
STEP-76: step_time = 22.744064 ms, foward_time = 10.893312, backward_time = 11.750400, perf = 36.26 tflops.
STEP-77: step_time = 23.136255 ms, foward_time = 11.025408, backward_time = 12.012544, perf = 35.64 tflops.
STEP-78: step_time = 23.599104 ms, foward_time = 11.557888, backward_time = 11.939840, perf = 34.94 tflops.
STEP-79: step_time = 23.047455 ms, foward_time = 11.012384, backward_time = 11.915264, perf = 35.78 tflops.
STEP-80: step_time = 23.247872 ms, foward_time = 10.974208, backward_time = 12.173312, perf = 35.47 tflops.
STEP-81: step_time = 23.272448 ms, foward_time = 10.984447, backward_time = 12.187648, perf = 35.43 tflops.
STEP-82: step_time = 23.061504 ms, foward_time = 11.155457, backward_time = 11.753472, perf = 35.76 tflops.
STEP-83: step_time = 23.616512 ms, foward_time = 11.597824, backward_time = 11.909120, perf = 34.92 tflops.
STEP-84: step_time = 23.504897 ms, foward_time = 11.378688, backward_time = 12.024832, perf = 35.08 tflops.
STEP-85: step_time = 23.622655 ms, foward_time = 11.274240, backward_time = 12.247040, perf = 34.91 tflops.
STEP-86: step_time = 22.648832 ms, foward_time = 10.735616, backward_time = 11.814912, perf = 36.41 tflops.
STEP-87: step_time = 22.886400 ms, foward_time = 10.980352, backward_time = 11.795456, perf = 36.03 tflops.
STEP-88: step_time = 23.224319 ms, foward_time = 11.234304, backward_time = 11.889664, perf = 35.51 tflops.
STEP-89: step_time = 23.593983 ms, foward_time = 11.397120, backward_time = 12.094464, perf = 34.95 tflops.
STEP-90: step_time = 23.821312 ms, foward_time = 11.554816, backward_time = 12.145664, perf = 34.62 tflops.
STEP-91: step_time = 23.700479 ms, foward_time = 11.416576, backward_time = 12.182528, perf = 34.79 tflops.
STEP-92: step_time = 23.490560 ms, foward_time = 11.473920, backward_time = 11.915264, perf = 35.10 tflops.
STEP-93: step_time = 23.478016 ms, foward_time = 11.404032, backward_time = 11.973632, perf = 35.12 tflops.
STEP-94: step_time = 22.958080 ms, foward_time = 11.032576, backward_time = 11.823104, perf = 35.92 tflops.
STEP-95: step_time = 23.265345 ms, foward_time = 11.318336, backward_time = 11.831296, perf = 35.44 tflops.
STEP-96: step_time = 24.512288 ms, foward_time = 11.929376, backward_time = 12.477440, perf = 33.64 tflops.
STEP-97: step_time = 23.248897 ms, foward_time = 11.097088, backward_time = 12.048384, perf = 35.47 tflops.
STEP-98: step_time = 23.290880 ms, foward_time = 11.345920, backward_time = 11.843584, perf = 35.41 tflops.
STEP-99: step_time = 23.869024 ms, foward_time = 11.739744, backward_time = 12.027904, perf = 34.55 tflops.

[Summary] Average synchronized step_time = 23.563488149642943 ms, forward = 11.431238317489624, backward = 12.0268798828125.
cuda:2
cuda:3
cuda:1
cuda:0
[Benchmark] world_size = 4, dtype = float16, model_dim = 1024, hidden_size = 4096, samples = 8192, num_local_experts = 32, topK = 2, a2a_ffn_overlap_degree = 1, device = `cuda:0`
STEP-0: step_time = 62.832520 ms, foward_time = 33.609863, backward_time = 28.871679, perf = 13.12 tflops.
STEP-1: step_time = 24.529907 ms, foward_time = 12.408813, backward_time = 11.996160, perf = 33.62 tflops.
STEP-2: step_time = 23.897087 ms, foward_time = 12.130304, backward_time = 11.666432, perf = 34.51 tflops.
STEP-3: step_time = 24.002560 ms, foward_time = 12.606464, backward_time = 11.299840, perf = 34.36 tflops.
STEP-4: step_time = 23.755775 ms, foward_time = 11.978752, backward_time = 11.678720, perf = 34.71 tflops.
STEP-5: step_time = 24.685568 ms, foward_time = 12.658688, backward_time = 11.929600, perf = 33.41 tflops.
STEP-6: step_time = 24.528896 ms, foward_time = 12.979200, backward_time = 11.450368, perf = 33.62 tflops.
STEP-7: step_time = 23.778305 ms, foward_time = 12.207104, backward_time = 11.473920, perf = 34.68 tflops.
STEP-8: step_time = 24.461313 ms, foward_time = 12.521472, backward_time = 11.842560, perf = 33.71 tflops.
STEP-9: step_time = 24.393728 ms, foward_time = 12.402689, backward_time = 11.878400, perf = 33.81 tflops.
STEP-10: step_time = 23.418880 ms, foward_time = 11.714560, backward_time = 11.604992, perf = 35.21 tflops.
STEP-11: step_time = 24.050527 ms, foward_time = 12.547936, backward_time = 11.404288, perf = 34.29 tflops.
STEP-12: step_time = 24.317952 ms, foward_time = 12.298240, backward_time = 11.921408, perf = 33.91 tflops.
STEP-13: step_time = 24.166529 ms, foward_time = 12.520576, backward_time = 11.548672, perf = 34.12 tflops.
STEP-14: step_time = 23.566849 ms, foward_time = 12.046848, backward_time = 11.420672, perf = 34.99 tflops.
STEP-15: step_time = 24.656897 ms, foward_time = 12.400640, backward_time = 12.153856, perf = 33.44 tflops.
STEP-16: step_time = 24.622079 ms, foward_time = 12.568576, backward_time = 11.954176, perf = 33.49 tflops.
STEP-17: step_time = 24.009727 ms, foward_time = 12.740608, backward_time = 11.171840, perf = 34.35 tflops.
STEP-18: step_time = 23.772352 ms, foward_time = 12.316864, backward_time = 11.333632, perf = 34.69 tflops.
STEP-19: step_time = 24.250368 ms, foward_time = 12.793856, backward_time = 11.359232, perf = 34.00 tflops.
STEP-20: step_time = 24.109056 ms, foward_time = 12.105728, backward_time = 11.907072, perf = 34.20 tflops.
STEP-21: step_time = 23.714817 ms, foward_time = 12.276736, backward_time = 11.340800, perf = 34.77 tflops.
STEP-22: step_time = 23.635776 ms, foward_time = 12.085056, backward_time = 11.453440, perf = 34.89 tflops.
STEP-23: step_time = 24.852449 ms, foward_time = 12.877792, backward_time = 11.877376, perf = 33.18 tflops.
STEP-24: step_time = 25.919489 ms, foward_time = 14.684160, backward_time = 11.105280, perf = 31.82 tflops.
STEP-25: step_time = 23.906304 ms, foward_time = 12.738560, backward_time = 11.071488, perf = 34.49 tflops.
STEP-26: step_time = 24.336384 ms, foward_time = 12.598272, backward_time = 11.641856, perf = 33.88 tflops.
STEP-27: step_time = 24.342720 ms, foward_time = 12.768448, backward_time = 11.478016, perf = 33.88 tflops.
STEP-28: step_time = 24.140800 ms, foward_time = 12.237823, backward_time = 11.807744, perf = 34.16 tflops.
STEP-29: step_time = 24.259583 ms, foward_time = 12.358655, backward_time = 11.803648, perf = 33.99 tflops.
STEP-30: step_time = 24.007840 ms, foward_time = 12.376224, backward_time = 11.516928, perf = 34.35 tflops.
STEP-31: step_time = 23.899136 ms, foward_time = 12.276736, backward_time = 11.525120, perf = 34.50 tflops.
STEP-32: step_time = 24.566784 ms, foward_time = 12.496896, backward_time = 11.973632, perf = 33.57 tflops.
STEP-33: step_time = 24.133632 ms, foward_time = 12.595200, backward_time = 11.422720, perf = 34.17 tflops.
STEP-34: step_time = 23.965696 ms, foward_time = 12.537856, backward_time = 11.331584, perf = 34.41 tflops.
STEP-35: step_time = 23.373825 ms, foward_time = 11.762687, backward_time = 11.506688, perf = 35.28 tflops.
STEP-36: step_time = 24.124288 ms, foward_time = 12.309376, backward_time = 11.697152, perf = 34.18 tflops.
STEP-37: step_time = 24.129535 ms, foward_time = 12.416000, backward_time = 11.617280, perf = 34.18 tflops.
STEP-38: step_time = 24.016288 ms, foward_time = 12.384672, backward_time = 11.535360, perf = 34.34 tflops.
STEP-39: step_time = 24.581120 ms, foward_time = 12.624897, backward_time = 11.859968, perf = 33.55 tflops.
STEP-40: step_time = 24.338112 ms, foward_time = 12.721856, backward_time = 11.498496, perf = 33.88 tflops.
STEP-41: step_time = 23.796736 ms, foward_time = 12.313600, backward_time = 11.386880, perf = 34.65 tflops.
STEP-42: step_time = 24.311808 ms, foward_time = 12.523520, backward_time = 11.691008, perf = 33.92 tflops.
STEP-43: step_time = 23.526400 ms, foward_time = 12.267520, backward_time = 11.160576, perf = 35.05 tflops.
STEP-44: step_time = 24.280192 ms, foward_time = 12.378240, backward_time = 11.802624, perf = 33.96 tflops.
STEP-45: step_time = 23.937024 ms, foward_time = 12.422144, backward_time = 11.409408, perf = 34.45 tflops.
STEP-46: step_time = 23.911423 ms, foward_time = 12.200959, backward_time = 11.611136, perf = 34.49 tflops.
STEP-47: step_time = 23.925760 ms, foward_time = 12.325888, backward_time = 11.500544, perf = 34.47 tflops.
STEP-48: step_time = 24.002561 ms, foward_time = 12.421120, backward_time = 11.483136, perf = 34.36 tflops.
STEP-49: step_time = 23.807999 ms, foward_time = 11.963392, backward_time = 11.746304, perf = 34.64 tflops.
STEP-50: step_time = 24.439808 ms, foward_time = 12.376064, backward_time = 11.947008, perf = 33.74 tflops.
STEP-51: step_time = 23.234560 ms, foward_time = 11.706368, backward_time = 11.429888, perf = 35.49 tflops.
STEP-52: step_time = 23.633920 ms, foward_time = 11.935744, backward_time = 11.598848, perf = 34.89 tflops.
STEP-53: step_time = 23.762944 ms, foward_time = 12.037120, backward_time = 11.622400, perf = 34.70 tflops.
STEP-54: step_time = 24.042495 ms, foward_time = 12.510208, backward_time = 11.436032, perf = 34.30 tflops.
STEP-55: step_time = 24.308576 ms, foward_time = 12.473184, backward_time = 11.738112, perf = 33.92 tflops.
STEP-56: step_time = 24.367104 ms, foward_time = 13.043712, backward_time = 11.229184, perf = 33.84 tflops.
STEP-57: step_time = 24.634368 ms, foward_time = 12.156928, backward_time = 12.372992, perf = 33.47 tflops.
STEP-58: step_time = 24.018943 ms, foward_time = 12.494848, backward_time = 11.427840, perf = 34.33 tflops.
STEP-59: step_time = 24.037376 ms, foward_time = 12.612607, backward_time = 11.329536, perf = 34.31 tflops.
STEP-60: step_time = 23.285760 ms, foward_time = 11.405312, backward_time = 11.784192, perf = 35.41 tflops.
STEP-61: step_time = 24.381440 ms, foward_time = 12.630016, backward_time = 11.635712, perf = 33.82 tflops.
STEP-62: step_time = 22.438913 ms, foward_time = 11.100160, backward_time = 11.242496, perf = 36.75 tflops.
STEP-63: step_time = 24.403969 ms, foward_time = 12.511232, backward_time = 11.793408, perf = 33.79 tflops.
STEP-64: step_time = 23.748608 ms, foward_time = 11.646976, backward_time = 12.004352, perf = 34.72 tflops.
STEP-65: step_time = 23.856127 ms, foward_time = 12.229632, backward_time = 11.529216, perf = 34.57 tflops.
STEP-66: step_time = 23.681024 ms, foward_time = 12.144640, backward_time = 11.439104, perf = 34.82 tflops.
STEP-67: step_time = 23.691264 ms, foward_time = 12.013568, backward_time = 11.582464, perf = 34.81 tflops.
STEP-68: step_time = 24.647903 ms, foward_time = 12.529888, backward_time = 11.999232, perf = 33.46 tflops.
STEP-69: step_time = 23.640064 ms, foward_time = 12.061696, backward_time = 11.482112, perf = 34.88 tflops.
STEP-70: step_time = 23.829503 ms, foward_time = 12.265472, backward_time = 11.467776, perf = 34.61 tflops.
STEP-71: step_time = 23.529472 ms, foward_time = 11.498496, backward_time = 11.929600, perf = 35.05 tflops.
STEP-72: step_time = 23.522303 ms, foward_time = 11.787265, backward_time = 11.639808, perf = 35.06 tflops.
STEP-73: step_time = 23.865344 ms, foward_time = 12.420096, backward_time = 11.350016, perf = 34.55 tflops.
STEP-74: step_time = 23.564288 ms, foward_time = 11.663360, backward_time = 11.803648, perf = 35.00 tflops.
STEP-75: step_time = 24.071167 ms, foward_time = 12.413952, backward_time = 11.540480, perf = 34.26 tflops.
STEP-76: step_time = 22.763520 ms, foward_time = 11.437056, backward_time = 11.229184, perf = 36.23 tflops.
STEP-77: step_time = 23.894016 ms, foward_time = 11.845632, backward_time = 11.951104, perf = 34.51 tflops.
STEP-78: step_time = 24.751104 ms, foward_time = 12.553216, backward_time = 12.051456, perf = 33.32 tflops.
STEP-79: step_time = 23.489536 ms, foward_time = 11.829247, backward_time = 11.566080, perf = 35.11 tflops.
STEP-80: step_time = 23.527425 ms, foward_time = 11.949056, backward_time = 11.482112, perf = 35.05 tflops.
STEP-81: step_time = 24.101888 ms, foward_time = 12.172288, backward_time = 11.832320, perf = 34.21 tflops.
STEP-82: step_time = 24.261632 ms, foward_time = 12.337152, backward_time = 11.827200, perf = 33.99 tflops.
STEP-83: step_time = 23.321601 ms, foward_time = 11.780096, backward_time = 11.445248, perf = 35.36 tflops.
STEP-84: step_time = 23.655424 ms, foward_time = 12.230656, backward_time = 11.328512, perf = 34.86 tflops.
STEP-85: step_time = 23.646209 ms, foward_time = 11.575296, backward_time = 11.973632, perf = 34.87 tflops.
STEP-86: step_time = 23.914495 ms, foward_time = 11.918336, backward_time = 11.900928, perf = 34.48 tflops.
STEP-87: step_time = 24.197121 ms, foward_time = 12.548096, backward_time = 11.551744, perf = 34.08 tflops.
STEP-88: step_time = 23.405569 ms, foward_time = 12.038144, backward_time = 11.271168, perf = 35.23 tflops.
STEP-89: step_time = 23.536640 ms, foward_time = 11.725824, backward_time = 11.713536, perf = 35.04 tflops.
STEP-90: step_time = 23.536641 ms, foward_time = 12.128256, backward_time = 11.311104, perf = 35.04 tflops.
STEP-91: step_time = 22.860799 ms, foward_time = 11.265024, backward_time = 11.499520, perf = 36.07 tflops.
STEP-92: step_time = 23.225343 ms, foward_time = 11.926528, backward_time = 11.199488, perf = 35.51 tflops.
STEP-93: step_time = 23.700480 ms, foward_time = 12.191744, backward_time = 11.410432, perf = 34.79 tflops.
STEP-94: step_time = 24.288257 ms, foward_time = 12.556288, backward_time = 11.632640, perf = 33.95 tflops.
STEP-95: step_time = 22.497280 ms, foward_time = 10.741760, backward_time = 11.659264, perf = 36.65 tflops.
STEP-96: step_time = 23.873536 ms, foward_time = 12.272640, backward_time = 11.504640, perf = 34.54 tflops.
STEP-97: step_time = 23.546880 ms, foward_time = 11.897856, backward_time = 11.548672, perf = 35.02 tflops.
STEP-98: step_time = 23.321601 ms, foward_time = 11.380736, backward_time = 11.845632, perf = 35.36 tflops.
STEP-99: step_time = 23.739392 ms, foward_time = 11.727872, backward_time = 11.916288, perf = 34.74 tflops.

[Summary] Average synchronized step_time = 23.459020829200746 ms, forward = 11.808870244026185, backward = 11.552767848968506.
cuda:2
cuda:3
cuda:1
cuda:0
[Benchmark] world_size = 4, dtype = float16, model_dim = 1024, hidden_size = 4096, samples = 8192, num_local_experts = 64, topK = 2, a2a_ffn_overlap_degree = 1, device = `cuda:0`
STEP-0: step_time = 56.104004 ms, foward_time = 36.003906, backward_time = 19.726336, perf = 14.70 tflops.
STEP-1: step_time = 25.609600 ms, foward_time = 14.869888, backward_time = 10.614784, perf = 32.20 tflops.
STEP-2: step_time = 25.779200 ms, foward_time = 14.823424, backward_time = 10.858496, perf = 31.99 tflops.
STEP-3: step_time = 25.476096 ms, foward_time = 14.711808, backward_time = 10.663936, perf = 32.37 tflops.
STEP-4: step_time = 25.503743 ms, foward_time = 14.705665, backward_time = 10.698752, perf = 32.33 tflops.
STEP-5: step_time = 24.991744 ms, foward_time = 14.137343, backward_time = 10.749952, perf = 33.00 tflops.
STEP-6: step_time = 26.090497 ms, foward_time = 14.580737, backward_time = 11.410432, perf = 31.61 tflops.
STEP-7: step_time = 25.388033 ms, foward_time = 14.521345, backward_time = 10.768384, perf = 32.48 tflops.
STEP-8: step_time = 25.635840 ms, foward_time = 14.727168, backward_time = 10.809344, perf = 32.17 tflops.
STEP-9: step_time = 25.198593 ms, foward_time = 14.497793, backward_time = 10.600448, perf = 32.73 tflops.
STEP-10: step_time = 25.786112 ms, foward_time = 15.125248, backward_time = 10.561536, perf = 31.98 tflops.
STEP-11: step_time = 25.765888 ms, foward_time = 14.912511, backward_time = 10.754048, perf = 32.00 tflops.
STEP-12: step_time = 25.711617 ms, foward_time = 14.875648, backward_time = 10.737664, perf = 32.07 tflops.
STEP-13: step_time = 26.456225 ms, foward_time = 15.416479, backward_time = 10.938368, perf = 31.17 tflops.
STEP-14: step_time = 25.923584 ms, foward_time = 14.953472, backward_time = 10.869760, perf = 31.81 tflops.
STEP-15: step_time = 25.670656 ms, foward_time = 14.696447, backward_time = 10.873856, perf = 32.12 tflops.
STEP-16: step_time = 26.034239 ms, foward_time = 15.092800, backward_time = 10.840064, perf = 31.67 tflops.
STEP-17: step_time = 25.665536 ms, foward_time = 14.563329, backward_time = 11.001856, perf = 32.13 tflops.
STEP-18: step_time = 26.049536 ms, foward_time = 14.701567, backward_time = 11.245568, perf = 31.66 tflops.
STEP-19: step_time = 26.206208 ms, foward_time = 15.214592, backward_time = 10.891264, perf = 31.47 tflops.
STEP-20: step_time = 25.622527 ms, foward_time = 14.695424, backward_time = 10.825728, perf = 32.18 tflops.
STEP-21: step_time = 26.300416 ms, foward_time = 14.990336, backward_time = 11.207680, perf = 31.35 tflops.
STEP-22: step_time = 26.132479 ms, foward_time = 14.849024, backward_time = 11.184128, perf = 31.56 tflops.
STEP-23: step_time = 25.834497 ms, foward_time = 15.028224, backward_time = 10.707968, perf = 31.92 tflops.
STEP-24: step_time = 25.891296 ms, foward_time = 15.016416, backward_time = 10.775552, perf = 31.85 tflops.
STEP-25: step_time = 26.492320 ms, foward_time = 15.234463, backward_time = 11.155456, perf = 31.13 tflops.
STEP-26: step_time = 26.054656 ms, foward_time = 14.704640, backward_time = 11.248640, perf = 31.65 tflops.
STEP-27: step_time = 25.939969 ms, foward_time = 14.969857, backward_time = 10.868736, perf = 31.79 tflops.
STEP-28: step_time = 26.041344 ms, foward_time = 15.004672, backward_time = 10.936320, perf = 31.67 tflops.
STEP-29: step_time = 26.418176 ms, foward_time = 14.718977, backward_time = 11.597824, perf = 31.21 tflops.
STEP-30: step_time = 25.393152 ms, foward_time = 14.338048, backward_time = 10.952704, perf = 32.47 tflops.
STEP-31: step_time = 25.994240 ms, foward_time = 15.066113, backward_time = 10.823680, perf = 31.72 tflops.
STEP-32: step_time = 25.565185 ms, foward_time = 14.528512, backward_time = 10.936320, perf = 32.26 tflops.
STEP-33: step_time = 25.785343 ms, foward_time = 14.908417, backward_time = 10.777600, perf = 31.98 tflops.
STEP-34: step_time = 25.742335 ms, foward_time = 14.739455, backward_time = 10.902528, perf = 32.03 tflops.
STEP-35: step_time = 25.418753 ms, foward_time = 14.313471, backward_time = 11.004928, perf = 32.44 tflops.
STEP-36: step_time = 26.285055 ms, foward_time = 14.818304, backward_time = 11.365376, perf = 31.37 tflops.
STEP-37: step_time = 26.161152 ms, foward_time = 15.179776, backward_time = 10.878976, perf = 31.52 tflops.
STEP-38: step_time = 25.566209 ms, foward_time = 14.748672, backward_time = 10.717184, perf = 32.25 tflops.
STEP-39: step_time = 25.709567 ms, foward_time = 14.865407, backward_time = 10.741760, perf = 32.07 tflops.
STEP-40: step_time = 26.684416 ms, foward_time = 15.435776, backward_time = 11.148288, perf = 30.90 tflops.
STEP-41: step_time = 25.828640 ms, foward_time = 15.187231, backward_time = 10.541056, perf = 31.93 tflops.
STEP-42: step_time = 25.622080 ms, foward_time = 14.923329, backward_time = 10.598400, perf = 32.18 tflops.
STEP-43: step_time = 25.437184 ms, foward_time = 14.745600, backward_time = 10.582016, perf = 32.42 tflops.
STEP-44: step_time = 25.548799 ms, foward_time = 14.583809, backward_time = 10.864640, perf = 32.28 tflops.
STEP-45: step_time = 25.629697 ms, foward_time = 14.613503, backward_time = 10.914816, perf = 32.17 tflops.
STEP-46: step_time = 25.219073 ms, foward_time = 14.437376, backward_time = 10.682368, perf = 32.70 tflops.
STEP-47: step_time = 25.848831 ms, foward_time = 15.002625, backward_time = 10.745856, perf = 31.90 tflops.
STEP-48: step_time = 26.178561 ms, foward_time = 15.359999, backward_time = 10.717184, perf = 31.50 tflops.
STEP-49: step_time = 26.006528 ms, foward_time = 15.267840, backward_time = 10.637312, perf = 31.71 tflops.
STEP-50: step_time = 25.680896 ms, foward_time = 14.692352, backward_time = 10.888192, perf = 32.11 tflops.
STEP-51: step_time = 25.650177 ms, foward_time = 14.372864, backward_time = 11.175936, perf = 32.15 tflops.
STEP-52: step_time = 25.613312 ms, foward_time = 14.658560, backward_time = 10.851328, perf = 32.20 tflops.
STEP-53: step_time = 25.609217 ms, foward_time = 14.841856, backward_time = 10.665984, perf = 32.20 tflops.
STEP-54: step_time = 25.262079 ms, foward_time = 14.385151, backward_time = 10.777600, perf = 32.64 tflops.
STEP-55: step_time = 25.716447 ms, foward_time = 14.985952, backward_time = 10.630144, perf = 32.07 tflops.
STEP-56: step_time = 25.402368 ms, foward_time = 14.590976, backward_time = 10.712064, perf = 32.46 tflops.
STEP-57: step_time = 24.801280 ms, foward_time = 13.903873, backward_time = 10.796032, perf = 33.25 tflops.
STEP-58: step_time = 25.154560 ms, foward_time = 14.171135, backward_time = 10.885120, perf = 32.78 tflops.
STEP-59: step_time = 25.716736 ms, foward_time = 14.483456, backward_time = 11.132928, perf = 32.07 tflops.
STEP-60: step_time = 25.418752 ms, foward_time = 14.578689, backward_time = 10.740736, perf = 32.44 tflops.
STEP-61: step_time = 25.448385 ms, foward_time = 14.610368, backward_time = 10.735616, perf = 32.40 tflops.
STEP-62: step_time = 25.048064 ms, foward_time = 14.329855, backward_time = 10.620928, perf = 32.92 tflops.
STEP-63: step_time = 25.085952 ms, foward_time = 14.323713, backward_time = 10.658816, perf = 32.87 tflops.
STEP-64: step_time = 25.543679 ms, foward_time = 14.702592, backward_time = 10.743808, perf = 32.28 tflops.
STEP-65: step_time = 26.832224 ms, foward_time = 14.988640, backward_time = 11.746304, perf = 30.73 tflops.
STEP-66: step_time = 25.074689 ms, foward_time = 14.321664, backward_time = 10.654720, perf = 32.89 tflops.
STEP-67: step_time = 25.814016 ms, foward_time = 14.736385, backward_time = 10.979328, perf = 31.95 tflops.
STEP-68: step_time = 25.463360 ms, foward_time = 14.611008, backward_time = 10.753024, perf = 32.39 tflops.
STEP-69: step_time = 25.120769 ms, foward_time = 14.294015, backward_time = 10.729472, perf = 32.83 tflops.
STEP-70: step_time = 25.572544 ms, foward_time = 14.887104, backward_time = 10.584064, perf = 32.25 tflops.
STEP-71: step_time = 25.259008 ms, foward_time = 14.476287, backward_time = 10.682368, perf = 32.65 tflops.
STEP-72: step_time = 25.222144 ms, foward_time = 14.370816, backward_time = 10.753024, perf = 32.69 tflops.
STEP-73: step_time = 25.741663 ms, foward_time = 15.017311, backward_time = 10.622976, perf = 32.03 tflops.
STEP-74: step_time = 26.484513 ms, foward_time = 15.019808, backward_time = 11.367424, perf = 31.14 tflops.
STEP-75: step_time = 24.967169 ms, foward_time = 14.234625, backward_time = 10.629120, perf = 33.03 tflops.
STEP-76: step_time = 25.500672 ms, foward_time = 14.912513, backward_time = 10.488832, perf = 32.34 tflops.
STEP-77: step_time = 25.032705 ms, foward_time = 14.347265, backward_time = 10.586112, perf = 32.94 tflops.
STEP-78: step_time = 25.672704 ms, foward_time = 14.597120, backward_time = 10.993664, perf = 32.12 tflops.
STEP-79: step_time = 26.036223 ms, foward_time = 14.729217, backward_time = 11.214848, perf = 31.67 tflops.
STEP-80: step_time = 25.892864 ms, foward_time = 14.503937, backward_time = 11.289600, perf = 31.85 tflops.
STEP-81: step_time = 25.001984 ms, foward_time = 14.281729, backward_time = 10.617856, perf = 32.98 tflops.
STEP-82: step_time = 25.452608 ms, foward_time = 14.796863, backward_time = 10.554368, perf = 32.40 tflops.
STEP-83: step_time = 25.540640 ms, foward_time = 15.003680, backward_time = 10.435584, perf = 32.29 tflops.
STEP-84: step_time = 25.504768 ms, foward_time = 14.510080, backward_time = 10.893312, perf = 32.33 tflops.
STEP-85: step_time = 24.909824 ms, foward_time = 14.277632, backward_time = 10.529792, perf = 33.10 tflops.
STEP-86: step_time = 25.131008 ms, foward_time = 14.433281, backward_time = 10.598400, perf = 32.81 tflops.
STEP-87: step_time = 25.384960 ms, foward_time = 14.562304, backward_time = 10.721280, perf = 32.49 tflops.
STEP-88: step_time = 25.232384 ms, foward_time = 14.392319, backward_time = 10.738688, perf = 32.68 tflops.
STEP-89: step_time = 25.175041 ms, foward_time = 14.385153, backward_time = 10.685440, perf = 32.76 tflops.
STEP-90: step_time = 26.479520 ms, foward_time = 14.790561, backward_time = 11.586560, perf = 31.14 tflops.
STEP-91: step_time = 25.783296 ms, foward_time = 14.407680, backward_time = 11.274240, perf = 31.98 tflops.
STEP-92: step_time = 25.273344 ms, foward_time = 14.175232, backward_time = 10.996736, perf = 32.63 tflops.
STEP-93: step_time = 25.208832 ms, foward_time = 14.615553, backward_time = 10.490880, perf = 32.71 tflops.
STEP-94: step_time = 25.342976 ms, foward_time = 14.474240, backward_time = 10.768384, perf = 32.54 tflops.
STEP-95: step_time = 25.956352 ms, foward_time = 15.170560, backward_time = 10.686464, perf = 31.77 tflops.
STEP-96: step_time = 25.026559 ms, foward_time = 14.540799, backward_time = 10.385408, perf = 32.95 tflops.
STEP-97: step_time = 24.395775 ms, foward_time = 13.914112, backward_time = 10.370048, perf = 33.80 tflops.
STEP-98: step_time = 25.903103 ms, foward_time = 14.807039, backward_time = 10.994688, perf = 31.84 tflops.
STEP-99: step_time = 25.857024 ms, foward_time = 14.579712, backward_time = 11.174912, perf = 31.89 tflops.

[Summary] Average synchronized step_time = 25.522677993774415 ms, forward = 14.547548866271972, backward = 10.872832012176513.
[Benchmark] world_size = 4, dtype = float16, model_dim = 1024, hidden_size = 4096, samples = 8192, num_local_experts = 8, topK = 2, a2a_ffn_overlap_degree = 1, device = `cuda:0`
STEP-0: step_time = 7025.435547 ms, foward_time = 6284.837891, backward_time = 739.055603, perf = 0.12 tflops.
STEP-1: step_time = 41.560062 ms, foward_time = 26.747904, backward_time = 14.654464, perf = 19.84 tflops.
STEP-2: step_time = 37.518337 ms, foward_time = 23.044096, backward_time = 14.334976, perf = 21.98 tflops.
STEP-3: step_time = 37.744640 ms, foward_time = 23.255039, backward_time = 14.353408, perf = 21.85 tflops.
STEP-4: step_time = 974.841858 ms, foward_time = 959.489014, backward_time = 15.202304, perf = 0.85 tflops.
STEP-5: step_time = 36.727810 ms, foward_time = 22.259712, backward_time = 14.350336, perf = 22.45 tflops.
STEP-6: step_time = 37.940224 ms, foward_time = 22.667265, backward_time = 15.165440, perf = 21.74 tflops.
STEP-7: step_time = 36.560898 ms, foward_time = 22.107136, backward_time = 14.329856, perf = 22.56 tflops.
STEP-8: step_time = 36.722687 ms, foward_time = 22.310911, backward_time = 14.302208, perf = 22.46 tflops.
STEP-9: step_time = 37.792767 ms, foward_time = 23.378944, backward_time = 14.310400, perf = 21.82 tflops.
STEP-10: step_time = 37.839870 ms, foward_time = 23.306240, backward_time = 14.428160, perf = 21.79 tflops.
STEP-11: step_time = 36.689919 ms, foward_time = 22.273024, backward_time = 14.311424, perf = 22.48 tflops.
STEP-12: step_time = 37.642239 ms, foward_time = 22.822912, backward_time = 14.699520, perf = 21.91 tflops.
STEP-13: step_time = 36.271103 ms, foward_time = 21.779455, backward_time = 14.377984, perf = 22.74 tflops.
STEP-14: step_time = 36.041729 ms, foward_time = 21.668863, backward_time = 14.269440, perf = 22.88 tflops.
STEP-15: step_time = 36.402176 ms, foward_time = 21.942272, backward_time = 14.352384, perf = 22.65 tflops.
STEP-16: step_time = 36.270081 ms, foward_time = 21.846016, backward_time = 14.321664, perf = 22.74 tflops.
STEP-17: step_time = 37.238785 ms, foward_time = 21.644287, backward_time = 15.489024, perf = 22.14 tflops.
STEP-18: step_time = 37.591042 ms, foward_time = 22.262783, backward_time = 15.220736, perf = 21.94 tflops.
STEP-19: step_time = 37.588993 ms, foward_time = 22.233088, backward_time = 15.248384, perf = 21.94 tflops.
STEP-20: step_time = 37.751808 ms, foward_time = 22.443008, backward_time = 15.205376, perf = 21.84 tflops.
STEP-21: step_time = 37.500927 ms, foward_time = 22.153215, backward_time = 15.244288, perf = 21.99 tflops.
STEP-22: step_time = 38.499329 ms, foward_time = 22.930431, backward_time = 15.464448, perf = 21.42 tflops.
STEP-23: step_time = 38.351871 ms, foward_time = 23.017471, backward_time = 15.229952, perf = 21.50 tflops.
STEP-24: step_time = 36.364288 ms, foward_time = 22.364161, backward_time = 13.893632, perf = 22.68 tflops.
STEP-25: step_time = 35.744766 ms, foward_time = 21.761024, backward_time = 13.880320, perf = 23.07 tflops.
STEP-26: step_time = 37.671936 ms, foward_time = 22.998016, backward_time = 14.568448, perf = 21.89 tflops.
STEP-27: step_time = 37.382145 ms, foward_time = 22.751232, backward_time = 14.524416, perf = 22.06 tflops.
STEP-28: step_time = 37.123074 ms, foward_time = 22.294527, backward_time = 14.723072, perf = 22.21 tflops.
STEP-29: step_time = 37.630978 ms, foward_time = 23.008257, backward_time = 14.517248, perf = 21.91 tflops.
STEP-30: step_time = 36.843521 ms, foward_time = 22.108160, backward_time = 14.630912, perf = 22.38 tflops.
STEP-31: step_time = 36.755455 ms, foward_time = 22.002687, backward_time = 14.650368, perf = 22.44 tflops.
STEP-32: step_time = 35.933186 ms, foward_time = 21.924864, backward_time = 13.901824, perf = 22.95 tflops.
STEP-33: step_time = 36.797440 ms, foward_time = 21.870592, backward_time = 14.821376, perf = 22.41 tflops.
STEP-34: step_time = 37.637119 ms, foward_time = 22.878208, backward_time = 14.652416, perf = 21.91 tflops.
STEP-35: step_time = 36.595711 ms, foward_time = 22.569984, backward_time = 13.921280, perf = 22.53 tflops.
STEP-36: step_time = 36.494335 ms, foward_time = 22.183935, backward_time = 14.204928, perf = 22.60 tflops.
STEP-37: step_time = 35.804161 ms, foward_time = 21.783552, backward_time = 13.916160, perf = 23.03 tflops.
STEP-38: step_time = 38.297600 ms, foward_time = 23.382015, backward_time = 14.810112, perf = 21.53 tflops.
STEP-39: step_time = 36.597759 ms, foward_time = 22.019072, backward_time = 14.472192, perf = 22.53 tflops.
STEP-40: step_time = 38.244350 ms, foward_time = 22.673409, backward_time = 15.464448, perf = 21.56 tflops.
STEP-41: step_time = 37.544960 ms, foward_time = 23.000065, backward_time = 14.434304, perf = 21.96 tflops.
STEP-42: step_time = 37.449726 ms, foward_time = 23.009279, backward_time = 14.331904, perf = 22.02 tflops.
STEP-43: step_time = 36.842495 ms, foward_time = 22.377472, backward_time = 14.355456, perf = 22.38 tflops.
STEP-44: step_time = 37.774338 ms, foward_time = 22.210560, backward_time = 15.452160, perf = 21.83 tflops.
STEP-45: step_time = 37.453823 ms, foward_time = 22.868992, backward_time = 14.475264, perf = 22.02 tflops.
STEP-46: step_time = 36.986881 ms, foward_time = 22.533119, backward_time = 14.345216, perf = 22.30 tflops.
STEP-47: step_time = 37.216255 ms, foward_time = 22.732800, backward_time = 14.358528, perf = 22.16 tflops.
STEP-48: step_time = 37.925888 ms, foward_time = 23.146496, backward_time = 14.673920, perf = 21.74 tflops.
STEP-49: step_time = 37.099522 ms, foward_time = 22.706177, backward_time = 14.288896, perf = 22.23 tflops.
STEP-50: step_time = 36.830208 ms, foward_time = 22.445057, backward_time = 14.276608, perf = 22.39 tflops.
STEP-51: step_time = 36.633598 ms, foward_time = 22.465536, backward_time = 14.062592, perf = 22.51 tflops.
STEP-52: step_time = 36.217857 ms, foward_time = 22.089727, backward_time = 14.018560, perf = 22.77 tflops.
STEP-53: step_time = 36.467712 ms, foward_time = 22.414335, backward_time = 13.948928, perf = 22.61 tflops.
STEP-54: step_time = 37.493759 ms, foward_time = 23.476225, backward_time = 13.913088, perf = 21.99 tflops.
STEP-55: step_time = 36.959232 ms, foward_time = 22.627329, backward_time = 14.226432, perf = 22.31 tflops.
STEP-56: step_time = 37.038078 ms, foward_time = 23.073792, backward_time = 13.857792, perf = 22.26 tflops.
STEP-57: step_time = 40.344578 ms, foward_time = 26.160128, backward_time = 14.071808, perf = 20.44 tflops.
STEP-58: step_time = 36.190208 ms, foward_time = 22.117376, backward_time = 13.968384, perf = 22.79 tflops.
STEP-59: step_time = 36.295681 ms, foward_time = 22.307840, backward_time = 13.877248, perf = 22.72 tflops.
STEP-60: step_time = 36.826111 ms, foward_time = 22.747135, backward_time = 13.971456, perf = 22.39 tflops.
STEP-61: step_time = 36.240383 ms, foward_time = 22.206465, backward_time = 13.914112, perf = 22.75 tflops.
STEP-62: step_time = 36.758530 ms, foward_time = 22.516735, backward_time = 14.137344, perf = 22.43 tflops.
STEP-63: step_time = 36.371456 ms, foward_time = 22.273024, backward_time = 13.988864, perf = 22.67 tflops.
STEP-64: step_time = 37.161983 ms, foward_time = 23.163904, backward_time = 13.890560, perf = 22.19 tflops.
STEP-65: step_time = 36.729855 ms, foward_time = 22.534143, backward_time = 14.089216, perf = 22.45 tflops.
STEP-66: step_time = 36.833279 ms, foward_time = 22.609921, backward_time = 14.119936, perf = 22.39 tflops.
STEP-67: step_time = 37.795841 ms, foward_time = 23.476225, backward_time = 14.214144, perf = 21.82 tflops.
STEP-68: step_time = 36.528130 ms, foward_time = 22.537216, backward_time = 13.888512, perf = 22.58 tflops.
STEP-69: step_time = 36.541439 ms, foward_time = 22.374399, backward_time = 14.061568, perf = 22.57 tflops.
STEP-70: step_time = 37.444607 ms, foward_time = 23.434240, backward_time = 13.908992, perf = 22.02 tflops.
STEP-71: step_time = 36.518913 ms, foward_time = 22.581247, backward_time = 13.832192, perf = 22.58 tflops.
STEP-72: step_time = 36.102142 ms, foward_time = 22.181889, backward_time = 13.818880, perf = 22.84 tflops.
STEP-73: step_time = 36.350975 ms, foward_time = 22.313984, backward_time = 13.933568, perf = 22.69 tflops.
STEP-74: step_time = 36.461567 ms, foward_time = 22.405121, backward_time = 13.953024, perf = 22.62 tflops.
STEP-75: step_time = 37.343231 ms, foward_time = 23.386112, backward_time = 13.854720, perf = 22.08 tflops.
STEP-76: step_time = 36.880383 ms, foward_time = 22.780928, backward_time = 13.998080, perf = 22.36 tflops.
STEP-77: step_time = 36.124672 ms, foward_time = 22.150145, backward_time = 13.869056, perf = 22.83 tflops.
STEP-78: step_time = 36.465664 ms, foward_time = 21.996544, backward_time = 14.364672, perf = 22.61 tflops.
STEP-79: step_time = 36.327423 ms, foward_time = 22.224895, backward_time = 13.999104, perf = 22.70 tflops.
STEP-80: step_time = 37.639168 ms, foward_time = 23.598080, backward_time = 13.940736, perf = 21.91 tflops.
STEP-81: step_time = 35.923969 ms, foward_time = 21.940224, backward_time = 13.876224, perf = 22.95 tflops.
STEP-82: step_time = 36.198399 ms, foward_time = 22.245377, backward_time = 13.834240, perf = 22.78 tflops.
STEP-83: step_time = 38.227966 ms, foward_time = 24.237057, backward_time = 13.888512, perf = 21.57 tflops.
STEP-84: step_time = 36.208641 ms, foward_time = 22.180864, backward_time = 13.923328, perf = 22.77 tflops.
STEP-85: step_time = 37.071873 ms, foward_time = 23.099392, backward_time = 13.870080, perf = 22.24 tflops.
STEP-86: step_time = 37.553150 ms, foward_time = 23.577600, backward_time = 13.839360, perf = 21.96 tflops.
STEP-87: step_time = 36.021248 ms, foward_time = 21.986303, backward_time = 13.927424, perf = 22.89 tflops.
STEP-88: step_time = 37.217281 ms, foward_time = 23.249920, backward_time = 13.867008, perf = 22.16 tflops.
STEP-89: step_time = 36.749313 ms, foward_time = 22.693888, backward_time = 13.955072, perf = 22.44 tflops.
STEP-90: step_time = 36.658176 ms, foward_time = 22.621183, backward_time = 13.922304, perf = 22.50 tflops.
STEP-91: step_time = 37.500927 ms, foward_time = 23.469055, backward_time = 13.927424, perf = 21.99 tflops.
STEP-92: step_time = 36.862976 ms, foward_time = 22.633472, backward_time = 14.127104, perf = 22.37 tflops.
STEP-93: step_time = 36.705280 ms, foward_time = 22.725632, backward_time = 13.873152, perf = 22.47 tflops.
STEP-94: step_time = 37.468159 ms, foward_time = 23.454720, backward_time = 13.908992, perf = 22.01 tflops.
STEP-95: step_time = 36.595711 ms, foward_time = 22.578176, backward_time = 13.914112, perf = 22.53 tflops.
STEP-96: step_time = 36.219906 ms, foward_time = 22.199297, backward_time = 13.916160, perf = 22.77 tflops.
STEP-97: step_time = 34.891777 ms, foward_time = 20.814848, backward_time = 13.970432, perf = 23.63 tflops.
STEP-98: step_time = 35.138561 ms, foward_time = 21.171200, backward_time = 13.863936, perf = 23.47 tflops.
STEP-99: step_time = 36.177921 ms, foward_time = 21.780479, backward_time = 14.290944, perf = 22.79 tflops.

[Summary] Average synchronized step_time = 36.864102300008135 ms, forward = 22.676445865631102, backward = 14.080767997105916.
[Benchmark] world_size = 4, dtype = float16, model_dim = 1024, hidden_size = 4096, samples = 8192, num_local_experts = 16, topK = 2, a2a_ffn_overlap_degree = 1, device = `cuda:0`
STEP-0: step_time = 6788.967285 ms, foward_time = 6760.792969, backward_time = 27.115520, perf = 0.12 tflops.
STEP-1: step_time = 60.924927 ms, foward_time = 32.715775, backward_time = 28.002304, perf = 13.54 tflops.
STEP-2: step_time = 50.679810 ms, foward_time = 30.983168, backward_time = 19.558399, perf = 16.27 tflops.
STEP-3: step_time = 51.205120 ms, foward_time = 31.451136, backward_time = 19.616768, perf = 16.10 tflops.
STEP-4: step_time = 55.102463 ms, foward_time = 33.033215, backward_time = 21.906431, perf = 14.97 tflops.
STEP-5: step_time = 49.526783 ms, foward_time = 29.507584, backward_time = 19.880960, perf = 16.65 tflops.
STEP-6: step_time = 49.561600 ms, foward_time = 29.982719, backward_time = 19.446783, perf = 16.64 tflops.
STEP-7: step_time = 48.776192 ms, foward_time = 29.187073, backward_time = 19.455999, perf = 16.91 tflops.
STEP-8: step_time = 51.977215 ms, foward_time = 32.112640, backward_time = 19.718143, perf = 15.87 tflops.
STEP-9: step_time = 53.944321 ms, foward_time = 31.529984, backward_time = 22.252544, perf = 15.29 tflops.
STEP-10: step_time = 50.577408 ms, foward_time = 30.796801, backward_time = 19.651585, perf = 16.30 tflops.
STEP-11: step_time = 50.326527 ms, foward_time = 30.515200, backward_time = 19.676161, perf = 16.39 tflops.
STEP-12: step_time = 53.517311 ms, foward_time = 29.921280, backward_time = 23.474176, perf = 15.41 tflops.
STEP-13: step_time = 49.372162 ms, foward_time = 30.003201, backward_time = 19.250175, perf = 16.70 tflops.
STEP-14: step_time = 48.562176 ms, foward_time = 29.095936, backward_time = 19.338240, perf = 16.98 tflops.
STEP-15: step_time = 49.124352 ms, foward_time = 30.144512, backward_time = 18.823168, perf = 16.79 tflops.
STEP-16: step_time = 49.155071 ms, foward_time = 29.096960, backward_time = 19.921921, perf = 16.78 tflops.
STEP-17: step_time = 48.145409 ms, foward_time = 29.447168, backward_time = 18.573313, perf = 17.13 tflops.
STEP-18: step_time = 161.477631 ms, foward_time = 29.173759, backward_time = 132.143097, perf = 5.11 tflops.
STEP-19: step_time = 51.286015 ms, foward_time = 32.171009, backward_time = 18.981888, perf = 16.08 tflops.
STEP-20: step_time = 49.224705 ms, foward_time = 30.312449, backward_time = 18.788351, perf = 16.75 tflops.
STEP-21: step_time = 48.730110 ms, foward_time = 29.836288, backward_time = 18.770945, perf = 16.92 tflops.
STEP-22: step_time = 50.100224 ms, foward_time = 31.296513, backward_time = 18.605057, perf = 16.46 tflops.
STEP-23: step_time = 51.018753 ms, foward_time = 31.582209, backward_time = 19.299328, perf = 16.16 tflops.
STEP-24: step_time = 49.396736 ms, foward_time = 30.461952, backward_time = 18.812927, perf = 16.69 tflops.
STEP-25: step_time = 49.951744 ms, foward_time = 30.209024, backward_time = 19.621887, perf = 16.51 tflops.
STEP-26: step_time = 49.341438 ms, foward_time = 30.537727, backward_time = 18.663424, perf = 16.71 tflops.
STEP-27: step_time = 49.755135 ms, foward_time = 30.085119, backward_time = 19.526655, perf = 16.57 tflops.
STEP-28: step_time = 49.557503 ms, foward_time = 29.932545, backward_time = 19.491840, perf = 16.64 tflops.
STEP-29: step_time = 50.319359 ms, foward_time = 31.308800, backward_time = 18.885632, perf = 16.39 tflops.
STEP-30: step_time = 49.301502 ms, foward_time = 30.063616, backward_time = 19.109888, perf = 16.73 tflops.
STEP-31: step_time = 50.446335 ms, foward_time = 31.386623, backward_time = 18.937857, perf = 16.35 tflops.
STEP-32: step_time = 49.569794 ms, foward_time = 30.120960, backward_time = 19.322880, perf = 16.64 tflops.
STEP-33: step_time = 49.501183 ms, foward_time = 30.437376, backward_time = 18.941952, perf = 16.66 tflops.
STEP-34: step_time = 49.064960 ms, foward_time = 30.007296, backward_time = 18.941952, perf = 16.81 tflops.
STEP-35: step_time = 49.231873 ms, foward_time = 30.379007, backward_time = 18.731009, perf = 16.75 tflops.
STEP-36: step_time = 48.974850 ms, foward_time = 30.063616, backward_time = 18.794497, perf = 16.84 tflops.
STEP-37: step_time = 48.836609 ms, foward_time = 29.890560, backward_time = 18.828287, perf = 16.89 tflops.
STEP-38: step_time = 49.716225 ms, foward_time = 30.649343, backward_time = 18.944000, perf = 16.59 tflops.
STEP-39: step_time = 49.737728 ms, foward_time = 30.545919, backward_time = 19.072001, perf = 16.58 tflops.
STEP-40: step_time = 51.399681 ms, foward_time = 32.351231, backward_time = 18.929665, perf = 16.04 tflops.
STEP-41: step_time = 49.890305 ms, foward_time = 30.234625, backward_time = 19.532801, perf = 16.53 tflops.
STEP-42: step_time = 48.998402 ms, foward_time = 29.954048, backward_time = 18.912256, perf = 16.83 tflops.
STEP-43: step_time = 49.844223 ms, foward_time = 30.713856, backward_time = 18.981888, perf = 16.54 tflops.
STEP-44: step_time = 49.993729 ms, foward_time = 30.940161, backward_time = 18.902016, perf = 16.49 tflops.
STEP-45: step_time = 49.802238 ms, foward_time = 30.047232, backward_time = 19.582975, perf = 16.56 tflops.
STEP-46: step_time = 48.952320 ms, foward_time = 30.053375, backward_time = 18.769920, perf = 16.85 tflops.
STEP-47: step_time = 49.240063 ms, foward_time = 30.145536, backward_time = 18.950144, perf = 16.75 tflops.
STEP-48: step_time = 48.854015 ms, foward_time = 29.896704, backward_time = 18.835457, perf = 16.88 tflops.
STEP-49: step_time = 48.967682 ms, foward_time = 30.041088, backward_time = 18.807808, perf = 16.84 tflops.
STEP-50: step_time = 48.807938 ms, foward_time = 29.885441, backward_time = 18.804735, perf = 16.90 tflops.
STEP-51: step_time = 48.526337 ms, foward_time = 29.540352, backward_time = 18.869247, perf = 16.99 tflops.
STEP-52: step_time = 48.920574 ms, foward_time = 29.833216, backward_time = 18.960384, perf = 16.86 tflops.
STEP-53: step_time = 49.172482 ms, foward_time = 30.263296, backward_time = 18.793472, perf = 16.77 tflops.
STEP-54: step_time = 49.171455 ms, foward_time = 29.993984, backward_time = 19.060736, perf = 16.77 tflops.
STEP-55: step_time = 49.203201 ms, foward_time = 30.120960, backward_time = 18.960384, perf = 16.76 tflops.
STEP-56: step_time = 49.996799 ms, foward_time = 30.884865, backward_time = 18.995199, perf = 16.49 tflops.
STEP-57: step_time = 49.123329 ms, foward_time = 30.155775, backward_time = 18.830336, perf = 16.79 tflops.
STEP-58: step_time = 49.143806 ms, foward_time = 30.266369, backward_time = 18.757631, perf = 16.78 tflops.
STEP-59: step_time = 51.320831 ms, foward_time = 32.351231, backward_time = 18.850817, perf = 16.07 tflops.
STEP-60: step_time = 49.976318 ms, foward_time = 30.745600, backward_time = 19.106815, perf = 16.50 tflops.
STEP-61: step_time = 49.803265 ms, foward_time = 30.182400, backward_time = 19.497984, perf = 16.56 tflops.
STEP-62: step_time = 49.467392 ms, foward_time = 30.045183, backward_time = 19.307520, perf = 16.67 tflops.
STEP-63: step_time = 48.740353 ms, foward_time = 29.906944, backward_time = 18.691072, perf = 16.92 tflops.
STEP-64: step_time = 48.856064 ms, foward_time = 29.884417, backward_time = 18.838528, perf = 16.88 tflops.
STEP-65: step_time = 49.503231 ms, foward_time = 30.337025, backward_time = 19.049473, perf = 16.66 tflops.
STEP-66: step_time = 50.115585 ms, foward_time = 30.727167, backward_time = 19.267584, perf = 16.45 tflops.
STEP-67: step_time = 49.255424 ms, foward_time = 29.827072, backward_time = 19.307520, perf = 16.74 tflops.
STEP-68: step_time = 48.834560 ms, foward_time = 29.843456, backward_time = 18.844671, perf = 16.89 tflops.
STEP-69: step_time = 49.350655 ms, foward_time = 30.028799, backward_time = 19.178495, perf = 16.71 tflops.
STEP-70: step_time = 49.008640 ms, foward_time = 30.139393, backward_time = 18.753536, perf = 16.83 tflops.
STEP-71: step_time = 48.992256 ms, foward_time = 29.995008, backward_time = 18.848768, perf = 16.83 tflops.
STEP-72: step_time = 50.652161 ms, foward_time = 31.180799, backward_time = 19.320831, perf = 16.28 tflops.
STEP-73: step_time = 49.072128 ms, foward_time = 30.021631, backward_time = 18.904064, perf = 16.80 tflops.
STEP-74: step_time = 48.761856 ms, foward_time = 29.863935, backward_time = 18.785280, perf = 16.91 tflops.
STEP-75: step_time = 48.928768 ms, foward_time = 29.496321, backward_time = 19.315712, perf = 16.85 tflops.
STEP-76: step_time = 48.573441 ms, foward_time = 29.678593, backward_time = 18.780161, perf = 16.98 tflops.
STEP-77: step_time = 48.564224 ms, foward_time = 29.762560, backward_time = 18.679808, perf = 16.98 tflops.
STEP-78: step_time = 48.629761 ms, foward_time = 29.716480, backward_time = 18.790400, perf = 16.96 tflops.
STEP-79: step_time = 48.622593 ms, foward_time = 29.821953, backward_time = 18.684929, perf = 16.96 tflops.
STEP-80: step_time = 48.896000 ms, foward_time = 30.043137, backward_time = 18.735104, perf = 16.87 tflops.
STEP-81: step_time = 49.704960 ms, foward_time = 30.142464, backward_time = 19.441664, perf = 16.59 tflops.
STEP-82: step_time = 48.919552 ms, foward_time = 30.116863, backward_time = 18.690048, perf = 16.86 tflops.
STEP-83: step_time = 49.402882 ms, foward_time = 30.547968, backward_time = 18.676737, perf = 16.69 tflops.
STEP-84: step_time = 48.835583 ms, foward_time = 29.764608, backward_time = 18.956287, perf = 16.89 tflops.
STEP-85: step_time = 49.041409 ms, foward_time = 30.100479, backward_time = 18.810881, perf = 16.82 tflops.
STEP-86: step_time = 49.874943 ms, foward_time = 30.225409, backward_time = 19.534847, perf = 16.53 tflops.
STEP-87: step_time = 49.110016 ms, foward_time = 29.938688, backward_time = 19.056641, perf = 16.79 tflops.
STEP-88: step_time = 48.710655 ms, foward_time = 29.763584, backward_time = 18.813951, perf = 16.93 tflops.
STEP-89: step_time = 49.707008 ms, foward_time = 30.134272, backward_time = 19.453953, perf = 16.59 tflops.
STEP-90: step_time = 49.356800 ms, foward_time = 30.423040, backward_time = 18.820095, perf = 16.71 tflops.
STEP-91: step_time = 48.531456 ms, foward_time = 29.723648, backward_time = 18.692097, perf = 16.99 tflops.
STEP-92: step_time = 48.962559 ms, foward_time = 29.952000, backward_time = 18.868223, perf = 16.84 tflops.
STEP-93: step_time = 48.765953 ms, foward_time = 29.879295, backward_time = 18.769920, perf = 16.91 tflops.
STEP-94: step_time = 48.836609 ms, foward_time = 29.986816, backward_time = 18.733055, perf = 16.89 tflops.
STEP-95: step_time = 48.941055 ms, foward_time = 29.995008, backward_time = 18.829311, perf = 16.85 tflops.
STEP-96: step_time = 49.509377 ms, foward_time = 30.252031, backward_time = 19.135489, perf = 16.66 tflops.
STEP-97: step_time = 48.901119 ms, foward_time = 30.035969, backward_time = 18.750463, perf = 16.86 tflops.
STEP-98: step_time = 48.792576 ms, foward_time = 29.939713, backward_time = 18.738176, perf = 16.90 tflops.
STEP-99: step_time = 48.940033 ms, foward_time = 30.055424, backward_time = 18.766848, perf = 16.85 tflops.

[Summary] Average synchronized step_time = 49.246310488382974 ms, forward = 30.164974943796793, backward = 18.95524689356486.
[Benchmark] world_size = 4, dtype = float16, model_dim = 1024, hidden_size = 4096, samples = 8192, num_local_experts = 32, topK = 2, a2a_ffn_overlap_degree = 1, device = `cuda:0`
STEP-0: step_time = 7317.800781 ms, foward_time = 7280.042969, backward_time = 37.228542, perf = 0.11 tflops.
STEP-1: step_time = 1014.425598 ms, foward_time = 48.029697, backward_time = 966.169617, perf = 0.81 tflops.
STEP-2: step_time = 67.505150 ms, foward_time = 43.440128, backward_time = 23.771135, perf = 12.22 tflops.
STEP-3: step_time = 63.875072 ms, foward_time = 41.344002, backward_time = 22.268929, perf = 12.91 tflops.
STEP-4: step_time = 60.504063 ms, foward_time = 38.394878, backward_time = 21.918720, perf = 13.63 tflops.
STEP-5: step_time = 58.950657 ms, foward_time = 36.830208, backward_time = 21.928961, perf = 13.99 tflops.
STEP-6: step_time = 58.771458 ms, foward_time = 36.748287, backward_time = 21.834751, perf = 14.03 tflops.
STEP-7: step_time = 58.498047 ms, foward_time = 36.384769, backward_time = 21.935104, perf = 14.10 tflops.
STEP-8: step_time = 58.306561 ms, foward_time = 36.175873, backward_time = 21.941248, perf = 14.14 tflops.
STEP-9: step_time = 61.490177 ms, foward_time = 37.715969, backward_time = 23.579647, perf = 13.41 tflops.
STEP-10: step_time = 59.062271 ms, foward_time = 36.626431, backward_time = 22.259712, perf = 13.96 tflops.
STEP-11: step_time = 60.545025 ms, foward_time = 37.822464, backward_time = 22.520832, perf = 13.62 tflops.
STEP-12: step_time = 62.139393 ms, foward_time = 39.092224, backward_time = 22.839296, perf = 13.27 tflops.
STEP-13: step_time = 60.661758 ms, foward_time = 38.193153, backward_time = 22.278145, perf = 13.59 tflops.
STEP-14: step_time = 60.909569 ms, foward_time = 38.562817, backward_time = 22.143999, perf = 13.54 tflops.
STEP-15: step_time = 61.171711 ms, foward_time = 38.850559, backward_time = 22.137856, perf = 13.48 tflops.
STEP-16: step_time = 60.966911 ms, foward_time = 38.490112, backward_time = 22.247423, perf = 13.53 tflops.
STEP-17: step_time = 60.273663 ms, foward_time = 37.981182, backward_time = 22.076416, perf = 13.68 tflops.
STEP-18: step_time = 60.468224 ms, foward_time = 38.087681, backward_time = 22.196224, perf = 13.64 tflops.
STEP-19: step_time = 61.220863 ms, foward_time = 38.362110, backward_time = 22.675455, perf = 13.47 tflops.
STEP-20: step_time = 62.425087 ms, foward_time = 39.147518, backward_time = 23.099392, perf = 13.21 tflops.
STEP-21: step_time = 60.835838 ms, foward_time = 38.446079, backward_time = 22.188032, perf = 13.56 tflops.
STEP-22: step_time = 61.452290 ms, foward_time = 39.230465, backward_time = 22.049791, perf = 13.42 tflops.
STEP-23: step_time = 60.760063 ms, foward_time = 38.428673, backward_time = 22.139904, perf = 13.57 tflops.
STEP-24: step_time = 59.558910 ms, foward_time = 37.709824, backward_time = 21.655552, perf = 13.85 tflops.
STEP-25: step_time = 58.487808 ms, foward_time = 36.472832, backward_time = 21.827583, perf = 14.10 tflops.
STEP-26: step_time = 58.684418 ms, foward_time = 36.305920, backward_time = 22.194176, perf = 14.05 tflops.
STEP-27: step_time = 58.042370 ms, foward_time = 36.057087, backward_time = 21.803007, perf = 14.21 tflops.
STEP-28: step_time = 58.773502 ms, foward_time = 35.952641, backward_time = 22.652927, perf = 14.03 tflops.
STEP-29: step_time = 58.722305 ms, foward_time = 36.877312, backward_time = 21.667839, perf = 14.04 tflops.
STEP-30: step_time = 58.478592 ms, foward_time = 36.233215, backward_time = 22.073343, perf = 14.10 tflops.
STEP-31: step_time = 58.296322 ms, foward_time = 36.231167, backward_time = 21.884928, perf = 14.15 tflops.
STEP-32: step_time = 58.716160 ms, foward_time = 35.959808, backward_time = 22.584320, perf = 14.04 tflops.
STEP-33: step_time = 58.863617 ms, foward_time = 36.121601, backward_time = 22.572033, perf = 14.01 tflops.
STEP-34: step_time = 57.984001 ms, foward_time = 36.203522, backward_time = 21.592064, perf = 14.22 tflops.
STEP-35: step_time = 59.185150 ms, foward_time = 37.075970, backward_time = 21.924864, perf = 13.93 tflops.
STEP-36: step_time = 58.909695 ms, foward_time = 36.235264, backward_time = 22.494207, perf = 14.00 tflops.
STEP-37: step_time = 58.344448 ms, foward_time = 36.425728, backward_time = 21.738497, perf = 14.13 tflops.
STEP-38: step_time = 58.033154 ms, foward_time = 36.257793, backward_time = 21.599232, perf = 14.21 tflops.
STEP-39: step_time = 58.330112 ms, foward_time = 36.203522, backward_time = 21.946367, perf = 14.14 tflops.
STEP-40: step_time = 57.965569 ms, foward_time = 36.033535, backward_time = 21.760000, perf = 14.23 tflops.
STEP-41: step_time = 58.193920 ms, foward_time = 36.333569, backward_time = 21.675009, perf = 14.17 tflops.
STEP-42: step_time = 57.995262 ms, foward_time = 36.176895, backward_time = 21.640192, perf = 14.22 tflops.
STEP-43: step_time = 58.176514 ms, foward_time = 36.379646, backward_time = 21.603329, perf = 14.17 tflops.
STEP-44: step_time = 58.372097 ms, foward_time = 36.399105, backward_time = 21.791744, perf = 14.13 tflops.
STEP-45: step_time = 57.939968 ms, foward_time = 36.172798, backward_time = 21.592064, perf = 14.23 tflops.
STEP-46: step_time = 58.129410 ms, foward_time = 36.223999, backward_time = 21.724159, perf = 14.19 tflops.
STEP-47: step_time = 59.436031 ms, foward_time = 37.222401, backward_time = 21.992449, perf = 13.87 tflops.
STEP-48: step_time = 60.537857 ms, foward_time = 36.080639, backward_time = 24.273920, perf = 13.62 tflops.
STEP-49: step_time = 57.859074 ms, foward_time = 36.062206, backward_time = 21.617664, perf = 14.25 tflops.
STEP-50: step_time = 58.907646 ms, foward_time = 35.872768, backward_time = 22.857727, perf = 14.00 tflops.
STEP-51: step_time = 57.671680 ms, foward_time = 35.889153, backward_time = 21.603329, perf = 14.30 tflops.
STEP-52: step_time = 58.472446 ms, foward_time = 36.612095, backward_time = 21.693439, perf = 14.10 tflops.
STEP-53: step_time = 59.312126 ms, foward_time = 36.137985, backward_time = 22.999041, perf = 13.90 tflops.
STEP-54: step_time = 58.658817 ms, foward_time = 36.926464, backward_time = 21.567488, perf = 14.06 tflops.
STEP-55: step_time = 58.823681 ms, foward_time = 36.659199, backward_time = 21.990400, perf = 14.02 tflops.
STEP-56: step_time = 60.726273 ms, foward_time = 36.837376, backward_time = 23.714815, perf = 13.58 tflops.
STEP-57: step_time = 60.455936 ms, foward_time = 37.058559, backward_time = 23.218176, perf = 13.64 tflops.
STEP-58: step_time = 60.219391 ms, foward_time = 37.150719, backward_time = 22.898687, perf = 13.69 tflops.
STEP-59: step_time = 61.182976 ms, foward_time = 37.138432, backward_time = 23.871489, perf = 13.48 tflops.
STEP-60: step_time = 60.225536 ms, foward_time = 36.124672, backward_time = 23.928831, perf = 13.69 tflops.
STEP-61: step_time = 60.145664 ms, foward_time = 36.296703, backward_time = 23.669760, perf = 13.71 tflops.
STEP-62: step_time = 60.281857 ms, foward_time = 36.360191, backward_time = 23.745537, perf = 13.68 tflops.
STEP-63: step_time = 60.354561 ms, foward_time = 36.286465, backward_time = 23.890944, perf = 13.66 tflops.
STEP-64: step_time = 57.963520 ms, foward_time = 36.082687, backward_time = 21.710848, perf = 14.23 tflops.
STEP-65: step_time = 59.957249 ms, foward_time = 36.316158, backward_time = 23.459841, perf = 13.75 tflops.
STEP-66: step_time = 57.973759 ms, foward_time = 36.188160, backward_time = 21.606400, perf = 14.22 tflops.
STEP-67: step_time = 58.034176 ms, foward_time = 36.151295, backward_time = 21.708799, perf = 14.21 tflops.
STEP-68: step_time = 57.869312 ms, foward_time = 35.919872, backward_time = 21.771263, perf = 14.25 tflops.
STEP-69: step_time = 58.445824 ms, foward_time = 36.306946, backward_time = 21.963776, perf = 14.11 tflops.
STEP-70: step_time = 57.958401 ms, foward_time = 35.985409, backward_time = 21.799936, perf = 14.23 tflops.
STEP-71: step_time = 57.884670 ms, foward_time = 36.272129, backward_time = 21.430271, perf = 14.25 tflops.
STEP-72: step_time = 57.419777 ms, foward_time = 35.585026, backward_time = 21.667839, perf = 14.36 tflops.
STEP-73: step_time = 58.312702 ms, foward_time = 36.508671, backward_time = 21.635073, perf = 14.14 tflops.
STEP-74: step_time = 57.613312 ms, foward_time = 35.917824, backward_time = 21.526527, perf = 14.31 tflops.
STEP-75: step_time = 57.645058 ms, foward_time = 35.854336, backward_time = 21.613567, perf = 14.31 tflops.
STEP-76: step_time = 58.466305 ms, foward_time = 35.973122, backward_time = 22.328320, perf = 14.10 tflops.
STEP-77: step_time = 58.126335 ms, foward_time = 36.166656, backward_time = 21.790720, perf = 14.19 tflops.
STEP-78: step_time = 57.960449 ms, foward_time = 36.059135, backward_time = 21.726208, perf = 14.23 tflops.
STEP-79: step_time = 58.130432 ms, foward_time = 36.151295, backward_time = 21.812223, perf = 14.19 tflops.
STEP-80: step_time = 57.950207 ms, foward_time = 36.206593, backward_time = 21.557247, perf = 14.23 tflops.
STEP-81: step_time = 58.287106 ms, foward_time = 36.184063, backward_time = 21.925888, perf = 14.15 tflops.
STEP-82: step_time = 58.469376 ms, foward_time = 36.109310, backward_time = 22.192127, perf = 14.10 tflops.
STEP-83: step_time = 57.818111 ms, foward_time = 36.008961, backward_time = 21.635073, perf = 14.26 tflops.
STEP-84: step_time = 57.837566 ms, foward_time = 36.050945, backward_time = 21.619713, perf = 14.26 tflops.
STEP-85: step_time = 58.207233 ms, foward_time = 36.474880, backward_time = 21.567488, perf = 14.17 tflops.
STEP-86: step_time = 58.614784 ms, foward_time = 36.529152, backward_time = 21.911552, perf = 14.07 tflops.
STEP-87: step_time = 58.276863 ms, foward_time = 36.213760, backward_time = 21.891071, perf = 14.15 tflops.
STEP-88: step_time = 57.804798 ms, foward_time = 36.083714, backward_time = 21.545984, perf = 14.27 tflops.
STEP-89: step_time = 58.227711 ms, foward_time = 36.369408, backward_time = 21.688320, perf = 14.16 tflops.
STEP-90: step_time = 58.134529 ms, foward_time = 36.127743, backward_time = 21.840897, perf = 14.18 tflops.
STEP-91: step_time = 60.551167 ms, foward_time = 36.152321, backward_time = 24.226816, perf = 13.62 tflops.
STEP-92: step_time = 59.101185 ms, foward_time = 37.190655, backward_time = 21.743616, perf = 13.95 tflops.
STEP-93: step_time = 57.995262 ms, foward_time = 36.149246, backward_time = 21.668863, perf = 14.22 tflops.
STEP-94: step_time = 60.516354 ms, foward_time = 36.034561, backward_time = 24.306688, perf = 13.63 tflops.
STEP-95: step_time = 58.257408 ms, foward_time = 36.204544, backward_time = 21.841921, perf = 14.16 tflops.
STEP-96: step_time = 58.662910 ms, foward_time = 36.235264, backward_time = 22.247423, perf = 14.06 tflops.
STEP-97: step_time = 57.974785 ms, foward_time = 36.166656, backward_time = 21.634048, perf = 14.22 tflops.
STEP-98: step_time = 57.971710 ms, foward_time = 36.074497, backward_time = 21.718016, perf = 14.22 tflops.
STEP-99: step_time = 59.735039 ms, foward_time = 37.580799, backward_time = 21.982208, perf = 13.80 tflops.

[Summary] Average synchronized step_time = 58.6699946085612 ms, forward = 36.30035610198975, backward = 22.193612734476726.
[Benchmark] world_size = 4, dtype = float16, model_dim = 1024, hidden_size = 4096, samples = 8192, num_local_experts = 64, topK = 2, a2a_ffn_overlap_degree = 1, device = `cuda:0`
STEP-0: step_time = 8610.966797 ms, foward_time = 7547.966309, backward_time = 1062.144043, perf = 0.10 tflops.
STEP-1: step_time = 805.995544 ms, foward_time = 69.847038, backward_time = 735.566833, perf = 1.02 tflops.
STEP-2: step_time = 97.836029 ms, foward_time = 67.509247, backward_time = 29.962240, perf = 8.43 tflops.
STEP-3: step_time = 94.750717 ms, foward_time = 64.939011, backward_time = 29.393921, perf = 8.70 tflops.
STEP-4: step_time = 90.840065 ms, foward_time = 60.360703, backward_time = 30.198784, perf = 9.08 tflops.
STEP-5: step_time = 87.225342 ms, foward_time = 57.145344, backward_time = 29.795328, perf = 9.45 tflops.
STEP-6: step_time = 86.034431 ms, foward_time = 56.105984, backward_time = 29.678593, perf = 9.58 tflops.
STEP-7: step_time = 84.979713 ms, foward_time = 55.263233, backward_time = 29.436928, perf = 9.70 tflops.
STEP-8: step_time = 84.710403 ms, foward_time = 57.115646, backward_time = 27.316223, perf = 9.73 tflops.
STEP-9: step_time = 82.524162 ms, foward_time = 54.337536, backward_time = 27.964417, perf = 9.99 tflops.
STEP-10: step_time = 82.993149 ms, foward_time = 55.002113, backward_time = 27.774977, perf = 9.94 tflops.
STEP-11: step_time = 85.526527 ms, foward_time = 57.066498, backward_time = 28.249088, perf = 9.64 tflops.
STEP-12: step_time = 86.090752 ms, foward_time = 54.805504, backward_time = 31.060991, perf = 9.58 tflops.
STEP-13: step_time = 82.925568 ms, foward_time = 54.764545, backward_time = 27.951103, perf = 9.94 tflops.
STEP-14: step_time = 81.973251 ms, foward_time = 54.740993, backward_time = 27.037697, perf = 10.06 tflops.
STEP-15: step_time = 83.333122 ms, foward_time = 55.494656, backward_time = 27.628544, perf = 9.90 tflops.
STEP-16: step_time = 82.965508 ms, foward_time = 55.169025, backward_time = 27.602943, perf = 9.94 tflops.
STEP-17: step_time = 83.531776 ms, foward_time = 55.917568, backward_time = 27.398144, perf = 9.87 tflops.
STEP-18: step_time = 83.887100 ms, foward_time = 55.956478, backward_time = 27.575296, perf = 9.83 tflops.
STEP-19: step_time = 84.608002 ms, foward_time = 56.286209, backward_time = 28.095488, perf = 9.75 tflops.
STEP-20: step_time = 85.511169 ms, foward_time = 56.749058, backward_time = 28.404736, perf = 9.64 tflops.
STEP-21: step_time = 85.368835 ms, foward_time = 57.141247, backward_time = 27.964417, perf = 9.66 tflops.
STEP-22: step_time = 81.796097 ms, foward_time = 53.709824, backward_time = 27.832319, perf = 10.08 tflops.
STEP-23: step_time = 80.221184 ms, foward_time = 53.145599, backward_time = 26.840063, perf = 10.28 tflops.
STEP-24: step_time = 81.163261 ms, foward_time = 53.650433, backward_time = 27.278336, perf = 10.16 tflops.
STEP-25: step_time = 81.748993 ms, foward_time = 54.654976, backward_time = 26.701824, perf = 10.09 tflops.
STEP-26: step_time = 80.328705 ms, foward_time = 53.185535, backward_time = 26.926081, perf = 10.27 tflops.
STEP-27: step_time = 80.184319 ms, foward_time = 52.313087, backward_time = 27.658239, perf = 10.28 tflops.
STEP-28: step_time = 81.545219 ms, foward_time = 53.082111, backward_time = 28.215296, perf = 10.11 tflops.
STEP-29: step_time = 80.840706 ms, foward_time = 52.625408, backward_time = 27.870209, perf = 10.20 tflops.
STEP-30: step_time = 81.819649 ms, foward_time = 54.096897, backward_time = 27.293695, perf = 10.08 tflops.
STEP-31: step_time = 80.699394 ms, foward_time = 53.206017, backward_time = 27.155457, perf = 10.22 tflops.
STEP-32: step_time = 94.962685 ms, foward_time = 64.984062, backward_time = 29.602816, perf = 8.68 tflops.
STEP-33: step_time = 92.463104 ms, foward_time = 57.982975, backward_time = 34.123775, perf = 8.92 tflops.
STEP-34: step_time = 86.499329 ms, foward_time = 57.896961, backward_time = 28.276735, perf = 9.53 tflops.
STEP-35: step_time = 85.787651 ms, foward_time = 57.070591, backward_time = 28.345345, perf = 9.61 tflops.
STEP-36: step_time = 87.675903 ms, foward_time = 57.711617, backward_time = 29.554688, perf = 9.41 tflops.
STEP-37: step_time = 87.503876 ms, foward_time = 57.120770, backward_time = 30.041088, perf = 9.42 tflops.
STEP-38: step_time = 87.214081 ms, foward_time = 57.046017, backward_time = 29.770752, perf = 9.46 tflops.
STEP-39: step_time = 87.029762 ms, foward_time = 56.879105, backward_time = 29.810688, perf = 9.48 tflops.
STEP-40: step_time = 89.094147 ms, foward_time = 58.938370, backward_time = 29.798401, perf = 9.26 tflops.
STEP-41: step_time = 87.360512 ms, foward_time = 57.178112, backward_time = 29.811712, perf = 9.44 tflops.
STEP-42: step_time = 88.193024 ms, foward_time = 57.814014, backward_time = 30.006271, perf = 9.35 tflops.
STEP-43: step_time = 87.942146 ms, foward_time = 57.973759, backward_time = 29.620224, perf = 9.38 tflops.
STEP-44: step_time = 88.632317 ms, foward_time = 59.831295, backward_time = 28.442623, perf = 9.30 tflops.
STEP-45: step_time = 84.804611 ms, foward_time = 57.009151, backward_time = 27.421696, perf = 9.72 tflops.
STEP-46: step_time = 85.429245 ms, foward_time = 56.770561, backward_time = 28.308479, perf = 9.65 tflops.
STEP-47: step_time = 85.816322 ms, foward_time = 57.280514, backward_time = 28.179457, perf = 9.61 tflops.
STEP-48: step_time = 85.523453 ms, foward_time = 56.891392, backward_time = 28.257280, perf = 9.64 tflops.
STEP-49: step_time = 86.751228 ms, foward_time = 57.383938, backward_time = 29.004801, perf = 9.51 tflops.
STEP-50: step_time = 85.327873 ms, foward_time = 57.037823, backward_time = 27.951103, perf = 9.66 tflops.
STEP-51: step_time = 90.033150 ms, foward_time = 61.181953, backward_time = 28.494848, perf = 9.16 tflops.
STEP-52: step_time = 86.609917 ms, foward_time = 57.413631, backward_time = 28.845057, perf = 9.52 tflops.
STEP-53: step_time = 85.987328 ms, foward_time = 58.013695, backward_time = 27.603968, perf = 9.59 tflops.
STEP-54: step_time = 85.307388 ms, foward_time = 57.629696, backward_time = 27.303936, perf = 9.67 tflops.
STEP-55: step_time = 84.830208 ms, foward_time = 56.991745, backward_time = 27.474943, perf = 9.72 tflops.
STEP-56: step_time = 85.321732 ms, foward_time = 57.404415, backward_time = 27.544577, perf = 9.66 tflops.
STEP-57: step_time = 84.989952 ms, foward_time = 57.117695, backward_time = 27.507711, perf = 9.70 tflops.
STEP-58: step_time = 86.205437 ms, foward_time = 57.828354, backward_time = 27.968512, perf = 9.57 tflops.
STEP-59: step_time = 87.814140 ms, foward_time = 58.692608, backward_time = 28.749825, perf = 9.39 tflops.
STEP-60: step_time = 86.719490 ms, foward_time = 57.080833, backward_time = 29.235201, perf = 9.51 tflops.
STEP-61: step_time = 85.660675 ms, foward_time = 56.693760, backward_time = 28.596224, perf = 9.63 tflops.
STEP-62: step_time = 85.143555 ms, foward_time = 56.394753, backward_time = 28.395519, perf = 9.69 tflops.
STEP-63: step_time = 84.861954 ms, foward_time = 56.427521, backward_time = 28.088320, perf = 9.72 tflops.
STEP-64: step_time = 85.892097 ms, foward_time = 56.928257, backward_time = 28.619776, perf = 9.60 tflops.
STEP-65: step_time = 86.497276 ms, foward_time = 56.918015, backward_time = 29.239296, perf = 9.53 tflops.
STEP-66: step_time = 87.804932 ms, foward_time = 58.901505, backward_time = 28.554239, perf = 9.39 tflops.
STEP-67: step_time = 85.325821 ms, foward_time = 56.713215, backward_time = 28.242945, perf = 9.66 tflops.
STEP-68: step_time = 85.212158 ms, foward_time = 57.183231, backward_time = 27.663361, perf = 9.68 tflops.
STEP-69: step_time = 85.132286 ms, foward_time = 57.004032, backward_time = 27.753471, perf = 9.69 tflops.
STEP-70: step_time = 85.723137 ms, foward_time = 57.149441, backward_time = 28.223488, perf = 9.62 tflops.
STEP-71: step_time = 86.067200 ms, foward_time = 56.803329, backward_time = 28.888063, perf = 9.58 tflops.
STEP-72: step_time = 85.905411 ms, foward_time = 57.534466, backward_time = 28.023808, perf = 9.60 tflops.
STEP-73: step_time = 87.086082 ms, foward_time = 58.855423, backward_time = 27.879423, perf = 9.47 tflops.
STEP-74: step_time = 85.987328 ms, foward_time = 57.493504, backward_time = 28.113920, perf = 9.59 tflops.
STEP-75: step_time = 85.787651 ms, foward_time = 56.706047, backward_time = 28.726273, perf = 9.61 tflops.
STEP-76: step_time = 84.851715 ms, foward_time = 56.771584, backward_time = 27.681791, perf = 9.72 tflops.
STEP-77: step_time = 85.612541 ms, foward_time = 57.154560, backward_time = 28.094463, perf = 9.63 tflops.
STEP-78: step_time = 84.891647 ms, foward_time = 56.788994, backward_time = 27.736065, perf = 9.71 tflops.
STEP-79: step_time = 87.202812 ms, foward_time = 58.498047, backward_time = 28.359680, perf = 9.46 tflops.
STEP-80: step_time = 86.574081 ms, foward_time = 57.569279, backward_time = 28.612608, perf = 9.53 tflops.
STEP-81: step_time = 88.614914 ms, foward_time = 60.284927, backward_time = 27.978752, perf = 9.31 tflops.
STEP-82: step_time = 86.571007 ms, foward_time = 57.377792, backward_time = 28.723200, perf = 9.53 tflops.
STEP-83: step_time = 86.649857 ms, foward_time = 57.196545, backward_time = 29.044737, perf = 9.52 tflops.
STEP-84: step_time = 84.370430 ms, foward_time = 56.881153, backward_time = 27.115520, perf = 9.77 tflops.
STEP-85: step_time = 84.593666 ms, foward_time = 56.849407, backward_time = 27.366400, perf = 9.75 tflops.
STEP-86: step_time = 85.431297 ms, foward_time = 57.652225, backward_time = 27.415552, perf = 9.65 tflops.
STEP-87: step_time = 84.526077 ms, foward_time = 56.835072, backward_time = 27.290625, perf = 9.76 tflops.
STEP-88: step_time = 84.667389 ms, foward_time = 56.983551, backward_time = 27.337729, perf = 9.74 tflops.
STEP-89: step_time = 84.642815 ms, foward_time = 56.779778, backward_time = 27.499519, perf = 9.74 tflops.
STEP-90: step_time = 84.553726 ms, foward_time = 56.999935, backward_time = 27.163649, perf = 9.75 tflops.
STEP-91: step_time = 85.371902 ms, foward_time = 57.678848, backward_time = 27.324415, perf = 9.66 tflops.
STEP-92: step_time = 84.644867 ms, foward_time = 56.997887, backward_time = 27.232256, perf = 9.74 tflops.
STEP-93: step_time = 86.376450 ms, foward_time = 57.401344, backward_time = 28.589056, perf = 9.55 tflops.
STEP-94: step_time = 86.217728 ms, foward_time = 57.047039, backward_time = 28.777472, perf = 9.56 tflops.
STEP-95: step_time = 85.346306 ms, foward_time = 57.000961, backward_time = 27.986944, perf = 9.66 tflops.
STEP-96: step_time = 86.083588 ms, foward_time = 56.934399, backward_time = 28.802048, perf = 9.58 tflops.
STEP-97: step_time = 86.496254 ms, foward_time = 57.582592, backward_time = 28.593151, perf = 9.53 tflops.
STEP-98: step_time = 84.985855 ms, foward_time = 56.936447, backward_time = 27.683840, perf = 9.70 tflops.
STEP-99: step_time = 84.834305 ms, foward_time = 57.157631, backward_time = 27.286528, perf = 9.72 tflops.

[Summary] Average synchronized step_time = 86.01487350463867 ms, forward = 57.44216747283936, backward = 28.2039124806722.
[Benchmark] world_size = 4, dtype = float16, model_dim = 1024, hidden_size = 4096, samples = 8192, num_local_experts = 8, topK = 2, a2a_ffn_overlap_degree = 1, device = `cuda:0`
STEP-0: step_time = 8550.923828 ms, foward_time = 8539.565430, backward_time = 10.300416, perf = 0.10 tflops.
STEP-1: step_time = 32.843777 ms, foward_time = 31.366144, backward_time = 1.379328, perf = 25.11 tflops.
STEP-2: step_time = 27.541504 ms, foward_time = 25.624577, backward_time = 1.832960, perf = 29.94 tflops.
STEP-3: step_time = 24.169472 ms, foward_time = 22.236160, backward_time = 1.849344, perf = 34.12 tflops.
STEP-4: step_time = 24.035328 ms, foward_time = 22.030336, backward_time = 1.925120, perf = 34.31 tflops.
STEP-5: step_time = 24.050688 ms, foward_time = 22.075392, backward_time = 1.894400, perf = 34.29 tflops.
STEP-6: step_time = 24.918016 ms, foward_time = 22.621183, backward_time = 2.213888, perf = 33.09 tflops.
STEP-7: step_time = 24.249344 ms, foward_time = 22.201344, backward_time = 1.968128, perf = 34.01 tflops.
STEP-8: step_time = 24.131584 ms, foward_time = 22.107136, backward_time = 1.945600, perf = 34.17 tflops.
STEP-9: step_time = 23.826431 ms, foward_time = 21.808128, backward_time = 1.941504, perf = 34.61 tflops.
STEP-10: step_time = 22.942720 ms, foward_time = 21.026815, backward_time = 1.836032, perf = 35.94 tflops.
STEP-11: step_time = 23.002111 ms, foward_time = 21.143553, backward_time = 1.778688, perf = 35.85 tflops.
STEP-12: step_time = 22.849537 ms, foward_time = 20.995071, backward_time = 1.776640, perf = 36.09 tflops.
STEP-13: step_time = 24.100864 ms, foward_time = 22.222849, backward_time = 1.799168, perf = 34.22 tflops.
STEP-14: step_time = 23.403521 ms, foward_time = 21.509121, backward_time = 1.813504, perf = 35.24 tflops.
STEP-15: step_time = 22.797312 ms, foward_time = 20.904961, backward_time = 1.813504, perf = 36.17 tflops.
STEP-16: step_time = 22.955008 ms, foward_time = 21.214209, backward_time = 1.660928, perf = 35.92 tflops.
STEP-17: step_time = 22.978559 ms, foward_time = 21.096449, backward_time = 1.802240, perf = 35.89 tflops.
STEP-18: step_time = 23.214081 ms, foward_time = 21.332993, backward_time = 1.801216, perf = 35.52 tflops.
STEP-19: step_time = 23.236609 ms, foward_time = 21.423103, backward_time = 1.733632, perf = 35.49 tflops.
STEP-20: step_time = 22.896641 ms, foward_time = 21.021696, backward_time = 1.795072, perf = 36.02 tflops.
STEP-21: step_time = 24.656897 ms, foward_time = 22.791168, backward_time = 1.787904, perf = 33.44 tflops.
STEP-22: step_time = 23.093248 ms, foward_time = 21.227520, backward_time = 1.785856, perf = 35.71 tflops.
STEP-23: step_time = 22.926336 ms, foward_time = 21.126144, backward_time = 1.720320, perf = 35.97 tflops.
STEP-24: step_time = 22.944769 ms, foward_time = 21.059584, backward_time = 1.808384, perf = 35.94 tflops.
STEP-25: step_time = 22.790144 ms, foward_time = 21.005312, backward_time = 1.705984, perf = 36.18 tflops.
STEP-26: step_time = 22.851583 ms, foward_time = 20.917248, backward_time = 1.855488, perf = 36.09 tflops.
STEP-27: step_time = 23.079935 ms, foward_time = 21.211136, backward_time = 1.792000, perf = 35.73 tflops.
STEP-28: step_time = 25.321472 ms, foward_time = 23.482368, backward_time = 1.755136, perf = 32.57 tflops.
STEP-29: step_time = 22.958080 ms, foward_time = 20.974592, backward_time = 1.902592, perf = 35.92 tflops.
STEP-30: step_time = 22.860800 ms, foward_time = 20.994047, backward_time = 1.785856, perf = 36.07 tflops.
STEP-31: step_time = 23.090176 ms, foward_time = 21.172224, backward_time = 1.841152, perf = 35.71 tflops.
STEP-32: step_time = 22.922239 ms, foward_time = 21.019648, backward_time = 1.816576, perf = 35.98 tflops.
STEP-33: step_time = 23.000065 ms, foward_time = 21.105663, backward_time = 1.812480, perf = 35.85 tflops.
STEP-34: step_time = 22.776833 ms, foward_time = 20.999168, backward_time = 1.697792, perf = 36.20 tflops.
STEP-35: step_time = 23.746559 ms, foward_time = 21.907455, backward_time = 1.756160, perf = 34.73 tflops.
STEP-36: step_time = 23.018496 ms, foward_time = 21.171200, backward_time = 1.770496, perf = 35.82 tflops.
STEP-37: step_time = 23.088127 ms, foward_time = 21.188608, backward_time = 1.822720, perf = 35.72 tflops.
STEP-38: step_time = 23.032831 ms, foward_time = 21.186560, backward_time = 1.766400, perf = 35.80 tflops.
STEP-39: step_time = 23.016447 ms, foward_time = 21.277697, backward_time = 1.658880, perf = 35.83 tflops.
STEP-40: step_time = 23.033855 ms, foward_time = 21.079041, backward_time = 1.878016, perf = 35.80 tflops.
STEP-41: step_time = 23.105536 ms, foward_time = 21.236736, backward_time = 1.788928, perf = 35.69 tflops.
STEP-42: step_time = 23.984129 ms, foward_time = 21.045248, backward_time = 2.861056, perf = 34.38 tflops.
STEP-43: step_time = 23.001087 ms, foward_time = 21.177343, backward_time = 1.744896, perf = 35.85 tflops.
STEP-44: step_time = 23.036928 ms, foward_time = 21.226496, backward_time = 1.731584, perf = 35.80 tflops.
STEP-45: step_time = 22.656000 ms, foward_time = 20.912128, backward_time = 1.667072, perf = 36.40 tflops.
STEP-46: step_time = 22.775808 ms, foward_time = 20.998144, backward_time = 1.701888, perf = 36.21 tflops.
STEP-47: step_time = 22.978559 ms, foward_time = 21.072895, backward_time = 1.828864, perf = 35.89 tflops.
STEP-48: step_time = 22.884352 ms, foward_time = 21.040129, backward_time = 1.762304, perf = 36.03 tflops.
STEP-49: step_time = 23.127041 ms, foward_time = 21.179392, backward_time = 1.868800, perf = 35.66 tflops.
STEP-50: step_time = 24.193024 ms, foward_time = 22.234112, backward_time = 1.881088, perf = 34.09 tflops.
STEP-51: step_time = 23.266304 ms, foward_time = 21.366783, backward_time = 1.822720, perf = 35.44 tflops.
STEP-52: step_time = 23.328768 ms, foward_time = 21.438463, backward_time = 1.815552, perf = 35.35 tflops.
STEP-53: step_time = 23.566336 ms, foward_time = 21.547009, backward_time = 1.945600, perf = 34.99 tflops.
STEP-54: step_time = 22.935553 ms, foward_time = 21.114880, backward_time = 1.744896, perf = 35.95 tflops.
STEP-55: step_time = 22.852608 ms, foward_time = 21.006336, backward_time = 1.767424, perf = 36.08 tflops.
STEP-56: step_time = 22.962175 ms, foward_time = 21.087233, backward_time = 1.798144, perf = 35.91 tflops.
STEP-57: step_time = 23.245825 ms, foward_time = 21.396481, backward_time = 1.772544, perf = 35.47 tflops.
STEP-58: step_time = 22.947840 ms, foward_time = 21.059584, backward_time = 1.814528, perf = 35.94 tflops.
STEP-59: step_time = 24.010752 ms, foward_time = 21.866495, backward_time = 2.068480, perf = 34.34 tflops.
STEP-60: step_time = 23.056383 ms, foward_time = 21.184511, backward_time = 1.795072, perf = 35.77 tflops.
STEP-61: step_time = 22.955008 ms, foward_time = 21.079041, backward_time = 1.798144, perf = 35.92 tflops.
STEP-62: step_time = 22.904833 ms, foward_time = 20.951040, backward_time = 1.878016, perf = 36.00 tflops.
STEP-63: step_time = 22.731775 ms, foward_time = 20.960257, backward_time = 1.694720, perf = 36.28 tflops.
STEP-64: step_time = 22.934528 ms, foward_time = 21.068800, backward_time = 1.789952, perf = 35.96 tflops.
STEP-65: step_time = 22.778879 ms, foward_time = 20.873217, backward_time = 1.827840, perf = 36.20 tflops.
STEP-66: step_time = 23.854080 ms, foward_time = 22.033407, backward_time = 1.741824, perf = 34.57 tflops.
STEP-67: step_time = 22.766592 ms, foward_time = 20.986879, backward_time = 1.702912, perf = 36.22 tflops.
STEP-68: step_time = 22.870016 ms, foward_time = 21.046272, backward_time = 1.745920, perf = 36.06 tflops.
STEP-69: step_time = 22.737921 ms, foward_time = 21.001217, backward_time = 1.659904, perf = 36.27 tflops.
STEP-70: step_time = 22.645760 ms, foward_time = 20.781055, backward_time = 1.768448, perf = 36.41 tflops.
STEP-71: step_time = 22.672384 ms, foward_time = 20.925440, backward_time = 1.670144, perf = 36.37 tflops.
STEP-72: step_time = 22.706177 ms, foward_time = 20.785152, backward_time = 1.846272, perf = 36.32 tflops.
STEP-73: step_time = 22.656000 ms, foward_time = 20.838400, backward_time = 1.742848, perf = 36.40 tflops.
STEP-74: step_time = 22.569984 ms, foward_time = 20.826113, backward_time = 1.665024, perf = 36.54 tflops.
STEP-75: step_time = 23.094273 ms, foward_time = 21.279743, backward_time = 1.738752, perf = 35.71 tflops.
STEP-76: step_time = 22.892544 ms, foward_time = 20.955135, backward_time = 1.863680, perf = 36.02 tflops.
STEP-77: step_time = 22.850559 ms, foward_time = 20.974592, backward_time = 1.798144, perf = 36.09 tflops.
STEP-78: step_time = 22.867968 ms, foward_time = 21.011456, backward_time = 1.781760, perf = 36.06 tflops.
STEP-79: step_time = 23.049215 ms, foward_time = 21.127169, backward_time = 1.844224, perf = 35.78 tflops.
STEP-80: step_time = 22.959105 ms, foward_time = 21.046272, backward_time = 1.833984, perf = 35.92 tflops.
STEP-81: step_time = 22.962175 ms, foward_time = 21.007360, backward_time = 1.879040, perf = 35.91 tflops.
STEP-82: step_time = 22.881281 ms, foward_time = 20.959232, backward_time = 1.847296, perf = 36.04 tflops.
STEP-83: step_time = 22.875135 ms, foward_time = 20.993025, backward_time = 1.806336, perf = 36.05 tflops.
STEP-84: step_time = 22.926336 ms, foward_time = 21.072895, backward_time = 1.777664, perf = 35.97 tflops.
STEP-85: step_time = 22.999041 ms, foward_time = 21.101568, backward_time = 1.822720, perf = 35.86 tflops.
STEP-86: step_time = 22.862848 ms, foward_time = 21.040129, backward_time = 1.745920, perf = 36.07 tflops.
STEP-87: step_time = 22.703104 ms, foward_time = 20.957184, backward_time = 1.669120, perf = 36.32 tflops.
STEP-88: step_time = 22.710272 ms, foward_time = 20.843519, backward_time = 1.793024, perf = 36.31 tflops.
STEP-89: step_time = 22.706177 ms, foward_time = 20.869120, backward_time = 1.762304, perf = 36.32 tflops.
STEP-90: step_time = 22.962175 ms, foward_time = 21.083136, backward_time = 1.804288, perf = 35.91 tflops.
STEP-91: step_time = 23.050240 ms, foward_time = 21.212160, backward_time = 1.761280, perf = 35.78 tflops.
STEP-92: step_time = 22.928385 ms, foward_time = 21.031937, backward_time = 1.822720, perf = 35.97 tflops.
STEP-93: step_time = 23.004160 ms, foward_time = 21.090303, backward_time = 1.837056, perf = 35.85 tflops.
STEP-94: step_time = 23.000065 ms, foward_time = 21.168127, backward_time = 1.758208, perf = 35.85 tflops.
STEP-95: step_time = 23.056383 ms, foward_time = 21.152767, backward_time = 1.826816, perf = 35.77 tflops.
STEP-96: step_time = 22.904833 ms, foward_time = 21.134336, backward_time = 1.692672, perf = 36.00 tflops.
STEP-97: step_time = 23.021568 ms, foward_time = 21.213184, backward_time = 1.734656, perf = 35.82 tflops.
STEP-98: step_time = 23.078913 ms, foward_time = 21.154816, backward_time = 1.848320, perf = 35.73 tflops.
STEP-99: step_time = 23.076864 ms, foward_time = 21.185535, backward_time = 1.813504, perf = 35.73 tflops.

[Summary] Average synchronized step_time = 23.00260696411133 ms, forward = 21.118173821767172, backward = 1.8075818677743276.
[Benchmark] world_size = 4, dtype = float16, model_dim = 1024, hidden_size = 4096, samples = 8192, num_local_experts = 16, topK = 2, a2a_ffn_overlap_degree = 1, device = `cuda:0`
STEP-0: step_time = 7537.856445 ms, foward_time = 7526.466797, backward_time = 10.432512, perf = 0.11 tflops.
STEP-1: step_time = 760.344604 ms, foward_time = 34.372608, backward_time = 725.852173, perf = 1.08 tflops.
STEP-2: step_time = 30.106625 ms, foward_time = 28.906496, backward_time = 1.099776, perf = 27.39 tflops.
STEP-3: step_time = 29.165567 ms, foward_time = 27.848703, backward_time = 1.216512, perf = 28.27 tflops.
STEP-4: step_time = 29.489153 ms, foward_time = 27.820032, backward_time = 1.568768, perf = 27.96 tflops.
STEP-5: step_time = 30.728191 ms, foward_time = 29.115393, backward_time = 1.533952, perf = 26.84 tflops.
STEP-6: step_time = 29.537279 ms, foward_time = 27.876352, backward_time = 1.583104, perf = 27.92 tflops.
STEP-7: step_time = 28.982271 ms, foward_time = 27.303936, backward_time = 1.601536, perf = 28.45 tflops.
STEP-8: step_time = 29.367296 ms, foward_time = 27.726849, backward_time = 1.562624, perf = 28.08 tflops.
STEP-9: step_time = 29.381632 ms, foward_time = 27.823105, backward_time = 1.480704, perf = 28.07 tflops.
STEP-10: step_time = 28.877825 ms, foward_time = 27.677696, backward_time = 1.123328, perf = 28.56 tflops.
STEP-11: step_time = 27.502592 ms, foward_time = 26.338305, backward_time = 1.086464, perf = 29.98 tflops.
STEP-12: step_time = 27.514879 ms, foward_time = 26.412031, backward_time = 1.027072, perf = 29.97 tflops.
STEP-13: step_time = 33.043457 ms, foward_time = 31.551489, backward_time = 1.308672, perf = 24.96 tflops.
STEP-14: step_time = 30.641151 ms, foward_time = 29.118464, backward_time = 1.417216, perf = 26.91 tflops.
STEP-15: step_time = 27.871231 ms, foward_time = 26.498049, backward_time = 1.270784, perf = 29.59 tflops.
STEP-16: step_time = 27.573248 ms, foward_time = 26.335232, backward_time = 1.135616, perf = 29.91 tflops.
STEP-17: step_time = 28.361729 ms, foward_time = 26.805248, backward_time = 1.406976, perf = 29.08 tflops.
STEP-18: step_time = 29.690880 ms, foward_time = 27.077633, backward_time = 2.536448, perf = 27.77 tflops.
STEP-19: step_time = 28.389376 ms, foward_time = 26.688513, backward_time = 1.623040, perf = 29.05 tflops.
STEP-20: step_time = 27.737087 ms, foward_time = 26.059776, backward_time = 1.603584, perf = 29.73 tflops.
STEP-21: step_time = 27.741184 ms, foward_time = 26.113024, backward_time = 1.551360, perf = 29.73 tflops.
STEP-22: step_time = 27.955200 ms, foward_time = 25.942017, backward_time = 1.936384, perf = 29.50 tflops.
STEP-23: step_time = 27.970560 ms, foward_time = 26.312704, backward_time = 1.580032, perf = 29.48 tflops.
STEP-24: step_time = 27.497473 ms, foward_time = 26.002432, backward_time = 1.414144, perf = 29.99 tflops.
STEP-25: step_time = 28.158976 ms, foward_time = 26.435583, backward_time = 1.646592, perf = 29.28 tflops.
STEP-26: step_time = 27.849728 ms, foward_time = 26.178560, backward_time = 1.594368, perf = 29.61 tflops.
STEP-27: step_time = 27.554815 ms, foward_time = 25.819136, backward_time = 1.658880, perf = 29.93 tflops.
STEP-28: step_time = 27.657215 ms, foward_time = 25.917440, backward_time = 1.660928, perf = 29.82 tflops.
STEP-29: step_time = 27.544577 ms, foward_time = 25.885696, backward_time = 1.581056, perf = 29.94 tflops.
STEP-30: step_time = 27.597824 ms, foward_time = 26.141697, backward_time = 1.379328, perf = 29.88 tflops.
STEP-31: step_time = 27.249664 ms, foward_time = 25.744385, backward_time = 1.427456, perf = 30.26 tflops.
STEP-32: step_time = 27.574272 ms, foward_time = 26.144768, backward_time = 1.351680, perf = 29.91 tflops.
STEP-33: step_time = 27.087872 ms, foward_time = 25.873407, backward_time = 1.137664, perf = 30.44 tflops.
STEP-34: step_time = 27.285503 ms, foward_time = 25.983999, backward_time = 1.222656, perf = 30.22 tflops.
STEP-35: step_time = 28.026880 ms, foward_time = 26.541056, backward_time = 1.408000, perf = 29.42 tflops.
STEP-36: step_time = 27.577345 ms, foward_time = 26.138624, backward_time = 1.360896, perf = 29.90 tflops.
STEP-37: step_time = 27.042816 ms, foward_time = 25.689089, backward_time = 1.273856, perf = 30.49 tflops.
STEP-38: step_time = 27.378689 ms, foward_time = 26.070017, backward_time = 1.231872, perf = 30.12 tflops.
STEP-39: step_time = 27.342848 ms, foward_time = 25.840639, backward_time = 1.424384, perf = 30.16 tflops.
STEP-40: step_time = 27.896832 ms, foward_time = 25.956352, backward_time = 1.861632, perf = 29.56 tflops.
STEP-41: step_time = 27.360256 ms, foward_time = 26.042368, backward_time = 1.240064, perf = 30.14 tflops.
STEP-42: step_time = 27.413504 ms, foward_time = 25.922560, backward_time = 1.415168, perf = 30.08 tflops.
STEP-43: step_time = 27.062271 ms, foward_time = 25.849855, backward_time = 1.134592, perf = 30.47 tflops.
STEP-44: step_time = 27.366400 ms, foward_time = 25.891840, backward_time = 1.376256, perf = 30.13 tflops.
STEP-45: step_time = 27.540480 ms, foward_time = 26.110975, backward_time = 1.349632, perf = 29.94 tflops.
STEP-46: step_time = 141.928452 ms, foward_time = 139.624451, backward_time = 2.224128, perf = 5.81 tflops.
STEP-47: step_time = 29.054976 ms, foward_time = 27.471872, backward_time = 1.504256, perf = 28.38 tflops.
STEP-48: step_time = 28.537855 ms, foward_time = 26.955776, backward_time = 1.504256, perf = 28.90 tflops.
STEP-49: step_time = 28.449793 ms, foward_time = 26.777599, backward_time = 1.591296, perf = 28.99 tflops.
STEP-50: step_time = 28.623873 ms, foward_time = 26.969088, backward_time = 1.576960, perf = 28.81 tflops.
STEP-51: step_time = 29.272064 ms, foward_time = 26.149887, backward_time = 3.043328, perf = 28.17 tflops.
STEP-52: step_time = 28.081152 ms, foward_time = 26.434561, backward_time = 1.569792, perf = 29.37 tflops.
STEP-53: step_time = 27.294720 ms, foward_time = 25.672705, backward_time = 1.544192, perf = 30.21 tflops.
STEP-54: step_time = 27.187201 ms, foward_time = 25.547775, backward_time = 1.561600, perf = 30.33 tflops.
STEP-55: step_time = 27.609089 ms, foward_time = 25.987072, backward_time = 1.542144, perf = 29.87 tflops.
STEP-56: step_time = 27.439104 ms, foward_time = 25.774080, backward_time = 1.587200, perf = 30.05 tflops.
STEP-57: step_time = 27.297792 ms, foward_time = 25.635839, backward_time = 1.584128, perf = 30.21 tflops.
STEP-58: step_time = 27.944960 ms, foward_time = 26.208256, backward_time = 1.658880, perf = 29.51 tflops.
STEP-59: step_time = 27.408384 ms, foward_time = 25.686016, backward_time = 1.646592, perf = 30.09 tflops.
STEP-60: step_time = 27.328512 ms, foward_time = 25.735168, backward_time = 1.518592, perf = 30.17 tflops.
STEP-61: step_time = 27.149311 ms, foward_time = 25.564159, backward_time = 1.508352, perf = 30.37 tflops.
STEP-62: step_time = 27.469824 ms, foward_time = 25.798656, backward_time = 1.595392, perf = 30.02 tflops.
STEP-63: step_time = 30.256128 ms, foward_time = 28.547071, backward_time = 1.629184, perf = 27.26 tflops.
STEP-64: step_time = 27.911167 ms, foward_time = 26.228737, backward_time = 1.605632, perf = 29.54 tflops.
STEP-65: step_time = 27.828224 ms, foward_time = 26.148865, backward_time = 1.601536, perf = 29.63 tflops.
STEP-66: step_time = 28.308479 ms, foward_time = 26.273792, backward_time = 1.946624, perf = 29.13 tflops.
STEP-67: step_time = 27.582464 ms, foward_time = 25.902081, backward_time = 1.592320, perf = 29.90 tflops.
STEP-68: step_time = 27.662336 ms, foward_time = 25.966593, backward_time = 1.614848, perf = 29.81 tflops.
STEP-69: step_time = 27.543552 ms, foward_time = 25.829376, backward_time = 1.637376, perf = 29.94 tflops.
STEP-70: step_time = 27.421696 ms, foward_time = 25.734144, backward_time = 1.608704, perf = 30.07 tflops.
STEP-71: step_time = 27.352064 ms, foward_time = 25.710592, backward_time = 1.562624, perf = 30.15 tflops.
STEP-72: step_time = 27.813889 ms, foward_time = 25.675776, backward_time = 2.061312, perf = 29.65 tflops.
STEP-73: step_time = 27.527168 ms, foward_time = 25.825279, backward_time = 1.623040, perf = 29.96 tflops.
STEP-74: step_time = 27.727873 ms, foward_time = 25.945087, backward_time = 1.705984, perf = 29.74 tflops.
STEP-75: step_time = 27.354113 ms, foward_time = 25.724928, backward_time = 1.552384, perf = 30.15 tflops.
STEP-76: step_time = 27.296768 ms, foward_time = 25.721855, backward_time = 1.498112, perf = 30.21 tflops.
STEP-77: step_time = 28.053505 ms, foward_time = 26.313728, backward_time = 1.659904, perf = 29.40 tflops.
STEP-78: step_time = 27.445248 ms, foward_time = 25.716736, backward_time = 1.650688, perf = 30.05 tflops.
STEP-79: step_time = 27.714560 ms, foward_time = 25.853952, backward_time = 1.782784, perf = 29.75 tflops.
STEP-80: step_time = 27.623425 ms, foward_time = 25.962496, backward_time = 1.584128, perf = 29.85 tflops.
STEP-81: step_time = 27.316223 ms, foward_time = 25.662464, backward_time = 1.576960, perf = 30.19 tflops.
STEP-82: step_time = 27.720703 ms, foward_time = 26.011648, backward_time = 1.630208, perf = 29.75 tflops.
STEP-83: step_time = 27.460608 ms, foward_time = 25.776129, backward_time = 1.606656, perf = 30.03 tflops.
STEP-84: step_time = 27.524096 ms, foward_time = 25.801727, backward_time = 1.634304, perf = 29.96 tflops.
STEP-85: step_time = 27.610111 ms, foward_time = 25.944063, backward_time = 1.575936, perf = 29.87 tflops.
STEP-86: step_time = 27.382784 ms, foward_time = 25.695232, backward_time = 1.607680, perf = 30.12 tflops.
STEP-87: step_time = 27.499519 ms, foward_time = 25.798656, backward_time = 1.620992, perf = 29.99 tflops.
STEP-88: step_time = 27.583488 ms, foward_time = 25.848831, backward_time = 1.652736, perf = 29.90 tflops.
STEP-89: step_time = 27.754496 ms, foward_time = 26.036224, backward_time = 1.638400, perf = 29.71 tflops.
STEP-90: step_time = 28.110847 ms, foward_time = 26.456064, backward_time = 1.575936, perf = 29.34 tflops.
STEP-91: step_time = 27.270144 ms, foward_time = 25.527296, backward_time = 1.640448, perf = 30.24 tflops.
STEP-92: step_time = 27.352064 ms, foward_time = 25.573376, backward_time = 1.700864, perf = 30.15 tflops.
STEP-93: step_time = 27.343872 ms, foward_time = 25.715712, backward_time = 1.550336, perf = 30.16 tflops.
STEP-94: step_time = 27.369473 ms, foward_time = 25.729025, backward_time = 1.565696, perf = 30.13 tflops.
STEP-95: step_time = 27.520000 ms, foward_time = 25.787392, backward_time = 1.654784, perf = 29.96 tflops.
STEP-96: step_time = 27.906048 ms, foward_time = 26.219521, backward_time = 1.603584, perf = 29.55 tflops.
STEP-97: step_time = 27.262976 ms, foward_time = 25.583616, backward_time = 1.600512, perf = 30.25 tflops.
STEP-98: step_time = 27.356159 ms, foward_time = 25.678848, backward_time = 1.600512, perf = 30.14 tflops.
STEP-99: step_time = 27.154432 ms, foward_time = 25.480192, backward_time = 1.595392, perf = 30.37 tflops.

[Summary] Average synchronized step_time = 29.59395840962728 ms, forward = 27.886233647664387, backward = 1.6281258622805277.
[Benchmark] world_size = 4, dtype = float16, model_dim = 1024, hidden_size = 4096, samples = 8192, num_local_experts = 32, topK = 2, a2a_ffn_overlap_degree = 1, device = `cuda:0`
STEP-0: step_time = 7035.340820 ms, foward_time = 7027.894043, backward_time = 6.531072, perf = 0.12 tflops.
STEP-1: step_time = 45.756416 ms, foward_time = 43.295746, backward_time = 2.349056, perf = 18.02 tflops.
STEP-2: step_time = 34.593792 ms, foward_time = 32.947201, backward_time = 1.549312, perf = 23.84 tflops.
STEP-3: step_time = 34.464767 ms, foward_time = 32.745472, backward_time = 1.620992, perf = 23.93 tflops.
STEP-4: step_time = 34.886658 ms, foward_time = 33.047550, backward_time = 1.738752, perf = 23.64 tflops.
STEP-5: step_time = 34.497536 ms, foward_time = 32.558079, backward_time = 1.858560, perf = 23.90 tflops.
STEP-6: step_time = 34.219009 ms, foward_time = 32.344063, backward_time = 1.796096, perf = 24.10 tflops.
STEP-7: step_time = 32.924671 ms, foward_time = 31.092735, backward_time = 1.754112, perf = 25.05 tflops.
STEP-8: step_time = 32.435200 ms, foward_time = 30.711807, backward_time = 1.643520, perf = 25.42 tflops.
STEP-9: step_time = 32.658432 ms, foward_time = 30.970881, backward_time = 1.606656, perf = 25.25 tflops.
STEP-10: step_time = 32.492542 ms, foward_time = 30.947329, backward_time = 1.465344, perf = 25.38 tflops.
STEP-11: step_time = 32.242687 ms, foward_time = 30.710785, backward_time = 1.456128, perf = 25.58 tflops.
STEP-12: step_time = 32.430080 ms, foward_time = 30.696447, backward_time = 1.659904, perf = 25.43 tflops.
STEP-13: step_time = 34.547710 ms, foward_time = 32.870399, backward_time = 1.598464, perf = 23.87 tflops.
STEP-14: step_time = 32.208897 ms, foward_time = 30.639105, backward_time = 1.494016, perf = 25.60 tflops.
STEP-15: step_time = 32.695297 ms, foward_time = 31.022079, backward_time = 1.576960, perf = 25.22 tflops.
STEP-16: step_time = 32.242687 ms, foward_time = 30.619648, backward_time = 1.546240, perf = 25.58 tflops.
STEP-17: step_time = 34.240513 ms, foward_time = 32.500736, backward_time = 1.648640, perf = 24.08 tflops.
STEP-18: step_time = 35.271679 ms, foward_time = 33.528831, backward_time = 1.629184, perf = 23.38 tflops.
STEP-19: step_time = 32.729088 ms, foward_time = 31.066113, backward_time = 1.573888, perf = 25.20 tflops.
STEP-20: step_time = 32.480255 ms, foward_time = 30.685184, backward_time = 1.703936, perf = 25.39 tflops.
STEP-21: step_time = 32.106495 ms, foward_time = 30.322687, backward_time = 1.710080, perf = 25.68 tflops.
STEP-22: step_time = 32.087040 ms, foward_time = 30.363647, backward_time = 1.653760, perf = 25.70 tflops.
STEP-23: step_time = 32.037888 ms, foward_time = 30.313473, backward_time = 1.653760, perf = 25.74 tflops.
STEP-24: step_time = 33.933311 ms, foward_time = 32.211967, backward_time = 1.651712, perf = 24.30 tflops.
STEP-25: step_time = 32.099327 ms, foward_time = 30.404608, backward_time = 1.627136, perf = 25.69 tflops.
STEP-26: step_time = 32.202751 ms, foward_time = 30.435328, backward_time = 1.696768, perf = 25.61 tflops.
STEP-27: step_time = 32.137215 ms, foward_time = 30.341120, backward_time = 1.728512, perf = 25.66 tflops.
STEP-28: step_time = 32.137215 ms, foward_time = 30.297089, backward_time = 1.773568, perf = 25.66 tflops.
STEP-29: step_time = 32.108543 ms, foward_time = 30.371840, backward_time = 1.665024, perf = 25.68 tflops.
STEP-30: step_time = 34.839554 ms, foward_time = 33.021954, backward_time = 1.747968, perf = 23.67 tflops.
STEP-31: step_time = 32.107521 ms, foward_time = 30.393345, backward_time = 1.644544, perf = 25.68 tflops.
STEP-32: step_time = 32.294910 ms, foward_time = 30.492672, backward_time = 1.733632, perf = 25.53 tflops.
STEP-33: step_time = 32.204800 ms, foward_time = 30.457855, backward_time = 1.676288, perf = 25.61 tflops.
STEP-34: step_time = 32.654335 ms, foward_time = 30.803968, backward_time = 1.772544, perf = 25.25 tflops.
STEP-35: step_time = 32.087040 ms, foward_time = 30.280704, backward_time = 1.728512, perf = 25.70 tflops.
STEP-36: step_time = 32.164864 ms, foward_time = 30.423040, backward_time = 1.676288, perf = 25.64 tflops.
STEP-37: step_time = 32.247807 ms, foward_time = 30.410751, backward_time = 1.767424, perf = 25.57 tflops.
STEP-38: step_time = 33.232895 ms, foward_time = 31.376385, backward_time = 1.674240, perf = 24.81 tflops.
STEP-39: step_time = 32.659454 ms, foward_time = 30.893057, backward_time = 1.693696, perf = 25.25 tflops.
STEP-40: step_time = 32.148479 ms, foward_time = 30.405632, backward_time = 1.672192, perf = 25.65 tflops.
STEP-41: step_time = 32.758785 ms, foward_time = 31.069183, backward_time = 1.597440, perf = 25.17 tflops.
STEP-42: step_time = 32.199680 ms, foward_time = 30.505983, backward_time = 1.623040, perf = 25.61 tflops.
STEP-43: step_time = 32.205826 ms, foward_time = 30.512129, backward_time = 1.624064, perf = 25.61 tflops.
STEP-44: step_time = 32.412670 ms, foward_time = 30.725121, backward_time = 1.618944, perf = 25.44 tflops.
STEP-45: step_time = 33.415169 ms, foward_time = 31.332352, backward_time = 1.972224, perf = 24.68 tflops.
STEP-46: step_time = 32.764927 ms, foward_time = 30.962688, backward_time = 1.730560, perf = 25.17 tflops.
STEP-47: step_time = 32.081921 ms, foward_time = 30.318592, backward_time = 1.693696, perf = 25.70 tflops.
STEP-48: step_time = 34.552834 ms, foward_time = 32.798721, backward_time = 1.684480, perf = 23.87 tflops.
STEP-49: step_time = 32.061440 ms, foward_time = 30.352385, backward_time = 1.623040, perf = 25.72 tflops.
STEP-50: step_time = 31.937536 ms, foward_time = 30.190592, backward_time = 1.677312, perf = 25.82 tflops.
STEP-51: step_time = 32.124928 ms, foward_time = 30.420992, backward_time = 1.634304, perf = 25.67 tflops.
STEP-52: step_time = 33.315842 ms, foward_time = 31.399937, backward_time = 1.848320, perf = 24.75 tflops.
STEP-53: step_time = 32.154625 ms, foward_time = 30.317568, backward_time = 1.767424, perf = 25.65 tflops.
STEP-54: step_time = 32.411648 ms, foward_time = 30.493696, backward_time = 1.850368, perf = 25.44 tflops.
STEP-55: step_time = 32.418816 ms, foward_time = 30.635008, backward_time = 1.713152, perf = 25.44 tflops.
STEP-56: step_time = 32.395264 ms, foward_time = 30.487553, backward_time = 1.838080, perf = 25.46 tflops.
STEP-57: step_time = 32.347137 ms, foward_time = 30.544895, backward_time = 1.731584, perf = 25.49 tflops.
STEP-58: step_time = 32.249855 ms, foward_time = 30.503937, backward_time = 1.676288, perf = 25.57 tflops.
STEP-59: step_time = 32.059391 ms, foward_time = 30.289921, backward_time = 1.699840, perf = 25.72 tflops.
STEP-60: step_time = 32.324608 ms, foward_time = 30.529535, backward_time = 1.725440, perf = 25.51 tflops.
STEP-61: step_time = 31.948799 ms, foward_time = 30.203903, backward_time = 1.677312, perf = 25.81 tflops.
STEP-62: step_time = 31.917055 ms, foward_time = 30.363647, backward_time = 1.478656, perf = 25.84 tflops.
STEP-63: step_time = 31.984640 ms, foward_time = 30.213120, backward_time = 1.692672, perf = 25.78 tflops.
STEP-64: step_time = 31.904768 ms, foward_time = 30.113792, backward_time = 1.725440, perf = 25.85 tflops.
STEP-65: step_time = 33.843201 ms, foward_time = 32.061440, backward_time = 1.715200, perf = 24.37 tflops.
STEP-66: step_time = 31.823872 ms, foward_time = 30.061567, backward_time = 1.695744, perf = 25.91 tflops.
STEP-67: step_time = 32.032768 ms, foward_time = 30.267391, backward_time = 1.698816, perf = 25.74 tflops.
STEP-68: step_time = 31.863808 ms, foward_time = 30.095360, backward_time = 1.696768, perf = 25.88 tflops.
STEP-69: step_time = 32.013313 ms, foward_time = 30.219263, backward_time = 1.722368, perf = 25.76 tflops.
STEP-70: step_time = 32.324608 ms, foward_time = 30.531584, backward_time = 1.725440, perf = 25.51 tflops.
STEP-71: step_time = 31.791103 ms, foward_time = 30.052353, backward_time = 1.668096, perf = 25.94 tflops.
STEP-72: step_time = 32.262142 ms, foward_time = 30.352385, backward_time = 1.843200, perf = 25.56 tflops.
STEP-73: step_time = 32.308224 ms, foward_time = 30.488577, backward_time = 1.750016, perf = 25.52 tflops.
STEP-74: step_time = 35.298306 ms, foward_time = 32.044033, backward_time = 3.165184, perf = 23.36 tflops.
STEP-75: step_time = 33.418240 ms, foward_time = 31.517696, backward_time = 1.811456, perf = 24.68 tflops.
STEP-76: step_time = 35.160065 ms, foward_time = 33.302528, backward_time = 1.770496, perf = 23.45 tflops.
STEP-77: step_time = 34.085888 ms, foward_time = 32.277504, backward_time = 1.719296, perf = 24.19 tflops.
STEP-78: step_time = 34.264065 ms, foward_time = 32.401409, backward_time = 1.792000, perf = 24.07 tflops.
STEP-79: step_time = 34.223103 ms, foward_time = 32.325630, backward_time = 1.827840, perf = 24.10 tflops.
STEP-80: step_time = 34.207745 ms, foward_time = 32.259071, backward_time = 1.878016, perf = 24.11 tflops.
STEP-81: step_time = 33.703938 ms, foward_time = 31.907841, backward_time = 1.726464, perf = 24.47 tflops.
STEP-82: step_time = 33.332226 ms, foward_time = 31.424513, backward_time = 1.812480, perf = 24.74 tflops.
STEP-83: step_time = 32.862209 ms, foward_time = 31.030272, backward_time = 1.760256, perf = 25.09 tflops.
STEP-84: step_time = 32.124928 ms, foward_time = 30.341120, backward_time = 1.712128, perf = 25.67 tflops.
STEP-85: step_time = 32.160767 ms, foward_time = 30.400513, backward_time = 1.695744, perf = 25.64 tflops.
STEP-86: step_time = 32.415745 ms, foward_time = 30.583809, backward_time = 1.765376, perf = 25.44 tflops.
STEP-87: step_time = 32.514050 ms, foward_time = 30.715904, backward_time = 1.707008, perf = 25.36 tflops.
STEP-88: step_time = 32.528385 ms, foward_time = 30.746624, backward_time = 1.716224, perf = 25.35 tflops.
STEP-89: step_time = 32.464897 ms, foward_time = 30.672895, backward_time = 1.725440, perf = 25.40 tflops.
STEP-90: step_time = 32.122879 ms, foward_time = 30.380032, backward_time = 1.675264, perf = 25.67 tflops.
STEP-91: step_time = 32.234497 ms, foward_time = 30.435328, backward_time = 1.731584, perf = 25.58 tflops.
STEP-92: step_time = 32.823296 ms, foward_time = 30.482431, backward_time = 2.267136, perf = 25.12 tflops.
STEP-93: step_time = 32.610306 ms, foward_time = 30.798847, backward_time = 1.744896, perf = 25.29 tflops.
STEP-94: step_time = 32.079872 ms, foward_time = 30.355455, backward_time = 1.657856, perf = 25.71 tflops.
STEP-95: step_time = 32.275455 ms, foward_time = 30.597120, backward_time = 1.611776, perf = 25.55 tflops.
STEP-96: step_time = 32.135166 ms, foward_time = 30.410751, backward_time = 1.657856, perf = 25.66 tflops.
STEP-97: step_time = 32.228352 ms, foward_time = 30.504959, backward_time = 1.657856, perf = 25.59 tflops.
STEP-98: step_time = 32.224255 ms, foward_time = 30.558208, backward_time = 1.595392, perf = 25.59 tflops.
STEP-99: step_time = 32.471039 ms, foward_time = 30.719999, backward_time = 1.680384, perf = 25.40 tflops.

[Summary] Average synchronized step_time = 32.6388224919637 ms, forward = 30.816921583811443, backward = 1.7492821355660757.
[Benchmark] world_size = 4, dtype = float16, model_dim = 1024, hidden_size = 4096, samples = 8192, num_local_experts = 64, topK = 2, a2a_ffn_overlap_degree = 1, device = `cuda:0`
STEP-0: step_time = 7318.959961 ms, foward_time = 7308.192871, backward_time = 9.505792, perf = 0.11 tflops.
STEP-1: step_time = 776.849426 ms, foward_time = 51.682304, backward_time = 724.954102, perf = 1.06 tflops.
STEP-2: step_time = 46.696449 ms, foward_time = 42.982399, backward_time = 3.608576, perf = 17.66 tflops.
STEP-3: step_time = 43.013119 ms, foward_time = 41.097218, backward_time = 1.815552, perf = 19.17 tflops.
STEP-4: step_time = 45.950977 ms, foward_time = 44.077057, backward_time = 1.745920, perf = 17.95 tflops.
STEP-5: step_time = 168.292358 ms, foward_time = 165.819397, backward_time = 2.349056, perf = 4.90 tflops.
STEP-6: step_time = 41.456638 ms, foward_time = 39.201794, backward_time = 2.179072, perf = 19.89 tflops.
STEP-7: step_time = 40.803329 ms, foward_time = 38.760448, backward_time = 1.946624, perf = 20.21 tflops.
STEP-8: step_time = 42.245121 ms, foward_time = 40.039425, backward_time = 2.136064, perf = 19.52 tflops.
STEP-9: step_time = 40.164352 ms, foward_time = 37.900288, backward_time = 2.196480, perf = 20.53 tflops.
STEP-10: step_time = 38.454273 ms, foward_time = 36.443134, backward_time = 1.942528, perf = 21.44 tflops.
STEP-11: step_time = 38.217728 ms, foward_time = 36.144127, backward_time = 2.004992, perf = 21.58 tflops.
STEP-12: step_time = 38.368256 ms, foward_time = 36.358143, backward_time = 1.942528, perf = 21.49 tflops.
STEP-13: step_time = 37.961727 ms, foward_time = 36.090881, backward_time = 1.799168, perf = 21.72 tflops.
STEP-14: step_time = 38.092800 ms, foward_time = 36.178944, backward_time = 1.839104, perf = 21.65 tflops.
STEP-15: step_time = 38.608894 ms, foward_time = 36.634624, backward_time = 1.886208, perf = 21.36 tflops.
STEP-16: step_time = 38.258690 ms, foward_time = 36.120575, backward_time = 2.070528, perf = 21.55 tflops.
STEP-17: step_time = 38.324223 ms, foward_time = 36.356094, backward_time = 1.896448, perf = 21.52 tflops.
STEP-18: step_time = 38.305794 ms, foward_time = 36.413441, backward_time = 1.821696, perf = 21.53 tflops.
STEP-19: step_time = 38.433792 ms, foward_time = 36.476929, backward_time = 1.885184, perf = 21.46 tflops.
STEP-20: step_time = 38.430721 ms, foward_time = 36.411392, backward_time = 1.951744, perf = 21.46 tflops.
STEP-21: step_time = 38.525951 ms, foward_time = 36.683777, backward_time = 1.769472, perf = 21.40 tflops.
STEP-22: step_time = 38.930431 ms, foward_time = 37.136383, backward_time = 1.724416, perf = 21.18 tflops.
STEP-23: step_time = 43.037697 ms, foward_time = 39.429119, backward_time = 3.537920, perf = 19.16 tflops.
STEP-24: step_time = 39.678974 ms, foward_time = 37.686272, backward_time = 1.918976, perf = 20.78 tflops.
STEP-25: step_time = 39.568382 ms, foward_time = 37.542912, backward_time = 1.956864, perf = 20.84 tflops.
STEP-26: step_time = 37.880833 ms, foward_time = 36.007935, backward_time = 1.802240, perf = 21.77 tflops.
STEP-27: step_time = 38.286335 ms, foward_time = 36.477951, backward_time = 1.740800, perf = 21.54 tflops.
STEP-28: step_time = 38.042625 ms, foward_time = 36.104191, backward_time = 1.869824, perf = 21.68 tflops.
STEP-29: step_time = 38.768639 ms, foward_time = 36.872192, backward_time = 1.824768, perf = 21.27 tflops.
STEP-30: step_time = 37.787647 ms, foward_time = 36.037632, backward_time = 1.681408, perf = 21.82 tflops.
STEP-31: step_time = 40.128513 ms, foward_time = 37.156864, backward_time = 2.899968, perf = 20.55 tflops.
STEP-32: step_time = 39.155712 ms, foward_time = 37.176319, backward_time = 1.907712, perf = 21.06 tflops.
STEP-33: step_time = 38.907906 ms, foward_time = 37.018623, backward_time = 1.818624, perf = 21.19 tflops.
STEP-34: step_time = 40.928257 ms, foward_time = 38.823936, backward_time = 1.916928, perf = 20.15 tflops.
STEP-35: step_time = 39.053310 ms, foward_time = 37.063679, backward_time = 1.920000, perf = 21.12 tflops.
STEP-36: step_time = 38.119423 ms, foward_time = 36.299774, backward_time = 1.751040, perf = 21.63 tflops.
STEP-37: step_time = 38.037502 ms, foward_time = 36.249599, backward_time = 1.718272, perf = 21.68 tflops.
STEP-38: step_time = 38.547455 ms, foward_time = 36.568066, backward_time = 1.901568, perf = 21.39 tflops.
STEP-39: step_time = 42.494976 ms, foward_time = 39.542786, backward_time = 2.881536, perf = 19.41 tflops.
STEP-40: step_time = 38.920193 ms, foward_time = 37.099522, backward_time = 1.751040, perf = 21.19 tflops.
STEP-41: step_time = 39.305218 ms, foward_time = 37.391361, backward_time = 1.842176, perf = 20.98 tflops.
STEP-42: step_time = 38.096897 ms, foward_time = 36.278271, backward_time = 1.741824, perf = 21.65 tflops.
STEP-43: step_time = 39.783424 ms, foward_time = 37.504002, backward_time = 2.208768, perf = 20.73 tflops.
STEP-44: step_time = 38.418430 ms, foward_time = 36.573185, backward_time = 1.773568, perf = 21.46 tflops.
STEP-45: step_time = 38.046719 ms, foward_time = 36.278271, backward_time = 1.697792, perf = 21.67 tflops.
STEP-46: step_time = 38.258690 ms, foward_time = 36.434944, backward_time = 1.754112, perf = 21.55 tflops.
STEP-47: step_time = 38.670338 ms, foward_time = 36.359169, backward_time = 2.237440, perf = 21.32 tflops.
STEP-48: step_time = 38.221825 ms, foward_time = 36.341759, backward_time = 1.812480, perf = 21.57 tflops.
STEP-49: step_time = 38.714367 ms, foward_time = 36.943871, backward_time = 1.702912, perf = 21.30 tflops.
STEP-50: step_time = 37.933056 ms, foward_time = 36.164608, backward_time = 1.699840, perf = 21.74 tflops.
STEP-51: step_time = 38.319103 ms, foward_time = 36.399105, backward_time = 1.848320, perf = 21.52 tflops.
STEP-52: step_time = 38.472706 ms, foward_time = 36.636673, backward_time = 1.766400, perf = 21.43 tflops.
STEP-53: step_time = 38.076416 ms, foward_time = 36.232193, backward_time = 1.776640, perf = 21.66 tflops.
STEP-54: step_time = 38.045696 ms, foward_time = 36.223999, backward_time = 1.753088, perf = 21.67 tflops.
STEP-55: step_time = 38.493183 ms, foward_time = 36.605953, backward_time = 1.817600, perf = 21.42 tflops.
STEP-56: step_time = 38.043648 ms, foward_time = 36.205566, backward_time = 1.767424, perf = 21.68 tflops.
STEP-57: step_time = 38.060032 ms, foward_time = 36.174847, backward_time = 1.815552, perf = 21.67 tflops.
STEP-58: step_time = 38.264832 ms, foward_time = 36.346882, backward_time = 1.848320, perf = 21.55 tflops.
STEP-59: step_time = 38.174721 ms, foward_time = 36.254719, backward_time = 1.848320, perf = 21.60 tflops.
STEP-60: step_time = 38.137856 ms, foward_time = 36.356094, backward_time = 1.711104, perf = 21.62 tflops.
STEP-61: step_time = 38.198273 ms, foward_time = 36.402176, backward_time = 1.726464, perf = 21.59 tflops.
STEP-62: step_time = 38.286335 ms, foward_time = 36.432896, backward_time = 1.783808, perf = 21.54 tflops.
STEP-63: step_time = 38.257664 ms, foward_time = 36.337666, backward_time = 1.849344, perf = 21.55 tflops.
STEP-64: step_time = 39.065601 ms, foward_time = 36.779007, backward_time = 2.215936, perf = 21.11 tflops.
STEP-65: step_time = 38.355968 ms, foward_time = 36.584450, backward_time = 1.686528, perf = 21.50 tflops.
STEP-66: step_time = 38.074368 ms, foward_time = 36.213760, backward_time = 1.788928, perf = 21.66 tflops.
STEP-67: step_time = 38.137856 ms, foward_time = 36.304897, backward_time = 1.762304, perf = 21.62 tflops.
STEP-68: step_time = 38.644737 ms, foward_time = 36.710400, backward_time = 1.862656, perf = 21.34 tflops.
STEP-69: step_time = 37.880833 ms, foward_time = 36.052994, backward_time = 1.757184, perf = 21.77 tflops.
STEP-70: step_time = 38.204414 ms, foward_time = 36.362240, backward_time = 1.760256, perf = 21.58 tflops.
STEP-71: step_time = 38.682625 ms, foward_time = 36.756481, backward_time = 1.852416, perf = 21.32 tflops.
STEP-72: step_time = 38.832127 ms, foward_time = 36.950016, backward_time = 1.812480, perf = 21.24 tflops.
STEP-73: step_time = 38.203392 ms, foward_time = 36.218880, backward_time = 1.915904, perf = 21.59 tflops.
STEP-74: step_time = 38.630402 ms, foward_time = 36.653057, backward_time = 1.905664, perf = 21.35 tflops.
STEP-75: step_time = 39.991295 ms, foward_time = 38.047745, backward_time = 1.846272, perf = 20.62 tflops.
STEP-76: step_time = 39.140350 ms, foward_time = 37.139458, backward_time = 1.931264, perf = 21.07 tflops.
STEP-77: step_time = 38.347775 ms, foward_time = 36.420609, backward_time = 1.854464, perf = 21.50 tflops.
STEP-78: step_time = 38.242306 ms, foward_time = 36.344833, backward_time = 1.824768, perf = 21.56 tflops.
STEP-79: step_time = 38.214657 ms, foward_time = 36.376575, backward_time = 1.741824, perf = 21.58 tflops.
STEP-80: step_time = 39.843842 ms, foward_time = 37.725185, backward_time = 2.041856, perf = 20.70 tflops.
STEP-81: step_time = 38.257664 ms, foward_time = 36.363262, backward_time = 1.823744, perf = 21.55 tflops.
STEP-82: step_time = 37.932034 ms, foward_time = 35.979263, backward_time = 1.885184, perf = 21.74 tflops.
STEP-83: step_time = 38.008831 ms, foward_time = 36.179970, backward_time = 1.760256, perf = 21.70 tflops.
STEP-84: step_time = 38.203392 ms, foward_time = 36.323326, backward_time = 1.809408, perf = 21.59 tflops.
STEP-85: step_time = 38.618111 ms, foward_time = 36.704254, backward_time = 1.840128, perf = 21.35 tflops.
STEP-86: step_time = 38.333439 ms, foward_time = 36.540417, backward_time = 1.723392, perf = 21.51 tflops.
STEP-87: step_time = 37.864449 ms, foward_time = 36.060162, backward_time = 1.734656, perf = 21.78 tflops.
STEP-88: step_time = 38.168575 ms, foward_time = 36.222977, backward_time = 1.868800, perf = 21.61 tflops.
STEP-89: step_time = 38.097919 ms, foward_time = 36.133888, backward_time = 1.897472, perf = 21.65 tflops.
STEP-90: step_time = 38.130688 ms, foward_time = 36.226048, backward_time = 1.836032, perf = 21.63 tflops.
STEP-91: step_time = 37.948418 ms, foward_time = 36.174847, backward_time = 1.701888, perf = 21.73 tflops.
STEP-92: step_time = 38.193153 ms, foward_time = 36.263935, backward_time = 1.861632, perf = 21.59 tflops.
STEP-93: step_time = 38.168575 ms, foward_time = 36.209663, backward_time = 1.890304, perf = 21.61 tflops.
STEP-94: step_time = 38.154240 ms, foward_time = 36.147202, backward_time = 1.937408, perf = 21.61 tflops.
STEP-95: step_time = 38.291454 ms, foward_time = 36.292606, backward_time = 1.926144, perf = 21.54 tflops.
STEP-96: step_time = 38.200321 ms, foward_time = 36.374527, backward_time = 1.756160, perf = 21.59 tflops.
STEP-97: step_time = 37.897217 ms, foward_time = 36.164608, backward_time = 1.661952, perf = 21.76 tflops.
STEP-98: step_time = 37.936127 ms, foward_time = 36.120575, backward_time = 1.744896, perf = 21.74 tflops.
STEP-99: step_time = 38.042625 ms, foward_time = 36.161537, backward_time = 1.810432, perf = 21.68 tflops.

[Summary] Average synchronized step_time = 38.36898994445801 ms, forward = 36.47102305094401, backward = 1.826082138220469.
